(async()=>{function _mergeNamespaces(U,D){for(var F=0;F<D.length;F++){const G=D[F];if(typeof G!="string"&&!Array.isArray(G)){for(const Q in G)if(Q!=="default"&&!(Q in U)){const X=Object.getOwnPropertyDescriptor(G,Q);X&&Object.defineProperty(U,Q,X.get?X:{enumerable:!0,get:()=>G[Q]})}}}return Object.freeze(Object.defineProperty(U,Symbol.toStringTag,{value:"Module"}))}(function(){const D=document.createElement("link").relList;if(D&&D.supports&&D.supports("modulepreload"))return;for(const Q of document.querySelectorAll('link[rel="modulepreload"]'))G(Q);new MutationObserver(Q=>{for(const X of Q)if(X.type==="childList")for(const q of X.addedNodes)q.tagName==="LINK"&&q.rel==="modulepreload"&&G(q)}).observe(document,{childList:!0,subtree:!0});function F(Q){const X={};return Q.integrity&&(X.integrity=Q.integrity),Q.referrerPolicy&&(X.referrerPolicy=Q.referrerPolicy),Q.crossOrigin==="use-credentials"?X.credentials="include":Q.crossOrigin==="anonymous"?X.credentials="omit":X.credentials="same-origin",X}function G(Q){if(Q.ep)return;Q.ep=!0;const X=F(Q);fetch(Q.href,X)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(U){return U&&U.__esModule&&Object.prototype.hasOwnProperty.call(U,"default")?U.default:U}var moizeExports={},moize$1={get exports(){return moizeExports},set exports(U){moizeExports=U}},microMemoizeExports={},microMemoize={get exports(){return microMemoizeExports},set exports(U){microMemoizeExports=U}},hasRequiredMicroMemoize;function requireMicroMemoize(){return hasRequiredMicroMemoize||(hasRequiredMicroMemoize=1,function(U,D){(function(F,G){U.exports=G()})(commonjsGlobal,function(){var F={isEqual:!0,isMatchingKey:!0,isPromise:!0,maxSize:!0,onCacheAdd:!0,onCacheChange:!0,onCacheHit:!0,transformKey:!0},G=Array.prototype.slice;function Q(Z){var ee=Z.length;return ee?ee===1?[Z[0]]:ee===2?[Z[0],Z[1]]:ee===3?[Z[0],Z[1],Z[2]]:G.call(Z,0):[]}function X(Z){var ee={};for(var re in Z)F[re]||(ee[re]=Z[re]);return ee}function q(Z){return typeof Z=="function"&&Z.isMemoized}function W(Z,ee){return Z===ee||Z!==Z&&ee!==ee}function Y(Z,ee){var re={};for(var ne in Z)re[ne]=Z[ne];for(var ne in ee)re[ne]=ee[ne];return re}var J=function(){function Z(ee){this.keys=[],this.values=[],this.options=ee;var re=typeof ee.isMatchingKey=="function";re?this.getKeyIndex=this._getKeyIndexFromMatchingKey:ee.maxSize>1?this.getKeyIndex=this._getKeyIndexForMany:this.getKeyIndex=this._getKeyIndexForSingle,this.canTransformKey=typeof ee.transformKey=="function",this.shouldCloneArguments=this.canTransformKey||re,this.shouldUpdateOnAdd=typeof ee.onCacheAdd=="function",this.shouldUpdateOnChange=typeof ee.onCacheChange=="function",this.shouldUpdateOnHit=typeof ee.onCacheHit=="function"}return Object.defineProperty(Z.prototype,"size",{get:function(){return this.keys.length},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"snapshot",{get:function(){return{keys:Q(this.keys),size:this.size,values:Q(this.values)}},enumerable:!1,configurable:!0}),Z.prototype._getKeyIndexFromMatchingKey=function(ee){var re=this.options,ne=re.isMatchingKey,le=re.maxSize,se=this.keys,ie=se.length;if(!ie)return-1;if(ne(se[0],ee))return 0;if(le>1){for(var ge=1;ge<ie;ge++)if(ne(se[ge],ee))return ge}return-1},Z.prototype._getKeyIndexForMany=function(ee){var re=this.options.isEqual,ne=this.keys,le=ne.length;if(!le)return-1;if(le===1)return this._getKeyIndexForSingle(ee);var se=ee.length,ie,ge;if(se>1){for(var fe=0;fe<le;fe++)if(ie=ne[fe],ie.length===se){for(ge=0;ge<se&&re(ie[ge],ee[ge]);ge++);if(ge===se)return fe}}else for(var fe=0;fe<le;fe++)if(ie=ne[fe],ie.length===se&&re(ie[0],ee[0]))return fe;return-1},Z.prototype._getKeyIndexForSingle=function(ee){var re=this.keys;if(!re.length)return-1;var ne=re[0],le=ne.length;if(ee.length!==le)return-1;var se=this.options.isEqual;if(le>1){for(var ie=0;ie<le;ie++)if(!se(ne[ie],ee[ie]))return-1;return 0}return se(ne[0],ee[0])?0:-1},Z.prototype.orderByLru=function(ee,re,ne){for(var le=this.keys,se=this.values,ie=le.length,ge=ne;ge--;)le[ge+1]=le[ge],se[ge+1]=se[ge];le[0]=ee,se[0]=re;var fe=this.options.maxSize;ie===fe&&ne===ie?(le.pop(),se.pop()):ne>=fe&&(le.length=se.length=fe)},Z.prototype.updateAsyncCache=function(ee){var re=this,ne=this.options,le=ne.onCacheChange,se=ne.onCacheHit,ie=this.keys[0],ge=this.values[0];this.values[0]=ge.then(function(fe){return re.shouldUpdateOnHit&&se(re,re.options,ee),re.shouldUpdateOnChange&&le(re,re.options,ee),fe},function(fe){var ae=re.getKeyIndex(ie);throw ae!==-1&&(re.keys.splice(ae,1),re.values.splice(ae,1)),fe})},Z}();function te(Z,ee){if(ee===void 0&&(ee={}),q(Z))return te(Z.fn,Y(Z.options,ee));if(typeof Z!="function")throw new TypeError("You must pass a function to `memoize`.");var re=ee.isEqual,ne=re===void 0?W:re,le=ee.isMatchingKey,se=ee.isPromise,ie=se===void 0?!1:se,ge=ee.maxSize,fe=ge===void 0?1:ge,ae=ee.onCacheAdd,ue=ee.onCacheChange,pe=ee.onCacheHit,_e=ee.transformKey,xe=Y({isEqual:ne,isMatchingKey:le,isPromise:ie,maxSize:fe,onCacheAdd:ae,onCacheChange:ue,onCacheHit:pe,transformKey:_e},X(ee)),be=new J(xe),Te=be.keys,ye=be.values,Ee=be.canTransformKey,he=be.shouldCloneArguments,oe=be.shouldUpdateOnAdd,me=be.shouldUpdateOnChange,ve=be.shouldUpdateOnHit,we=function(){var Pe=he?Q(arguments):arguments;Ee&&(Pe=_e(Pe));var Me=Te.length?be.getKeyIndex(Pe):-1;if(Me!==-1)ve&&pe(be,xe,we),Me&&(be.orderByLru(Te[Me],ye[Me],Me),me&&ue(be,xe,we));else{var De=Z.apply(this,arguments),Oe=he?Pe:Q(arguments);be.orderByLru(Oe,De,Te.length),ie&&be.updateAsyncCache(we),oe&&ae(be,xe,we),me&&ue(be,xe,we)}return ye[0]};return we.cache=be,we.fn=Z,we.isMemoized=!0,we.options=xe,we}return te})}(microMemoize)),microMemoizeExports}var fastEqualsExports={},fastEquals={get exports(){return fastEqualsExports},set exports(U){fastEqualsExports=U}},hasRequiredFastEquals;function requireFastEquals(){return hasRequiredFastEquals||(hasRequiredFastEquals=1,function(U,D){(function(F,G){G(D)})(commonjsGlobal,function(F){var G=typeof WeakMap=="function",Q=Object.keys;function X(ye,Ee){return ye===Ee||ye!==ye&&Ee!==Ee}function q(ye){return ye.constructor===Object||ye.constructor==null}function W(ye){return!!ye&&typeof ye.then=="function"}function Y(ye){return!!(ye&&ye.$$typeof)}function J(){var ye=[];return{delete:function(Ee){for(var he=0;he<ye.length;++he)if(ye[he][0]===Ee){ye.splice(he,1);return}},get:function(Ee){for(var he=0;he<ye.length;++he)if(ye[he][0]===Ee)return ye[he][1]},set:function(Ee,he){for(var oe=0;oe<ye.length;++oe)if(ye[oe][0]===Ee){ye[oe][1]=he;return}ye.push([Ee,he])}}}var te=function(ye){return ye?function(){return new WeakMap}:J}(G);function Z(ye){return function(he){var oe=ye||he;return function(ve,we,Pe,Me,De,Oe,Ie){Ie===void 0&&(Ie=te());var Be=!!ve&&typeof ve=="object",ze=!!we&&typeof we=="object";if(Be!==ze)return!1;if(!Be&&!ze)return oe(ve,we,Ie);var et=Ie.get(ve);if(et&&Ie.get(we))return et===we;Ie.set(ve,we),Ie.set(we,ve);var qe=oe(ve,we,Ie);return Ie.delete(ve),Ie.delete(we),qe}}}function ee(ye,Ee,he,oe){var me=ye.length;if(Ee.length!==me)return!1;for(;me-- >0;)if(!he(ye[me],Ee[me],me,me,ye,Ee,oe))return!1;return!0}function re(ye,Ee,he,oe){var me=ye.size===Ee.size;if(me&&ye.size){var ve={},we=0;ye.forEach(function(Pe,Me){if(me){var De=!1,Oe=0;Ee.forEach(function(Ie,Be){!De&&!ve[Oe]&&(De=he(Me,Be,we,Oe,ye,Ee,oe)&&he(Pe,Ie,Me,Be,ye,Ee,oe),De&&(ve[Oe]=!0)),Oe++}),we++,me=De}})}return me}var ne="_owner",le=Function.prototype.bind.call(Function.prototype.call,Object.prototype.hasOwnProperty);function se(ye,Ee,he,oe){var me=Q(ye),ve=me.length;if(Q(Ee).length!==ve)return!1;if(ve)for(var we=void 0;ve-- >0;){if(we=me[ve],we===ne){var Pe=Y(ye),Me=Y(Ee);if((Pe||Me)&&Pe!==Me)return!1}if(!le(Ee,we)||!he(ye[we],Ee[we],we,we,ye,Ee,oe))return!1}return!0}var ie=function(){return/foo/g.flags==="g"?function(Ee,he){return Ee.source===he.source&&Ee.flags===he.flags}:function(Ee,he){return Ee.source===he.source&&Ee.global===he.global&&Ee.ignoreCase===he.ignoreCase&&Ee.multiline===he.multiline&&Ee.unicode===he.unicode&&Ee.sticky===he.sticky&&Ee.lastIndex===he.lastIndex}}();function ge(ye,Ee,he,oe){var me=ye.size===Ee.size;if(me&&ye.size){var ve={};ye.forEach(function(we,Pe){if(me){var Me=!1,De=0;Ee.forEach(function(Oe,Ie){!Me&&!ve[De]&&(Me=he(we,Oe,Pe,Ie,ye,Ee,oe),Me&&(ve[De]=!0)),De++}),me=Me}})}return me}var fe=typeof Map=="function",ae=typeof Set=="function",ue=Object.prototype.valueOf;function pe(ye){var Ee=typeof ye=="function"?ye(he):function(oe,me,ve,we,Pe,Me,De){return he(oe,me,De)};function he(oe,me,ve){if(oe===me)return!0;if(oe&&me&&typeof oe=="object"&&typeof me=="object"){if(q(oe)&&q(me))return se(oe,me,Ee,ve);var we=Array.isArray(oe),Pe=Array.isArray(me);return we||Pe?we===Pe&&ee(oe,me,Ee,ve):(we=oe instanceof Date,Pe=me instanceof Date,we||Pe?we===Pe&&X(oe.getTime(),me.getTime()):(we=oe instanceof RegExp,Pe=me instanceof RegExp,we||Pe?we===Pe&&ie(oe,me):W(oe)||W(me)?oe===me:fe&&(we=oe instanceof Map,Pe=me instanceof Map,we||Pe)?we===Pe&&re(oe,me,Ee,ve):ae&&(we=oe instanceof Set,Pe=me instanceof Set,we||Pe)?we===Pe&&ge(oe,me,Ee,ve):oe.valueOf!==ue||me.valueOf!==ue?X(oe.valueOf(),me.valueOf()):se(oe,me,Ee,ve)))}return oe!==oe&&me!==me}return he}var _e=pe(),xe=pe(function(){return X}),be=pe(Z()),Te=pe(Z(X));F.circularDeepEqual=be,F.circularShallowEqual=Te,F.createCustomEqual=pe,F.deepEqual=_e,F.sameValueZeroEqual=X,F.shallowEqual=xe,Object.defineProperty(F,"__esModule",{value:!0})})}(fastEquals,fastEqualsExports)),fastEqualsExports}(function(U,D){(function(F,G){U.exports=G(requireMicroMemoize(),requireFastEquals())})(commonjsGlobal,function(F,G){function Q(){return Q=Object.assign?Object.assign.bind():function(Le){for(var Ge=1;Ge<arguments.length;Ge++){var ke=arguments[Ge];for(var He in ke)Object.prototype.hasOwnProperty.call(ke,He)&&(Le[He]=ke[He])}return Le},Q.apply(this,arguments)}function X(Le,Ge){if(Le==null)return{};var ke={},He=Object.keys(Le),Ke,$e;for($e=0;$e<He.length;$e++)Ke=He[$e],!(Ge.indexOf(Ke)>=0)&&(ke[Ke]=Le[Ke]);return ke}var q={isDeepEqual:!1,isPromise:!1,isReact:!1,isSerialized:!1,isShallowEqual:!1,matchesArg:void 0,matchesKey:void 0,maxAge:void 0,maxArgs:void 0,maxSize:1,onExpire:void 0,profileName:void 0,serializer:void 0,updateCacheForKey:void 0,transformArgs:void 0,updateExpire:!1};function W(){for(var Le=arguments.length,Ge=new Array(Le),ke=0;ke<Le;ke++)Ge[ke]=arguments[ke];return Ge.reduce(function(He,Ke){if(typeof He=="function")return typeof Ke=="function"?function(){He.apply(this,arguments),Ke.apply(this,arguments)}:He;if(typeof Ke=="function")return Ke})}function Y(){for(var Le=arguments.length,Ge=new Array(Le),ke=0;ke<Le;ke++)Ge[ke]=arguments[ke];return Ge.reduce(function(He,Ke){if(typeof He=="function")return typeof Ke=="function"?function(){return He(Ke.apply(this,arguments))}:He;if(typeof Ke=="function")return Ke})}function J(Le,Ge){for(var ke=0;ke<Le.length;ke++)if(Le[ke].key===Ge)return ke;return-1}function te(Le,Ge){var ke=typeof Ge=="function"?Ge:function(He,Ke){for(var $e=0;$e<Ke.length;$e++)if(!Le(He[$e],Ke[$e]))return!1;return!0};return function(He,Ke){for(var $e=0;$e<He.length;$e++)if(He[$e].length===Ke.length&&ke(He[$e],Ke))return $e;return-1}}function Z(Le,Ge){return!Ge||Ge===q?Le:Q({},Le,Ge,{onCacheAdd:W(Le.onCacheAdd,Ge.onCacheAdd),onCacheChange:W(Le.onCacheChange,Ge.onCacheChange),onCacheHit:W(Le.onCacheHit,Ge.onCacheHit),transformArgs:Y(Le.transformArgs,Ge.transformArgs)})}function ee(Le){return typeof Le=="function"&&Le.isMoized}function re(Le,Ge,ke){try{var He=ke||Ge||"anonymous";Object.defineProperty(Le,"name",{configurable:!0,enumerable:!1,value:"moized("+He+")",writable:!0})}catch{}}function ne(Le,Ge,ke){var He=J(Le,Ge);He!==-1&&(clearTimeout(Le[He].timeoutId),ke&&Le.splice(He,1))}function le(Le,Ge){var ke=setTimeout(Le,Ge);return typeof ke.unref=="function"&&ke.unref(),ke}function se(Le,Ge,ke,He){var Ke=Ge.maxAge;return function $e(Qe,Ne,Ce){var Ze=Qe.keys[0];if(J(Le,Ze)===-1){var at=function(){var Se=te(ke,He),ce=Se(Qe.keys,Ze),de=Qe.values[ce];~ce&&(Qe.keys.splice(ce,1),Qe.values.splice(ce,1),typeof Ge.onCacheChange=="function"&&Ge.onCacheChange(Qe,Ne,Ce)),ne(Le,Ze,!0),typeof Ge.onExpire=="function"&&Ge.onExpire(Ze)===!1&&(Qe.keys.unshift(Ze),Qe.values.unshift(de),$e(Qe,Ne,Ce),typeof Ge.onCacheChange=="function"&&Ge.onCacheChange(Qe,Ne,Ce))};Le.push({expirationMethod:at,key:Ze,timeoutId:le(at,Ke)})}}}function ie(Le,Ge){return function(He){var Ke=He.keys[0],$e=J(Le,Ke);~$e&&(ne(Le,Ke,!1),Le[$e].timeoutId=le(Le[$e].expirationMethod,Ge.maxAge))}}function ge(Le,Ge,ke,He){var Ke=typeof Ge.maxAge=="number"&&isFinite(Ge.maxAge)?se(Le,Ge,ke,He):void 0;return{onCacheAdd:Ke,onCacheHit:Ke&&Ge.updateExpire?ie(Le,Ge):void 0}}var fe={anonymousProfileNameCounter:1,isCollectingStats:!1,profiles:{}},ae=!1;function ue(Le){Le?delete fe.profiles[Le]:fe.profiles={}}function pe(Le){Le===void 0&&(Le=!0),fe.isCollectingStats=Le}function _e(Le){var Ge=Le.profileName;return function(){Ge&&!fe.profiles[Ge]&&(fe.profiles[Ge]={calls:0,hits:0}),fe.profiles[Ge].calls++}}function xe(Le){return function(){var Ge=fe.profiles,ke=Le.profileName;Ge[ke]||(Ge[ke]={calls:0,hits:0}),Ge[ke].calls++,Ge[ke].hits++}}function be(Le){return Le.displayName||Le.name||"Anonymous "+fe.anonymousProfileNameCounter++}function Te(Le,Ge){return Le?(Ge/Le*100).toFixed(4)+"%":"0.0000%"}function ye(Le){!fe.isCollectingStats&&!ae&&(console.warn('Stats are not currently being collected, please run "collectStats" to enable them.'),ae=!0);var Ge=fe.profiles;if(Le){if(!Ge[Le])return{calls:0,hits:0,usage:"0.0000%"};var ke=Ge[Le];return Q({},ke,{usage:Te(ke.calls,ke.hits)})}var He=Object.keys(fe.profiles).reduce(function(Ke,$e){return Ke.calls+=Ge[$e].calls,Ke.hits+=Ge[$e].hits,Ke},{calls:0,hits:0});return Q({},He,{profiles:Object.keys(Ge).reduce(function(Ke,$e){return Ke[$e]=ye($e),Ke},{}),usage:Te(He.calls,He.hits)})}function Ee(Le){return fe.isCollectingStats?{onCacheAdd:_e(Le),onCacheHit:xe(Le)}:{}}var he={arguments:!0,callee:!0,caller:!0,constructor:!0,length:!0,name:!0,prototype:!0};function oe(Le,Ge,ke){ke===void 0&&(ke=[]),Object.getOwnPropertyNames(Le).forEach(function(He){if(!he[He]&&ke.indexOf(He)===-1){var Ke=Object.getOwnPropertyDescriptor(Le,He);Ke.get||Ke.set?Object.defineProperty(Ge,He,Ke):Ge[He]=Le[He]}})}function me(Le,Ge){var ke=Ge.expirations,He=Le.options,Ke=te(He.isEqual,He.isMatchingKey),$e=Le;$e.clear=function(){var Qe=$e._microMemoizeOptions.onCacheChange,Ne=$e.cache;return Ne.keys.length=0,Ne.values.length=0,Qe&&Qe(Ne,$e.options,$e),!0},$e.clearStats=function(){ue($e.options.profileName)},$e.get=function(Qe){var Ne=$e._microMemoizeOptions.transformKey,Ce=$e.cache,Ze=Ne?Ne(Qe):Qe,at=Ke(Ce.keys,Ze);return at!==-1?$e.apply(this,Qe):void 0},$e.getStats=function(){return ye($e.options.profileName)},$e.has=function(Qe){var Ne=$e._microMemoizeOptions.transformKey,Ce=Ne?Ne(Qe):Qe;return Ke($e.cache.keys,Ce)!==-1},$e.keys=function(){return $e.cacheSnapshot.keys},$e.remove=function(Qe){var Ne=$e._microMemoizeOptions,Ce=Ne.onCacheChange,Ze=Ne.transformKey,at=$e.cache,st=Ke(at.keys,Ze?Ze(Qe):Qe);if(st===-1)return!1;var Se=at.keys[st];return at.keys.splice(st,1),at.values.splice(st,1),Ce&&Ce(at,$e.options,$e),ne(ke,Se,!0),!0},$e.set=function(Qe,Ne){var Ce=$e._microMemoizeOptions,Ze=$e.cache,at=$e.options,st=Ce.onCacheAdd,Se=Ce.onCacheChange,ce=Ce.transformKey,de=ce?ce(Qe):Qe,Ae=Ke(Ze.keys,de);if(Ae===-1){var Fe=at.maxSize-1;Ze.size>Fe&&(Ze.keys.length=Fe,Ze.values.length=Fe),Ze.keys.unshift(de),Ze.values.unshift(Ne),at.isPromise&&Ze.updateAsyncCache($e),st&&st(Ze,at,$e),Se&&Se(Ze,at,$e)}else{var Ve=Ze.keys[Ae];Ze.values[Ae]=Ne,Ae>0&&Ze.orderByLru(Ve,Ne,Ae),at.isPromise&&Ze.updateAsyncCache($e),typeof Se=="function"&&Se(Ze,at,$e)}},$e.values=function(){return $e.cacheSnapshot.values}}function ve(Le,Ge){var ke=Ge.expirations,He=Ge.options,Ke=Ge.originalFunction,$e=Le.options;Object.defineProperties(Le,{_microMemoizeOptions:{configurable:!0,get:function(){return $e}},cacheSnapshot:{configurable:!0,get:function(){var Ce=Le.cache;return{keys:Ce.keys.slice(0),size:Ce.size,values:Ce.values.slice(0)}}},expirations:{configurable:!0,get:function(){return ke}},expirationsSnapshot:{configurable:!0,get:function(){return ke.slice(0)}},isMoized:{configurable:!0,get:function(){return!0}},options:{configurable:!0,get:function(){return He}},originalFunction:{configurable:!0,get:function(){return Ke}}});var Qe=Le;oe(Ke,Qe)}function we(Le,Ge){return me(Le,Ge),ve(Le,Ge),Le}var Pe=typeof Symbol=="function"&&Symbol.for?Symbol.for("react.element"):60103;function Me(Le,Ge,ke){var He=Le(Q({maxArgs:2,isShallowEqual:!0},ke,{isReact:!1}));Ge.displayName||(Ge.displayName=Ge.name||"Component");function Ke($e,Qe,Ne){this.props=$e,this.context=Qe,this.updater=Ne,this.MoizedComponent=He(Ge)}return Ke.prototype.isReactComponent={},Ke.prototype.render=function(){return{$$typeof:Pe,type:this.MoizedComponent,props:this.props,ref:null,key:null,_owner:null}},oe(Ge,Ke,["contextType","contextTypes"]),Ke.displayName="Moized("+(Ge.displayName||Ge.name||"Component")+")",re(Ke,Ge.name,ke.profileName),Ke}function De(Le){return function(Ge){if(Le>=Ge.length)return Ge;if(Le===0)return[];if(Le===1)return[Ge[0]];if(Le===2)return[Ge[0],Ge[1]];if(Le===3)return[Ge[0],Ge[1],Ge[2]];for(var ke=[],He=0;He<Le;He++)ke[He]=Ge[He];return ke}}function Oe(Le,Ge){for(var ke=Le.length,He=0;He<ke;++He)if(Le[He]===Ge)return He+1;return 0}function Ie(){var Le=[],Ge=[];return function(He,Ke){var $e=typeof Ke;if($e==="function"||$e==="symbol")return Ke.toString();if(typeof Ke=="object"){if(Le.length){var Qe=Oe(Le,this);Qe===0?Le[Le.length]=this:(Le.splice(Qe),Ge.splice(Qe)),Ge[Ge.length]=He;var Ne=Oe(Le,Ke);if(Ne!==0)return"[ref="+(Ge.slice(0,Ne).join(".")||".")+"]"}else Le[0]=Ke,Ge[0]=He;return Ke}return""+Ke}}function Be(Le){var Ge=typeof Le;return Le&&(Ge==="object"||Ge==="function")?JSON.stringify(Le,Ie()):Le}function ze(Le){for(var Ge="|",ke=0;ke<Le.length;ke++)Ge+=Be(Le[ke])+"|";return[Ge]}function et(Le){return typeof Le.serializer=="function"?Le.serializer:ze}function qe(Le,Ge){return Le[0]===Ge[0]}function je(Le){if(typeof Le=="function")return function(Ge,ke,He){return Le(He.cache,He.options,He)}}function it(Le){return Le.matchesArg||Le.isDeepEqual&&G.deepEqual||Le.isShallowEqual&&G.shallowEqual||G.sameValueZeroEqual}function ct(Le){return Le.matchesKey||Le.isSerialized&&qe||void 0}function rt(Le){return Y(Le.isSerialized&&et(Le),typeof Le.transformArgs=="function"&&Le.transformArgs,typeof Le.maxArgs=="number"&&De(Le.maxArgs))}function ut(Le){var Ge=Le.options.updateCacheForKey,ke=function(){for(var Ke=arguments.length,$e=new Array(Ke),Qe=0;Qe<Ke;Qe++)$e[Qe]=arguments[Qe];if(!Ge($e))return Le.apply(this,$e);var Ne=Le.fn.apply(this,$e);return Le.set($e,Ne),Ne};return oe(Le,ke),ke}var We=["matchesArg","isDeepEqual","isPromise","isReact","isSerialized","isShallowEqual","matchesKey","maxAge","maxArgs","maxSize","onCacheAdd","onCacheChange","onCacheHit","onExpire","profileName","serializer","updateCacheForKey","transformArgs","updateExpire"],Re=function Le(Ge,ke){var He=ke||q;if(ee(Ge)){var Ke=Ge.originalFunction,$e=Z(Ge.options,He);return Le(Ke,$e)}if(typeof Ge=="object")return function(wt,ot){if(typeof wt=="function"){var pt=Z(Ge,ot);return Le(wt,pt)}var xt=Z(Ge,wt);return Le(xt)};if(He.isReact)return Me(Le,Ge,He);var Qe=Q({},q,He,{maxAge:typeof He.maxAge=="number"&&He.maxAge>=0?He.maxAge:q.maxAge,maxArgs:typeof He.maxArgs=="number"&&He.maxArgs>=0?He.maxArgs:q.maxArgs,maxSize:typeof He.maxSize=="number"&&He.maxSize>=0?He.maxSize:q.maxSize,profileName:He.profileName||be(Ge)}),Ne=[];Qe.matchesArg,Qe.isDeepEqual;var Ce=Qe.isPromise;Qe.isReact,Qe.isSerialized,Qe.isShallowEqual,Qe.matchesKey,Qe.maxAge,Qe.maxArgs;var Ze=Qe.maxSize,at=Qe.onCacheAdd,st=Qe.onCacheChange,Se=Qe.onCacheHit;Qe.onExpire,Qe.profileName,Qe.serializer;var ce=Qe.updateCacheForKey;Qe.transformArgs,Qe.updateExpire;var de=X(Qe,We),Ae=it(Qe),Fe=ct(Qe),Ve=ge(Ne,Qe,Ae,Fe),Je=Ee(Qe),dt=rt(Qe),St=Q({},de,{isEqual:Ae,isMatchingKey:Fe,isPromise:Ce,maxSize:Ze,onCacheAdd:je(W(at,Ve.onCacheAdd,Je.onCacheAdd)),onCacheChange:je(st),onCacheHit:je(W(Se,Ve.onCacheHit,Je.onCacheHit)),transformKey:dt}),Tt=F(Ge,St),At=we(Tt,{expirations:Ne,options:Qe,originalFunction:Ge});return ce&&(At=ut(At)),re(At,Ge.name,He.profileName),At};Re.clearStats=ue,Re.collectStats=pe,Re.compose=function(){return Y.apply(void 0,arguments)||Re},Re.deep=Re({isDeepEqual:!0}),Re.getStats=ye,Re.infinite=Re({maxSize:1/0}),Re.isCollectingStats=function(){return fe.isCollectingStats},Re.isMoized=function(Ge){return typeof Ge=="function"&&!!Ge.isMoized},Re.matchesArg=function(Le){return Re({matchesArg:Le})},Re.matchesKey=function(Le){return Re({matchesKey:Le})};function Ue(Le,Ge){if(Ge===!0)return Re({maxAge:Le,updateExpire:Ge});if(typeof Ge=="object"){var ke=Ge.onExpire,He=Ge.updateExpire;return Re({maxAge:Le,onExpire:ke,updateExpire:He})}return Re(typeof Ge=="function"?{maxAge:Le,onExpire:Ge,updateExpire:!0}:{maxAge:Le})}return Re.maxAge=Ue,Re.maxArgs=function(Le){return Re({maxArgs:Le})},Re.maxSize=function(Le){return Re({maxSize:Le})},Re.profile=function(Le){return Re({profileName:Le})},Re.promise=Re({isPromise:!0,updateExpire:!0}),Re.react=Re({isReact:!0}),Re.serialize=Re({isSerialized:!0}),Re.serializeWith=function(Le){return Re({isSerialized:!0,serializer:Le})},Re.shallow=Re({isShallowEqual:!0}),Re.transformArgs=function(Le){return Re({transformArgs:Le})},Re.updateCacheForKey=function(Le){return Re({updateCacheForKey:Le})},Object.defineProperty(Re,"default",{configurable:!1,enumerable:!1,value:Re,writable:!1}),Re})})(moize$1);const moize=moizeExports,proxyMarker=Symbol("Comlink.proxy"),createEndpoint=Symbol("Comlink.endpoint"),releaseProxy=Symbol("Comlink.releaseProxy"),throwMarker=Symbol("Comlink.thrown"),isObject$3=U=>typeof U=="object"&&U!==null||typeof U=="function",proxyTransferHandler={canHandle:U=>isObject$3(U)&&U[proxyMarker],serialize(U){const{port1:D,port2:F}=new MessageChannel;return expose$1(U,D),[F,[F]]},deserialize(U){return U.start(),wrap$1(U)}},throwTransferHandler={canHandle:U=>isObject$3(U)&&throwMarker in U,serialize({value:U}){let D;return U instanceof Error?D={isError:!0,value:{message:U.message,name:U.name,stack:U.stack}}:D={isError:!1,value:U},[D,[]]},deserialize(U){throw U.isError?Object.assign(new Error(U.value.message),U.value):U.value}},transferHandlers=new Map([["proxy",proxyTransferHandler],["throw",throwTransferHandler]]);function expose$1(U,D=self){D.addEventListener("message",function F(G){if(!G||!G.data)return;const{id:Q,type:X,path:q}=Object.assign({path:[]},G.data),W=(G.data.argumentList||[]).map(fromWireValue);let Y;try{const J=q.slice(0,-1).reduce((Z,ee)=>Z[ee],U),te=q.reduce((Z,ee)=>Z[ee],U);switch(X){case"GET":Y=te;break;case"SET":J[q.slice(-1)[0]]=fromWireValue(G.data.value),Y=!0;break;case"APPLY":Y=te.apply(J,W);break;case"CONSTRUCT":{const Z=new te(...W);Y=proxy(Z)}break;case"ENDPOINT":{const{port1:Z,port2:ee}=new MessageChannel;expose$1(U,ee),Y=transfer$1(Z,[Z])}break;case"RELEASE":Y=void 0;break;default:return}}catch(J){Y={value:J,[throwMarker]:0}}Promise.resolve(Y).catch(J=>({value:J,[throwMarker]:0})).then(J=>{const[te,Z]=toWireValue(J);D.postMessage(Object.assign(Object.assign({},te),{id:Q}),Z),X==="RELEASE"&&(D.removeEventListener("message",F),closeEndPoint(D))})}),D.start&&D.start()}function isMessagePort(U){return U.constructor.name==="MessagePort"}function closeEndPoint(U){isMessagePort(U)&&U.close()}function wrap$1(U,D){return createProxy(U,[],D)}function throwIfProxyReleased(U){if(U)throw new Error("Proxy has been released and is not useable")}function createProxy(U,D=[],F=function(){}){let G=!1;const Q=new Proxy(F,{get(X,q){if(throwIfProxyReleased(G),q===releaseProxy)return()=>requestResponseMessage(U,{type:"RELEASE",path:D.map(W=>W.toString())}).then(()=>{closeEndPoint(U),G=!0});if(q==="then"){if(D.length===0)return{then:()=>Q};const W=requestResponseMessage(U,{type:"GET",path:D.map(Y=>Y.toString())}).then(fromWireValue);return W.then.bind(W)}return createProxy(U,[...D,q])},set(X,q,W){throwIfProxyReleased(G);const[Y,J]=toWireValue(W);return requestResponseMessage(U,{type:"SET",path:[...D,q].map(te=>te.toString()),value:Y},J).then(fromWireValue)},apply(X,q,W){throwIfProxyReleased(G);const Y=D[D.length-1];if(Y===createEndpoint)return requestResponseMessage(U,{type:"ENDPOINT"}).then(fromWireValue);if(Y==="bind")return createProxy(U,D.slice(0,-1));const[J,te]=processArguments(W);return requestResponseMessage(U,{type:"APPLY",path:D.map(Z=>Z.toString()),argumentList:J},te).then(fromWireValue)},construct(X,q){throwIfProxyReleased(G);const[W,Y]=processArguments(q);return requestResponseMessage(U,{type:"CONSTRUCT",path:D.map(J=>J.toString()),argumentList:W},Y).then(fromWireValue)}});return Q}function myFlat(U){return Array.prototype.concat.apply([],U)}function processArguments(U){const D=U.map(toWireValue);return[D.map(F=>F[0]),myFlat(D.map(F=>F[1]))]}const transferCache=new WeakMap;function transfer$1(U,D){return transferCache.set(U,D),U}function proxy(U){return Object.assign(U,{[proxyMarker]:!0})}function toWireValue(U){for(const[D,F]of transferHandlers)if(F.canHandle(U)){const[G,Q]=F.serialize(U);return[{type:"HANDLER",name:D,value:G},Q]}return[{type:"RAW",value:U},transferCache.get(U)||[]]}function fromWireValue(U){switch(U.type){case"HANDLER":return transferHandlers.get(U.name).deserialize(U.value);case"RAW":return U.value}}function requestResponseMessage(U,D,F){return new Promise(G=>{const Q=generateUUID$1();U.addEventListener("message",function X(q){!q.data||!q.data.id||q.data.id!==Q||(U.removeEventListener("message",X),G(q.data))}),U.start&&U.start(),U.postMessage(Object.assign({id:Q},D),F)})}function generateUUID$1(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}const REVISION="151",CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,PCFShadowMap=1,PCFSoftShadowMap=2,VSMShadowMap=3,FrontSide=0,BackSide=1,DoubleSide=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,CineonToneMapping=3,ACESFilmicToneMapping=4,CustomToneMapping=5,UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,CubeUVReflectionMapping=306,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipmapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipmapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedInt248Type=1020,AlphaFormat=1021,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGB_ETC2_Format=37492,RGBA_ETC2_EAC_Format=37496,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,RGBA_BPTC_Format=36492,RED_RGTC1_Format=36283,SIGNED_RED_RGTC1_Format=36284,RED_GREEN_RGTC2_Format=36285,SIGNED_RED_GREEN_RGTC2_Format=36286,LinearEncoding=3e3,sRGBEncoding=3001,BasicDepthPacking=3200,RGBADepthPacking=3201,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,SRGBColorSpace="srgb",LinearSRGBColorSpace="srgb-linear",DisplayP3ColorSpace="display-p3",KeepStencilOp=7680,AlwaysStencilFunc=519,StaticDrawUsage=35044,GLSL3="300 es",_SRGBAFormat=1035;class EventDispatcher{addEventListener(D,F){this._listeners===void 0&&(this._listeners={});const G=this._listeners;G[D]===void 0&&(G[D]=[]),G[D].indexOf(F)===-1&&G[D].push(F)}hasEventListener(D,F){if(this._listeners===void 0)return!1;const G=this._listeners;return G[D]!==void 0&&G[D].indexOf(F)!==-1}removeEventListener(D,F){if(this._listeners===void 0)return;const Q=this._listeners[D];if(Q!==void 0){const X=Q.indexOf(F);X!==-1&&Q.splice(X,1)}}dispatchEvent(D){if(this._listeners===void 0)return;const G=this._listeners[D.type];if(G!==void 0){D.target=this;const Q=G.slice(0);for(let X=0,q=Q.length;X<q;X++)Q[X].call(this,D);D.target=null}}}const _lut=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;function generateUUID(){const U=Math.random()*4294967295|0,D=Math.random()*4294967295|0,F=Math.random()*4294967295|0,G=Math.random()*4294967295|0;return(_lut[U&255]+_lut[U>>8&255]+_lut[U>>16&255]+_lut[U>>24&255]+"-"+_lut[D&255]+_lut[D>>8&255]+"-"+_lut[D>>16&15|64]+_lut[D>>24&255]+"-"+_lut[F&63|128]+_lut[F>>8&255]+"-"+_lut[F>>16&255]+_lut[F>>24&255]+_lut[G&255]+_lut[G>>8&255]+_lut[G>>16&255]+_lut[G>>24&255]).toLowerCase()}function clamp(U,D,F){return Math.max(D,Math.min(F,U))}function euclideanModulo(U,D){return(U%D+D)%D}function lerp(U,D,F){return(1-F)*U+F*D}function isPowerOfTwo(U){return(U&U-1)===0&&U!==0}function floorPowerOfTwo(U){return Math.pow(2,Math.floor(Math.log(U)/Math.LN2))}function denormalize(U,D){switch(D.constructor){case Float32Array:return U;case Uint16Array:return U/65535;case Uint8Array:return U/255;case Int16Array:return Math.max(U/32767,-1);case Int8Array:return Math.max(U/127,-1);default:throw new Error("Invalid component type.")}}function normalize$1(U,D){switch(D.constructor){case Float32Array:return U;case Uint16Array:return Math.round(U*65535);case Uint8Array:return Math.round(U*255);case Int16Array:return Math.round(U*32767);case Int8Array:return Math.round(U*127);default:throw new Error("Invalid component type.")}}class Vector2{constructor(D=0,F=0){Vector2.prototype.isVector2=!0,this.x=D,this.y=F}get width(){return this.x}set width(D){this.x=D}get height(){return this.y}set height(D){this.y=D}set(D,F){return this.x=D,this.y=F,this}setScalar(D){return this.x=D,this.y=D,this}setX(D){return this.x=D,this}setY(D){return this.y=D,this}setComponent(D,F){switch(D){case 0:this.x=F;break;case 1:this.y=F;break;default:throw new Error("index is out of range: "+D)}return this}getComponent(D){switch(D){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+D)}}clone(){return new this.constructor(this.x,this.y)}copy(D){return this.x=D.x,this.y=D.y,this}add(D){return this.x+=D.x,this.y+=D.y,this}addScalar(D){return this.x+=D,this.y+=D,this}addVectors(D,F){return this.x=D.x+F.x,this.y=D.y+F.y,this}addScaledVector(D,F){return this.x+=D.x*F,this.y+=D.y*F,this}sub(D){return this.x-=D.x,this.y-=D.y,this}subScalar(D){return this.x-=D,this.y-=D,this}subVectors(D,F){return this.x=D.x-F.x,this.y=D.y-F.y,this}multiply(D){return this.x*=D.x,this.y*=D.y,this}multiplyScalar(D){return this.x*=D,this.y*=D,this}divide(D){return this.x/=D.x,this.y/=D.y,this}divideScalar(D){return this.multiplyScalar(1/D)}applyMatrix3(D){const F=this.x,G=this.y,Q=D.elements;return this.x=Q[0]*F+Q[3]*G+Q[6],this.y=Q[1]*F+Q[4]*G+Q[7],this}min(D){return this.x=Math.min(this.x,D.x),this.y=Math.min(this.y,D.y),this}max(D){return this.x=Math.max(this.x,D.x),this.y=Math.max(this.y,D.y),this}clamp(D,F){return this.x=Math.max(D.x,Math.min(F.x,this.x)),this.y=Math.max(D.y,Math.min(F.y,this.y)),this}clampScalar(D,F){return this.x=Math.max(D,Math.min(F,this.x)),this.y=Math.max(D,Math.min(F,this.y)),this}clampLength(D,F){const G=this.length();return this.divideScalar(G||1).multiplyScalar(Math.max(D,Math.min(F,G)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(D){return this.x*D.x+this.y*D.y}cross(D){return this.x*D.y-this.y*D.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(D){const F=Math.sqrt(this.lengthSq()*D.lengthSq());if(F===0)return Math.PI/2;const G=this.dot(D)/F;return Math.acos(clamp(G,-1,1))}distanceTo(D){return Math.sqrt(this.distanceToSquared(D))}distanceToSquared(D){const F=this.x-D.x,G=this.y-D.y;return F*F+G*G}manhattanDistanceTo(D){return Math.abs(this.x-D.x)+Math.abs(this.y-D.y)}setLength(D){return this.normalize().multiplyScalar(D)}lerp(D,F){return this.x+=(D.x-this.x)*F,this.y+=(D.y-this.y)*F,this}lerpVectors(D,F,G){return this.x=D.x+(F.x-D.x)*G,this.y=D.y+(F.y-D.y)*G,this}equals(D){return D.x===this.x&&D.y===this.y}fromArray(D,F=0){return this.x=D[F],this.y=D[F+1],this}toArray(D=[],F=0){return D[F]=this.x,D[F+1]=this.y,D}fromBufferAttribute(D,F){return this.x=D.getX(F),this.y=D.getY(F),this}rotateAround(D,F){const G=Math.cos(F),Q=Math.sin(F),X=this.x-D.x,q=this.y-D.y;return this.x=X*G-q*Q+D.x,this.y=X*Q+q*G+D.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Matrix3{constructor(){Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(D,F,G,Q,X,q,W,Y,J){const te=this.elements;return te[0]=D,te[1]=Q,te[2]=W,te[3]=F,te[4]=X,te[5]=Y,te[6]=G,te[7]=q,te[8]=J,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(D){const F=this.elements,G=D.elements;return F[0]=G[0],F[1]=G[1],F[2]=G[2],F[3]=G[3],F[4]=G[4],F[5]=G[5],F[6]=G[6],F[7]=G[7],F[8]=G[8],this}extractBasis(D,F,G){return D.setFromMatrix3Column(this,0),F.setFromMatrix3Column(this,1),G.setFromMatrix3Column(this,2),this}setFromMatrix4(D){const F=D.elements;return this.set(F[0],F[4],F[8],F[1],F[5],F[9],F[2],F[6],F[10]),this}multiply(D){return this.multiplyMatrices(this,D)}premultiply(D){return this.multiplyMatrices(D,this)}multiplyMatrices(D,F){const G=D.elements,Q=F.elements,X=this.elements,q=G[0],W=G[3],Y=G[6],J=G[1],te=G[4],Z=G[7],ee=G[2],re=G[5],ne=G[8],le=Q[0],se=Q[3],ie=Q[6],ge=Q[1],fe=Q[4],ae=Q[7],ue=Q[2],pe=Q[5],_e=Q[8];return X[0]=q*le+W*ge+Y*ue,X[3]=q*se+W*fe+Y*pe,X[6]=q*ie+W*ae+Y*_e,X[1]=J*le+te*ge+Z*ue,X[4]=J*se+te*fe+Z*pe,X[7]=J*ie+te*ae+Z*_e,X[2]=ee*le+re*ge+ne*ue,X[5]=ee*se+re*fe+ne*pe,X[8]=ee*ie+re*ae+ne*_e,this}multiplyScalar(D){const F=this.elements;return F[0]*=D,F[3]*=D,F[6]*=D,F[1]*=D,F[4]*=D,F[7]*=D,F[2]*=D,F[5]*=D,F[8]*=D,this}determinant(){const D=this.elements,F=D[0],G=D[1],Q=D[2],X=D[3],q=D[4],W=D[5],Y=D[6],J=D[7],te=D[8];return F*q*te-F*W*J-G*X*te+G*W*Y+Q*X*J-Q*q*Y}invert(){const D=this.elements,F=D[0],G=D[1],Q=D[2],X=D[3],q=D[4],W=D[5],Y=D[6],J=D[7],te=D[8],Z=te*q-W*J,ee=W*Y-te*X,re=J*X-q*Y,ne=F*Z+G*ee+Q*re;if(ne===0)return this.set(0,0,0,0,0,0,0,0,0);const le=1/ne;return D[0]=Z*le,D[1]=(Q*J-te*G)*le,D[2]=(W*G-Q*q)*le,D[3]=ee*le,D[4]=(te*F-Q*Y)*le,D[5]=(Q*X-W*F)*le,D[6]=re*le,D[7]=(G*Y-J*F)*le,D[8]=(q*F-G*X)*le,this}transpose(){let D;const F=this.elements;return D=F[1],F[1]=F[3],F[3]=D,D=F[2],F[2]=F[6],F[6]=D,D=F[5],F[5]=F[7],F[7]=D,this}getNormalMatrix(D){return this.setFromMatrix4(D).invert().transpose()}transposeIntoArray(D){const F=this.elements;return D[0]=F[0],D[1]=F[3],D[2]=F[6],D[3]=F[1],D[4]=F[4],D[5]=F[7],D[6]=F[2],D[7]=F[5],D[8]=F[8],this}setUvTransform(D,F,G,Q,X,q,W){const Y=Math.cos(X),J=Math.sin(X);return this.set(G*Y,G*J,-G*(Y*q+J*W)+q+D,-Q*J,Q*Y,-Q*(-J*q+Y*W)+W+F,0,0,1),this}scale(D,F){return this.premultiply(_m3.makeScale(D,F)),this}rotate(D){return this.premultiply(_m3.makeRotation(-D)),this}translate(D,F){return this.premultiply(_m3.makeTranslation(D,F)),this}makeTranslation(D,F){return this.set(1,0,D,0,1,F,0,0,1),this}makeRotation(D){const F=Math.cos(D),G=Math.sin(D);return this.set(F,-G,0,G,F,0,0,0,1),this}makeScale(D,F){return this.set(D,0,0,0,F,0,0,0,1),this}equals(D){const F=this.elements,G=D.elements;for(let Q=0;Q<9;Q++)if(F[Q]!==G[Q])return!1;return!0}fromArray(D,F=0){for(let G=0;G<9;G++)this.elements[G]=D[G+F];return this}toArray(D=[],F=0){const G=this.elements;return D[F]=G[0],D[F+1]=G[1],D[F+2]=G[2],D[F+3]=G[3],D[F+4]=G[4],D[F+5]=G[5],D[F+6]=G[6],D[F+7]=G[7],D[F+8]=G[8],D}clone(){return new this.constructor().fromArray(this.elements)}}const _m3=new Matrix3;function arrayNeedsUint32(U){for(let D=U.length-1;D>=0;--D)if(U[D]>=65535)return!0;return!1}function createElementNS(U){return document.createElementNS("http://www.w3.org/1999/xhtml",U)}function SRGBToLinear(U){return U<.04045?U*.0773993808:Math.pow(U*.9478672986+.0521327014,2.4)}function LinearToSRGB(U){return U<.0031308?U*12.92:1.055*Math.pow(U,.41666)-.055}const LINEAR_SRGB_TO_LINEAR_DISPLAY_P3=new Matrix3().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),LINEAR_DISPLAY_P3_TO_LINEAR_SRGB=new Matrix3().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function DisplayP3ToLinearSRGB(U){return U.convertSRGBToLinear().applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB)}function LinearSRGBToDisplayP3(U){return U.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3).convertLinearToSRGB()}const TO_LINEAR={[LinearSRGBColorSpace]:U=>U,[SRGBColorSpace]:U=>U.convertSRGBToLinear(),[DisplayP3ColorSpace]:DisplayP3ToLinearSRGB},FROM_LINEAR={[LinearSRGBColorSpace]:U=>U,[SRGBColorSpace]:U=>U.convertLinearToSRGB(),[DisplayP3ColorSpace]:LinearSRGBToDisplayP3},ColorManagement={enabled:!1,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(U){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!U},get workingColorSpace(){return LinearSRGBColorSpace},set workingColorSpace(U){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(U,D,F){if(this.enabled===!1||D===F||!D||!F)return U;const G=TO_LINEAR[D],Q=FROM_LINEAR[F];if(G===void 0||Q===void 0)throw new Error(`Unsupported color space conversion, "${D}" to "${F}".`);return Q(G(U))},fromWorkingColorSpace:function(U,D){return this.convert(U,this.workingColorSpace,D)},toWorkingColorSpace:function(U,D){return this.convert(U,D,this.workingColorSpace)}};let _canvas;class ImageUtils{static getDataURL(D){if(/^data:/i.test(D.src)||typeof HTMLCanvasElement>"u")return D.src;let F;if(D instanceof HTMLCanvasElement)F=D;else{_canvas===void 0&&(_canvas=createElementNS("canvas")),_canvas.width=D.width,_canvas.height=D.height;const G=_canvas.getContext("2d");D instanceof ImageData?G.putImageData(D,0,0):G.drawImage(D,0,0,D.width,D.height),F=_canvas}return F.width>2048||F.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",D),F.toDataURL("image/jpeg",.6)):F.toDataURL("image/png")}static sRGBToLinear(D){if(typeof HTMLImageElement<"u"&&D instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&D instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&D instanceof ImageBitmap){const F=createElementNS("canvas");F.width=D.width,F.height=D.height;const G=F.getContext("2d");G.drawImage(D,0,0,D.width,D.height);const Q=G.getImageData(0,0,D.width,D.height),X=Q.data;for(let q=0;q<X.length;q++)X[q]=SRGBToLinear(X[q]/255)*255;return G.putImageData(Q,0,0),F}else if(D.data){const F=D.data.slice(0);for(let G=0;G<F.length;G++)F instanceof Uint8Array||F instanceof Uint8ClampedArray?F[G]=Math.floor(SRGBToLinear(F[G]/255)*255):F[G]=SRGBToLinear(F[G]);return{data:F,width:D.width,height:D.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),D}}class Source{constructor(D=null){this.isSource=!0,this.uuid=generateUUID(),this.data=D,this.version=0}set needsUpdate(D){D===!0&&this.version++}toJSON(D){const F=D===void 0||typeof D=="string";if(!F&&D.images[this.uuid]!==void 0)return D.images[this.uuid];const G={uuid:this.uuid,url:""},Q=this.data;if(Q!==null){let X;if(Array.isArray(Q)){X=[];for(let q=0,W=Q.length;q<W;q++)Q[q].isDataTexture?X.push(serializeImage(Q[q].image)):X.push(serializeImage(Q[q]))}else X=serializeImage(Q);G.url=X}return F||(D.images[this.uuid]=G),G}}function serializeImage(U){return typeof HTMLImageElement<"u"&&U instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&U instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&U instanceof ImageBitmap?ImageUtils.getDataURL(U):U.data?{data:Array.from(U.data),width:U.width,height:U.height,type:U.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let textureId=0;class Texture extends EventDispatcher{constructor(D=Texture.DEFAULT_IMAGE,F=Texture.DEFAULT_MAPPING,G=ClampToEdgeWrapping,Q=ClampToEdgeWrapping,X=LinearFilter,q=LinearMipmapLinearFilter,W=RGBAFormat,Y=UnsignedByteType,J=Texture.DEFAULT_ANISOTROPY,te=LinearEncoding){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:textureId++}),this.uuid=generateUUID(),this.name="",this.source=new Source(D),this.mipmaps=[],this.mapping=F,this.channel=0,this.wrapS=G,this.wrapT=Q,this.magFilter=X,this.minFilter=q,this.anisotropy=J,this.format=W,this.internalFormat=null,this.type=Y,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=te,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(D=null){this.source.data=D}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(D){return this.name=D.name,this.source=D.source,this.mipmaps=D.mipmaps.slice(0),this.mapping=D.mapping,this.channel=D.channel,this.wrapS=D.wrapS,this.wrapT=D.wrapT,this.magFilter=D.magFilter,this.minFilter=D.minFilter,this.anisotropy=D.anisotropy,this.format=D.format,this.internalFormat=D.internalFormat,this.type=D.type,this.offset.copy(D.offset),this.repeat.copy(D.repeat),this.center.copy(D.center),this.rotation=D.rotation,this.matrixAutoUpdate=D.matrixAutoUpdate,this.matrix.copy(D.matrix),this.generateMipmaps=D.generateMipmaps,this.premultiplyAlpha=D.premultiplyAlpha,this.flipY=D.flipY,this.unpackAlignment=D.unpackAlignment,this.encoding=D.encoding,this.userData=JSON.parse(JSON.stringify(D.userData)),this.needsUpdate=!0,this}toJSON(D){const F=D===void 0||typeof D=="string";if(!F&&D.textures[this.uuid]!==void 0)return D.textures[this.uuid];const G={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(D).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(G.userData=this.userData),F||(D.textures[this.uuid]=G),G}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(D){if(this.mapping!==UVMapping)return D;if(D.applyMatrix3(this.matrix),D.x<0||D.x>1)switch(this.wrapS){case RepeatWrapping:D.x=D.x-Math.floor(D.x);break;case ClampToEdgeWrapping:D.x=D.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(D.x)%2)===1?D.x=Math.ceil(D.x)-D.x:D.x=D.x-Math.floor(D.x);break}if(D.y<0||D.y>1)switch(this.wrapT){case RepeatWrapping:D.y=D.y-Math.floor(D.y);break;case ClampToEdgeWrapping:D.y=D.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(D.y)%2)===1?D.y=Math.ceil(D.y)-D.y:D.y=D.y-Math.floor(D.y);break}return this.flipY&&(D.y=1-D.y),D}set needsUpdate(D){D===!0&&(this.version++,this.source.needsUpdate=!0)}}Texture.DEFAULT_IMAGE=null;Texture.DEFAULT_MAPPING=UVMapping;Texture.DEFAULT_ANISOTROPY=1;class Vector4{constructor(D=0,F=0,G=0,Q=1){Vector4.prototype.isVector4=!0,this.x=D,this.y=F,this.z=G,this.w=Q}get width(){return this.z}set width(D){this.z=D}get height(){return this.w}set height(D){this.w=D}set(D,F,G,Q){return this.x=D,this.y=F,this.z=G,this.w=Q,this}setScalar(D){return this.x=D,this.y=D,this.z=D,this.w=D,this}setX(D){return this.x=D,this}setY(D){return this.y=D,this}setZ(D){return this.z=D,this}setW(D){return this.w=D,this}setComponent(D,F){switch(D){case 0:this.x=F;break;case 1:this.y=F;break;case 2:this.z=F;break;case 3:this.w=F;break;default:throw new Error("index is out of range: "+D)}return this}getComponent(D){switch(D){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+D)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(D){return this.x=D.x,this.y=D.y,this.z=D.z,this.w=D.w!==void 0?D.w:1,this}add(D){return this.x+=D.x,this.y+=D.y,this.z+=D.z,this.w+=D.w,this}addScalar(D){return this.x+=D,this.y+=D,this.z+=D,this.w+=D,this}addVectors(D,F){return this.x=D.x+F.x,this.y=D.y+F.y,this.z=D.z+F.z,this.w=D.w+F.w,this}addScaledVector(D,F){return this.x+=D.x*F,this.y+=D.y*F,this.z+=D.z*F,this.w+=D.w*F,this}sub(D){return this.x-=D.x,this.y-=D.y,this.z-=D.z,this.w-=D.w,this}subScalar(D){return this.x-=D,this.y-=D,this.z-=D,this.w-=D,this}subVectors(D,F){return this.x=D.x-F.x,this.y=D.y-F.y,this.z=D.z-F.z,this.w=D.w-F.w,this}multiply(D){return this.x*=D.x,this.y*=D.y,this.z*=D.z,this.w*=D.w,this}multiplyScalar(D){return this.x*=D,this.y*=D,this.z*=D,this.w*=D,this}applyMatrix4(D){const F=this.x,G=this.y,Q=this.z,X=this.w,q=D.elements;return this.x=q[0]*F+q[4]*G+q[8]*Q+q[12]*X,this.y=q[1]*F+q[5]*G+q[9]*Q+q[13]*X,this.z=q[2]*F+q[6]*G+q[10]*Q+q[14]*X,this.w=q[3]*F+q[7]*G+q[11]*Q+q[15]*X,this}divideScalar(D){return this.multiplyScalar(1/D)}setAxisAngleFromQuaternion(D){this.w=2*Math.acos(D.w);const F=Math.sqrt(1-D.w*D.w);return F<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=D.x/F,this.y=D.y/F,this.z=D.z/F),this}setAxisAngleFromRotationMatrix(D){let F,G,Q,X;const Y=D.elements,J=Y[0],te=Y[4],Z=Y[8],ee=Y[1],re=Y[5],ne=Y[9],le=Y[2],se=Y[6],ie=Y[10];if(Math.abs(te-ee)<.01&&Math.abs(Z-le)<.01&&Math.abs(ne-se)<.01){if(Math.abs(te+ee)<.1&&Math.abs(Z+le)<.1&&Math.abs(ne+se)<.1&&Math.abs(J+re+ie-3)<.1)return this.set(1,0,0,0),this;F=Math.PI;const fe=(J+1)/2,ae=(re+1)/2,ue=(ie+1)/2,pe=(te+ee)/4,_e=(Z+le)/4,xe=(ne+se)/4;return fe>ae&&fe>ue?fe<.01?(G=0,Q=.707106781,X=.707106781):(G=Math.sqrt(fe),Q=pe/G,X=_e/G):ae>ue?ae<.01?(G=.707106781,Q=0,X=.707106781):(Q=Math.sqrt(ae),G=pe/Q,X=xe/Q):ue<.01?(G=.707106781,Q=.707106781,X=0):(X=Math.sqrt(ue),G=_e/X,Q=xe/X),this.set(G,Q,X,F),this}let ge=Math.sqrt((se-ne)*(se-ne)+(Z-le)*(Z-le)+(ee-te)*(ee-te));return Math.abs(ge)<.001&&(ge=1),this.x=(se-ne)/ge,this.y=(Z-le)/ge,this.z=(ee-te)/ge,this.w=Math.acos((J+re+ie-1)/2),this}min(D){return this.x=Math.min(this.x,D.x),this.y=Math.min(this.y,D.y),this.z=Math.min(this.z,D.z),this.w=Math.min(this.w,D.w),this}max(D){return this.x=Math.max(this.x,D.x),this.y=Math.max(this.y,D.y),this.z=Math.max(this.z,D.z),this.w=Math.max(this.w,D.w),this}clamp(D,F){return this.x=Math.max(D.x,Math.min(F.x,this.x)),this.y=Math.max(D.y,Math.min(F.y,this.y)),this.z=Math.max(D.z,Math.min(F.z,this.z)),this.w=Math.max(D.w,Math.min(F.w,this.w)),this}clampScalar(D,F){return this.x=Math.max(D,Math.min(F,this.x)),this.y=Math.max(D,Math.min(F,this.y)),this.z=Math.max(D,Math.min(F,this.z)),this.w=Math.max(D,Math.min(F,this.w)),this}clampLength(D,F){const G=this.length();return this.divideScalar(G||1).multiplyScalar(Math.max(D,Math.min(F,G)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(D){return this.x*D.x+this.y*D.y+this.z*D.z+this.w*D.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(D){return this.normalize().multiplyScalar(D)}lerp(D,F){return this.x+=(D.x-this.x)*F,this.y+=(D.y-this.y)*F,this.z+=(D.z-this.z)*F,this.w+=(D.w-this.w)*F,this}lerpVectors(D,F,G){return this.x=D.x+(F.x-D.x)*G,this.y=D.y+(F.y-D.y)*G,this.z=D.z+(F.z-D.z)*G,this.w=D.w+(F.w-D.w)*G,this}equals(D){return D.x===this.x&&D.y===this.y&&D.z===this.z&&D.w===this.w}fromArray(D,F=0){return this.x=D[F],this.y=D[F+1],this.z=D[F+2],this.w=D[F+3],this}toArray(D=[],F=0){return D[F]=this.x,D[F+1]=this.y,D[F+2]=this.z,D[F+3]=this.w,D}fromBufferAttribute(D,F){return this.x=D.getX(F),this.y=D.getY(F),this.z=D.getZ(F),this.w=D.getW(F),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class WebGLRenderTarget extends EventDispatcher{constructor(D=1,F=1,G={}){super(),this.isWebGLRenderTarget=!0,this.width=D,this.height=F,this.depth=1,this.scissor=new Vector4(0,0,D,F),this.scissorTest=!1,this.viewport=new Vector4(0,0,D,F);const Q={width:D,height:F,depth:1};this.texture=new Texture(Q,G.mapping,G.wrapS,G.wrapT,G.magFilter,G.minFilter,G.format,G.type,G.anisotropy,G.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=G.generateMipmaps!==void 0?G.generateMipmaps:!1,this.texture.internalFormat=G.internalFormat!==void 0?G.internalFormat:null,this.texture.minFilter=G.minFilter!==void 0?G.minFilter:LinearFilter,this.depthBuffer=G.depthBuffer!==void 0?G.depthBuffer:!0,this.stencilBuffer=G.stencilBuffer!==void 0?G.stencilBuffer:!1,this.depthTexture=G.depthTexture!==void 0?G.depthTexture:null,this.samples=G.samples!==void 0?G.samples:0}setSize(D,F,G=1){(this.width!==D||this.height!==F||this.depth!==G)&&(this.width=D,this.height=F,this.depth=G,this.texture.image.width=D,this.texture.image.height=F,this.texture.image.depth=G,this.dispose()),this.viewport.set(0,0,D,F),this.scissor.set(0,0,D,F)}clone(){return new this.constructor().copy(this)}copy(D){this.width=D.width,this.height=D.height,this.depth=D.depth,this.viewport.copy(D.viewport),this.texture=D.texture.clone(),this.texture.isRenderTargetTexture=!0;const F=Object.assign({},D.texture.image);return this.texture.source=new Source(F),this.depthBuffer=D.depthBuffer,this.stencilBuffer=D.stencilBuffer,D.depthTexture!==null&&(this.depthTexture=D.depthTexture.clone()),this.samples=D.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class DataArrayTexture extends Texture{constructor(D=null,F=1,G=1,Q=1){super(null),this.isDataArrayTexture=!0,this.image={data:D,width:F,height:G,depth:Q},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Data3DTexture extends Texture{constructor(D=null,F=1,G=1,Q=1){super(null),this.isData3DTexture=!0,this.image={data:D,width:F,height:G,depth:Q},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Quaternion{constructor(D=0,F=0,G=0,Q=1){this.isQuaternion=!0,this._x=D,this._y=F,this._z=G,this._w=Q}static slerpFlat(D,F,G,Q,X,q,W){let Y=G[Q+0],J=G[Q+1],te=G[Q+2],Z=G[Q+3];const ee=X[q+0],re=X[q+1],ne=X[q+2],le=X[q+3];if(W===0){D[F+0]=Y,D[F+1]=J,D[F+2]=te,D[F+3]=Z;return}if(W===1){D[F+0]=ee,D[F+1]=re,D[F+2]=ne,D[F+3]=le;return}if(Z!==le||Y!==ee||J!==re||te!==ne){let se=1-W;const ie=Y*ee+J*re+te*ne+Z*le,ge=ie>=0?1:-1,fe=1-ie*ie;if(fe>Number.EPSILON){const ue=Math.sqrt(fe),pe=Math.atan2(ue,ie*ge);se=Math.sin(se*pe)/ue,W=Math.sin(W*pe)/ue}const ae=W*ge;if(Y=Y*se+ee*ae,J=J*se+re*ae,te=te*se+ne*ae,Z=Z*se+le*ae,se===1-W){const ue=1/Math.sqrt(Y*Y+J*J+te*te+Z*Z);Y*=ue,J*=ue,te*=ue,Z*=ue}}D[F]=Y,D[F+1]=J,D[F+2]=te,D[F+3]=Z}static multiplyQuaternionsFlat(D,F,G,Q,X,q){const W=G[Q],Y=G[Q+1],J=G[Q+2],te=G[Q+3],Z=X[q],ee=X[q+1],re=X[q+2],ne=X[q+3];return D[F]=W*ne+te*Z+Y*re-J*ee,D[F+1]=Y*ne+te*ee+J*Z-W*re,D[F+2]=J*ne+te*re+W*ee-Y*Z,D[F+3]=te*ne-W*Z-Y*ee-J*re,D}get x(){return this._x}set x(D){this._x=D,this._onChangeCallback()}get y(){return this._y}set y(D){this._y=D,this._onChangeCallback()}get z(){return this._z}set z(D){this._z=D,this._onChangeCallback()}get w(){return this._w}set w(D){this._w=D,this._onChangeCallback()}set(D,F,G,Q){return this._x=D,this._y=F,this._z=G,this._w=Q,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(D){return this._x=D.x,this._y=D.y,this._z=D.z,this._w=D.w,this._onChangeCallback(),this}setFromEuler(D,F){const G=D._x,Q=D._y,X=D._z,q=D._order,W=Math.cos,Y=Math.sin,J=W(G/2),te=W(Q/2),Z=W(X/2),ee=Y(G/2),re=Y(Q/2),ne=Y(X/2);switch(q){case"XYZ":this._x=ee*te*Z+J*re*ne,this._y=J*re*Z-ee*te*ne,this._z=J*te*ne+ee*re*Z,this._w=J*te*Z-ee*re*ne;break;case"YXZ":this._x=ee*te*Z+J*re*ne,this._y=J*re*Z-ee*te*ne,this._z=J*te*ne-ee*re*Z,this._w=J*te*Z+ee*re*ne;break;case"ZXY":this._x=ee*te*Z-J*re*ne,this._y=J*re*Z+ee*te*ne,this._z=J*te*ne+ee*re*Z,this._w=J*te*Z-ee*re*ne;break;case"ZYX":this._x=ee*te*Z-J*re*ne,this._y=J*re*Z+ee*te*ne,this._z=J*te*ne-ee*re*Z,this._w=J*te*Z+ee*re*ne;break;case"YZX":this._x=ee*te*Z+J*re*ne,this._y=J*re*Z+ee*te*ne,this._z=J*te*ne-ee*re*Z,this._w=J*te*Z-ee*re*ne;break;case"XZY":this._x=ee*te*Z-J*re*ne,this._y=J*re*Z-ee*te*ne,this._z=J*te*ne+ee*re*Z,this._w=J*te*Z+ee*re*ne;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+q)}return F!==!1&&this._onChangeCallback(),this}setFromAxisAngle(D,F){const G=F/2,Q=Math.sin(G);return this._x=D.x*Q,this._y=D.y*Q,this._z=D.z*Q,this._w=Math.cos(G),this._onChangeCallback(),this}setFromRotationMatrix(D){const F=D.elements,G=F[0],Q=F[4],X=F[8],q=F[1],W=F[5],Y=F[9],J=F[2],te=F[6],Z=F[10],ee=G+W+Z;if(ee>0){const re=.5/Math.sqrt(ee+1);this._w=.25/re,this._x=(te-Y)*re,this._y=(X-J)*re,this._z=(q-Q)*re}else if(G>W&&G>Z){const re=2*Math.sqrt(1+G-W-Z);this._w=(te-Y)/re,this._x=.25*re,this._y=(Q+q)/re,this._z=(X+J)/re}else if(W>Z){const re=2*Math.sqrt(1+W-G-Z);this._w=(X-J)/re,this._x=(Q+q)/re,this._y=.25*re,this._z=(Y+te)/re}else{const re=2*Math.sqrt(1+Z-G-W);this._w=(q-Q)/re,this._x=(X+J)/re,this._y=(Y+te)/re,this._z=.25*re}return this._onChangeCallback(),this}setFromUnitVectors(D,F){let G=D.dot(F)+1;return G<Number.EPSILON?(G=0,Math.abs(D.x)>Math.abs(D.z)?(this._x=-D.y,this._y=D.x,this._z=0,this._w=G):(this._x=0,this._y=-D.z,this._z=D.y,this._w=G)):(this._x=D.y*F.z-D.z*F.y,this._y=D.z*F.x-D.x*F.z,this._z=D.x*F.y-D.y*F.x,this._w=G),this.normalize()}angleTo(D){return 2*Math.acos(Math.abs(clamp(this.dot(D),-1,1)))}rotateTowards(D,F){const G=this.angleTo(D);if(G===0)return this;const Q=Math.min(1,F/G);return this.slerp(D,Q),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(D){return this._x*D._x+this._y*D._y+this._z*D._z+this._w*D._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let D=this.length();return D===0?(this._x=0,this._y=0,this._z=0,this._w=1):(D=1/D,this._x=this._x*D,this._y=this._y*D,this._z=this._z*D,this._w=this._w*D),this._onChangeCallback(),this}multiply(D){return this.multiplyQuaternions(this,D)}premultiply(D){return this.multiplyQuaternions(D,this)}multiplyQuaternions(D,F){const G=D._x,Q=D._y,X=D._z,q=D._w,W=F._x,Y=F._y,J=F._z,te=F._w;return this._x=G*te+q*W+Q*J-X*Y,this._y=Q*te+q*Y+X*W-G*J,this._z=X*te+q*J+G*Y-Q*W,this._w=q*te-G*W-Q*Y-X*J,this._onChangeCallback(),this}slerp(D,F){if(F===0)return this;if(F===1)return this.copy(D);const G=this._x,Q=this._y,X=this._z,q=this._w;let W=q*D._w+G*D._x+Q*D._y+X*D._z;if(W<0?(this._w=-D._w,this._x=-D._x,this._y=-D._y,this._z=-D._z,W=-W):this.copy(D),W>=1)return this._w=q,this._x=G,this._y=Q,this._z=X,this;const Y=1-W*W;if(Y<=Number.EPSILON){const re=1-F;return this._w=re*q+F*this._w,this._x=re*G+F*this._x,this._y=re*Q+F*this._y,this._z=re*X+F*this._z,this.normalize(),this._onChangeCallback(),this}const J=Math.sqrt(Y),te=Math.atan2(J,W),Z=Math.sin((1-F)*te)/J,ee=Math.sin(F*te)/J;return this._w=q*Z+this._w*ee,this._x=G*Z+this._x*ee,this._y=Q*Z+this._y*ee,this._z=X*Z+this._z*ee,this._onChangeCallback(),this}slerpQuaternions(D,F,G){return this.copy(D).slerp(F,G)}random(){const D=Math.random(),F=Math.sqrt(1-D),G=Math.sqrt(D),Q=2*Math.PI*Math.random(),X=2*Math.PI*Math.random();return this.set(F*Math.cos(Q),G*Math.sin(X),G*Math.cos(X),F*Math.sin(Q))}equals(D){return D._x===this._x&&D._y===this._y&&D._z===this._z&&D._w===this._w}fromArray(D,F=0){return this._x=D[F],this._y=D[F+1],this._z=D[F+2],this._w=D[F+3],this._onChangeCallback(),this}toArray(D=[],F=0){return D[F]=this._x,D[F+1]=this._y,D[F+2]=this._z,D[F+3]=this._w,D}fromBufferAttribute(D,F){return this._x=D.getX(F),this._y=D.getY(F),this._z=D.getZ(F),this._w=D.getW(F),this}toJSON(){return this.toArray()}_onChange(D){return this._onChangeCallback=D,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3{constructor(D=0,F=0,G=0){Vector3.prototype.isVector3=!0,this.x=D,this.y=F,this.z=G}set(D,F,G){return G===void 0&&(G=this.z),this.x=D,this.y=F,this.z=G,this}setScalar(D){return this.x=D,this.y=D,this.z=D,this}setX(D){return this.x=D,this}setY(D){return this.y=D,this}setZ(D){return this.z=D,this}setComponent(D,F){switch(D){case 0:this.x=F;break;case 1:this.y=F;break;case 2:this.z=F;break;default:throw new Error("index is out of range: "+D)}return this}getComponent(D){switch(D){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+D)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(D){return this.x=D.x,this.y=D.y,this.z=D.z,this}add(D){return this.x+=D.x,this.y+=D.y,this.z+=D.z,this}addScalar(D){return this.x+=D,this.y+=D,this.z+=D,this}addVectors(D,F){return this.x=D.x+F.x,this.y=D.y+F.y,this.z=D.z+F.z,this}addScaledVector(D,F){return this.x+=D.x*F,this.y+=D.y*F,this.z+=D.z*F,this}sub(D){return this.x-=D.x,this.y-=D.y,this.z-=D.z,this}subScalar(D){return this.x-=D,this.y-=D,this.z-=D,this}subVectors(D,F){return this.x=D.x-F.x,this.y=D.y-F.y,this.z=D.z-F.z,this}multiply(D){return this.x*=D.x,this.y*=D.y,this.z*=D.z,this}multiplyScalar(D){return this.x*=D,this.y*=D,this.z*=D,this}multiplyVectors(D,F){return this.x=D.x*F.x,this.y=D.y*F.y,this.z=D.z*F.z,this}applyEuler(D){return this.applyQuaternion(_quaternion$4.setFromEuler(D))}applyAxisAngle(D,F){return this.applyQuaternion(_quaternion$4.setFromAxisAngle(D,F))}applyMatrix3(D){const F=this.x,G=this.y,Q=this.z,X=D.elements;return this.x=X[0]*F+X[3]*G+X[6]*Q,this.y=X[1]*F+X[4]*G+X[7]*Q,this.z=X[2]*F+X[5]*G+X[8]*Q,this}applyNormalMatrix(D){return this.applyMatrix3(D).normalize()}applyMatrix4(D){const F=this.x,G=this.y,Q=this.z,X=D.elements,q=1/(X[3]*F+X[7]*G+X[11]*Q+X[15]);return this.x=(X[0]*F+X[4]*G+X[8]*Q+X[12])*q,this.y=(X[1]*F+X[5]*G+X[9]*Q+X[13])*q,this.z=(X[2]*F+X[6]*G+X[10]*Q+X[14])*q,this}applyQuaternion(D){const F=this.x,G=this.y,Q=this.z,X=D.x,q=D.y,W=D.z,Y=D.w,J=Y*F+q*Q-W*G,te=Y*G+W*F-X*Q,Z=Y*Q+X*G-q*F,ee=-X*F-q*G-W*Q;return this.x=J*Y+ee*-X+te*-W-Z*-q,this.y=te*Y+ee*-q+Z*-X-J*-W,this.z=Z*Y+ee*-W+J*-q-te*-X,this}project(D){return this.applyMatrix4(D.matrixWorldInverse).applyMatrix4(D.projectionMatrix)}unproject(D){return this.applyMatrix4(D.projectionMatrixInverse).applyMatrix4(D.matrixWorld)}transformDirection(D){const F=this.x,G=this.y,Q=this.z,X=D.elements;return this.x=X[0]*F+X[4]*G+X[8]*Q,this.y=X[1]*F+X[5]*G+X[9]*Q,this.z=X[2]*F+X[6]*G+X[10]*Q,this.normalize()}divide(D){return this.x/=D.x,this.y/=D.y,this.z/=D.z,this}divideScalar(D){return this.multiplyScalar(1/D)}min(D){return this.x=Math.min(this.x,D.x),this.y=Math.min(this.y,D.y),this.z=Math.min(this.z,D.z),this}max(D){return this.x=Math.max(this.x,D.x),this.y=Math.max(this.y,D.y),this.z=Math.max(this.z,D.z),this}clamp(D,F){return this.x=Math.max(D.x,Math.min(F.x,this.x)),this.y=Math.max(D.y,Math.min(F.y,this.y)),this.z=Math.max(D.z,Math.min(F.z,this.z)),this}clampScalar(D,F){return this.x=Math.max(D,Math.min(F,this.x)),this.y=Math.max(D,Math.min(F,this.y)),this.z=Math.max(D,Math.min(F,this.z)),this}clampLength(D,F){const G=this.length();return this.divideScalar(G||1).multiplyScalar(Math.max(D,Math.min(F,G)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(D){return this.x*D.x+this.y*D.y+this.z*D.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(D){return this.normalize().multiplyScalar(D)}lerp(D,F){return this.x+=(D.x-this.x)*F,this.y+=(D.y-this.y)*F,this.z+=(D.z-this.z)*F,this}lerpVectors(D,F,G){return this.x=D.x+(F.x-D.x)*G,this.y=D.y+(F.y-D.y)*G,this.z=D.z+(F.z-D.z)*G,this}cross(D){return this.crossVectors(this,D)}crossVectors(D,F){const G=D.x,Q=D.y,X=D.z,q=F.x,W=F.y,Y=F.z;return this.x=Q*Y-X*W,this.y=X*q-G*Y,this.z=G*W-Q*q,this}projectOnVector(D){const F=D.lengthSq();if(F===0)return this.set(0,0,0);const G=D.dot(this)/F;return this.copy(D).multiplyScalar(G)}projectOnPlane(D){return _vector$b.copy(this).projectOnVector(D),this.sub(_vector$b)}reflect(D){return this.sub(_vector$b.copy(D).multiplyScalar(2*this.dot(D)))}angleTo(D){const F=Math.sqrt(this.lengthSq()*D.lengthSq());if(F===0)return Math.PI/2;const G=this.dot(D)/F;return Math.acos(clamp(G,-1,1))}distanceTo(D){return Math.sqrt(this.distanceToSquared(D))}distanceToSquared(D){const F=this.x-D.x,G=this.y-D.y,Q=this.z-D.z;return F*F+G*G+Q*Q}manhattanDistanceTo(D){return Math.abs(this.x-D.x)+Math.abs(this.y-D.y)+Math.abs(this.z-D.z)}setFromSpherical(D){return this.setFromSphericalCoords(D.radius,D.phi,D.theta)}setFromSphericalCoords(D,F,G){const Q=Math.sin(F)*D;return this.x=Q*Math.sin(G),this.y=Math.cos(F)*D,this.z=Q*Math.cos(G),this}setFromCylindrical(D){return this.setFromCylindricalCoords(D.radius,D.theta,D.y)}setFromCylindricalCoords(D,F,G){return this.x=D*Math.sin(F),this.y=G,this.z=D*Math.cos(F),this}setFromMatrixPosition(D){const F=D.elements;return this.x=F[12],this.y=F[13],this.z=F[14],this}setFromMatrixScale(D){const F=this.setFromMatrixColumn(D,0).length(),G=this.setFromMatrixColumn(D,1).length(),Q=this.setFromMatrixColumn(D,2).length();return this.x=F,this.y=G,this.z=Q,this}setFromMatrixColumn(D,F){return this.fromArray(D.elements,F*4)}setFromMatrix3Column(D,F){return this.fromArray(D.elements,F*3)}setFromEuler(D){return this.x=D._x,this.y=D._y,this.z=D._z,this}setFromColor(D){return this.x=D.r,this.y=D.g,this.z=D.b,this}equals(D){return D.x===this.x&&D.y===this.y&&D.z===this.z}fromArray(D,F=0){return this.x=D[F],this.y=D[F+1],this.z=D[F+2],this}toArray(D=[],F=0){return D[F]=this.x,D[F+1]=this.y,D[F+2]=this.z,D}fromBufferAttribute(D,F){return this.x=D.getX(F),this.y=D.getY(F),this.z=D.getZ(F),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const D=(Math.random()-.5)*2,F=Math.random()*Math.PI*2,G=Math.sqrt(1-D**2);return this.x=G*Math.cos(F),this.y=G*Math.sin(F),this.z=D,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _vector$b=new Vector3,_quaternion$4=new Quaternion;class Box3{constructor(D=new Vector3(1/0,1/0,1/0),F=new Vector3(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=D,this.max=F}set(D,F){return this.min.copy(D),this.max.copy(F),this}setFromArray(D){this.makeEmpty();for(let F=0,G=D.length;F<G;F+=3)this.expandByPoint(_vector$a.fromArray(D,F));return this}setFromBufferAttribute(D){this.makeEmpty();for(let F=0,G=D.count;F<G;F++)this.expandByPoint(_vector$a.fromBufferAttribute(D,F));return this}setFromPoints(D){this.makeEmpty();for(let F=0,G=D.length;F<G;F++)this.expandByPoint(D[F]);return this}setFromCenterAndSize(D,F){const G=_vector$a.copy(F).multiplyScalar(.5);return this.min.copy(D).sub(G),this.max.copy(D).add(G),this}setFromObject(D,F=!1){return this.makeEmpty(),this.expandByObject(D,F)}clone(){return new this.constructor().copy(this)}copy(D){return this.min.copy(D.min),this.max.copy(D.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(D){return this.isEmpty()?D.set(0,0,0):D.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(D){return this.isEmpty()?D.set(0,0,0):D.subVectors(this.max,this.min)}expandByPoint(D){return this.min.min(D),this.max.max(D),this}expandByVector(D){return this.min.sub(D),this.max.add(D),this}expandByScalar(D){return this.min.addScalar(-D),this.max.addScalar(D),this}expandByObject(D,F=!1){if(D.updateWorldMatrix(!1,!1),D.boundingBox!==void 0)D.boundingBox===null&&D.computeBoundingBox(),_box$3.copy(D.boundingBox),_box$3.applyMatrix4(D.matrixWorld),this.union(_box$3);else{const Q=D.geometry;if(Q!==void 0)if(F&&Q.attributes!==void 0&&Q.attributes.position!==void 0){const X=Q.attributes.position;for(let q=0,W=X.count;q<W;q++)_vector$a.fromBufferAttribute(X,q).applyMatrix4(D.matrixWorld),this.expandByPoint(_vector$a)}else Q.boundingBox===null&&Q.computeBoundingBox(),_box$3.copy(Q.boundingBox),_box$3.applyMatrix4(D.matrixWorld),this.union(_box$3)}const G=D.children;for(let Q=0,X=G.length;Q<X;Q++)this.expandByObject(G[Q],F);return this}containsPoint(D){return!(D.x<this.min.x||D.x>this.max.x||D.y<this.min.y||D.y>this.max.y||D.z<this.min.z||D.z>this.max.z)}containsBox(D){return this.min.x<=D.min.x&&D.max.x<=this.max.x&&this.min.y<=D.min.y&&D.max.y<=this.max.y&&this.min.z<=D.min.z&&D.max.z<=this.max.z}getParameter(D,F){return F.set((D.x-this.min.x)/(this.max.x-this.min.x),(D.y-this.min.y)/(this.max.y-this.min.y),(D.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(D){return!(D.max.x<this.min.x||D.min.x>this.max.x||D.max.y<this.min.y||D.min.y>this.max.y||D.max.z<this.min.z||D.min.z>this.max.z)}intersectsSphere(D){return this.clampPoint(D.center,_vector$a),_vector$a.distanceToSquared(D.center)<=D.radius*D.radius}intersectsPlane(D){let F,G;return D.normal.x>0?(F=D.normal.x*this.min.x,G=D.normal.x*this.max.x):(F=D.normal.x*this.max.x,G=D.normal.x*this.min.x),D.normal.y>0?(F+=D.normal.y*this.min.y,G+=D.normal.y*this.max.y):(F+=D.normal.y*this.max.y,G+=D.normal.y*this.min.y),D.normal.z>0?(F+=D.normal.z*this.min.z,G+=D.normal.z*this.max.z):(F+=D.normal.z*this.max.z,G+=D.normal.z*this.min.z),F<=-D.constant&&G>=-D.constant}intersectsTriangle(D){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0$2.subVectors(D.a,_center),_v1$7.subVectors(D.b,_center),_v2$4.subVectors(D.c,_center),_f0.subVectors(_v1$7,_v0$2),_f1.subVectors(_v2$4,_v1$7),_f2.subVectors(_v0$2,_v2$4);let F=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(F,_v0$2,_v1$7,_v2$4,_extents)||(F=[1,0,0,0,1,0,0,0,1],!satForAxes(F,_v0$2,_v1$7,_v2$4,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),F=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(F,_v0$2,_v1$7,_v2$4,_extents))}clampPoint(D,F){return F.copy(D).clamp(this.min,this.max)}distanceToPoint(D){return this.clampPoint(D,_vector$a).distanceTo(D)}getBoundingSphere(D){return this.isEmpty()?D.makeEmpty():(this.getCenter(D.center),D.radius=this.getSize(_vector$a).length()*.5),D}intersect(D){return this.min.max(D.min),this.max.min(D.max),this.isEmpty()&&this.makeEmpty(),this}union(D){return this.min.min(D.min),this.max.max(D.max),this}applyMatrix4(D){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(D),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(D),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(D),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(D),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(D),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(D),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(D),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(D),this.setFromPoints(_points),this)}translate(D){return this.min.add(D),this.max.add(D),this}equals(D){return D.min.equals(this.min)&&D.max.equals(this.max)}}const _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$a=new Vector3,_box$3=new Box3,_v0$2=new Vector3,_v1$7=new Vector3,_v2$4=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function satForAxes(U,D,F,G,Q){for(let X=0,q=U.length-3;X<=q;X+=3){_testAxis.fromArray(U,X);const W=Q.x*Math.abs(_testAxis.x)+Q.y*Math.abs(_testAxis.y)+Q.z*Math.abs(_testAxis.z),Y=D.dot(_testAxis),J=F.dot(_testAxis),te=G.dot(_testAxis);if(Math.max(-Math.max(Y,J,te),Math.min(Y,J,te))>W)return!1}return!0}const _box$2=new Box3,_v1$6=new Vector3,_v2$3=new Vector3;class Sphere{constructor(D=new Vector3,F=-1){this.center=D,this.radius=F}set(D,F){return this.center.copy(D),this.radius=F,this}setFromPoints(D,F){const G=this.center;F!==void 0?G.copy(F):_box$2.setFromPoints(D).getCenter(G);let Q=0;for(let X=0,q=D.length;X<q;X++)Q=Math.max(Q,G.distanceToSquared(D[X]));return this.radius=Math.sqrt(Q),this}copy(D){return this.center.copy(D.center),this.radius=D.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(D){return D.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(D){return D.distanceTo(this.center)-this.radius}intersectsSphere(D){const F=this.radius+D.radius;return D.center.distanceToSquared(this.center)<=F*F}intersectsBox(D){return D.intersectsSphere(this)}intersectsPlane(D){return Math.abs(D.distanceToPoint(this.center))<=this.radius}clampPoint(D,F){const G=this.center.distanceToSquared(D);return F.copy(D),G>this.radius*this.radius&&(F.sub(this.center).normalize(),F.multiplyScalar(this.radius).add(this.center)),F}getBoundingBox(D){return this.isEmpty()?(D.makeEmpty(),D):(D.set(this.center,this.center),D.expandByScalar(this.radius),D)}applyMatrix4(D){return this.center.applyMatrix4(D),this.radius=this.radius*D.getMaxScaleOnAxis(),this}translate(D){return this.center.add(D),this}expandByPoint(D){if(this.isEmpty())return this.center.copy(D),this.radius=0,this;_v1$6.subVectors(D,this.center);const F=_v1$6.lengthSq();if(F>this.radius*this.radius){const G=Math.sqrt(F),Q=(G-this.radius)*.5;this.center.addScaledVector(_v1$6,Q/G),this.radius+=Q}return this}union(D){return D.isEmpty()?this:this.isEmpty()?(this.copy(D),this):(this.center.equals(D.center)===!0?this.radius=Math.max(this.radius,D.radius):(_v2$3.subVectors(D.center,this.center).setLength(D.radius),this.expandByPoint(_v1$6.copy(D.center).add(_v2$3)),this.expandByPoint(_v1$6.copy(D.center).sub(_v2$3))),this)}equals(D){return D.center.equals(this.center)&&D.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _vector$9=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal$1=new Vector3;class Ray{constructor(D=new Vector3,F=new Vector3(0,0,-1)){this.origin=D,this.direction=F}set(D,F){return this.origin.copy(D),this.direction.copy(F),this}copy(D){return this.origin.copy(D.origin),this.direction.copy(D.direction),this}at(D,F){return F.copy(this.origin).addScaledVector(this.direction,D)}lookAt(D){return this.direction.copy(D).sub(this.origin).normalize(),this}recast(D){return this.origin.copy(this.at(D,_vector$9)),this}closestPointToPoint(D,F){F.subVectors(D,this.origin);const G=F.dot(this.direction);return G<0?F.copy(this.origin):F.copy(this.origin).addScaledVector(this.direction,G)}distanceToPoint(D){return Math.sqrt(this.distanceSqToPoint(D))}distanceSqToPoint(D){const F=_vector$9.subVectors(D,this.origin).dot(this.direction);return F<0?this.origin.distanceToSquared(D):(_vector$9.copy(this.origin).addScaledVector(this.direction,F),_vector$9.distanceToSquared(D))}distanceSqToSegment(D,F,G,Q){_segCenter.copy(D).add(F).multiplyScalar(.5),_segDir.copy(F).sub(D).normalize(),_diff.copy(this.origin).sub(_segCenter);const X=D.distanceTo(F)*.5,q=-this.direction.dot(_segDir),W=_diff.dot(this.direction),Y=-_diff.dot(_segDir),J=_diff.lengthSq(),te=Math.abs(1-q*q);let Z,ee,re,ne;if(te>0)if(Z=q*Y-W,ee=q*W-Y,ne=X*te,Z>=0)if(ee>=-ne)if(ee<=ne){const le=1/te;Z*=le,ee*=le,re=Z*(Z+q*ee+2*W)+ee*(q*Z+ee+2*Y)+J}else ee=X,Z=Math.max(0,-(q*ee+W)),re=-Z*Z+ee*(ee+2*Y)+J;else ee=-X,Z=Math.max(0,-(q*ee+W)),re=-Z*Z+ee*(ee+2*Y)+J;else ee<=-ne?(Z=Math.max(0,-(-q*X+W)),ee=Z>0?-X:Math.min(Math.max(-X,-Y),X),re=-Z*Z+ee*(ee+2*Y)+J):ee<=ne?(Z=0,ee=Math.min(Math.max(-X,-Y),X),re=ee*(ee+2*Y)+J):(Z=Math.max(0,-(q*X+W)),ee=Z>0?X:Math.min(Math.max(-X,-Y),X),re=-Z*Z+ee*(ee+2*Y)+J);else ee=q>0?-X:X,Z=Math.max(0,-(q*ee+W)),re=-Z*Z+ee*(ee+2*Y)+J;return G&&G.copy(this.origin).addScaledVector(this.direction,Z),Q&&Q.copy(_segCenter).addScaledVector(_segDir,ee),re}intersectSphere(D,F){_vector$9.subVectors(D.center,this.origin);const G=_vector$9.dot(this.direction),Q=_vector$9.dot(_vector$9)-G*G,X=D.radius*D.radius;if(Q>X)return null;const q=Math.sqrt(X-Q),W=G-q,Y=G+q;return Y<0?null:W<0?this.at(Y,F):this.at(W,F)}intersectsSphere(D){return this.distanceSqToPoint(D.center)<=D.radius*D.radius}distanceToPlane(D){const F=D.normal.dot(this.direction);if(F===0)return D.distanceToPoint(this.origin)===0?0:null;const G=-(this.origin.dot(D.normal)+D.constant)/F;return G>=0?G:null}intersectPlane(D,F){const G=this.distanceToPlane(D);return G===null?null:this.at(G,F)}intersectsPlane(D){const F=D.distanceToPoint(this.origin);return F===0||D.normal.dot(this.direction)*F<0}intersectBox(D,F){let G,Q,X,q,W,Y;const J=1/this.direction.x,te=1/this.direction.y,Z=1/this.direction.z,ee=this.origin;return J>=0?(G=(D.min.x-ee.x)*J,Q=(D.max.x-ee.x)*J):(G=(D.max.x-ee.x)*J,Q=(D.min.x-ee.x)*J),te>=0?(X=(D.min.y-ee.y)*te,q=(D.max.y-ee.y)*te):(X=(D.max.y-ee.y)*te,q=(D.min.y-ee.y)*te),G>q||X>Q||((X>G||isNaN(G))&&(G=X),(q<Q||isNaN(Q))&&(Q=q),Z>=0?(W=(D.min.z-ee.z)*Z,Y=(D.max.z-ee.z)*Z):(W=(D.max.z-ee.z)*Z,Y=(D.min.z-ee.z)*Z),G>Y||W>Q)||((W>G||G!==G)&&(G=W),(Y<Q||Q!==Q)&&(Q=Y),Q<0)?null:this.at(G>=0?G:Q,F)}intersectsBox(D){return this.intersectBox(D,_vector$9)!==null}intersectTriangle(D,F,G,Q,X){_edge1.subVectors(F,D),_edge2.subVectors(G,D),_normal$1.crossVectors(_edge1,_edge2);let q=this.direction.dot(_normal$1),W;if(q>0){if(Q)return null;W=1}else if(q<0)W=-1,q=-q;else return null;_diff.subVectors(this.origin,D);const Y=W*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(Y<0)return null;const J=W*this.direction.dot(_edge1.cross(_diff));if(J<0||Y+J>q)return null;const te=-W*_diff.dot(_normal$1);return te<0?null:this.at(te/q,X)}applyMatrix4(D){return this.origin.applyMatrix4(D),this.direction.transformDirection(D),this}equals(D){return D.origin.equals(this.origin)&&D.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Matrix4{constructor(){Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(D,F,G,Q,X,q,W,Y,J,te,Z,ee,re,ne,le,se){const ie=this.elements;return ie[0]=D,ie[4]=F,ie[8]=G,ie[12]=Q,ie[1]=X,ie[5]=q,ie[9]=W,ie[13]=Y,ie[2]=J,ie[6]=te,ie[10]=Z,ie[14]=ee,ie[3]=re,ie[7]=ne,ie[11]=le,ie[15]=se,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Matrix4().fromArray(this.elements)}copy(D){const F=this.elements,G=D.elements;return F[0]=G[0],F[1]=G[1],F[2]=G[2],F[3]=G[3],F[4]=G[4],F[5]=G[5],F[6]=G[6],F[7]=G[7],F[8]=G[8],F[9]=G[9],F[10]=G[10],F[11]=G[11],F[12]=G[12],F[13]=G[13],F[14]=G[14],F[15]=G[15],this}copyPosition(D){const F=this.elements,G=D.elements;return F[12]=G[12],F[13]=G[13],F[14]=G[14],this}setFromMatrix3(D){const F=D.elements;return this.set(F[0],F[3],F[6],0,F[1],F[4],F[7],0,F[2],F[5],F[8],0,0,0,0,1),this}extractBasis(D,F,G){return D.setFromMatrixColumn(this,0),F.setFromMatrixColumn(this,1),G.setFromMatrixColumn(this,2),this}makeBasis(D,F,G){return this.set(D.x,F.x,G.x,0,D.y,F.y,G.y,0,D.z,F.z,G.z,0,0,0,0,1),this}extractRotation(D){const F=this.elements,G=D.elements,Q=1/_v1$5.setFromMatrixColumn(D,0).length(),X=1/_v1$5.setFromMatrixColumn(D,1).length(),q=1/_v1$5.setFromMatrixColumn(D,2).length();return F[0]=G[0]*Q,F[1]=G[1]*Q,F[2]=G[2]*Q,F[3]=0,F[4]=G[4]*X,F[5]=G[5]*X,F[6]=G[6]*X,F[7]=0,F[8]=G[8]*q,F[9]=G[9]*q,F[10]=G[10]*q,F[11]=0,F[12]=0,F[13]=0,F[14]=0,F[15]=1,this}makeRotationFromEuler(D){const F=this.elements,G=D.x,Q=D.y,X=D.z,q=Math.cos(G),W=Math.sin(G),Y=Math.cos(Q),J=Math.sin(Q),te=Math.cos(X),Z=Math.sin(X);if(D.order==="XYZ"){const ee=q*te,re=q*Z,ne=W*te,le=W*Z;F[0]=Y*te,F[4]=-Y*Z,F[8]=J,F[1]=re+ne*J,F[5]=ee-le*J,F[9]=-W*Y,F[2]=le-ee*J,F[6]=ne+re*J,F[10]=q*Y}else if(D.order==="YXZ"){const ee=Y*te,re=Y*Z,ne=J*te,le=J*Z;F[0]=ee+le*W,F[4]=ne*W-re,F[8]=q*J,F[1]=q*Z,F[5]=q*te,F[9]=-W,F[2]=re*W-ne,F[6]=le+ee*W,F[10]=q*Y}else if(D.order==="ZXY"){const ee=Y*te,re=Y*Z,ne=J*te,le=J*Z;F[0]=ee-le*W,F[4]=-q*Z,F[8]=ne+re*W,F[1]=re+ne*W,F[5]=q*te,F[9]=le-ee*W,F[2]=-q*J,F[6]=W,F[10]=q*Y}else if(D.order==="ZYX"){const ee=q*te,re=q*Z,ne=W*te,le=W*Z;F[0]=Y*te,F[4]=ne*J-re,F[8]=ee*J+le,F[1]=Y*Z,F[5]=le*J+ee,F[9]=re*J-ne,F[2]=-J,F[6]=W*Y,F[10]=q*Y}else if(D.order==="YZX"){const ee=q*Y,re=q*J,ne=W*Y,le=W*J;F[0]=Y*te,F[4]=le-ee*Z,F[8]=ne*Z+re,F[1]=Z,F[5]=q*te,F[9]=-W*te,F[2]=-J*te,F[6]=re*Z+ne,F[10]=ee-le*Z}else if(D.order==="XZY"){const ee=q*Y,re=q*J,ne=W*Y,le=W*J;F[0]=Y*te,F[4]=-Z,F[8]=J*te,F[1]=ee*Z+le,F[5]=q*te,F[9]=re*Z-ne,F[2]=ne*Z-re,F[6]=W*te,F[10]=le*Z+ee}return F[3]=0,F[7]=0,F[11]=0,F[12]=0,F[13]=0,F[14]=0,F[15]=1,this}makeRotationFromQuaternion(D){return this.compose(_zero,D,_one)}lookAt(D,F,G){const Q=this.elements;return _z.subVectors(D,F),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x.crossVectors(G,_z),_x.lengthSq()===0&&(Math.abs(G.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(G,_z)),_x.normalize(),_y.crossVectors(_z,_x),Q[0]=_x.x,Q[4]=_y.x,Q[8]=_z.x,Q[1]=_x.y,Q[5]=_y.y,Q[9]=_z.y,Q[2]=_x.z,Q[6]=_y.z,Q[10]=_z.z,this}multiply(D){return this.multiplyMatrices(this,D)}premultiply(D){return this.multiplyMatrices(D,this)}multiplyMatrices(D,F){const G=D.elements,Q=F.elements,X=this.elements,q=G[0],W=G[4],Y=G[8],J=G[12],te=G[1],Z=G[5],ee=G[9],re=G[13],ne=G[2],le=G[6],se=G[10],ie=G[14],ge=G[3],fe=G[7],ae=G[11],ue=G[15],pe=Q[0],_e=Q[4],xe=Q[8],be=Q[12],Te=Q[1],ye=Q[5],Ee=Q[9],he=Q[13],oe=Q[2],me=Q[6],ve=Q[10],we=Q[14],Pe=Q[3],Me=Q[7],De=Q[11],Oe=Q[15];return X[0]=q*pe+W*Te+Y*oe+J*Pe,X[4]=q*_e+W*ye+Y*me+J*Me,X[8]=q*xe+W*Ee+Y*ve+J*De,X[12]=q*be+W*he+Y*we+J*Oe,X[1]=te*pe+Z*Te+ee*oe+re*Pe,X[5]=te*_e+Z*ye+ee*me+re*Me,X[9]=te*xe+Z*Ee+ee*ve+re*De,X[13]=te*be+Z*he+ee*we+re*Oe,X[2]=ne*pe+le*Te+se*oe+ie*Pe,X[6]=ne*_e+le*ye+se*me+ie*Me,X[10]=ne*xe+le*Ee+se*ve+ie*De,X[14]=ne*be+le*he+se*we+ie*Oe,X[3]=ge*pe+fe*Te+ae*oe+ue*Pe,X[7]=ge*_e+fe*ye+ae*me+ue*Me,X[11]=ge*xe+fe*Ee+ae*ve+ue*De,X[15]=ge*be+fe*he+ae*we+ue*Oe,this}multiplyScalar(D){const F=this.elements;return F[0]*=D,F[4]*=D,F[8]*=D,F[12]*=D,F[1]*=D,F[5]*=D,F[9]*=D,F[13]*=D,F[2]*=D,F[6]*=D,F[10]*=D,F[14]*=D,F[3]*=D,F[7]*=D,F[11]*=D,F[15]*=D,this}determinant(){const D=this.elements,F=D[0],G=D[4],Q=D[8],X=D[12],q=D[1],W=D[5],Y=D[9],J=D[13],te=D[2],Z=D[6],ee=D[10],re=D[14],ne=D[3],le=D[7],se=D[11],ie=D[15];return ne*(+X*Y*Z-Q*J*Z-X*W*ee+G*J*ee+Q*W*re-G*Y*re)+le*(+F*Y*re-F*J*ee+X*q*ee-Q*q*re+Q*J*te-X*Y*te)+se*(+F*J*Z-F*W*re-X*q*Z+G*q*re+X*W*te-G*J*te)+ie*(-Q*W*te-F*Y*Z+F*W*ee+Q*q*Z-G*q*ee+G*Y*te)}transpose(){const D=this.elements;let F;return F=D[1],D[1]=D[4],D[4]=F,F=D[2],D[2]=D[8],D[8]=F,F=D[6],D[6]=D[9],D[9]=F,F=D[3],D[3]=D[12],D[12]=F,F=D[7],D[7]=D[13],D[13]=F,F=D[11],D[11]=D[14],D[14]=F,this}setPosition(D,F,G){const Q=this.elements;return D.isVector3?(Q[12]=D.x,Q[13]=D.y,Q[14]=D.z):(Q[12]=D,Q[13]=F,Q[14]=G),this}invert(){const D=this.elements,F=D[0],G=D[1],Q=D[2],X=D[3],q=D[4],W=D[5],Y=D[6],J=D[7],te=D[8],Z=D[9],ee=D[10],re=D[11],ne=D[12],le=D[13],se=D[14],ie=D[15],ge=Z*se*J-le*ee*J+le*Y*re-W*se*re-Z*Y*ie+W*ee*ie,fe=ne*ee*J-te*se*J-ne*Y*re+q*se*re+te*Y*ie-q*ee*ie,ae=te*le*J-ne*Z*J+ne*W*re-q*le*re-te*W*ie+q*Z*ie,ue=ne*Z*Y-te*le*Y-ne*W*ee+q*le*ee+te*W*se-q*Z*se,pe=F*ge+G*fe+Q*ae+X*ue;if(pe===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const _e=1/pe;return D[0]=ge*_e,D[1]=(le*ee*X-Z*se*X-le*Q*re+G*se*re+Z*Q*ie-G*ee*ie)*_e,D[2]=(W*se*X-le*Y*X+le*Q*J-G*se*J-W*Q*ie+G*Y*ie)*_e,D[3]=(Z*Y*X-W*ee*X-Z*Q*J+G*ee*J+W*Q*re-G*Y*re)*_e,D[4]=fe*_e,D[5]=(te*se*X-ne*ee*X+ne*Q*re-F*se*re-te*Q*ie+F*ee*ie)*_e,D[6]=(ne*Y*X-q*se*X-ne*Q*J+F*se*J+q*Q*ie-F*Y*ie)*_e,D[7]=(q*ee*X-te*Y*X+te*Q*J-F*ee*J-q*Q*re+F*Y*re)*_e,D[8]=ae*_e,D[9]=(ne*Z*X-te*le*X-ne*G*re+F*le*re+te*G*ie-F*Z*ie)*_e,D[10]=(q*le*X-ne*W*X+ne*G*J-F*le*J-q*G*ie+F*W*ie)*_e,D[11]=(te*W*X-q*Z*X-te*G*J+F*Z*J+q*G*re-F*W*re)*_e,D[12]=ue*_e,D[13]=(te*le*Q-ne*Z*Q+ne*G*ee-F*le*ee-te*G*se+F*Z*se)*_e,D[14]=(ne*W*Q-q*le*Q-ne*G*Y+F*le*Y+q*G*se-F*W*se)*_e,D[15]=(q*Z*Q-te*W*Q+te*G*Y-F*Z*Y-q*G*ee+F*W*ee)*_e,this}scale(D){const F=this.elements,G=D.x,Q=D.y,X=D.z;return F[0]*=G,F[4]*=Q,F[8]*=X,F[1]*=G,F[5]*=Q,F[9]*=X,F[2]*=G,F[6]*=Q,F[10]*=X,F[3]*=G,F[7]*=Q,F[11]*=X,this}getMaxScaleOnAxis(){const D=this.elements,F=D[0]*D[0]+D[1]*D[1]+D[2]*D[2],G=D[4]*D[4]+D[5]*D[5]+D[6]*D[6],Q=D[8]*D[8]+D[9]*D[9]+D[10]*D[10];return Math.sqrt(Math.max(F,G,Q))}makeTranslation(D,F,G){return this.set(1,0,0,D,0,1,0,F,0,0,1,G,0,0,0,1),this}makeRotationX(D){const F=Math.cos(D),G=Math.sin(D);return this.set(1,0,0,0,0,F,-G,0,0,G,F,0,0,0,0,1),this}makeRotationY(D){const F=Math.cos(D),G=Math.sin(D);return this.set(F,0,G,0,0,1,0,0,-G,0,F,0,0,0,0,1),this}makeRotationZ(D){const F=Math.cos(D),G=Math.sin(D);return this.set(F,-G,0,0,G,F,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(D,F){const G=Math.cos(F),Q=Math.sin(F),X=1-G,q=D.x,W=D.y,Y=D.z,J=X*q,te=X*W;return this.set(J*q+G,J*W-Q*Y,J*Y+Q*W,0,J*W+Q*Y,te*W+G,te*Y-Q*q,0,J*Y-Q*W,te*Y+Q*q,X*Y*Y+G,0,0,0,0,1),this}makeScale(D,F,G){return this.set(D,0,0,0,0,F,0,0,0,0,G,0,0,0,0,1),this}makeShear(D,F,G,Q,X,q){return this.set(1,G,X,0,D,1,q,0,F,Q,1,0,0,0,0,1),this}compose(D,F,G){const Q=this.elements,X=F._x,q=F._y,W=F._z,Y=F._w,J=X+X,te=q+q,Z=W+W,ee=X*J,re=X*te,ne=X*Z,le=q*te,se=q*Z,ie=W*Z,ge=Y*J,fe=Y*te,ae=Y*Z,ue=G.x,pe=G.y,_e=G.z;return Q[0]=(1-(le+ie))*ue,Q[1]=(re+ae)*ue,Q[2]=(ne-fe)*ue,Q[3]=0,Q[4]=(re-ae)*pe,Q[5]=(1-(ee+ie))*pe,Q[6]=(se+ge)*pe,Q[7]=0,Q[8]=(ne+fe)*_e,Q[9]=(se-ge)*_e,Q[10]=(1-(ee+le))*_e,Q[11]=0,Q[12]=D.x,Q[13]=D.y,Q[14]=D.z,Q[15]=1,this}decompose(D,F,G){const Q=this.elements;let X=_v1$5.set(Q[0],Q[1],Q[2]).length();const q=_v1$5.set(Q[4],Q[5],Q[6]).length(),W=_v1$5.set(Q[8],Q[9],Q[10]).length();this.determinant()<0&&(X=-X),D.x=Q[12],D.y=Q[13],D.z=Q[14],_m1$2.copy(this);const J=1/X,te=1/q,Z=1/W;return _m1$2.elements[0]*=J,_m1$2.elements[1]*=J,_m1$2.elements[2]*=J,_m1$2.elements[4]*=te,_m1$2.elements[5]*=te,_m1$2.elements[6]*=te,_m1$2.elements[8]*=Z,_m1$2.elements[9]*=Z,_m1$2.elements[10]*=Z,F.setFromRotationMatrix(_m1$2),G.x=X,G.y=q,G.z=W,this}makePerspective(D,F,G,Q,X,q){const W=this.elements,Y=2*X/(F-D),J=2*X/(G-Q),te=(F+D)/(F-D),Z=(G+Q)/(G-Q),ee=-(q+X)/(q-X),re=-2*q*X/(q-X);return W[0]=Y,W[4]=0,W[8]=te,W[12]=0,W[1]=0,W[5]=J,W[9]=Z,W[13]=0,W[2]=0,W[6]=0,W[10]=ee,W[14]=re,W[3]=0,W[7]=0,W[11]=-1,W[15]=0,this}makeOrthographic(D,F,G,Q,X,q){const W=this.elements,Y=1/(F-D),J=1/(G-Q),te=1/(q-X),Z=(F+D)*Y,ee=(G+Q)*J,re=(q+X)*te;return W[0]=2*Y,W[4]=0,W[8]=0,W[12]=-Z,W[1]=0,W[5]=2*J,W[9]=0,W[13]=-ee,W[2]=0,W[6]=0,W[10]=-2*te,W[14]=-re,W[3]=0,W[7]=0,W[11]=0,W[15]=1,this}equals(D){const F=this.elements,G=D.elements;for(let Q=0;Q<16;Q++)if(F[Q]!==G[Q])return!1;return!0}fromArray(D,F=0){for(let G=0;G<16;G++)this.elements[G]=D[G+F];return this}toArray(D=[],F=0){const G=this.elements;return D[F]=G[0],D[F+1]=G[1],D[F+2]=G[2],D[F+3]=G[3],D[F+4]=G[4],D[F+5]=G[5],D[F+6]=G[6],D[F+7]=G[7],D[F+8]=G[8],D[F+9]=G[9],D[F+10]=G[10],D[F+11]=G[11],D[F+12]=G[12],D[F+13]=G[13],D[F+14]=G[14],D[F+15]=G[15],D}}const _v1$5=new Vector3,_m1$2=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3,_matrix=new Matrix4,_quaternion$3=new Quaternion;class Euler{constructor(D=0,F=0,G=0,Q=Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=D,this._y=F,this._z=G,this._order=Q}get x(){return this._x}set x(D){this._x=D,this._onChangeCallback()}get y(){return this._y}set y(D){this._y=D,this._onChangeCallback()}get z(){return this._z}set z(D){this._z=D,this._onChangeCallback()}get order(){return this._order}set order(D){this._order=D,this._onChangeCallback()}set(D,F,G,Q=this._order){return this._x=D,this._y=F,this._z=G,this._order=Q,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(D){return this._x=D._x,this._y=D._y,this._z=D._z,this._order=D._order,this._onChangeCallback(),this}setFromRotationMatrix(D,F=this._order,G=!0){const Q=D.elements,X=Q[0],q=Q[4],W=Q[8],Y=Q[1],J=Q[5],te=Q[9],Z=Q[2],ee=Q[6],re=Q[10];switch(F){case"XYZ":this._y=Math.asin(clamp(W,-1,1)),Math.abs(W)<.9999999?(this._x=Math.atan2(-te,re),this._z=Math.atan2(-q,X)):(this._x=Math.atan2(ee,J),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp(te,-1,1)),Math.abs(te)<.9999999?(this._y=Math.atan2(W,re),this._z=Math.atan2(Y,J)):(this._y=Math.atan2(-Z,X),this._z=0);break;case"ZXY":this._x=Math.asin(clamp(ee,-1,1)),Math.abs(ee)<.9999999?(this._y=Math.atan2(-Z,re),this._z=Math.atan2(-q,J)):(this._y=0,this._z=Math.atan2(Y,X));break;case"ZYX":this._y=Math.asin(-clamp(Z,-1,1)),Math.abs(Z)<.9999999?(this._x=Math.atan2(ee,re),this._z=Math.atan2(Y,X)):(this._x=0,this._z=Math.atan2(-q,J));break;case"YZX":this._z=Math.asin(clamp(Y,-1,1)),Math.abs(Y)<.9999999?(this._x=Math.atan2(-te,J),this._y=Math.atan2(-Z,X)):(this._x=0,this._y=Math.atan2(W,re));break;case"XZY":this._z=Math.asin(-clamp(q,-1,1)),Math.abs(q)<.9999999?(this._x=Math.atan2(ee,J),this._y=Math.atan2(W,X)):(this._x=Math.atan2(-te,re),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+F)}return this._order=F,G===!0&&this._onChangeCallback(),this}setFromQuaternion(D,F,G){return _matrix.makeRotationFromQuaternion(D),this.setFromRotationMatrix(_matrix,F,G)}setFromVector3(D,F=this._order){return this.set(D.x,D.y,D.z,F)}reorder(D){return _quaternion$3.setFromEuler(this),this.setFromQuaternion(_quaternion$3,D)}equals(D){return D._x===this._x&&D._y===this._y&&D._z===this._z&&D._order===this._order}fromArray(D){return this._x=D[0],this._y=D[1],this._z=D[2],D[3]!==void 0&&(this._order=D[3]),this._onChangeCallback(),this}toArray(D=[],F=0){return D[F]=this._x,D[F+1]=this._y,D[F+2]=this._z,D[F+3]=this._order,D}_onChange(D){return this._onChangeCallback=D,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(D){this.mask=(1<<D|0)>>>0}enable(D){this.mask|=1<<D|0}enableAll(){this.mask=-1}toggle(D){this.mask^=1<<D|0}disable(D){this.mask&=~(1<<D|0)}disableAll(){this.mask=0}test(D){return(this.mask&D.mask)!==0}isEnabled(D){return(this.mask&(1<<D|0))!==0}}let _object3DId=0;const _v1$4=new Vector3,_q1=new Quaternion,_m1$1=new Matrix4,_target=new Vector3,_position$3=new Vector3,_scale$2=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"};class Object3D extends EventDispatcher{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DEFAULT_UP.clone();const D=new Vector3,F=new Euler,G=new Quaternion,Q=new Vector3(1,1,1);function X(){G.setFromEuler(F,!1)}function q(){F.setFromQuaternion(G,void 0,!1)}F._onChange(X),G._onChange(q),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:D},rotation:{configurable:!0,enumerable:!0,value:F},quaternion:{configurable:!0,enumerable:!0,value:G},scale:{configurable:!0,enumerable:!0,value:Q},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(D){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(D),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(D){return this.quaternion.premultiply(D),this}setRotationFromAxisAngle(D,F){this.quaternion.setFromAxisAngle(D,F)}setRotationFromEuler(D){this.quaternion.setFromEuler(D,!0)}setRotationFromMatrix(D){this.quaternion.setFromRotationMatrix(D)}setRotationFromQuaternion(D){this.quaternion.copy(D)}rotateOnAxis(D,F){return _q1.setFromAxisAngle(D,F),this.quaternion.multiply(_q1),this}rotateOnWorldAxis(D,F){return _q1.setFromAxisAngle(D,F),this.quaternion.premultiply(_q1),this}rotateX(D){return this.rotateOnAxis(_xAxis,D)}rotateY(D){return this.rotateOnAxis(_yAxis,D)}rotateZ(D){return this.rotateOnAxis(_zAxis,D)}translateOnAxis(D,F){return _v1$4.copy(D).applyQuaternion(this.quaternion),this.position.add(_v1$4.multiplyScalar(F)),this}translateX(D){return this.translateOnAxis(_xAxis,D)}translateY(D){return this.translateOnAxis(_yAxis,D)}translateZ(D){return this.translateOnAxis(_zAxis,D)}localToWorld(D){return this.updateWorldMatrix(!0,!1),D.applyMatrix4(this.matrixWorld)}worldToLocal(D){return this.updateWorldMatrix(!0,!1),D.applyMatrix4(_m1$1.copy(this.matrixWorld).invert())}lookAt(D,F,G){D.isVector3?_target.copy(D):_target.set(D,F,G);const Q=this.parent;this.updateWorldMatrix(!0,!1),_position$3.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$1.lookAt(_position$3,_target,this.up):_m1$1.lookAt(_target,_position$3,this.up),this.quaternion.setFromRotationMatrix(_m1$1),Q&&(_m1$1.extractRotation(Q.matrixWorld),_q1.setFromRotationMatrix(_m1$1),this.quaternion.premultiply(_q1.invert()))}add(D){if(arguments.length>1){for(let F=0;F<arguments.length;F++)this.add(arguments[F]);return this}return D===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",D),this):(D&&D.isObject3D?(D.parent!==null&&D.parent.remove(D),D.parent=this,this.children.push(D),D.dispatchEvent(_addedEvent)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",D),this)}remove(D){if(arguments.length>1){for(let G=0;G<arguments.length;G++)this.remove(arguments[G]);return this}const F=this.children.indexOf(D);return F!==-1&&(D.parent=null,this.children.splice(F,1),D.dispatchEvent(_removedEvent)),this}removeFromParent(){const D=this.parent;return D!==null&&D.remove(this),this}clear(){for(let D=0;D<this.children.length;D++){const F=this.children[D];F.parent=null,F.dispatchEvent(_removedEvent)}return this.children.length=0,this}attach(D){return this.updateWorldMatrix(!0,!1),_m1$1.copy(this.matrixWorld).invert(),D.parent!==null&&(D.parent.updateWorldMatrix(!0,!1),_m1$1.multiply(D.parent.matrixWorld)),D.applyMatrix4(_m1$1),this.add(D),D.updateWorldMatrix(!1,!0),this}getObjectById(D){return this.getObjectByProperty("id",D)}getObjectByName(D){return this.getObjectByProperty("name",D)}getObjectByProperty(D,F){if(this[D]===F)return this;for(let G=0,Q=this.children.length;G<Q;G++){const q=this.children[G].getObjectByProperty(D,F);if(q!==void 0)return q}}getObjectsByProperty(D,F){let G=[];this[D]===F&&G.push(this);for(let Q=0,X=this.children.length;Q<X;Q++){const q=this.children[Q].getObjectsByProperty(D,F);q.length>0&&(G=G.concat(q))}return G}getWorldPosition(D){return this.updateWorldMatrix(!0,!1),D.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(D){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,D,_scale$2),D}getWorldScale(D){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_quaternion$2,D),D}getWorldDirection(D){this.updateWorldMatrix(!0,!1);const F=this.matrixWorld.elements;return D.set(F[8],F[9],F[10]).normalize()}raycast(){}traverse(D){D(this);const F=this.children;for(let G=0,Q=F.length;G<Q;G++)F[G].traverse(D)}traverseVisible(D){if(this.visible===!1)return;D(this);const F=this.children;for(let G=0,Q=F.length;G<Q;G++)F[G].traverseVisible(D)}traverseAncestors(D){const F=this.parent;F!==null&&(D(F),F.traverseAncestors(D))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(D){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||D)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,D=!0);const F=this.children;for(let G=0,Q=F.length;G<Q;G++){const X=F[G];(X.matrixWorldAutoUpdate===!0||D===!0)&&X.updateMatrixWorld(D)}}updateWorldMatrix(D,F){const G=this.parent;if(D===!0&&G!==null&&G.matrixWorldAutoUpdate===!0&&G.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),F===!0){const Q=this.children;for(let X=0,q=Q.length;X<q;X++){const W=Q[X];W.matrixWorldAutoUpdate===!0&&W.updateWorldMatrix(!1,!0)}}}toJSON(D){const F=D===void 0||typeof D=="string",G={};F&&(D={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},G.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const Q={};Q.uuid=this.uuid,Q.type=this.type,this.name!==""&&(Q.name=this.name),this.castShadow===!0&&(Q.castShadow=!0),this.receiveShadow===!0&&(Q.receiveShadow=!0),this.visible===!1&&(Q.visible=!1),this.frustumCulled===!1&&(Q.frustumCulled=!1),this.renderOrder!==0&&(Q.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(Q.userData=this.userData),Q.layers=this.layers.mask,Q.matrix=this.matrix.toArray(),Q.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(Q.matrixAutoUpdate=!1),this.isInstancedMesh&&(Q.type="InstancedMesh",Q.count=this.count,Q.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(Q.instanceColor=this.instanceColor.toJSON()));function X(W,Y){return W[Y.uuid]===void 0&&(W[Y.uuid]=Y.toJSON(D)),Y.uuid}if(this.isScene)this.background&&(this.background.isColor?Q.background=this.background.toJSON():this.background.isTexture&&(Q.background=this.background.toJSON(D).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(Q.environment=this.environment.toJSON(D).uuid);else if(this.isMesh||this.isLine||this.isPoints){Q.geometry=X(D.geometries,this.geometry);const W=this.geometry.parameters;if(W!==void 0&&W.shapes!==void 0){const Y=W.shapes;if(Array.isArray(Y))for(let J=0,te=Y.length;J<te;J++){const Z=Y[J];X(D.shapes,Z)}else X(D.shapes,Y)}}if(this.isSkinnedMesh&&(Q.bindMode=this.bindMode,Q.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(X(D.skeletons,this.skeleton),Q.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const W=[];for(let Y=0,J=this.material.length;Y<J;Y++)W.push(X(D.materials,this.material[Y]));Q.material=W}else Q.material=X(D.materials,this.material);if(this.children.length>0){Q.children=[];for(let W=0;W<this.children.length;W++)Q.children.push(this.children[W].toJSON(D).object)}if(this.animations.length>0){Q.animations=[];for(let W=0;W<this.animations.length;W++){const Y=this.animations[W];Q.animations.push(X(D.animations,Y))}}if(F){const W=q(D.geometries),Y=q(D.materials),J=q(D.textures),te=q(D.images),Z=q(D.shapes),ee=q(D.skeletons),re=q(D.animations),ne=q(D.nodes);W.length>0&&(G.geometries=W),Y.length>0&&(G.materials=Y),J.length>0&&(G.textures=J),te.length>0&&(G.images=te),Z.length>0&&(G.shapes=Z),ee.length>0&&(G.skeletons=ee),re.length>0&&(G.animations=re),ne.length>0&&(G.nodes=ne)}return G.object=Q,G;function q(W){const Y=[];for(const J in W){const te=W[J];delete te.metadata,Y.push(te)}return Y}}clone(D){return new this.constructor().copy(this,D)}copy(D,F=!0){if(this.name=D.name,this.up.copy(D.up),this.position.copy(D.position),this.rotation.order=D.rotation.order,this.quaternion.copy(D.quaternion),this.scale.copy(D.scale),this.matrix.copy(D.matrix),this.matrixWorld.copy(D.matrixWorld),this.matrixAutoUpdate=D.matrixAutoUpdate,this.matrixWorldNeedsUpdate=D.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=D.matrixWorldAutoUpdate,this.layers.mask=D.layers.mask,this.visible=D.visible,this.castShadow=D.castShadow,this.receiveShadow=D.receiveShadow,this.frustumCulled=D.frustumCulled,this.renderOrder=D.renderOrder,this.userData=JSON.parse(JSON.stringify(D.userData)),F===!0)for(let G=0;G<D.children.length;G++){const Q=D.children[G];this.add(Q.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$1=new Vector3,_v1$3=new Vector3,_v2$2=new Vector3,_v3$1=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3;let warnedGetUV=!1;class Triangle{constructor(D=new Vector3,F=new Vector3,G=new Vector3){this.a=D,this.b=F,this.c=G}static getNormal(D,F,G,Q){Q.subVectors(G,F),_v0$1.subVectors(D,F),Q.cross(_v0$1);const X=Q.lengthSq();return X>0?Q.multiplyScalar(1/Math.sqrt(X)):Q.set(0,0,0)}static getBarycoord(D,F,G,Q,X){_v0$1.subVectors(Q,F),_v1$3.subVectors(G,F),_v2$2.subVectors(D,F);const q=_v0$1.dot(_v0$1),W=_v0$1.dot(_v1$3),Y=_v0$1.dot(_v2$2),J=_v1$3.dot(_v1$3),te=_v1$3.dot(_v2$2),Z=q*J-W*W;if(Z===0)return X.set(-2,-1,-1);const ee=1/Z,re=(J*Y-W*te)*ee,ne=(q*te-W*Y)*ee;return X.set(1-re-ne,ne,re)}static containsPoint(D,F,G,Q){return this.getBarycoord(D,F,G,Q,_v3$1),_v3$1.x>=0&&_v3$1.y>=0&&_v3$1.x+_v3$1.y<=1}static getUV(D,F,G,Q,X,q,W,Y){return warnedGetUV===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),warnedGetUV=!0),this.getInterpolation(D,F,G,Q,X,q,W,Y)}static getInterpolation(D,F,G,Q,X,q,W,Y){return this.getBarycoord(D,F,G,Q,_v3$1),Y.setScalar(0),Y.addScaledVector(X,_v3$1.x),Y.addScaledVector(q,_v3$1.y),Y.addScaledVector(W,_v3$1.z),Y}static isFrontFacing(D,F,G,Q){return _v0$1.subVectors(G,F),_v1$3.subVectors(D,F),_v0$1.cross(_v1$3).dot(Q)<0}set(D,F,G){return this.a.copy(D),this.b.copy(F),this.c.copy(G),this}setFromPointsAndIndices(D,F,G,Q){return this.a.copy(D[F]),this.b.copy(D[G]),this.c.copy(D[Q]),this}setFromAttributeAndIndices(D,F,G,Q){return this.a.fromBufferAttribute(D,F),this.b.fromBufferAttribute(D,G),this.c.fromBufferAttribute(D,Q),this}clone(){return new this.constructor().copy(this)}copy(D){return this.a.copy(D.a),this.b.copy(D.b),this.c.copy(D.c),this}getArea(){return _v0$1.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$1.cross(_v1$3).length()*.5}getMidpoint(D){return D.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(D){return Triangle.getNormal(this.a,this.b,this.c,D)}getPlane(D){return D.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(D,F){return Triangle.getBarycoord(D,this.a,this.b,this.c,F)}getUV(D,F,G,Q,X){return warnedGetUV===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),warnedGetUV=!0),Triangle.getInterpolation(D,this.a,this.b,this.c,F,G,Q,X)}getInterpolation(D,F,G,Q,X){return Triangle.getInterpolation(D,this.a,this.b,this.c,F,G,Q,X)}containsPoint(D){return Triangle.containsPoint(D,this.a,this.b,this.c)}isFrontFacing(D){return Triangle.isFrontFacing(this.a,this.b,this.c,D)}intersectsBox(D){return D.intersectsTriangle(this)}closestPointToPoint(D,F){const G=this.a,Q=this.b,X=this.c;let q,W;_vab.subVectors(Q,G),_vac.subVectors(X,G),_vap.subVectors(D,G);const Y=_vab.dot(_vap),J=_vac.dot(_vap);if(Y<=0&&J<=0)return F.copy(G);_vbp.subVectors(D,Q);const te=_vab.dot(_vbp),Z=_vac.dot(_vbp);if(te>=0&&Z<=te)return F.copy(Q);const ee=Y*Z-te*J;if(ee<=0&&Y>=0&&te<=0)return q=Y/(Y-te),F.copy(G).addScaledVector(_vab,q);_vcp.subVectors(D,X);const re=_vab.dot(_vcp),ne=_vac.dot(_vcp);if(ne>=0&&re<=ne)return F.copy(X);const le=re*J-Y*ne;if(le<=0&&J>=0&&ne<=0)return W=J/(J-ne),F.copy(G).addScaledVector(_vac,W);const se=te*ne-re*Z;if(se<=0&&Z-te>=0&&re-ne>=0)return _vbc.subVectors(X,Q),W=(Z-te)/(Z-te+(re-ne)),F.copy(Q).addScaledVector(_vbc,W);const ie=1/(se+le+ee);return q=le*ie,W=ee*ie,F.copy(G).addScaledVector(_vab,q).addScaledVector(_vac,W)}equals(D){return D.a.equals(this.a)&&D.b.equals(this.b)&&D.c.equals(this.c)}}let materialId=0;class Material extends EventDispatcher{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:materialId++}),this.uuid=generateUUID(),this.name="",this.type="Material",this.blending=NormalBlending,this.side=FrontSide,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(D){this._alphaTest>0!=D>0&&this.version++,this._alphaTest=D}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(D){if(D!==void 0)for(const F in D){const G=D[F];if(G===void 0){console.warn(`THREE.Material: parameter '${F}' has value of undefined.`);continue}const Q=this[F];if(Q===void 0){console.warn(`THREE.Material: '${F}' is not a property of THREE.${this.type}.`);continue}Q&&Q.isColor?Q.set(G):Q&&Q.isVector3&&G&&G.isVector3?Q.copy(G):this[F]=G}}toJSON(D){const F=D===void 0||typeof D=="string";F&&(D={textures:{},images:{}});const G={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};G.uuid=this.uuid,G.type=this.type,this.name!==""&&(G.name=this.name),this.color&&this.color.isColor&&(G.color=this.color.getHex()),this.roughness!==void 0&&(G.roughness=this.roughness),this.metalness!==void 0&&(G.metalness=this.metalness),this.sheen!==void 0&&(G.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(G.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(G.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(G.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(G.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(G.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(G.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(G.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(G.shininess=this.shininess),this.clearcoat!==void 0&&(G.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(G.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(G.clearcoatMap=this.clearcoatMap.toJSON(D).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(G.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(D).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(G.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(D).uuid,G.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(G.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(G.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(G.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(G.iridescenceMap=this.iridescenceMap.toJSON(D).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(G.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(D).uuid),this.map&&this.map.isTexture&&(G.map=this.map.toJSON(D).uuid),this.matcap&&this.matcap.isTexture&&(G.matcap=this.matcap.toJSON(D).uuid),this.alphaMap&&this.alphaMap.isTexture&&(G.alphaMap=this.alphaMap.toJSON(D).uuid),this.lightMap&&this.lightMap.isTexture&&(G.lightMap=this.lightMap.toJSON(D).uuid,G.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(G.aoMap=this.aoMap.toJSON(D).uuid,G.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(G.bumpMap=this.bumpMap.toJSON(D).uuid,G.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(G.normalMap=this.normalMap.toJSON(D).uuid,G.normalMapType=this.normalMapType,G.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(G.displacementMap=this.displacementMap.toJSON(D).uuid,G.displacementScale=this.displacementScale,G.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(G.roughnessMap=this.roughnessMap.toJSON(D).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(G.metalnessMap=this.metalnessMap.toJSON(D).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(G.emissiveMap=this.emissiveMap.toJSON(D).uuid),this.specularMap&&this.specularMap.isTexture&&(G.specularMap=this.specularMap.toJSON(D).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(G.specularIntensityMap=this.specularIntensityMap.toJSON(D).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(G.specularColorMap=this.specularColorMap.toJSON(D).uuid),this.envMap&&this.envMap.isTexture&&(G.envMap=this.envMap.toJSON(D).uuid,this.combine!==void 0&&(G.combine=this.combine)),this.envMapIntensity!==void 0&&(G.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(G.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(G.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(G.gradientMap=this.gradientMap.toJSON(D).uuid),this.transmission!==void 0&&(G.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(G.transmissionMap=this.transmissionMap.toJSON(D).uuid),this.thickness!==void 0&&(G.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(G.thicknessMap=this.thicknessMap.toJSON(D).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(G.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(G.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(G.size=this.size),this.shadowSide!==null&&(G.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(G.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(G.blending=this.blending),this.side!==FrontSide&&(G.side=this.side),this.vertexColors&&(G.vertexColors=!0),this.opacity<1&&(G.opacity=this.opacity),this.transparent===!0&&(G.transparent=this.transparent),G.depthFunc=this.depthFunc,G.depthTest=this.depthTest,G.depthWrite=this.depthWrite,G.colorWrite=this.colorWrite,G.stencilWrite=this.stencilWrite,G.stencilWriteMask=this.stencilWriteMask,G.stencilFunc=this.stencilFunc,G.stencilRef=this.stencilRef,G.stencilFuncMask=this.stencilFuncMask,G.stencilFail=this.stencilFail,G.stencilZFail=this.stencilZFail,G.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(G.rotation=this.rotation),this.polygonOffset===!0&&(G.polygonOffset=!0),this.polygonOffsetFactor!==0&&(G.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(G.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(G.linewidth=this.linewidth),this.dashSize!==void 0&&(G.dashSize=this.dashSize),this.gapSize!==void 0&&(G.gapSize=this.gapSize),this.scale!==void 0&&(G.scale=this.scale),this.dithering===!0&&(G.dithering=!0),this.alphaTest>0&&(G.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(G.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(G.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(G.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(G.wireframe=this.wireframe),this.wireframeLinewidth>1&&(G.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(G.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(G.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(G.flatShading=this.flatShading),this.visible===!1&&(G.visible=!1),this.toneMapped===!1&&(G.toneMapped=!1),this.fog===!1&&(G.fog=!1),Object.keys(this.userData).length>0&&(G.userData=this.userData);function Q(X){const q=[];for(const W in X){const Y=X[W];delete Y.metadata,q.push(Y)}return q}if(F){const X=Q(D.textures),q=Q(D.images);X.length>0&&(G.textures=X),q.length>0&&(G.images=q)}return G}clone(){return new this.constructor().copy(this)}copy(D){this.name=D.name,this.blending=D.blending,this.side=D.side,this.vertexColors=D.vertexColors,this.opacity=D.opacity,this.transparent=D.transparent,this.blendSrc=D.blendSrc,this.blendDst=D.blendDst,this.blendEquation=D.blendEquation,this.blendSrcAlpha=D.blendSrcAlpha,this.blendDstAlpha=D.blendDstAlpha,this.blendEquationAlpha=D.blendEquationAlpha,this.depthFunc=D.depthFunc,this.depthTest=D.depthTest,this.depthWrite=D.depthWrite,this.stencilWriteMask=D.stencilWriteMask,this.stencilFunc=D.stencilFunc,this.stencilRef=D.stencilRef,this.stencilFuncMask=D.stencilFuncMask,this.stencilFail=D.stencilFail,this.stencilZFail=D.stencilZFail,this.stencilZPass=D.stencilZPass,this.stencilWrite=D.stencilWrite;const F=D.clippingPlanes;let G=null;if(F!==null){const Q=F.length;G=new Array(Q);for(let X=0;X!==Q;++X)G[X]=F[X].clone()}return this.clippingPlanes=G,this.clipIntersection=D.clipIntersection,this.clipShadows=D.clipShadows,this.shadowSide=D.shadowSide,this.colorWrite=D.colorWrite,this.precision=D.precision,this.polygonOffset=D.polygonOffset,this.polygonOffsetFactor=D.polygonOffsetFactor,this.polygonOffsetUnits=D.polygonOffsetUnits,this.dithering=D.dithering,this.alphaTest=D.alphaTest,this.alphaToCoverage=D.alphaToCoverage,this.premultipliedAlpha=D.premultipliedAlpha,this.forceSinglePass=D.forceSinglePass,this.visible=D.visible,this.toneMapped=D.toneMapped,this.userData=JSON.parse(JSON.stringify(D.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(D){D===!0&&this.version++}}const _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function hue2rgb(U,D,F){return F<0&&(F+=1),F>1&&(F-=1),F<1/6?U+(D-U)*6*F:F<1/2?D:F<2/3?U+(D-U)*6*(2/3-F):U}class Color{constructor(D,F,G){return this.isColor=!0,this.r=1,this.g=1,this.b=1,F===void 0&&G===void 0?this.set(D):this.setRGB(D,F,G)}set(D){return D&&D.isColor?this.copy(D):typeof D=="number"?this.setHex(D):typeof D=="string"&&this.setStyle(D),this}setScalar(D){return this.r=D,this.g=D,this.b=D,this}setHex(D,F=SRGBColorSpace){return D=Math.floor(D),this.r=(D>>16&255)/255,this.g=(D>>8&255)/255,this.b=(D&255)/255,ColorManagement.toWorkingColorSpace(this,F),this}setRGB(D,F,G,Q=ColorManagement.workingColorSpace){return this.r=D,this.g=F,this.b=G,ColorManagement.toWorkingColorSpace(this,Q),this}setHSL(D,F,G,Q=ColorManagement.workingColorSpace){if(D=euclideanModulo(D,1),F=clamp(F,0,1),G=clamp(G,0,1),F===0)this.r=this.g=this.b=G;else{const X=G<=.5?G*(1+F):G+F-G*F,q=2*G-X;this.r=hue2rgb(q,X,D+1/3),this.g=hue2rgb(q,X,D),this.b=hue2rgb(q,X,D-1/3)}return ColorManagement.toWorkingColorSpace(this,Q),this}setStyle(D,F=SRGBColorSpace){function G(X){X!==void 0&&parseFloat(X)<1&&console.warn("THREE.Color: Alpha component of "+D+" will be ignored.")}let Q;if(Q=/^(\w+)\(([^\)]*)\)/.exec(D)){let X;const q=Q[1],W=Q[2];switch(q){case"rgb":case"rgba":if(X=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(W))return this.r=Math.min(255,parseInt(X[1],10))/255,this.g=Math.min(255,parseInt(X[2],10))/255,this.b=Math.min(255,parseInt(X[3],10))/255,ColorManagement.toWorkingColorSpace(this,F),G(X[4]),this;if(X=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(W))return this.r=Math.min(100,parseInt(X[1],10))/100,this.g=Math.min(100,parseInt(X[2],10))/100,this.b=Math.min(100,parseInt(X[3],10))/100,ColorManagement.toWorkingColorSpace(this,F),G(X[4]),this;break;case"hsl":case"hsla":if(X=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(W)){const Y=parseFloat(X[1])/360,J=parseFloat(X[2])/100,te=parseFloat(X[3])/100;return G(X[4]),this.setHSL(Y,J,te,F)}break;default:console.warn("THREE.Color: Unknown color model "+D)}}else if(Q=/^\#([A-Fa-f\d]+)$/.exec(D)){const X=Q[1],q=X.length;if(q===3)return this.setRGB(parseInt(X.charAt(0),16)/15,parseInt(X.charAt(1),16)/15,parseInt(X.charAt(2),16)/15,F);if(q===6)return this.setHex(parseInt(X,16),F);console.warn("THREE.Color: Invalid hex color "+D)}else if(D&&D.length>0)return this.setColorName(D,F);return this}setColorName(D,F=SRGBColorSpace){const G=_colorKeywords[D.toLowerCase()];return G!==void 0?this.setHex(G,F):console.warn("THREE.Color: Unknown color "+D),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(D){return this.r=D.r,this.g=D.g,this.b=D.b,this}copySRGBToLinear(D){return this.r=SRGBToLinear(D.r),this.g=SRGBToLinear(D.g),this.b=SRGBToLinear(D.b),this}copyLinearToSRGB(D){return this.r=LinearToSRGB(D.r),this.g=LinearToSRGB(D.g),this.b=LinearToSRGB(D.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(D=SRGBColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),D),clamp(_color.r*255,0,255)<<16^clamp(_color.g*255,0,255)<<8^clamp(_color.b*255,0,255)<<0}getHexString(D=SRGBColorSpace){return("000000"+this.getHex(D).toString(16)).slice(-6)}getHSL(D,F=ColorManagement.workingColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),F);const G=_color.r,Q=_color.g,X=_color.b,q=Math.max(G,Q,X),W=Math.min(G,Q,X);let Y,J;const te=(W+q)/2;if(W===q)Y=0,J=0;else{const Z=q-W;switch(J=te<=.5?Z/(q+W):Z/(2-q-W),q){case G:Y=(Q-X)/Z+(Q<X?6:0);break;case Q:Y=(X-G)/Z+2;break;case X:Y=(G-Q)/Z+4;break}Y/=6}return D.h=Y,D.s=J,D.l=te,D}getRGB(D,F=ColorManagement.workingColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),F),D.r=_color.r,D.g=_color.g,D.b=_color.b,D}getStyle(D=SRGBColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),D);const F=_color.r,G=_color.g,Q=_color.b;return D!==SRGBColorSpace?`color(${D} ${F.toFixed(3)} ${G.toFixed(3)} ${Q.toFixed(3)})`:`rgb(${F*255|0},${G*255|0},${Q*255|0})`}offsetHSL(D,F,G){return this.getHSL(_hslA),_hslA.h+=D,_hslA.s+=F,_hslA.l+=G,this.setHSL(_hslA.h,_hslA.s,_hslA.l),this}add(D){return this.r+=D.r,this.g+=D.g,this.b+=D.b,this}addColors(D,F){return this.r=D.r+F.r,this.g=D.g+F.g,this.b=D.b+F.b,this}addScalar(D){return this.r+=D,this.g+=D,this.b+=D,this}sub(D){return this.r=Math.max(0,this.r-D.r),this.g=Math.max(0,this.g-D.g),this.b=Math.max(0,this.b-D.b),this}multiply(D){return this.r*=D.r,this.g*=D.g,this.b*=D.b,this}multiplyScalar(D){return this.r*=D,this.g*=D,this.b*=D,this}lerp(D,F){return this.r+=(D.r-this.r)*F,this.g+=(D.g-this.g)*F,this.b+=(D.b-this.b)*F,this}lerpColors(D,F,G){return this.r=D.r+(F.r-D.r)*G,this.g=D.g+(F.g-D.g)*G,this.b=D.b+(F.b-D.b)*G,this}lerpHSL(D,F){this.getHSL(_hslA),D.getHSL(_hslB);const G=lerp(_hslA.h,_hslB.h,F),Q=lerp(_hslA.s,_hslB.s,F),X=lerp(_hslA.l,_hslB.l,F);return this.setHSL(G,Q,X),this}setFromVector3(D){return this.r=D.x,this.g=D.y,this.b=D.z,this}applyMatrix3(D){const F=this.r,G=this.g,Q=this.b,X=D.elements;return this.r=X[0]*F+X[3]*G+X[6]*Q,this.g=X[1]*F+X[4]*G+X[7]*Q,this.b=X[2]*F+X[5]*G+X[8]*Q,this}equals(D){return D.r===this.r&&D.g===this.g&&D.b===this.b}fromArray(D,F=0){return this.r=D[F],this.g=D[F+1],this.b=D[F+2],this}toArray(D=[],F=0){return D[F]=this.r,D[F+1]=this.g,D[F+2]=this.b,D}fromBufferAttribute(D,F){return this.r=D.getX(F),this.g=D.getY(F),this.b=D.getZ(F),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const _color=new Color;Color.NAMES=_colorKeywords;class MeshBasicMaterial extends Material{constructor(D){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(D)}copy(D){return super.copy(D),this.color.copy(D.color),this.map=D.map,this.lightMap=D.lightMap,this.lightMapIntensity=D.lightMapIntensity,this.aoMap=D.aoMap,this.aoMapIntensity=D.aoMapIntensity,this.specularMap=D.specularMap,this.alphaMap=D.alphaMap,this.envMap=D.envMap,this.combine=D.combine,this.reflectivity=D.reflectivity,this.refractionRatio=D.refractionRatio,this.wireframe=D.wireframe,this.wireframeLinewidth=D.wireframeLinewidth,this.wireframeLinecap=D.wireframeLinecap,this.wireframeLinejoin=D.wireframeLinejoin,this.fog=D.fog,this}}const _vector$8=new Vector3,_vector2$1=new Vector2;class BufferAttribute{constructor(D,F,G=!1){if(Array.isArray(D))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=D,this.itemSize=F,this.count=D!==void 0?D.length/F:0,this.normalized=G,this.usage=StaticDrawUsage,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(D){D===!0&&this.version++}setUsage(D){return this.usage=D,this}copy(D){return this.name=D.name,this.array=new D.array.constructor(D.array),this.itemSize=D.itemSize,this.count=D.count,this.normalized=D.normalized,this.usage=D.usage,this}copyAt(D,F,G){D*=this.itemSize,G*=F.itemSize;for(let Q=0,X=this.itemSize;Q<X;Q++)this.array[D+Q]=F.array[G+Q];return this}copyArray(D){return this.array.set(D),this}applyMatrix3(D){if(this.itemSize===2)for(let F=0,G=this.count;F<G;F++)_vector2$1.fromBufferAttribute(this,F),_vector2$1.applyMatrix3(D),this.setXY(F,_vector2$1.x,_vector2$1.y);else if(this.itemSize===3)for(let F=0,G=this.count;F<G;F++)_vector$8.fromBufferAttribute(this,F),_vector$8.applyMatrix3(D),this.setXYZ(F,_vector$8.x,_vector$8.y,_vector$8.z);return this}applyMatrix4(D){for(let F=0,G=this.count;F<G;F++)_vector$8.fromBufferAttribute(this,F),_vector$8.applyMatrix4(D),this.setXYZ(F,_vector$8.x,_vector$8.y,_vector$8.z);return this}applyNormalMatrix(D){for(let F=0,G=this.count;F<G;F++)_vector$8.fromBufferAttribute(this,F),_vector$8.applyNormalMatrix(D),this.setXYZ(F,_vector$8.x,_vector$8.y,_vector$8.z);return this}transformDirection(D){for(let F=0,G=this.count;F<G;F++)_vector$8.fromBufferAttribute(this,F),_vector$8.transformDirection(D),this.setXYZ(F,_vector$8.x,_vector$8.y,_vector$8.z);return this}set(D,F=0){return this.array.set(D,F),this}getX(D){let F=this.array[D*this.itemSize];return this.normalized&&(F=denormalize(F,this.array)),F}setX(D,F){return this.normalized&&(F=normalize$1(F,this.array)),this.array[D*this.itemSize]=F,this}getY(D){let F=this.array[D*this.itemSize+1];return this.normalized&&(F=denormalize(F,this.array)),F}setY(D,F){return this.normalized&&(F=normalize$1(F,this.array)),this.array[D*this.itemSize+1]=F,this}getZ(D){let F=this.array[D*this.itemSize+2];return this.normalized&&(F=denormalize(F,this.array)),F}setZ(D,F){return this.normalized&&(F=normalize$1(F,this.array)),this.array[D*this.itemSize+2]=F,this}getW(D){let F=this.array[D*this.itemSize+3];return this.normalized&&(F=denormalize(F,this.array)),F}setW(D,F){return this.normalized&&(F=normalize$1(F,this.array)),this.array[D*this.itemSize+3]=F,this}setXY(D,F,G){return D*=this.itemSize,this.normalized&&(F=normalize$1(F,this.array),G=normalize$1(G,this.array)),this.array[D+0]=F,this.array[D+1]=G,this}setXYZ(D,F,G,Q){return D*=this.itemSize,this.normalized&&(F=normalize$1(F,this.array),G=normalize$1(G,this.array),Q=normalize$1(Q,this.array)),this.array[D+0]=F,this.array[D+1]=G,this.array[D+2]=Q,this}setXYZW(D,F,G,Q,X){return D*=this.itemSize,this.normalized&&(F=normalize$1(F,this.array),G=normalize$1(G,this.array),Q=normalize$1(Q,this.array),X=normalize$1(X,this.array)),this.array[D+0]=F,this.array[D+1]=G,this.array[D+2]=Q,this.array[D+3]=X,this}onUpload(D){return this.onUploadCallback=D,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const D={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(D.name=this.name),this.usage!==StaticDrawUsage&&(D.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(D.updateRange=this.updateRange),D}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class Uint16BufferAttribute extends BufferAttribute{constructor(D,F,G){super(new Uint16Array(D),F,G)}}class Uint32BufferAttribute extends BufferAttribute{constructor(D,F,G){super(new Uint32Array(D),F,G)}}class Float32BufferAttribute extends BufferAttribute{constructor(D,F,G){super(new Float32Array(D),F,G)}}let _id$1=0;const _m1=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$1=new Box3,_boxMorphTargets=new Box3,_vector$7=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$1++}),this.uuid=generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(D){return Array.isArray(D)?this.index=new(arrayNeedsUint32(D)?Uint32BufferAttribute:Uint16BufferAttribute)(D,1):this.index=D,this}getAttribute(D){return this.attributes[D]}setAttribute(D,F){return this.attributes[D]=F,this}deleteAttribute(D){return delete this.attributes[D],this}hasAttribute(D){return this.attributes[D]!==void 0}addGroup(D,F,G=0){this.groups.push({start:D,count:F,materialIndex:G})}clearGroups(){this.groups=[]}setDrawRange(D,F){this.drawRange.start=D,this.drawRange.count=F}applyMatrix4(D){const F=this.attributes.position;F!==void 0&&(F.applyMatrix4(D),F.needsUpdate=!0);const G=this.attributes.normal;if(G!==void 0){const X=new Matrix3().getNormalMatrix(D);G.applyNormalMatrix(X),G.needsUpdate=!0}const Q=this.attributes.tangent;return Q!==void 0&&(Q.transformDirection(D),Q.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(D){return _m1.makeRotationFromQuaternion(D),this.applyMatrix4(_m1),this}rotateX(D){return _m1.makeRotationX(D),this.applyMatrix4(_m1),this}rotateY(D){return _m1.makeRotationY(D),this.applyMatrix4(_m1),this}rotateZ(D){return _m1.makeRotationZ(D),this.applyMatrix4(_m1),this}translate(D,F,G){return _m1.makeTranslation(D,F,G),this.applyMatrix4(_m1),this}scale(D,F,G){return _m1.makeScale(D,F,G),this.applyMatrix4(_m1),this}lookAt(D){return _obj.lookAt(D),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this}setFromPoints(D){const F=[];for(let G=0,Q=D.length;G<Q;G++){const X=D[G];F.push(X.x,X.y,X.z||0)}return this.setAttribute("position",new Float32BufferAttribute(F,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const D=this.attributes.position,F=this.morphAttributes.position;if(D&&D.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));return}if(D!==void 0){if(this.boundingBox.setFromBufferAttribute(D),F)for(let G=0,Q=F.length;G<Q;G++){const X=F[G];_box$1.setFromBufferAttribute(X),this.morphTargetsRelative?(_vector$7.addVectors(this.boundingBox.min,_box$1.min),this.boundingBox.expandByPoint(_vector$7),_vector$7.addVectors(this.boundingBox.max,_box$1.max),this.boundingBox.expandByPoint(_vector$7)):(this.boundingBox.expandByPoint(_box$1.min),this.boundingBox.expandByPoint(_box$1.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const D=this.attributes.position,F=this.morphAttributes.position;if(D&&D.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Vector3,1/0);return}if(D){const G=this.boundingSphere.center;if(_box$1.setFromBufferAttribute(D),F)for(let X=0,q=F.length;X<q;X++){const W=F[X];_boxMorphTargets.setFromBufferAttribute(W),this.morphTargetsRelative?(_vector$7.addVectors(_box$1.min,_boxMorphTargets.min),_box$1.expandByPoint(_vector$7),_vector$7.addVectors(_box$1.max,_boxMorphTargets.max),_box$1.expandByPoint(_vector$7)):(_box$1.expandByPoint(_boxMorphTargets.min),_box$1.expandByPoint(_boxMorphTargets.max))}_box$1.getCenter(G);let Q=0;for(let X=0,q=D.count;X<q;X++)_vector$7.fromBufferAttribute(D,X),Q=Math.max(Q,G.distanceToSquared(_vector$7));if(F)for(let X=0,q=F.length;X<q;X++){const W=F[X],Y=this.morphTargetsRelative;for(let J=0,te=W.count;J<te;J++)_vector$7.fromBufferAttribute(W,J),Y&&(_offset.fromBufferAttribute(D,J),_vector$7.add(_offset)),Q=Math.max(Q,G.distanceToSquared(_vector$7))}this.boundingSphere.radius=Math.sqrt(Q),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const D=this.index,F=this.attributes;if(D===null||F.position===void 0||F.normal===void 0||F.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const G=D.array,Q=F.position.array,X=F.normal.array,q=F.uv.array,W=Q.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*W),4));const Y=this.getAttribute("tangent").array,J=[],te=[];for(let Te=0;Te<W;Te++)J[Te]=new Vector3,te[Te]=new Vector3;const Z=new Vector3,ee=new Vector3,re=new Vector3,ne=new Vector2,le=new Vector2,se=new Vector2,ie=new Vector3,ge=new Vector3;function fe(Te,ye,Ee){Z.fromArray(Q,Te*3),ee.fromArray(Q,ye*3),re.fromArray(Q,Ee*3),ne.fromArray(q,Te*2),le.fromArray(q,ye*2),se.fromArray(q,Ee*2),ee.sub(Z),re.sub(Z),le.sub(ne),se.sub(ne);const he=1/(le.x*se.y-se.x*le.y);isFinite(he)&&(ie.copy(ee).multiplyScalar(se.y).addScaledVector(re,-le.y).multiplyScalar(he),ge.copy(re).multiplyScalar(le.x).addScaledVector(ee,-se.x).multiplyScalar(he),J[Te].add(ie),J[ye].add(ie),J[Ee].add(ie),te[Te].add(ge),te[ye].add(ge),te[Ee].add(ge))}let ae=this.groups;ae.length===0&&(ae=[{start:0,count:G.length}]);for(let Te=0,ye=ae.length;Te<ye;++Te){const Ee=ae[Te],he=Ee.start,oe=Ee.count;for(let me=he,ve=he+oe;me<ve;me+=3)fe(G[me+0],G[me+1],G[me+2])}const ue=new Vector3,pe=new Vector3,_e=new Vector3,xe=new Vector3;function be(Te){_e.fromArray(X,Te*3),xe.copy(_e);const ye=J[Te];ue.copy(ye),ue.sub(_e.multiplyScalar(_e.dot(ye))).normalize(),pe.crossVectors(xe,ye);const he=pe.dot(te[Te])<0?-1:1;Y[Te*4]=ue.x,Y[Te*4+1]=ue.y,Y[Te*4+2]=ue.z,Y[Te*4+3]=he}for(let Te=0,ye=ae.length;Te<ye;++Te){const Ee=ae[Te],he=Ee.start,oe=Ee.count;for(let me=he,ve=he+oe;me<ve;me+=3)be(G[me+0]),be(G[me+1]),be(G[me+2])}}computeVertexNormals(){const D=this.index,F=this.getAttribute("position");if(F!==void 0){let G=this.getAttribute("normal");if(G===void 0)G=new BufferAttribute(new Float32Array(F.count*3),3),this.setAttribute("normal",G);else for(let ee=0,re=G.count;ee<re;ee++)G.setXYZ(ee,0,0,0);const Q=new Vector3,X=new Vector3,q=new Vector3,W=new Vector3,Y=new Vector3,J=new Vector3,te=new Vector3,Z=new Vector3;if(D)for(let ee=0,re=D.count;ee<re;ee+=3){const ne=D.getX(ee+0),le=D.getX(ee+1),se=D.getX(ee+2);Q.fromBufferAttribute(F,ne),X.fromBufferAttribute(F,le),q.fromBufferAttribute(F,se),te.subVectors(q,X),Z.subVectors(Q,X),te.cross(Z),W.fromBufferAttribute(G,ne),Y.fromBufferAttribute(G,le),J.fromBufferAttribute(G,se),W.add(te),Y.add(te),J.add(te),G.setXYZ(ne,W.x,W.y,W.z),G.setXYZ(le,Y.x,Y.y,Y.z),G.setXYZ(se,J.x,J.y,J.z)}else for(let ee=0,re=F.count;ee<re;ee+=3)Q.fromBufferAttribute(F,ee+0),X.fromBufferAttribute(F,ee+1),q.fromBufferAttribute(F,ee+2),te.subVectors(q,X),Z.subVectors(Q,X),te.cross(Z),G.setXYZ(ee+0,te.x,te.y,te.z),G.setXYZ(ee+1,te.x,te.y,te.z),G.setXYZ(ee+2,te.x,te.y,te.z);this.normalizeNormals(),G.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeGeometries() instead."),this}normalizeNormals(){const D=this.attributes.normal;for(let F=0,G=D.count;F<G;F++)_vector$7.fromBufferAttribute(D,F),_vector$7.normalize(),D.setXYZ(F,_vector$7.x,_vector$7.y,_vector$7.z)}toNonIndexed(){function D(W,Y){const J=W.array,te=W.itemSize,Z=W.normalized,ee=new J.constructor(Y.length*te);let re=0,ne=0;for(let le=0,se=Y.length;le<se;le++){W.isInterleavedBufferAttribute?re=Y[le]*W.data.stride+W.offset:re=Y[le]*te;for(let ie=0;ie<te;ie++)ee[ne++]=J[re++]}return new BufferAttribute(ee,te,Z)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const F=new BufferGeometry,G=this.index.array,Q=this.attributes;for(const W in Q){const Y=Q[W],J=D(Y,G);F.setAttribute(W,J)}const X=this.morphAttributes;for(const W in X){const Y=[],J=X[W];for(let te=0,Z=J.length;te<Z;te++){const ee=J[te],re=D(ee,G);Y.push(re)}F.morphAttributes[W]=Y}F.morphTargetsRelative=this.morphTargetsRelative;const q=this.groups;for(let W=0,Y=q.length;W<Y;W++){const J=q[W];F.addGroup(J.start,J.count,J.materialIndex)}return F}toJSON(){const D={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(D.uuid=this.uuid,D.type=this.type,this.name!==""&&(D.name=this.name),Object.keys(this.userData).length>0&&(D.userData=this.userData),this.parameters!==void 0){const Y=this.parameters;for(const J in Y)Y[J]!==void 0&&(D[J]=Y[J]);return D}D.data={attributes:{}};const F=this.index;F!==null&&(D.data.index={type:F.array.constructor.name,array:Array.prototype.slice.call(F.array)});const G=this.attributes;for(const Y in G){const J=G[Y];D.data.attributes[Y]=J.toJSON(D.data)}const Q={};let X=!1;for(const Y in this.morphAttributes){const J=this.morphAttributes[Y],te=[];for(let Z=0,ee=J.length;Z<ee;Z++){const re=J[Z];te.push(re.toJSON(D.data))}te.length>0&&(Q[Y]=te,X=!0)}X&&(D.data.morphAttributes=Q,D.data.morphTargetsRelative=this.morphTargetsRelative);const q=this.groups;q.length>0&&(D.data.groups=JSON.parse(JSON.stringify(q)));const W=this.boundingSphere;return W!==null&&(D.data.boundingSphere={center:W.center.toArray(),radius:W.radius}),D}clone(){return new this.constructor().copy(this)}copy(D){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const F={};this.name=D.name;const G=D.index;G!==null&&this.setIndex(G.clone(F));const Q=D.attributes;for(const J in Q){const te=Q[J];this.setAttribute(J,te.clone(F))}const X=D.morphAttributes;for(const J in X){const te=[],Z=X[J];for(let ee=0,re=Z.length;ee<re;ee++)te.push(Z[ee].clone(F));this.morphAttributes[J]=te}this.morphTargetsRelative=D.morphTargetsRelative;const q=D.groups;for(let J=0,te=q.length;J<te;J++){const Z=q[J];this.addGroup(Z.start,Z.count,Z.materialIndex)}const W=D.boundingBox;W!==null&&(this.boundingBox=W.clone());const Y=D.boundingSphere;return Y!==null&&(this.boundingSphere=Y.clone()),this.drawRange.start=D.drawRange.start,this.drawRange.count=D.drawRange.count,this.userData=D.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _inverseMatrix$2=new Matrix4,_ray$2=new Ray,_sphere$4=new Sphere,_sphereHitAt=new Vector3,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_tempA=new Vector3,_morphA=new Vector3,_uvA$1=new Vector2,_uvB$1=new Vector2,_uvC$1=new Vector2,_normalA=new Vector3,_normalB=new Vector3,_normalC=new Vector3,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;class Mesh extends Object3D{constructor(D=new BufferGeometry,F=new MeshBasicMaterial){super(),this.isMesh=!0,this.type="Mesh",this.geometry=D,this.material=F,this.updateMorphTargets()}copy(D,F){return super.copy(D,F),D.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=D.morphTargetInfluences.slice()),D.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},D.morphTargetDictionary)),this.material=D.material,this.geometry=D.geometry,this}updateMorphTargets(){const F=this.geometry.morphAttributes,G=Object.keys(F);if(G.length>0){const Q=F[G[0]];if(Q!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let X=0,q=Q.length;X<q;X++){const W=Q[X].name||String(X);this.morphTargetInfluences.push(0),this.morphTargetDictionary[W]=X}}}}getVertexPosition(D,F){const G=this.geometry,Q=G.attributes.position,X=G.morphAttributes.position,q=G.morphTargetsRelative;F.fromBufferAttribute(Q,D);const W=this.morphTargetInfluences;if(X&&W){_morphA.set(0,0,0);for(let Y=0,J=X.length;Y<J;Y++){const te=W[Y],Z=X[Y];te!==0&&(_tempA.fromBufferAttribute(Z,D),q?_morphA.addScaledVector(_tempA,te):_morphA.addScaledVector(_tempA.sub(F),te))}F.add(_morphA)}return this.isSkinnedMesh&&this.applyBoneTransform(D,F),F}raycast(D,F){const G=this.geometry,Q=this.material,X=this.matrixWorld;if(Q===void 0||(G.boundingSphere===null&&G.computeBoundingSphere(),_sphere$4.copy(G.boundingSphere),_sphere$4.applyMatrix4(X),_ray$2.copy(D.ray).recast(D.near),_sphere$4.containsPoint(_ray$2.origin)===!1&&(_ray$2.intersectSphere(_sphere$4,_sphereHitAt)===null||_ray$2.origin.distanceToSquared(_sphereHitAt)>(D.far-D.near)**2))||(_inverseMatrix$2.copy(X).invert(),_ray$2.copy(D.ray).applyMatrix4(_inverseMatrix$2),G.boundingBox!==null&&_ray$2.intersectsBox(G.boundingBox)===!1))return;let q;const W=G.index,Y=G.attributes.position,J=G.attributes.uv,te=G.attributes.uv2,Z=G.attributes.normal,ee=G.groups,re=G.drawRange;if(W!==null)if(Array.isArray(Q))for(let ne=0,le=ee.length;ne<le;ne++){const se=ee[ne],ie=Q[se.materialIndex],ge=Math.max(se.start,re.start),fe=Math.min(W.count,Math.min(se.start+se.count,re.start+re.count));for(let ae=ge,ue=fe;ae<ue;ae+=3){const pe=W.getX(ae),_e=W.getX(ae+1),xe=W.getX(ae+2);q=checkGeometryIntersection(this,ie,D,_ray$2,J,te,Z,pe,_e,xe),q&&(q.faceIndex=Math.floor(ae/3),q.face.materialIndex=se.materialIndex,F.push(q))}}else{const ne=Math.max(0,re.start),le=Math.min(W.count,re.start+re.count);for(let se=ne,ie=le;se<ie;se+=3){const ge=W.getX(se),fe=W.getX(se+1),ae=W.getX(se+2);q=checkGeometryIntersection(this,Q,D,_ray$2,J,te,Z,ge,fe,ae),q&&(q.faceIndex=Math.floor(se/3),F.push(q))}}else if(Y!==void 0)if(Array.isArray(Q))for(let ne=0,le=ee.length;ne<le;ne++){const se=ee[ne],ie=Q[se.materialIndex],ge=Math.max(se.start,re.start),fe=Math.min(Y.count,Math.min(se.start+se.count,re.start+re.count));for(let ae=ge,ue=fe;ae<ue;ae+=3){const pe=ae,_e=ae+1,xe=ae+2;q=checkGeometryIntersection(this,ie,D,_ray$2,J,te,Z,pe,_e,xe),q&&(q.faceIndex=Math.floor(ae/3),q.face.materialIndex=se.materialIndex,F.push(q))}}else{const ne=Math.max(0,re.start),le=Math.min(Y.count,re.start+re.count);for(let se=ne,ie=le;se<ie;se+=3){const ge=se,fe=se+1,ae=se+2;q=checkGeometryIntersection(this,Q,D,_ray$2,J,te,Z,ge,fe,ae),q&&(q.faceIndex=Math.floor(se/3),F.push(q))}}}}function checkIntersection(U,D,F,G,Q,X,q,W){let Y;if(D.side===BackSide?Y=G.intersectTriangle(q,X,Q,!0,W):Y=G.intersectTriangle(Q,X,q,D.side===FrontSide,W),Y===null)return null;_intersectionPointWorld.copy(W),_intersectionPointWorld.applyMatrix4(U.matrixWorld);const J=F.ray.origin.distanceTo(_intersectionPointWorld);return J<F.near||J>F.far?null:{distance:J,point:_intersectionPointWorld.clone(),object:U}}function checkGeometryIntersection(U,D,F,G,Q,X,q,W,Y,J){U.getVertexPosition(W,_vA$1),U.getVertexPosition(Y,_vB$1),U.getVertexPosition(J,_vC$1);const te=checkIntersection(U,D,F,G,_vA$1,_vB$1,_vC$1,_intersectionPoint);if(te){Q&&(_uvA$1.fromBufferAttribute(Q,W),_uvB$1.fromBufferAttribute(Q,Y),_uvC$1.fromBufferAttribute(Q,J),te.uv=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),X&&(_uvA$1.fromBufferAttribute(X,W),_uvB$1.fromBufferAttribute(X,Y),_uvC$1.fromBufferAttribute(X,J),te.uv2=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),q&&(_normalA.fromBufferAttribute(q,W),_normalB.fromBufferAttribute(q,Y),_normalC.fromBufferAttribute(q,J),te.normal=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_normalA,_normalB,_normalC,new Vector3),te.normal.dot(G.direction)>0&&te.normal.multiplyScalar(-1));const Z={a:W,b:Y,c:J,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1,_vB$1,_vC$1,Z.normal),te.face=Z}return te}class BoxGeometry extends BufferGeometry{constructor(D=1,F=1,G=1,Q=1,X=1,q=1){super(),this.type="BoxGeometry",this.parameters={width:D,height:F,depth:G,widthSegments:Q,heightSegments:X,depthSegments:q};const W=this;Q=Math.floor(Q),X=Math.floor(X),q=Math.floor(q);const Y=[],J=[],te=[],Z=[];let ee=0,re=0;ne("z","y","x",-1,-1,G,F,D,q,X,0),ne("z","y","x",1,-1,G,F,-D,q,X,1),ne("x","z","y",1,1,D,G,F,Q,q,2),ne("x","z","y",1,-1,D,G,-F,Q,q,3),ne("x","y","z",1,-1,D,F,G,Q,X,4),ne("x","y","z",-1,-1,D,F,-G,Q,X,5),this.setIndex(Y),this.setAttribute("position",new Float32BufferAttribute(J,3)),this.setAttribute("normal",new Float32BufferAttribute(te,3)),this.setAttribute("uv",new Float32BufferAttribute(Z,2));function ne(le,se,ie,ge,fe,ae,ue,pe,_e,xe,be){const Te=ae/_e,ye=ue/xe,Ee=ae/2,he=ue/2,oe=pe/2,me=_e+1,ve=xe+1;let we=0,Pe=0;const Me=new Vector3;for(let De=0;De<ve;De++){const Oe=De*ye-he;for(let Ie=0;Ie<me;Ie++){const Be=Ie*Te-Ee;Me[le]=Be*ge,Me[se]=Oe*fe,Me[ie]=oe,J.push(Me.x,Me.y,Me.z),Me[le]=0,Me[se]=0,Me[ie]=pe>0?1:-1,te.push(Me.x,Me.y,Me.z),Z.push(Ie/_e),Z.push(1-De/xe),we+=1}}for(let De=0;De<xe;De++)for(let Oe=0;Oe<_e;Oe++){const Ie=ee+Oe+me*De,Be=ee+Oe+me*(De+1),ze=ee+(Oe+1)+me*(De+1),et=ee+(Oe+1)+me*De;Y.push(Ie,Be,et),Y.push(Be,ze,et),Pe+=6}W.addGroup(re,Pe,be),re+=Pe,ee+=we}}copy(D){return super.copy(D),this.parameters=Object.assign({},D.parameters),this}static fromJSON(D){return new BoxGeometry(D.width,D.height,D.depth,D.widthSegments,D.heightSegments,D.depthSegments)}}function cloneUniforms(U){const D={};for(const F in U){D[F]={};for(const G in U[F]){const Q=U[F][G];Q&&(Q.isColor||Q.isMatrix3||Q.isMatrix4||Q.isVector2||Q.isVector3||Q.isVector4||Q.isTexture||Q.isQuaternion)?Q.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),D[F][G]=null):D[F][G]=Q.clone():Array.isArray(Q)?D[F][G]=Q.slice():D[F][G]=Q}}return D}function mergeUniforms(U){const D={};for(let F=0;F<U.length;F++){const G=cloneUniforms(U[F]);for(const Q in G)D[Q]=G[Q]}return D}function cloneUniformsGroups(U){const D=[];for(let F=0;F<U.length;F++)D.push(U[F].clone());return D}function getUnlitUniformColorSpace(U){return U.getRenderTarget()===null&&U.outputEncoding===sRGBEncoding?SRGBColorSpace:LinearSRGBColorSpace}const UniformsUtils={clone:cloneUniforms,merge:mergeUniforms};var default_vertex=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,default_fragment=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ShaderMaterial extends Material{constructor(D){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,D!==void 0&&this.setValues(D)}copy(D){return super.copy(D),this.fragmentShader=D.fragmentShader,this.vertexShader=D.vertexShader,this.uniforms=cloneUniforms(D.uniforms),this.uniformsGroups=cloneUniformsGroups(D.uniformsGroups),this.defines=Object.assign({},D.defines),this.wireframe=D.wireframe,this.wireframeLinewidth=D.wireframeLinewidth,this.fog=D.fog,this.lights=D.lights,this.clipping=D.clipping,this.extensions=Object.assign({},D.extensions),this.glslVersion=D.glslVersion,this}toJSON(D){const F=super.toJSON(D);F.glslVersion=this.glslVersion,F.uniforms={};for(const Q in this.uniforms){const q=this.uniforms[Q].value;q&&q.isTexture?F.uniforms[Q]={type:"t",value:q.toJSON(D).uuid}:q&&q.isColor?F.uniforms[Q]={type:"c",value:q.getHex()}:q&&q.isVector2?F.uniforms[Q]={type:"v2",value:q.toArray()}:q&&q.isVector3?F.uniforms[Q]={type:"v3",value:q.toArray()}:q&&q.isVector4?F.uniforms[Q]={type:"v4",value:q.toArray()}:q&&q.isMatrix3?F.uniforms[Q]={type:"m3",value:q.toArray()}:q&&q.isMatrix4?F.uniforms[Q]={type:"m4",value:q.toArray()}:F.uniforms[Q]={value:q}}Object.keys(this.defines).length>0&&(F.defines=this.defines),F.vertexShader=this.vertexShader,F.fragmentShader=this.fragmentShader;const G={};for(const Q in this.extensions)this.extensions[Q]===!0&&(G[Q]=!0);return Object.keys(G).length>0&&(F.extensions=G),F}}class Camera extends Object3D{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4}copy(D,F){return super.copy(D,F),this.matrixWorldInverse.copy(D.matrixWorldInverse),this.projectionMatrix.copy(D.projectionMatrix),this.projectionMatrixInverse.copy(D.projectionMatrixInverse),this}getWorldDirection(D){this.updateWorldMatrix(!0,!1);const F=this.matrixWorld.elements;return D.set(-F[8],-F[9],-F[10]).normalize()}updateMatrixWorld(D){super.updateMatrixWorld(D),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(D,F){super.updateWorldMatrix(D,F),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class PerspectiveCamera extends Camera{constructor(D=50,F=1,G=.1,Q=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=D,this.zoom=1,this.near=G,this.far=Q,this.focus=10,this.aspect=F,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(D,F){return super.copy(D,F),this.fov=D.fov,this.zoom=D.zoom,this.near=D.near,this.far=D.far,this.focus=D.focus,this.aspect=D.aspect,this.view=D.view===null?null:Object.assign({},D.view),this.filmGauge=D.filmGauge,this.filmOffset=D.filmOffset,this}setFocalLength(D){const F=.5*this.getFilmHeight()/D;this.fov=RAD2DEG*2*Math.atan(F),this.updateProjectionMatrix()}getFocalLength(){const D=Math.tan(DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/D}getEffectiveFOV(){return RAD2DEG*2*Math.atan(Math.tan(DEG2RAD*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(D,F,G,Q,X,q){this.aspect=D/F,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=D,this.view.fullHeight=F,this.view.offsetX=G,this.view.offsetY=Q,this.view.width=X,this.view.height=q,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const D=this.near;let F=D*Math.tan(DEG2RAD*.5*this.fov)/this.zoom,G=2*F,Q=this.aspect*G,X=-.5*Q;const q=this.view;if(this.view!==null&&this.view.enabled){const Y=q.fullWidth,J=q.fullHeight;X+=q.offsetX*Q/Y,F-=q.offsetY*G/J,Q*=q.width/Y,G*=q.height/J}const W=this.filmOffset;W!==0&&(X+=D*W/this.getFilmWidth()),this.projectionMatrix.makePerspective(X,X+Q,F,F-G,D,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(D){const F=super.toJSON(D);return F.object.fov=this.fov,F.object.zoom=this.zoom,F.object.near=this.near,F.object.far=this.far,F.object.focus=this.focus,F.object.aspect=this.aspect,this.view!==null&&(F.object.view=Object.assign({},this.view)),F.object.filmGauge=this.filmGauge,F.object.filmOffset=this.filmOffset,F}}const fov=-90,aspect=1;class CubeCamera extends Object3D{constructor(D,F,G){super(),this.type="CubeCamera",this.renderTarget=G;const Q=new PerspectiveCamera(fov,aspect,D,F);Q.layers=this.layers,Q.up.set(0,1,0),Q.lookAt(1,0,0),this.add(Q);const X=new PerspectiveCamera(fov,aspect,D,F);X.layers=this.layers,X.up.set(0,1,0),X.lookAt(-1,0,0),this.add(X);const q=new PerspectiveCamera(fov,aspect,D,F);q.layers=this.layers,q.up.set(0,0,-1),q.lookAt(0,1,0),this.add(q);const W=new PerspectiveCamera(fov,aspect,D,F);W.layers=this.layers,W.up.set(0,0,1),W.lookAt(0,-1,0),this.add(W);const Y=new PerspectiveCamera(fov,aspect,D,F);Y.layers=this.layers,Y.up.set(0,1,0),Y.lookAt(0,0,1),this.add(Y);const J=new PerspectiveCamera(fov,aspect,D,F);J.layers=this.layers,J.up.set(0,1,0),J.lookAt(0,0,-1),this.add(J)}update(D,F){this.parent===null&&this.updateMatrixWorld();const G=this.renderTarget,[Q,X,q,W,Y,J]=this.children,te=D.getRenderTarget(),Z=D.toneMapping,ee=D.xr.enabled;D.toneMapping=NoToneMapping,D.xr.enabled=!1;const re=G.texture.generateMipmaps;G.texture.generateMipmaps=!1,D.setRenderTarget(G,0),D.render(F,Q),D.setRenderTarget(G,1),D.render(F,X),D.setRenderTarget(G,2),D.render(F,q),D.setRenderTarget(G,3),D.render(F,W),D.setRenderTarget(G,4),D.render(F,Y),G.texture.generateMipmaps=re,D.setRenderTarget(G,5),D.render(F,J),D.setRenderTarget(te),D.toneMapping=Z,D.xr.enabled=ee,G.texture.needsPMREMUpdate=!0}}class CubeTexture extends Texture{constructor(D,F,G,Q,X,q,W,Y,J,te){D=D!==void 0?D:[],F=F!==void 0?F:CubeReflectionMapping,super(D,F,G,Q,X,q,W,Y,J,te),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(D){this.image=D}}class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(D=1,F={}){super(D,D,F),this.isWebGLCubeRenderTarget=!0;const G={width:D,height:D,depth:1},Q=[G,G,G,G,G,G];this.texture=new CubeTexture(Q,F.mapping,F.wrapS,F.wrapT,F.magFilter,F.minFilter,F.format,F.type,F.anisotropy,F.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=F.generateMipmaps!==void 0?F.generateMipmaps:!1,this.texture.minFilter=F.minFilter!==void 0?F.minFilter:LinearFilter}fromEquirectangularTexture(D,F){this.texture.type=F.type,this.texture.encoding=F.encoding,this.texture.generateMipmaps=F.generateMipmaps,this.texture.minFilter=F.minFilter,this.texture.magFilter=F.magFilter;const G={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},Q=new BoxGeometry(5,5,5),X=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms(G.uniforms),vertexShader:G.vertexShader,fragmentShader:G.fragmentShader,side:BackSide,blending:NoBlending});X.uniforms.tEquirect.value=F;const q=new Mesh(Q,X),W=F.minFilter;return F.minFilter===LinearMipmapLinearFilter&&(F.minFilter=LinearFilter),new CubeCamera(1,10,this).update(D,q),F.minFilter=W,q.geometry.dispose(),q.material.dispose(),this}clear(D,F,G,Q){const X=D.getRenderTarget();for(let q=0;q<6;q++)D.setRenderTarget(this,q),D.clear(F,G,Q);D.setRenderTarget(X)}}const _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;class Plane{constructor(D=new Vector3(1,0,0),F=0){this.isPlane=!0,this.normal=D,this.constant=F}set(D,F){return this.normal.copy(D),this.constant=F,this}setComponents(D,F,G,Q){return this.normal.set(D,F,G),this.constant=Q,this}setFromNormalAndCoplanarPoint(D,F){return this.normal.copy(D),this.constant=-F.dot(this.normal),this}setFromCoplanarPoints(D,F,G){const Q=_vector1.subVectors(G,F).cross(_vector2.subVectors(D,F)).normalize();return this.setFromNormalAndCoplanarPoint(Q,D),this}copy(D){return this.normal.copy(D.normal),this.constant=D.constant,this}normalize(){const D=1/this.normal.length();return this.normal.multiplyScalar(D),this.constant*=D,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(D){return this.normal.dot(D)+this.constant}distanceToSphere(D){return this.distanceToPoint(D.center)-D.radius}projectPoint(D,F){return F.copy(D).addScaledVector(this.normal,-this.distanceToPoint(D))}intersectLine(D,F){const G=D.delta(_vector1),Q=this.normal.dot(G);if(Q===0)return this.distanceToPoint(D.start)===0?F.copy(D.start):null;const X=-(D.start.dot(this.normal)+this.constant)/Q;return X<0||X>1?null:F.copy(D.start).addScaledVector(G,X)}intersectsLine(D){const F=this.distanceToPoint(D.start),G=this.distanceToPoint(D.end);return F<0&&G>0||G<0&&F>0}intersectsBox(D){return D.intersectsPlane(this)}intersectsSphere(D){return D.intersectsPlane(this)}coplanarPoint(D){return D.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(D,F){const G=F||_normalMatrix.getNormalMatrix(D),Q=this.coplanarPoint(_vector1).applyMatrix4(D),X=this.normal.applyMatrix3(G).normalize();return this.constant=-Q.dot(X),this}translate(D){return this.constant-=D.dot(this.normal),this}equals(D){return D.normal.equals(this.normal)&&D.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _sphere$3=new Sphere,_vector$6=new Vector3;class Frustum{constructor(D=new Plane,F=new Plane,G=new Plane,Q=new Plane,X=new Plane,q=new Plane){this.planes=[D,F,G,Q,X,q]}set(D,F,G,Q,X,q){const W=this.planes;return W[0].copy(D),W[1].copy(F),W[2].copy(G),W[3].copy(Q),W[4].copy(X),W[5].copy(q),this}copy(D){const F=this.planes;for(let G=0;G<6;G++)F[G].copy(D.planes[G]);return this}setFromProjectionMatrix(D){const F=this.planes,G=D.elements,Q=G[0],X=G[1],q=G[2],W=G[3],Y=G[4],J=G[5],te=G[6],Z=G[7],ee=G[8],re=G[9],ne=G[10],le=G[11],se=G[12],ie=G[13],ge=G[14],fe=G[15];return F[0].setComponents(W-Q,Z-Y,le-ee,fe-se).normalize(),F[1].setComponents(W+Q,Z+Y,le+ee,fe+se).normalize(),F[2].setComponents(W+X,Z+J,le+re,fe+ie).normalize(),F[3].setComponents(W-X,Z-J,le-re,fe-ie).normalize(),F[4].setComponents(W-q,Z-te,le-ne,fe-ge).normalize(),F[5].setComponents(W+q,Z+te,le+ne,fe+ge).normalize(),this}intersectsObject(D){if(D.boundingSphere!==void 0)D.boundingSphere===null&&D.computeBoundingSphere(),_sphere$3.copy(D.boundingSphere).applyMatrix4(D.matrixWorld);else{const F=D.geometry;F.boundingSphere===null&&F.computeBoundingSphere(),_sphere$3.copy(F.boundingSphere).applyMatrix4(D.matrixWorld)}return this.intersectsSphere(_sphere$3)}intersectsSprite(D){return _sphere$3.center.set(0,0,0),_sphere$3.radius=.7071067811865476,_sphere$3.applyMatrix4(D.matrixWorld),this.intersectsSphere(_sphere$3)}intersectsSphere(D){const F=this.planes,G=D.center,Q=-D.radius;for(let X=0;X<6;X++)if(F[X].distanceToPoint(G)<Q)return!1;return!0}intersectsBox(D){const F=this.planes;for(let G=0;G<6;G++){const Q=F[G];if(_vector$6.x=Q.normal.x>0?D.max.x:D.min.x,_vector$6.y=Q.normal.y>0?D.max.y:D.min.y,_vector$6.z=Q.normal.z>0?D.max.z:D.min.z,Q.distanceToPoint(_vector$6)<0)return!1}return!0}containsPoint(D){const F=this.planes;for(let G=0;G<6;G++)if(F[G].distanceToPoint(D)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function WebGLAnimation(){let U=null,D=!1,F=null,G=null;function Q(X,q){F(X,q),G=U.requestAnimationFrame(Q)}return{start:function(){D!==!0&&F!==null&&(G=U.requestAnimationFrame(Q),D=!0)},stop:function(){U.cancelAnimationFrame(G),D=!1},setAnimationLoop:function(X){F=X},setContext:function(X){U=X}}}function WebGLAttributes(U,D){const F=D.isWebGL2,G=new WeakMap;function Q(J,te){const Z=J.array,ee=J.usage,re=U.createBuffer();U.bindBuffer(te,re),U.bufferData(te,Z,ee),J.onUploadCallback();let ne;if(Z instanceof Float32Array)ne=5126;else if(Z instanceof Uint16Array)if(J.isFloat16BufferAttribute)if(F)ne=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else ne=5123;else if(Z instanceof Int16Array)ne=5122;else if(Z instanceof Uint32Array)ne=5125;else if(Z instanceof Int32Array)ne=5124;else if(Z instanceof Int8Array)ne=5120;else if(Z instanceof Uint8Array)ne=5121;else if(Z instanceof Uint8ClampedArray)ne=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+Z);return{buffer:re,type:ne,bytesPerElement:Z.BYTES_PER_ELEMENT,version:J.version}}function X(J,te,Z){const ee=te.array,re=te.updateRange;U.bindBuffer(Z,J),re.count===-1?U.bufferSubData(Z,0,ee):(F?U.bufferSubData(Z,re.offset*ee.BYTES_PER_ELEMENT,ee,re.offset,re.count):U.bufferSubData(Z,re.offset*ee.BYTES_PER_ELEMENT,ee.subarray(re.offset,re.offset+re.count)),re.count=-1),te.onUploadCallback()}function q(J){return J.isInterleavedBufferAttribute&&(J=J.data),G.get(J)}function W(J){J.isInterleavedBufferAttribute&&(J=J.data);const te=G.get(J);te&&(U.deleteBuffer(te.buffer),G.delete(J))}function Y(J,te){if(J.isGLBufferAttribute){const ee=G.get(J);(!ee||ee.version<J.version)&&G.set(J,{buffer:J.buffer,type:J.type,bytesPerElement:J.elementSize,version:J.version});return}J.isInterleavedBufferAttribute&&(J=J.data);const Z=G.get(J);Z===void 0?G.set(J,Q(J,te)):Z.version<J.version&&(X(Z.buffer,J,te),Z.version=J.version)}return{get:q,remove:W,update:Y}}class PlaneGeometry extends BufferGeometry{constructor(D=1,F=1,G=1,Q=1){super(),this.type="PlaneGeometry",this.parameters={width:D,height:F,widthSegments:G,heightSegments:Q};const X=D/2,q=F/2,W=Math.floor(G),Y=Math.floor(Q),J=W+1,te=Y+1,Z=D/W,ee=F/Y,re=[],ne=[],le=[],se=[];for(let ie=0;ie<te;ie++){const ge=ie*ee-q;for(let fe=0;fe<J;fe++){const ae=fe*Z-X;ne.push(ae,-ge,0),le.push(0,0,1),se.push(fe/W),se.push(1-ie/Y)}}for(let ie=0;ie<Y;ie++)for(let ge=0;ge<W;ge++){const fe=ge+J*ie,ae=ge+J*(ie+1),ue=ge+1+J*(ie+1),pe=ge+1+J*ie;re.push(fe,ae,pe),re.push(ae,ue,pe)}this.setIndex(re),this.setAttribute("position",new Float32BufferAttribute(ne,3)),this.setAttribute("normal",new Float32BufferAttribute(le,3)),this.setAttribute("uv",new Float32BufferAttribute(se,2))}copy(D){return super.copy(D),this.parameters=Object.assign({},D.parameters),this}static fromJSON(D){return new PlaneGeometry(D.width,D.height,D.widthSegments,D.heightSegments)}}var alphamap_fragment=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,alphamap_pars_fragment=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,alphatest_pars_fragment=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex="vec3 transformed = vec3( position );",beginnormal_vertex=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,iridescence_fragment=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,bumpmap_pars_fragment=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common$7=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,cube_uv_reflection_fragment=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment="gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,envmap_fragment=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_vertex=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,lightmap_fragment=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,lightmap_pars_fragment=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_fragment=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,lights_lambert_pars_fragment=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,lights_pars_begin=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,envmap_physical_pars_fragment=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,lights_toon_fragment=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lights_phong_fragment=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,lights_physical_fragment=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif`,lights_physical_pars_fragment=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,map_pars_fragment=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphcolor_vertex=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,morphnormal_vertex=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,morphtarget_pars_vertex=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,morphtarget_vertex=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,normal_fragment_begin=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#ifdef USE_NORMALMAP_TANGENTSPACE
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal, vNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,clearcoat_normal_fragment_begin=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,clearcoat_pars_fragment=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,iridescence_pars_fragment=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,output_fragment=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,premultiplied_alpha_fragment=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,shadowmask_pars_fragment=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,skinning_vertex=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,transmission_pars_fragment=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		
		vec2 lodFudge = pow( 1.95, lod ) / fullSize;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec2 fullSize = vec2( textureSize( sampler, 0 ) );
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,uv_pars_fragment=`#ifdef USE_UV
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_pars_vertex=`#ifdef USE_UV
	varying vec2 vUv;
#endif
#ifdef USE_UV2
	attribute vec2 uv2;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_vertex=`#ifdef USE_UV
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,worldpos_vertex=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vertex$h=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,fragment$h=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vertex$g=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$g=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vertex$f=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$f=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vertex$e=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,fragment$e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,vertex$d=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fragment$d=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,vertex$c=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragment$c=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vertex$b=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$b=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$a=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fragment$a=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$9=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$9=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,fragment$8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fragment$7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vertex$6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fragment$5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$3=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,fragment$3=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$2=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$2=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,vertex$1=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$1=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,ShaderChunk={alphamap_fragment,alphamap_pars_fragment,alphatest_fragment,alphatest_pars_fragment,aomap_fragment,aomap_pars_fragment,begin_vertex,beginnormal_vertex,bsdfs,iridescence_fragment,bumpmap_pars_fragment,clipping_planes_fragment,clipping_planes_pars_fragment,clipping_planes_pars_vertex,clipping_planes_vertex,color_fragment,color_pars_fragment,color_pars_vertex,color_vertex,common:common$7,cube_uv_reflection_fragment,defaultnormal_vertex,displacementmap_pars_vertex,displacementmap_vertex,emissivemap_fragment,emissivemap_pars_fragment,encodings_fragment,encodings_pars_fragment,envmap_fragment,envmap_common_pars_fragment,envmap_pars_fragment,envmap_pars_vertex,envmap_physical_pars_fragment,envmap_vertex,fog_vertex,fog_pars_vertex,fog_fragment,fog_pars_fragment,gradientmap_pars_fragment,lightmap_fragment,lightmap_pars_fragment,lights_lambert_fragment,lights_lambert_pars_fragment,lights_pars_begin,lights_toon_fragment,lights_toon_pars_fragment,lights_phong_fragment,lights_phong_pars_fragment,lights_physical_fragment,lights_physical_pars_fragment,lights_fragment_begin,lights_fragment_maps,lights_fragment_end,logdepthbuf_fragment,logdepthbuf_pars_fragment,logdepthbuf_pars_vertex,logdepthbuf_vertex,map_fragment,map_pars_fragment,map_particle_fragment,map_particle_pars_fragment,metalnessmap_fragment,metalnessmap_pars_fragment,morphcolor_vertex,morphnormal_vertex,morphtarget_pars_vertex,morphtarget_vertex,normal_fragment_begin,normal_fragment_maps,normal_pars_fragment,normal_pars_vertex,normal_vertex,normalmap_pars_fragment,clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps,clearcoat_pars_fragment,iridescence_pars_fragment,output_fragment,packing,premultiplied_alpha_fragment,project_vertex,dithering_fragment,dithering_pars_fragment,roughnessmap_fragment,roughnessmap_pars_fragment,shadowmap_pars_fragment,shadowmap_pars_vertex,shadowmap_vertex,shadowmask_pars_fragment,skinbase_vertex,skinning_pars_vertex,skinning_vertex,skinnormal_vertex,specularmap_fragment,specularmap_pars_fragment,tonemapping_fragment,tonemapping_pars_fragment,transmission_fragment,transmission_pars_fragment,uv_pars_fragment,uv_pars_vertex,uv_vertex,worldpos_vertex,background_vert:vertex$h,background_frag:fragment$h,backgroundCube_vert:vertex$g,backgroundCube_frag:fragment$g,cube_vert:vertex$f,cube_frag:fragment$f,depth_vert:vertex$e,depth_frag:fragment$e,distanceRGBA_vert:vertex$d,distanceRGBA_frag:fragment$d,equirect_vert:vertex$c,equirect_frag:fragment$c,linedashed_vert:vertex$b,linedashed_frag:fragment$b,meshbasic_vert:vertex$a,meshbasic_frag:fragment$a,meshlambert_vert:vertex$9,meshlambert_frag:fragment$9,meshmatcap_vert:vertex$8,meshmatcap_frag:fragment$8,meshnormal_vert:vertex$7,meshnormal_frag:fragment$7,meshphong_vert:vertex$6,meshphong_frag:fragment$6,meshphysical_vert:vertex$5,meshphysical_frag:fragment$5,meshtoon_vert:vertex$4,meshtoon_frag:fragment$4,points_vert:vertex$3,points_frag:fragment$3,shadow_vert:vertex$2,shadow_frag:fragment$2,sprite_vert:vertex$1,sprite_frag:fragment$1},UniformsLib={common:{diffuse:{value:new Color(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Matrix3}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Matrix3}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Matrix3}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Matrix3},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Matrix3},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Matrix3},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Matrix3}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Matrix3}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Matrix3}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color(16777215)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaTest:{value:0}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.meshnormal_vert,fragmentShader:ShaderChunk.meshnormal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.backgroundCube_vert,fragmentShader:ShaderChunk.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Matrix3},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Matrix3},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Matrix3},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Matrix3},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Matrix3},sheen:{value:0},sheenColor:{value:new Color(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Matrix3},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Matrix3},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Matrix3},transmissionSamplerSize:{value:new Vector2},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Matrix3},attenuationDistance:{value:0},attenuationColor:{value:new Color(0)},specularColor:{value:new Color(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Matrix3},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Matrix3}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};const _rgb={r:0,b:0,g:0};function WebGLBackground(U,D,F,G,Q,X,q){const W=new Color(0);let Y=X===!0?0:1,J,te,Z=null,ee=0,re=null;function ne(se,ie){let ge=!1,fe=ie.isScene===!0?ie.background:null;fe&&fe.isTexture&&(fe=(ie.backgroundBlurriness>0?F:D).get(fe));const ae=U.xr,ue=ae.getSession&&ae.getSession();ue&&ue.environmentBlendMode==="additive"&&(fe=null),fe===null?le(W,Y):fe&&fe.isColor&&(le(fe,1),ge=!0),(U.autoClear||ge)&&U.clear(U.autoClearColor,U.autoClearDepth,U.autoClearStencil),fe&&(fe.isCubeTexture||fe.mapping===CubeUVReflectionMapping)?(te===void 0&&(te=new Mesh(new BoxGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.backgroundCube.uniforms),vertexShader:ShaderLib.backgroundCube.vertexShader,fragmentShader:ShaderLib.backgroundCube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1})),te.geometry.deleteAttribute("normal"),te.geometry.deleteAttribute("uv"),te.onBeforeRender=function(pe,_e,xe){this.matrixWorld.copyPosition(xe.matrixWorld)},Object.defineProperty(te.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),Q.update(te)),te.material.uniforms.envMap.value=fe,te.material.uniforms.flipEnvMap.value=fe.isCubeTexture&&fe.isRenderTargetTexture===!1?-1:1,te.material.uniforms.backgroundBlurriness.value=ie.backgroundBlurriness,te.material.uniforms.backgroundIntensity.value=ie.backgroundIntensity,te.material.toneMapped=fe.encoding!==sRGBEncoding,(Z!==fe||ee!==fe.version||re!==U.toneMapping)&&(te.material.needsUpdate=!0,Z=fe,ee=fe.version,re=U.toneMapping),te.layers.enableAll(),se.unshift(te,te.geometry,te.material,0,0,null)):fe&&fe.isTexture&&(J===void 0&&(J=new Mesh(new PlaneGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1})),J.geometry.deleteAttribute("normal"),Object.defineProperty(J.material,"map",{get:function(){return this.uniforms.t2D.value}}),Q.update(J)),J.material.uniforms.t2D.value=fe,J.material.uniforms.backgroundIntensity.value=ie.backgroundIntensity,J.material.toneMapped=fe.encoding!==sRGBEncoding,fe.matrixAutoUpdate===!0&&fe.updateMatrix(),J.material.uniforms.uvTransform.value.copy(fe.matrix),(Z!==fe||ee!==fe.version||re!==U.toneMapping)&&(J.material.needsUpdate=!0,Z=fe,ee=fe.version,re=U.toneMapping),J.layers.enableAll(),se.unshift(J,J.geometry,J.material,0,0,null))}function le(se,ie){se.getRGB(_rgb,getUnlitUniformColorSpace(U)),G.buffers.color.setClear(_rgb.r,_rgb.g,_rgb.b,ie,q)}return{getClearColor:function(){return W},setClearColor:function(se,ie=1){W.set(se),Y=ie,le(W,Y)},getClearAlpha:function(){return Y},setClearAlpha:function(se){Y=se,le(W,Y)},render:ne}}function WebGLBindingStates(U,D,F,G){const Q=U.getParameter(34921),X=G.isWebGL2?null:D.get("OES_vertex_array_object"),q=G.isWebGL2||X!==null,W={},Y=se(null);let J=Y,te=!1;function Z(oe,me,ve,we,Pe){let Me=!1;if(q){const De=le(we,ve,me);J!==De&&(J=De,re(J.object)),Me=ie(oe,we,ve,Pe),Me&&ge(oe,we,ve,Pe)}else{const De=me.wireframe===!0;(J.geometry!==we.id||J.program!==ve.id||J.wireframe!==De)&&(J.geometry=we.id,J.program=ve.id,J.wireframe=De,Me=!0)}Pe!==null&&F.update(Pe,34963),(Me||te)&&(te=!1,xe(oe,me,ve,we),Pe!==null&&U.bindBuffer(34963,F.get(Pe).buffer))}function ee(){return G.isWebGL2?U.createVertexArray():X.createVertexArrayOES()}function re(oe){return G.isWebGL2?U.bindVertexArray(oe):X.bindVertexArrayOES(oe)}function ne(oe){return G.isWebGL2?U.deleteVertexArray(oe):X.deleteVertexArrayOES(oe)}function le(oe,me,ve){const we=ve.wireframe===!0;let Pe=W[oe.id];Pe===void 0&&(Pe={},W[oe.id]=Pe);let Me=Pe[me.id];Me===void 0&&(Me={},Pe[me.id]=Me);let De=Me[we];return De===void 0&&(De=se(ee()),Me[we]=De),De}function se(oe){const me=[],ve=[],we=[];for(let Pe=0;Pe<Q;Pe++)me[Pe]=0,ve[Pe]=0,we[Pe]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:me,enabledAttributes:ve,attributeDivisors:we,object:oe,attributes:{},index:null}}function ie(oe,me,ve,we){const Pe=J.attributes,Me=me.attributes;let De=0;const Oe=ve.getAttributes();for(const Ie in Oe)if(Oe[Ie].location>=0){const ze=Pe[Ie];let et=Me[Ie];if(et===void 0&&(Ie==="instanceMatrix"&&oe.instanceMatrix&&(et=oe.instanceMatrix),Ie==="instanceColor"&&oe.instanceColor&&(et=oe.instanceColor)),ze===void 0||ze.attribute!==et||et&&ze.data!==et.data)return!0;De++}return J.attributesNum!==De||J.index!==we}function ge(oe,me,ve,we){const Pe={},Me=me.attributes;let De=0;const Oe=ve.getAttributes();for(const Ie in Oe)if(Oe[Ie].location>=0){let ze=Me[Ie];ze===void 0&&(Ie==="instanceMatrix"&&oe.instanceMatrix&&(ze=oe.instanceMatrix),Ie==="instanceColor"&&oe.instanceColor&&(ze=oe.instanceColor));const et={};et.attribute=ze,ze&&ze.data&&(et.data=ze.data),Pe[Ie]=et,De++}J.attributes=Pe,J.attributesNum=De,J.index=we}function fe(){const oe=J.newAttributes;for(let me=0,ve=oe.length;me<ve;me++)oe[me]=0}function ae(oe){ue(oe,0)}function ue(oe,me){const ve=J.newAttributes,we=J.enabledAttributes,Pe=J.attributeDivisors;ve[oe]=1,we[oe]===0&&(U.enableVertexAttribArray(oe),we[oe]=1),Pe[oe]!==me&&((G.isWebGL2?U:D.get("ANGLE_instanced_arrays"))[G.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](oe,me),Pe[oe]=me)}function pe(){const oe=J.newAttributes,me=J.enabledAttributes;for(let ve=0,we=me.length;ve<we;ve++)me[ve]!==oe[ve]&&(U.disableVertexAttribArray(ve),me[ve]=0)}function _e(oe,me,ve,we,Pe,Me){G.isWebGL2===!0&&(ve===5124||ve===5125)?U.vertexAttribIPointer(oe,me,ve,Pe,Me):U.vertexAttribPointer(oe,me,ve,we,Pe,Me)}function xe(oe,me,ve,we){if(G.isWebGL2===!1&&(oe.isInstancedMesh||we.isInstancedBufferGeometry)&&D.get("ANGLE_instanced_arrays")===null)return;fe();const Pe=we.attributes,Me=ve.getAttributes(),De=me.defaultAttributeValues;for(const Oe in Me){const Ie=Me[Oe];if(Ie.location>=0){let Be=Pe[Oe];if(Be===void 0&&(Oe==="instanceMatrix"&&oe.instanceMatrix&&(Be=oe.instanceMatrix),Oe==="instanceColor"&&oe.instanceColor&&(Be=oe.instanceColor)),Be!==void 0){const ze=Be.normalized,et=Be.itemSize,qe=F.get(Be);if(qe===void 0)continue;const je=qe.buffer,it=qe.type,ct=qe.bytesPerElement;if(Be.isInterleavedBufferAttribute){const rt=Be.data,ut=rt.stride,We=Be.offset;if(rt.isInstancedInterleavedBuffer){for(let Re=0;Re<Ie.locationSize;Re++)ue(Ie.location+Re,rt.meshPerAttribute);oe.isInstancedMesh!==!0&&we._maxInstanceCount===void 0&&(we._maxInstanceCount=rt.meshPerAttribute*rt.count)}else for(let Re=0;Re<Ie.locationSize;Re++)ae(Ie.location+Re);U.bindBuffer(34962,je);for(let Re=0;Re<Ie.locationSize;Re++)_e(Ie.location+Re,et/Ie.locationSize,it,ze,ut*ct,(We+et/Ie.locationSize*Re)*ct)}else{if(Be.isInstancedBufferAttribute){for(let rt=0;rt<Ie.locationSize;rt++)ue(Ie.location+rt,Be.meshPerAttribute);oe.isInstancedMesh!==!0&&we._maxInstanceCount===void 0&&(we._maxInstanceCount=Be.meshPerAttribute*Be.count)}else for(let rt=0;rt<Ie.locationSize;rt++)ae(Ie.location+rt);U.bindBuffer(34962,je);for(let rt=0;rt<Ie.locationSize;rt++)_e(Ie.location+rt,et/Ie.locationSize,it,ze,et*ct,et/Ie.locationSize*rt*ct)}}else if(De!==void 0){const ze=De[Oe];if(ze!==void 0)switch(ze.length){case 2:U.vertexAttrib2fv(Ie.location,ze);break;case 3:U.vertexAttrib3fv(Ie.location,ze);break;case 4:U.vertexAttrib4fv(Ie.location,ze);break;default:U.vertexAttrib1fv(Ie.location,ze)}}}}pe()}function be(){Ee();for(const oe in W){const me=W[oe];for(const ve in me){const we=me[ve];for(const Pe in we)ne(we[Pe].object),delete we[Pe];delete me[ve]}delete W[oe]}}function Te(oe){if(W[oe.id]===void 0)return;const me=W[oe.id];for(const ve in me){const we=me[ve];for(const Pe in we)ne(we[Pe].object),delete we[Pe];delete me[ve]}delete W[oe.id]}function ye(oe){for(const me in W){const ve=W[me];if(ve[oe.id]===void 0)continue;const we=ve[oe.id];for(const Pe in we)ne(we[Pe].object),delete we[Pe];delete ve[oe.id]}}function Ee(){he(),te=!0,J!==Y&&(J=Y,re(J.object))}function he(){Y.geometry=null,Y.program=null,Y.wireframe=!1}return{setup:Z,reset:Ee,resetDefaultState:he,dispose:be,releaseStatesOfGeometry:Te,releaseStatesOfProgram:ye,initAttributes:fe,enableAttribute:ae,disableUnusedAttributes:pe}}function WebGLBufferRenderer(U,D,F,G){const Q=G.isWebGL2;let X;function q(J){X=J}function W(J,te){U.drawArrays(X,J,te),F.update(te,X,1)}function Y(J,te,Z){if(Z===0)return;let ee,re;if(Q)ee=U,re="drawArraysInstanced";else if(ee=D.get("ANGLE_instanced_arrays"),re="drawArraysInstancedANGLE",ee===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}ee[re](X,J,te,Z),F.update(te,X,Z)}this.setMode=q,this.render=W,this.renderInstances=Y}function WebGLCapabilities(U,D,F){let G;function Q(){if(G!==void 0)return G;if(D.has("EXT_texture_filter_anisotropic")===!0){const _e=D.get("EXT_texture_filter_anisotropic");G=U.getParameter(_e.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else G=0;return G}function X(_e){if(_e==="highp"){if(U.getShaderPrecisionFormat(35633,36338).precision>0&&U.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";_e="mediump"}return _e==="mediump"&&U.getShaderPrecisionFormat(35633,36337).precision>0&&U.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const q=typeof WebGL2RenderingContext<"u"&&U.constructor.name==="WebGL2RenderingContext";let W=F.precision!==void 0?F.precision:"highp";const Y=X(W);Y!==W&&(console.warn("THREE.WebGLRenderer:",W,"not supported, using",Y,"instead."),W=Y);const J=q||D.has("WEBGL_draw_buffers"),te=F.logarithmicDepthBuffer===!0,Z=U.getParameter(34930),ee=U.getParameter(35660),re=U.getParameter(3379),ne=U.getParameter(34076),le=U.getParameter(34921),se=U.getParameter(36347),ie=U.getParameter(36348),ge=U.getParameter(36349),fe=ee>0,ae=q||D.has("OES_texture_float"),ue=fe&&ae,pe=q?U.getParameter(36183):0;return{isWebGL2:q,drawBuffers:J,getMaxAnisotropy:Q,getMaxPrecision:X,precision:W,logarithmicDepthBuffer:te,maxTextures:Z,maxVertexTextures:ee,maxTextureSize:re,maxCubemapSize:ne,maxAttributes:le,maxVertexUniforms:se,maxVaryings:ie,maxFragmentUniforms:ge,vertexTextures:fe,floatFragmentTextures:ae,floatVertexTextures:ue,maxSamples:pe}}function WebGLClipping(U){const D=this;let F=null,G=0,Q=!1,X=!1;const q=new Plane,W=new Matrix3,Y={value:null,needsUpdate:!1};this.uniform=Y,this.numPlanes=0,this.numIntersection=0,this.init=function(Z,ee){const re=Z.length!==0||ee||G!==0||Q;return Q=ee,G=Z.length,re},this.beginShadows=function(){X=!0,te(null)},this.endShadows=function(){X=!1},this.setGlobalState=function(Z,ee){F=te(Z,ee,0)},this.setState=function(Z,ee,re){const ne=Z.clippingPlanes,le=Z.clipIntersection,se=Z.clipShadows,ie=U.get(Z);if(!Q||ne===null||ne.length===0||X&&!se)X?te(null):J();else{const ge=X?0:G,fe=ge*4;let ae=ie.clippingState||null;Y.value=ae,ae=te(ne,ee,fe,re);for(let ue=0;ue!==fe;++ue)ae[ue]=F[ue];ie.clippingState=ae,this.numIntersection=le?this.numPlanes:0,this.numPlanes+=ge}};function J(){Y.value!==F&&(Y.value=F,Y.needsUpdate=G>0),D.numPlanes=G,D.numIntersection=0}function te(Z,ee,re,ne){const le=Z!==null?Z.length:0;let se=null;if(le!==0){if(se=Y.value,ne!==!0||se===null){const ie=re+le*4,ge=ee.matrixWorldInverse;W.getNormalMatrix(ge),(se===null||se.length<ie)&&(se=new Float32Array(ie));for(let fe=0,ae=re;fe!==le;++fe,ae+=4)q.copy(Z[fe]).applyMatrix4(ge,W),q.normal.toArray(se,ae),se[ae+3]=q.constant}Y.value=se,Y.needsUpdate=!0}return D.numPlanes=le,D.numIntersection=0,se}}function WebGLCubeMaps(U){let D=new WeakMap;function F(q,W){return W===EquirectangularReflectionMapping?q.mapping=CubeReflectionMapping:W===EquirectangularRefractionMapping&&(q.mapping=CubeRefractionMapping),q}function G(q){if(q&&q.isTexture&&q.isRenderTargetTexture===!1){const W=q.mapping;if(W===EquirectangularReflectionMapping||W===EquirectangularRefractionMapping)if(D.has(q)){const Y=D.get(q).texture;return F(Y,q.mapping)}else{const Y=q.image;if(Y&&Y.height>0){const J=new WebGLCubeRenderTarget(Y.height/2);return J.fromEquirectangularTexture(U,q),D.set(q,J),q.addEventListener("dispose",Q),F(J.texture,q.mapping)}else return null}}return q}function Q(q){const W=q.target;W.removeEventListener("dispose",Q);const Y=D.get(W);Y!==void 0&&(D.delete(W),Y.dispose())}function X(){D=new WeakMap}return{get:G,dispose:X}}class OrthographicCamera extends Camera{constructor(D=-1,F=1,G=1,Q=-1,X=.1,q=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=D,this.right=F,this.top=G,this.bottom=Q,this.near=X,this.far=q,this.updateProjectionMatrix()}copy(D,F){return super.copy(D,F),this.left=D.left,this.right=D.right,this.top=D.top,this.bottom=D.bottom,this.near=D.near,this.far=D.far,this.zoom=D.zoom,this.view=D.view===null?null:Object.assign({},D.view),this}setViewOffset(D,F,G,Q,X,q){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=D,this.view.fullHeight=F,this.view.offsetX=G,this.view.offsetY=Q,this.view.width=X,this.view.height=q,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const D=(this.right-this.left)/(2*this.zoom),F=(this.top-this.bottom)/(2*this.zoom),G=(this.right+this.left)/2,Q=(this.top+this.bottom)/2;let X=G-D,q=G+D,W=Q+F,Y=Q-F;if(this.view!==null&&this.view.enabled){const J=(this.right-this.left)/this.view.fullWidth/this.zoom,te=(this.top-this.bottom)/this.view.fullHeight/this.zoom;X+=J*this.view.offsetX,q=X+J*this.view.width,W-=te*this.view.offsetY,Y=W-te*this.view.height}this.projectionMatrix.makeOrthographic(X,q,W,Y,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(D){const F=super.toJSON(D);return F.object.zoom=this.zoom,F.object.left=this.left,F.object.right=this.right,F.object.top=this.top,F.object.bottom=this.bottom,F.object.near=this.near,F.object.far=this.far,this.view!==null&&(F.object.view=Object.assign({},this.view)),F}}const LOD_MIN=4,EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],MAX_SAMPLES=20,_flatCamera=new OrthographicCamera,_clearColor=new Color;let _oldTarget=null;const PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(1,1,1),new Vector3(-1,1,1),new Vector3(1,1,-1),new Vector3(-1,1,-1),new Vector3(0,PHI,INV_PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(INV_PHI,0,PHI),new Vector3(-INV_PHI,0,PHI),new Vector3(PHI,INV_PHI,0),new Vector3(-PHI,INV_PHI,0)];class PMREMGenerator{constructor(D){this._renderer=D,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(D,F=0,G=.1,Q=100){_oldTarget=this._renderer.getRenderTarget(),this._setSize(256);const X=this._allocateTargets();return X.depthBuffer=!0,this._sceneToCubeUV(D,G,Q,X),F>0&&this._blur(X,0,0,F),this._applyPMREM(X),this._cleanup(X),X}fromEquirectangular(D,F=null){return this._fromTexture(D,F)}fromCubemap(D,F=null){return this._fromTexture(D,F)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(D){this._lodMax=Math.floor(Math.log2(D)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let D=0;D<this._lodPlanes.length;D++)this._lodPlanes[D].dispose()}_cleanup(D){this._renderer.setRenderTarget(_oldTarget),D.scissorTest=!1,_setViewport(D,0,0,D.width,D.height)}_fromTexture(D,F){D.mapping===CubeReflectionMapping||D.mapping===CubeRefractionMapping?this._setSize(D.image.length===0?16:D.image[0].width||D.image[0].image.width):this._setSize(D.image.width/4),_oldTarget=this._renderer.getRenderTarget();const G=F||this._allocateTargets();return this._textureToCubeUV(D,G),this._applyPMREM(G),this._cleanup(G),G}_allocateTargets(){const D=3*Math.max(this._cubeSize,112),F=4*this._cubeSize,G={magFilter:LinearFilter,minFilter:LinearFilter,generateMipmaps:!1,type:HalfFloatType,format:RGBAFormat,encoding:LinearEncoding,depthBuffer:!1},Q=_createRenderTarget(D,F,G);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==D||this._pingPongRenderTarget.height!==F){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_createRenderTarget(D,F,G);const{_lodMax:X}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_createPlanes(X)),this._blurMaterial=_getBlurShader(X,D,F)}return Q}_compileMaterial(D){const F=new Mesh(this._lodPlanes[0],D);this._renderer.compile(F,_flatCamera)}_sceneToCubeUV(D,F,G,Q){const W=new PerspectiveCamera(90,1,F,G),Y=[1,-1,1,1,1,1],J=[1,1,1,-1,-1,-1],te=this._renderer,Z=te.autoClear,ee=te.toneMapping;te.getClearColor(_clearColor),te.toneMapping=NoToneMapping,te.autoClear=!1;const re=new MeshBasicMaterial({name:"PMREM.Background",side:BackSide,depthWrite:!1,depthTest:!1}),ne=new Mesh(new BoxGeometry,re);let le=!1;const se=D.background;se?se.isColor&&(re.color.copy(se),D.background=null,le=!0):(re.color.copy(_clearColor),le=!0);for(let ie=0;ie<6;ie++){const ge=ie%3;ge===0?(W.up.set(0,Y[ie],0),W.lookAt(J[ie],0,0)):ge===1?(W.up.set(0,0,Y[ie]),W.lookAt(0,J[ie],0)):(W.up.set(0,Y[ie],0),W.lookAt(0,0,J[ie]));const fe=this._cubeSize;_setViewport(Q,ge*fe,ie>2?fe:0,fe,fe),te.setRenderTarget(Q),le&&te.render(ne,W),te.render(D,W)}ne.geometry.dispose(),ne.material.dispose(),te.toneMapping=ee,te.autoClear=Z,D.background=se}_textureToCubeUV(D,F){const G=this._renderer,Q=D.mapping===CubeReflectionMapping||D.mapping===CubeRefractionMapping;Q?(this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial()),this._cubemapMaterial.uniforms.flipEnvMap.value=D.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial());const X=Q?this._cubemapMaterial:this._equirectMaterial,q=new Mesh(this._lodPlanes[0],X),W=X.uniforms;W.envMap.value=D;const Y=this._cubeSize;_setViewport(F,0,0,3*Y,2*Y),G.setRenderTarget(F),G.render(q,_flatCamera)}_applyPMREM(D){const F=this._renderer,G=F.autoClear;F.autoClear=!1;for(let Q=1;Q<this._lodPlanes.length;Q++){const X=Math.sqrt(this._sigmas[Q]*this._sigmas[Q]-this._sigmas[Q-1]*this._sigmas[Q-1]),q=_axisDirections[(Q-1)%_axisDirections.length];this._blur(D,Q-1,Q,X,q)}F.autoClear=G}_blur(D,F,G,Q,X){const q=this._pingPongRenderTarget;this._halfBlur(D,q,F,G,Q,"latitudinal",X),this._halfBlur(q,D,G,G,Q,"longitudinal",X)}_halfBlur(D,F,G,Q,X,q,W){const Y=this._renderer,J=this._blurMaterial;q!=="latitudinal"&&q!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const te=3,Z=new Mesh(this._lodPlanes[Q],J),ee=J.uniforms,re=this._sizeLods[G]-1,ne=isFinite(X)?Math.PI/(2*re):2*Math.PI/(2*MAX_SAMPLES-1),le=X/ne,se=isFinite(X)?1+Math.floor(te*le):MAX_SAMPLES;se>MAX_SAMPLES&&console.warn(`sigmaRadians, ${X}, is too large and will clip, as it requested ${se} samples when the maximum is set to ${MAX_SAMPLES}`);const ie=[];let ge=0;for(let _e=0;_e<MAX_SAMPLES;++_e){const xe=_e/le,be=Math.exp(-xe*xe/2);ie.push(be),_e===0?ge+=be:_e<se&&(ge+=2*be)}for(let _e=0;_e<ie.length;_e++)ie[_e]=ie[_e]/ge;ee.envMap.value=D.texture,ee.samples.value=se,ee.weights.value=ie,ee.latitudinal.value=q==="latitudinal",W&&(ee.poleAxis.value=W);const{_lodMax:fe}=this;ee.dTheta.value=ne,ee.mipInt.value=fe-G;const ae=this._sizeLods[Q],ue=3*ae*(Q>fe-LOD_MIN?Q-fe+LOD_MIN:0),pe=4*(this._cubeSize-ae);_setViewport(F,ue,pe,3*ae,2*ae),Y.setRenderTarget(F),Y.render(Z,_flatCamera)}}function _createPlanes(U){const D=[],F=[],G=[];let Q=U;const X=U-LOD_MIN+1+EXTRA_LOD_SIGMA.length;for(let q=0;q<X;q++){const W=Math.pow(2,Q);F.push(W);let Y=1/W;q>U-LOD_MIN?Y=EXTRA_LOD_SIGMA[q-U+LOD_MIN-1]:q===0&&(Y=0),G.push(Y);const J=1/(W-2),te=-J,Z=1+J,ee=[te,te,Z,te,Z,Z,te,te,Z,Z,te,Z],re=6,ne=6,le=3,se=2,ie=1,ge=new Float32Array(le*ne*re),fe=new Float32Array(se*ne*re),ae=new Float32Array(ie*ne*re);for(let pe=0;pe<re;pe++){const _e=pe%3*2/3-1,xe=pe>2?0:-1,be=[_e,xe,0,_e+2/3,xe,0,_e+2/3,xe+1,0,_e,xe,0,_e+2/3,xe+1,0,_e,xe+1,0];ge.set(be,le*ne*pe),fe.set(ee,se*ne*pe);const Te=[pe,pe,pe,pe,pe,pe];ae.set(Te,ie*ne*pe)}const ue=new BufferGeometry;ue.setAttribute("position",new BufferAttribute(ge,le)),ue.setAttribute("uv",new BufferAttribute(fe,se)),ue.setAttribute("faceIndex",new BufferAttribute(ae,ie)),D.push(ue),Q>LOD_MIN&&Q--}return{lodPlanes:D,sizeLods:F,sigmas:G}}function _createRenderTarget(U,D,F){const G=new WebGLRenderTarget(U,D,F);return G.texture.mapping=CubeUVReflectionMapping,G.texture.name="PMREM.cubeUv",G.scissorTest=!0,G}function _setViewport(U,D,F,G,Q){U.viewport.set(D,F,G,Q),U.scissor.set(D,F,G,Q)}function _getBlurShader(U,D,F){const G=new Float32Array(MAX_SAMPLES),Q=new Vector3(0,1,0);return new ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:MAX_SAMPLES,CUBEUV_TEXEL_WIDTH:1/D,CUBEUV_TEXEL_HEIGHT:1/F,CUBEUV_MAX_MIP:`${U}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:G},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:Q}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getEquirectMaterial(){return new ShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCubemapMaterial(){return new ShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WebGLCubeUVMaps(U){let D=new WeakMap,F=null;function G(W){if(W&&W.isTexture){const Y=W.mapping,J=Y===EquirectangularReflectionMapping||Y===EquirectangularRefractionMapping,te=Y===CubeReflectionMapping||Y===CubeRefractionMapping;if(J||te)if(W.isRenderTargetTexture&&W.needsPMREMUpdate===!0){W.needsPMREMUpdate=!1;let Z=D.get(W);return F===null&&(F=new PMREMGenerator(U)),Z=J?F.fromEquirectangular(W,Z):F.fromCubemap(W,Z),D.set(W,Z),Z.texture}else{if(D.has(W))return D.get(W).texture;{const Z=W.image;if(J&&Z&&Z.height>0||te&&Z&&Q(Z)){F===null&&(F=new PMREMGenerator(U));const ee=J?F.fromEquirectangular(W):F.fromCubemap(W);return D.set(W,ee),W.addEventListener("dispose",X),ee.texture}else return null}}}return W}function Q(W){let Y=0;const J=6;for(let te=0;te<J;te++)W[te]!==void 0&&Y++;return Y===J}function X(W){const Y=W.target;Y.removeEventListener("dispose",X);const J=D.get(Y);J!==void 0&&(D.delete(Y),J.dispose())}function q(){D=new WeakMap,F!==null&&(F.dispose(),F=null)}return{get:G,dispose:q}}function WebGLExtensions(U){const D={};function F(G){if(D[G]!==void 0)return D[G];let Q;switch(G){case"WEBGL_depth_texture":Q=U.getExtension("WEBGL_depth_texture")||U.getExtension("MOZ_WEBGL_depth_texture")||U.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":Q=U.getExtension("EXT_texture_filter_anisotropic")||U.getExtension("MOZ_EXT_texture_filter_anisotropic")||U.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":Q=U.getExtension("WEBGL_compressed_texture_s3tc")||U.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||U.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":Q=U.getExtension("WEBGL_compressed_texture_pvrtc")||U.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:Q=U.getExtension(G)}return D[G]=Q,Q}return{has:function(G){return F(G)!==null},init:function(G){G.isWebGL2?F("EXT_color_buffer_float"):(F("WEBGL_depth_texture"),F("OES_texture_float"),F("OES_texture_half_float"),F("OES_texture_half_float_linear"),F("OES_standard_derivatives"),F("OES_element_index_uint"),F("OES_vertex_array_object"),F("ANGLE_instanced_arrays")),F("OES_texture_float_linear"),F("EXT_color_buffer_half_float"),F("WEBGL_multisampled_render_to_texture")},get:function(G){const Q=F(G);return Q===null&&console.warn("THREE.WebGLRenderer: "+G+" extension not supported."),Q}}}function WebGLGeometries(U,D,F,G){const Q={},X=new WeakMap;function q(Z){const ee=Z.target;ee.index!==null&&D.remove(ee.index);for(const ne in ee.attributes)D.remove(ee.attributes[ne]);ee.removeEventListener("dispose",q),delete Q[ee.id];const re=X.get(ee);re&&(D.remove(re),X.delete(ee)),G.releaseStatesOfGeometry(ee),ee.isInstancedBufferGeometry===!0&&delete ee._maxInstanceCount,F.memory.geometries--}function W(Z,ee){return Q[ee.id]===!0||(ee.addEventListener("dispose",q),Q[ee.id]=!0,F.memory.geometries++),ee}function Y(Z){const ee=Z.attributes;for(const ne in ee)D.update(ee[ne],34962);const re=Z.morphAttributes;for(const ne in re){const le=re[ne];for(let se=0,ie=le.length;se<ie;se++)D.update(le[se],34962)}}function J(Z){const ee=[],re=Z.index,ne=Z.attributes.position;let le=0;if(re!==null){const ge=re.array;le=re.version;for(let fe=0,ae=ge.length;fe<ae;fe+=3){const ue=ge[fe+0],pe=ge[fe+1],_e=ge[fe+2];ee.push(ue,pe,pe,_e,_e,ue)}}else{const ge=ne.array;le=ne.version;for(let fe=0,ae=ge.length/3-1;fe<ae;fe+=3){const ue=fe+0,pe=fe+1,_e=fe+2;ee.push(ue,pe,pe,_e,_e,ue)}}const se=new(arrayNeedsUint32(ee)?Uint32BufferAttribute:Uint16BufferAttribute)(ee,1);se.version=le;const ie=X.get(Z);ie&&D.remove(ie),X.set(Z,se)}function te(Z){const ee=X.get(Z);if(ee){const re=Z.index;re!==null&&ee.version<re.version&&J(Z)}else J(Z);return X.get(Z)}return{get:W,update:Y,getWireframeAttribute:te}}function WebGLIndexedBufferRenderer(U,D,F,G){const Q=G.isWebGL2;let X;function q(ee){X=ee}let W,Y;function J(ee){W=ee.type,Y=ee.bytesPerElement}function te(ee,re){U.drawElements(X,re,W,ee*Y),F.update(re,X,1)}function Z(ee,re,ne){if(ne===0)return;let le,se;if(Q)le=U,se="drawElementsInstanced";else if(le=D.get("ANGLE_instanced_arrays"),se="drawElementsInstancedANGLE",le===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}le[se](X,re,W,ee*Y,ne),F.update(re,X,ne)}this.setMode=q,this.setIndex=J,this.render=te,this.renderInstances=Z}function WebGLInfo(U){const D={geometries:0,textures:0},F={frame:0,calls:0,triangles:0,points:0,lines:0};function G(X,q,W){switch(F.calls++,q){case 4:F.triangles+=W*(X/3);break;case 1:F.lines+=W*(X/2);break;case 3:F.lines+=W*(X-1);break;case 2:F.lines+=W*X;break;case 0:F.points+=W*X;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",q);break}}function Q(){F.frame++,F.calls=0,F.triangles=0,F.points=0,F.lines=0}return{memory:D,render:F,programs:null,autoReset:!0,reset:Q,update:G}}function numericalSort(U,D){return U[0]-D[0]}function absNumericalSort(U,D){return Math.abs(D[1])-Math.abs(U[1])}function WebGLMorphtargets(U,D,F){const G={},Q=new Float32Array(8),X=new WeakMap,q=new Vector4,W=[];for(let J=0;J<8;J++)W[J]=[J,0];function Y(J,te,Z){const ee=J.morphTargetInfluences;if(D.isWebGL2===!0){const re=te.morphAttributes.position||te.morphAttributes.normal||te.morphAttributes.color,ne=re!==void 0?re.length:0;let le=X.get(te);if(le===void 0||le.count!==ne){let oe=function(){Ee.dispose(),X.delete(te),te.removeEventListener("dispose",oe)};le!==void 0&&le.texture.dispose();const ge=te.morphAttributes.position!==void 0,fe=te.morphAttributes.normal!==void 0,ae=te.morphAttributes.color!==void 0,ue=te.morphAttributes.position||[],pe=te.morphAttributes.normal||[],_e=te.morphAttributes.color||[];let xe=0;ge===!0&&(xe=1),fe===!0&&(xe=2),ae===!0&&(xe=3);let be=te.attributes.position.count*xe,Te=1;be>D.maxTextureSize&&(Te=Math.ceil(be/D.maxTextureSize),be=D.maxTextureSize);const ye=new Float32Array(be*Te*4*ne),Ee=new DataArrayTexture(ye,be,Te,ne);Ee.type=FloatType,Ee.needsUpdate=!0;const he=xe*4;for(let me=0;me<ne;me++){const ve=ue[me],we=pe[me],Pe=_e[me],Me=be*Te*4*me;for(let De=0;De<ve.count;De++){const Oe=De*he;ge===!0&&(q.fromBufferAttribute(ve,De),ye[Me+Oe+0]=q.x,ye[Me+Oe+1]=q.y,ye[Me+Oe+2]=q.z,ye[Me+Oe+3]=0),fe===!0&&(q.fromBufferAttribute(we,De),ye[Me+Oe+4]=q.x,ye[Me+Oe+5]=q.y,ye[Me+Oe+6]=q.z,ye[Me+Oe+7]=0),ae===!0&&(q.fromBufferAttribute(Pe,De),ye[Me+Oe+8]=q.x,ye[Me+Oe+9]=q.y,ye[Me+Oe+10]=q.z,ye[Me+Oe+11]=Pe.itemSize===4?q.w:1)}}le={count:ne,texture:Ee,size:new Vector2(be,Te)},X.set(te,le),te.addEventListener("dispose",oe)}let se=0;for(let ge=0;ge<ee.length;ge++)se+=ee[ge];const ie=te.morphTargetsRelative?1:1-se;Z.getUniforms().setValue(U,"morphTargetBaseInfluence",ie),Z.getUniforms().setValue(U,"morphTargetInfluences",ee),Z.getUniforms().setValue(U,"morphTargetsTexture",le.texture,F),Z.getUniforms().setValue(U,"morphTargetsTextureSize",le.size)}else{const re=ee===void 0?0:ee.length;let ne=G[te.id];if(ne===void 0||ne.length!==re){ne=[];for(let fe=0;fe<re;fe++)ne[fe]=[fe,0];G[te.id]=ne}for(let fe=0;fe<re;fe++){const ae=ne[fe];ae[0]=fe,ae[1]=ee[fe]}ne.sort(absNumericalSort);for(let fe=0;fe<8;fe++)fe<re&&ne[fe][1]?(W[fe][0]=ne[fe][0],W[fe][1]=ne[fe][1]):(W[fe][0]=Number.MAX_SAFE_INTEGER,W[fe][1]=0);W.sort(numericalSort);const le=te.morphAttributes.position,se=te.morphAttributes.normal;let ie=0;for(let fe=0;fe<8;fe++){const ae=W[fe],ue=ae[0],pe=ae[1];ue!==Number.MAX_SAFE_INTEGER&&pe?(le&&te.getAttribute("morphTarget"+fe)!==le[ue]&&te.setAttribute("morphTarget"+fe,le[ue]),se&&te.getAttribute("morphNormal"+fe)!==se[ue]&&te.setAttribute("morphNormal"+fe,se[ue]),Q[fe]=pe,ie+=pe):(le&&te.hasAttribute("morphTarget"+fe)===!0&&te.deleteAttribute("morphTarget"+fe),se&&te.hasAttribute("morphNormal"+fe)===!0&&te.deleteAttribute("morphNormal"+fe),Q[fe]=0)}const ge=te.morphTargetsRelative?1:1-ie;Z.getUniforms().setValue(U,"morphTargetBaseInfluence",ge),Z.getUniforms().setValue(U,"morphTargetInfluences",Q)}}return{update:Y}}function WebGLObjects(U,D,F,G){let Q=new WeakMap;function X(Y){const J=G.render.frame,te=Y.geometry,Z=D.get(Y,te);return Q.get(Z)!==J&&(D.update(Z),Q.set(Z,J)),Y.isInstancedMesh&&(Y.hasEventListener("dispose",W)===!1&&Y.addEventListener("dispose",W),F.update(Y.instanceMatrix,34962),Y.instanceColor!==null&&F.update(Y.instanceColor,34962)),Z}function q(){Q=new WeakMap}function W(Y){const J=Y.target;J.removeEventListener("dispose",W),F.remove(J.instanceMatrix),J.instanceColor!==null&&F.remove(J.instanceColor)}return{update:X,dispose:q}}const emptyTexture=new Texture,emptyArrayTexture=new DataArrayTexture,empty3dTexture=new Data3DTexture,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten(U,D,F){const G=U[0];if(G<=0||G>0)return U;const Q=D*F;let X=arrayCacheF32[Q];if(X===void 0&&(X=new Float32Array(Q),arrayCacheF32[Q]=X),D!==0){G.toArray(X,0);for(let q=1,W=0;q!==D;++q)W+=F,U[q].toArray(X,W)}return X}function arraysEqual$1(U,D){if(U.length!==D.length)return!1;for(let F=0,G=U.length;F<G;F++)if(U[F]!==D[F])return!1;return!0}function copyArray(U,D){for(let F=0,G=D.length;F<G;F++)U[F]=D[F]}function allocTexUnits(U,D){let F=arrayCacheI32[D];F===void 0&&(F=new Int32Array(D),arrayCacheI32[D]=F);for(let G=0;G!==D;++G)F[G]=U.allocateTextureUnit();return F}function setValueV1f(U,D){const F=this.cache;F[0]!==D&&(U.uniform1f(this.addr,D),F[0]=D)}function setValueV2f(U,D){const F=this.cache;if(D.x!==void 0)(F[0]!==D.x||F[1]!==D.y)&&(U.uniform2f(this.addr,D.x,D.y),F[0]=D.x,F[1]=D.y);else{if(arraysEqual$1(F,D))return;U.uniform2fv(this.addr,D),copyArray(F,D)}}function setValueV3f(U,D){const F=this.cache;if(D.x!==void 0)(F[0]!==D.x||F[1]!==D.y||F[2]!==D.z)&&(U.uniform3f(this.addr,D.x,D.y,D.z),F[0]=D.x,F[1]=D.y,F[2]=D.z);else if(D.r!==void 0)(F[0]!==D.r||F[1]!==D.g||F[2]!==D.b)&&(U.uniform3f(this.addr,D.r,D.g,D.b),F[0]=D.r,F[1]=D.g,F[2]=D.b);else{if(arraysEqual$1(F,D))return;U.uniform3fv(this.addr,D),copyArray(F,D)}}function setValueV4f(U,D){const F=this.cache;if(D.x!==void 0)(F[0]!==D.x||F[1]!==D.y||F[2]!==D.z||F[3]!==D.w)&&(U.uniform4f(this.addr,D.x,D.y,D.z,D.w),F[0]=D.x,F[1]=D.y,F[2]=D.z,F[3]=D.w);else{if(arraysEqual$1(F,D))return;U.uniform4fv(this.addr,D),copyArray(F,D)}}function setValueM2(U,D){const F=this.cache,G=D.elements;if(G===void 0){if(arraysEqual$1(F,D))return;U.uniformMatrix2fv(this.addr,!1,D),copyArray(F,D)}else{if(arraysEqual$1(F,G))return;mat2array.set(G),U.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(F,G)}}function setValueM3(U,D){const F=this.cache,G=D.elements;if(G===void 0){if(arraysEqual$1(F,D))return;U.uniformMatrix3fv(this.addr,!1,D),copyArray(F,D)}else{if(arraysEqual$1(F,G))return;mat3array.set(G),U.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(F,G)}}function setValueM4(U,D){const F=this.cache,G=D.elements;if(G===void 0){if(arraysEqual$1(F,D))return;U.uniformMatrix4fv(this.addr,!1,D),copyArray(F,D)}else{if(arraysEqual$1(F,G))return;mat4array.set(G),U.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(F,G)}}function setValueV1i(U,D){const F=this.cache;F[0]!==D&&(U.uniform1i(this.addr,D),F[0]=D)}function setValueV2i(U,D){const F=this.cache;if(D.x!==void 0)(F[0]!==D.x||F[1]!==D.y)&&(U.uniform2i(this.addr,D.x,D.y),F[0]=D.x,F[1]=D.y);else{if(arraysEqual$1(F,D))return;U.uniform2iv(this.addr,D),copyArray(F,D)}}function setValueV3i(U,D){const F=this.cache;if(D.x!==void 0)(F[0]!==D.x||F[1]!==D.y||F[2]!==D.z)&&(U.uniform3i(this.addr,D.x,D.y,D.z),F[0]=D.x,F[1]=D.y,F[2]=D.z);else{if(arraysEqual$1(F,D))return;U.uniform3iv(this.addr,D),copyArray(F,D)}}function setValueV4i(U,D){const F=this.cache;if(D.x!==void 0)(F[0]!==D.x||F[1]!==D.y||F[2]!==D.z||F[3]!==D.w)&&(U.uniform4i(this.addr,D.x,D.y,D.z,D.w),F[0]=D.x,F[1]=D.y,F[2]=D.z,F[3]=D.w);else{if(arraysEqual$1(F,D))return;U.uniform4iv(this.addr,D),copyArray(F,D)}}function setValueV1ui(U,D){const F=this.cache;F[0]!==D&&(U.uniform1ui(this.addr,D),F[0]=D)}function setValueV2ui(U,D){const F=this.cache;if(D.x!==void 0)(F[0]!==D.x||F[1]!==D.y)&&(U.uniform2ui(this.addr,D.x,D.y),F[0]=D.x,F[1]=D.y);else{if(arraysEqual$1(F,D))return;U.uniform2uiv(this.addr,D),copyArray(F,D)}}function setValueV3ui(U,D){const F=this.cache;if(D.x!==void 0)(F[0]!==D.x||F[1]!==D.y||F[2]!==D.z)&&(U.uniform3ui(this.addr,D.x,D.y,D.z),F[0]=D.x,F[1]=D.y,F[2]=D.z);else{if(arraysEqual$1(F,D))return;U.uniform3uiv(this.addr,D),copyArray(F,D)}}function setValueV4ui(U,D){const F=this.cache;if(D.x!==void 0)(F[0]!==D.x||F[1]!==D.y||F[2]!==D.z||F[3]!==D.w)&&(U.uniform4ui(this.addr,D.x,D.y,D.z,D.w),F[0]=D.x,F[1]=D.y,F[2]=D.z,F[3]=D.w);else{if(arraysEqual$1(F,D))return;U.uniform4uiv(this.addr,D),copyArray(F,D)}}function setValueT1(U,D,F){const G=this.cache,Q=F.allocateTextureUnit();G[0]!==Q&&(U.uniform1i(this.addr,Q),G[0]=Q),F.setTexture2D(D||emptyTexture,Q)}function setValueT3D1(U,D,F){const G=this.cache,Q=F.allocateTextureUnit();G[0]!==Q&&(U.uniform1i(this.addr,Q),G[0]=Q),F.setTexture3D(D||empty3dTexture,Q)}function setValueT6(U,D,F){const G=this.cache,Q=F.allocateTextureUnit();G[0]!==Q&&(U.uniform1i(this.addr,Q),G[0]=Q),F.setTextureCube(D||emptyCubeTexture,Q)}function setValueT2DArray1(U,D,F){const G=this.cache,Q=F.allocateTextureUnit();G[0]!==Q&&(U.uniform1i(this.addr,Q),G[0]=Q),F.setTexture2DArray(D||emptyArrayTexture,Q)}function getSingularSetter(U){switch(U){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(U,D){U.uniform1fv(this.addr,D)}function setValueV2fArray(U,D){const F=flatten(D,this.size,2);U.uniform2fv(this.addr,F)}function setValueV3fArray(U,D){const F=flatten(D,this.size,3);U.uniform3fv(this.addr,F)}function setValueV4fArray(U,D){const F=flatten(D,this.size,4);U.uniform4fv(this.addr,F)}function setValueM2Array(U,D){const F=flatten(D,this.size,4);U.uniformMatrix2fv(this.addr,!1,F)}function setValueM3Array(U,D){const F=flatten(D,this.size,9);U.uniformMatrix3fv(this.addr,!1,F)}function setValueM4Array(U,D){const F=flatten(D,this.size,16);U.uniformMatrix4fv(this.addr,!1,F)}function setValueV1iArray(U,D){U.uniform1iv(this.addr,D)}function setValueV2iArray(U,D){U.uniform2iv(this.addr,D)}function setValueV3iArray(U,D){U.uniform3iv(this.addr,D)}function setValueV4iArray(U,D){U.uniform4iv(this.addr,D)}function setValueV1uiArray(U,D){U.uniform1uiv(this.addr,D)}function setValueV2uiArray(U,D){U.uniform2uiv(this.addr,D)}function setValueV3uiArray(U,D){U.uniform3uiv(this.addr,D)}function setValueV4uiArray(U,D){U.uniform4uiv(this.addr,D)}function setValueT1Array(U,D,F){const G=this.cache,Q=D.length,X=allocTexUnits(F,Q);arraysEqual$1(G,X)||(U.uniform1iv(this.addr,X),copyArray(G,X));for(let q=0;q!==Q;++q)F.setTexture2D(D[q]||emptyTexture,X[q])}function setValueT3DArray(U,D,F){const G=this.cache,Q=D.length,X=allocTexUnits(F,Q);arraysEqual$1(G,X)||(U.uniform1iv(this.addr,X),copyArray(G,X));for(let q=0;q!==Q;++q)F.setTexture3D(D[q]||empty3dTexture,X[q])}function setValueT6Array(U,D,F){const G=this.cache,Q=D.length,X=allocTexUnits(F,Q);arraysEqual$1(G,X)||(U.uniform1iv(this.addr,X),copyArray(G,X));for(let q=0;q!==Q;++q)F.setTextureCube(D[q]||emptyCubeTexture,X[q])}function setValueT2DArrayArray(U,D,F){const G=this.cache,Q=D.length,X=allocTexUnits(F,Q);arraysEqual$1(G,X)||(U.uniform1iv(this.addr,X),copyArray(G,X));for(let q=0;q!==Q;++q)F.setTexture2DArray(D[q]||emptyArrayTexture,X[q])}function getPureArraySetter(U){switch(U){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35679:case 36299:case 36307:return setValueT3DArray;case 35680:case 36300:case 36308:case 36293:return setValueT6Array;case 36289:case 36303:case 36311:case 36292:return setValueT2DArrayArray}}class SingleUniform{constructor(D,F,G){this.id=D,this.addr=G,this.cache=[],this.setValue=getSingularSetter(F.type)}}class PureArrayUniform{constructor(D,F,G){this.id=D,this.addr=G,this.cache=[],this.size=F.size,this.setValue=getPureArraySetter(F.type)}}class StructuredUniform{constructor(D){this.id=D,this.seq=[],this.map={}}setValue(D,F,G){const Q=this.seq;for(let X=0,q=Q.length;X!==q;++X){const W=Q[X];W.setValue(D,F[W.id],G)}}}const RePathPart=/(\w+)(\])?(\[|\.)?/g;function addUniform(U,D){U.seq.push(D),U.map[D.id]=D}function parseUniform(U,D,F){const G=U.name,Q=G.length;for(RePathPart.lastIndex=0;;){const X=RePathPart.exec(G),q=RePathPart.lastIndex;let W=X[1];const Y=X[2]==="]",J=X[3];if(Y&&(W=W|0),J===void 0||J==="["&&q+2===Q){addUniform(F,J===void 0?new SingleUniform(W,U,D):new PureArrayUniform(W,U,D));break}else{let Z=F.map[W];Z===void 0&&(Z=new StructuredUniform(W),addUniform(F,Z)),F=Z}}}class WebGLUniforms{constructor(D,F){this.seq=[],this.map={};const G=D.getProgramParameter(F,35718);for(let Q=0;Q<G;++Q){const X=D.getActiveUniform(F,Q),q=D.getUniformLocation(F,X.name);parseUniform(X,q,this)}}setValue(D,F,G,Q){const X=this.map[F];X!==void 0&&X.setValue(D,G,Q)}setOptional(D,F,G){const Q=F[G];Q!==void 0&&this.setValue(D,G,Q)}static upload(D,F,G,Q){for(let X=0,q=F.length;X!==q;++X){const W=F[X],Y=G[W.id];Y.needsUpdate!==!1&&W.setValue(D,Y.value,Q)}}static seqWithValue(D,F){const G=[];for(let Q=0,X=D.length;Q!==X;++Q){const q=D[Q];q.id in F&&G.push(q)}return G}}function WebGLShader(U,D,F){const G=U.createShader(D);return U.shaderSource(G,F),U.compileShader(G),G}let programIdCount=0;function handleSource(U,D){const F=U.split(`
`),G=[],Q=Math.max(D-6,0),X=Math.min(D+6,F.length);for(let q=Q;q<X;q++){const W=q+1;G.push(`${W===D?">":" "} ${W}: ${F[q]}`)}return G.join(`
`)}function getEncodingComponents(U){switch(U){case LinearEncoding:return["Linear","( value )"];case sRGBEncoding:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",U),["Linear","( value )"]}}function getShaderErrors(U,D,F){const G=U.getShaderParameter(D,35713),Q=U.getShaderInfoLog(D).trim();if(G&&Q==="")return"";const X=/ERROR: 0:(\d+)/.exec(Q);if(X){const q=parseInt(X[1]);return F.toUpperCase()+`

`+Q+`

`+handleSource(U.getShaderSource(D),q)}else return Q}function getTexelEncodingFunction(U,D){const F=getEncodingComponents(D);return"vec4 "+U+"( vec4 value ) { return LinearTo"+F[0]+F[1]+"; }"}function getToneMappingFunction(U,D){let F;switch(D){case LinearToneMapping:F="Linear";break;case ReinhardToneMapping:F="Reinhard";break;case CineonToneMapping:F="OptimizedCineon";break;case ACESFilmicToneMapping:F="ACESFilmic";break;case CustomToneMapping:F="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",D),F="Linear"}return"vec3 "+U+"( vec3 color ) { return "+F+"ToneMapping( color ); }"}function generateExtensions(U){return[U.extensionDerivatives||U.envMapCubeUVHeight||U.bumpMap||U.normalMapTangentSpace||U.clearcoatNormalMap||U.flatShading||U.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(U.extensionFragDepth||U.logarithmicDepthBuffer)&&U.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",U.extensionDrawBuffers&&U.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(U.extensionShaderTextureLOD||U.envMap||U.transmission)&&U.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(filterEmptyLine).join(`
`)}function generateDefines(U){const D=[];for(const F in U){const G=U[F];G!==!1&&D.push("#define "+F+" "+G)}return D.join(`
`)}function fetchAttributeLocations(U,D){const F={},G=U.getProgramParameter(D,35721);for(let Q=0;Q<G;Q++){const X=U.getActiveAttrib(D,Q),q=X.name;let W=1;X.type===35674&&(W=2),X.type===35675&&(W=3),X.type===35676&&(W=4),F[q]={type:X.type,location:U.getAttribLocation(D,q),locationSize:W}}return F}function filterEmptyLine(U){return U!==""}function replaceLightNums(U,D){const F=D.numSpotLightShadows+D.numSpotLightMaps-D.numSpotLightShadowsWithMaps;return U.replace(/NUM_DIR_LIGHTS/g,D.numDirLights).replace(/NUM_SPOT_LIGHTS/g,D.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,D.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,F).replace(/NUM_RECT_AREA_LIGHTS/g,D.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,D.numPointLights).replace(/NUM_HEMI_LIGHTS/g,D.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,D.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,D.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,D.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,D.numPointLightShadows)}function replaceClippingPlaneNums(U,D){return U.replace(/NUM_CLIPPING_PLANES/g,D.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,D.numClippingPlanes-D.numClipIntersection)}const includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(U){return U.replace(includePattern,includeReplacer)}function includeReplacer(U,D){const F=ShaderChunk[D];if(F===void 0)throw new Error("Can not resolve #include <"+D+">");return resolveIncludes(F)}const unrollLoopPattern=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(U){return U.replace(unrollLoopPattern,loopReplacer)}function loopReplacer(U,D,F,G){let Q="";for(let X=parseInt(D);X<parseInt(F);X++)Q+=G.replace(/\[\s*i\s*\]/g,"[ "+X+" ]").replace(/UNROLLED_LOOP_INDEX/g,X);return Q}function generatePrecision(U){let D="precision "+U.precision+` float;
precision `+U.precision+" int;";return U.precision==="highp"?D+=`
#define HIGH_PRECISION`:U.precision==="mediump"?D+=`
#define MEDIUM_PRECISION`:U.precision==="lowp"&&(D+=`
#define LOW_PRECISION`),D}function generateShadowMapTypeDefine(U){let D="SHADOWMAP_TYPE_BASIC";return U.shadowMapType===PCFShadowMap?D="SHADOWMAP_TYPE_PCF":U.shadowMapType===PCFSoftShadowMap?D="SHADOWMAP_TYPE_PCF_SOFT":U.shadowMapType===VSMShadowMap&&(D="SHADOWMAP_TYPE_VSM"),D}function generateEnvMapTypeDefine(U){let D="ENVMAP_TYPE_CUBE";if(U.envMap)switch(U.envMapMode){case CubeReflectionMapping:case CubeRefractionMapping:D="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:D="ENVMAP_TYPE_CUBE_UV";break}return D}function generateEnvMapModeDefine(U){let D="ENVMAP_MODE_REFLECTION";if(U.envMap)switch(U.envMapMode){case CubeRefractionMapping:D="ENVMAP_MODE_REFRACTION";break}return D}function generateEnvMapBlendingDefine(U){let D="ENVMAP_BLENDING_NONE";if(U.envMap)switch(U.combine){case MultiplyOperation:D="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:D="ENVMAP_BLENDING_MIX";break;case AddOperation:D="ENVMAP_BLENDING_ADD";break}return D}function generateCubeUVSize(U){const D=U.envMapCubeUVHeight;if(D===null)return null;const F=Math.log2(D)-2,G=1/D;return{texelWidth:1/(3*Math.max(Math.pow(2,F),7*16)),texelHeight:G,maxMip:F}}function WebGLProgram(U,D,F,G){const Q=U.getContext(),X=F.defines;let q=F.vertexShader,W=F.fragmentShader;const Y=generateShadowMapTypeDefine(F),J=generateEnvMapTypeDefine(F),te=generateEnvMapModeDefine(F),Z=generateEnvMapBlendingDefine(F),ee=generateCubeUVSize(F),re=F.isWebGL2?"":generateExtensions(F),ne=generateDefines(X),le=Q.createProgram();let se,ie,ge=F.glslVersion?"#version "+F.glslVersion+`
`:"";F.isRawShaderMaterial?(se=[ne].filter(filterEmptyLine).join(`
`),se.length>0&&(se+=`
`),ie=[re,ne].filter(filterEmptyLine).join(`
`),ie.length>0&&(ie+=`
`)):(se=[generatePrecision(F),"#define SHADER_NAME "+F.shaderName,ne,F.instancing?"#define USE_INSTANCING":"",F.instancingColor?"#define USE_INSTANCING_COLOR":"",F.useFog&&F.fog?"#define USE_FOG":"",F.useFog&&F.fogExp2?"#define FOG_EXP2":"",F.map?"#define USE_MAP":"",F.envMap?"#define USE_ENVMAP":"",F.envMap?"#define "+te:"",F.lightMap?"#define USE_LIGHTMAP":"",F.aoMap?"#define USE_AOMAP":"",F.bumpMap?"#define USE_BUMPMAP":"",F.normalMap?"#define USE_NORMALMAP":"",F.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",F.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",F.displacementMap?"#define USE_DISPLACEMENTMAP":"",F.emissiveMap?"#define USE_EMISSIVEMAP":"",F.clearcoatMap?"#define USE_CLEARCOATMAP":"",F.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",F.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",F.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",F.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",F.specularMap?"#define USE_SPECULARMAP":"",F.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",F.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",F.roughnessMap?"#define USE_ROUGHNESSMAP":"",F.metalnessMap?"#define USE_METALNESSMAP":"",F.alphaMap?"#define USE_ALPHAMAP":"",F.transmission?"#define USE_TRANSMISSION":"",F.transmissionMap?"#define USE_TRANSMISSIONMAP":"",F.thicknessMap?"#define USE_THICKNESSMAP":"",F.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",F.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",F.mapUv?"#define MAP_UV "+F.mapUv:"",F.alphaMapUv?"#define ALPHAMAP_UV "+F.alphaMapUv:"",F.lightMapUv?"#define LIGHTMAP_UV "+F.lightMapUv:"",F.aoMapUv?"#define AOMAP_UV "+F.aoMapUv:"",F.emissiveMapUv?"#define EMISSIVEMAP_UV "+F.emissiveMapUv:"",F.bumpMapUv?"#define BUMPMAP_UV "+F.bumpMapUv:"",F.normalMapUv?"#define NORMALMAP_UV "+F.normalMapUv:"",F.displacementMapUv?"#define DISPLACEMENTMAP_UV "+F.displacementMapUv:"",F.metalnessMapUv?"#define METALNESSMAP_UV "+F.metalnessMapUv:"",F.roughnessMapUv?"#define ROUGHNESSMAP_UV "+F.roughnessMapUv:"",F.clearcoatMapUv?"#define CLEARCOATMAP_UV "+F.clearcoatMapUv:"",F.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+F.clearcoatNormalMapUv:"",F.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+F.clearcoatRoughnessMapUv:"",F.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+F.iridescenceMapUv:"",F.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+F.iridescenceThicknessMapUv:"",F.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+F.sheenColorMapUv:"",F.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+F.sheenRoughnessMapUv:"",F.specularMapUv?"#define SPECULARMAP_UV "+F.specularMapUv:"",F.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+F.specularColorMapUv:"",F.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+F.specularIntensityMapUv:"",F.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+F.transmissionMapUv:"",F.thicknessMapUv?"#define THICKNESSMAP_UV "+F.thicknessMapUv:"",F.vertexTangents?"#define USE_TANGENT":"",F.vertexColors?"#define USE_COLOR":"",F.vertexAlphas?"#define USE_COLOR_ALPHA":"",F.vertexUvs2?"#define USE_UV2":"",F.pointsUvs?"#define USE_POINTS_UV":"",F.flatShading?"#define FLAT_SHADED":"",F.skinning?"#define USE_SKINNING":"",F.morphTargets?"#define USE_MORPHTARGETS":"",F.morphNormals&&F.flatShading===!1?"#define USE_MORPHNORMALS":"",F.morphColors&&F.isWebGL2?"#define USE_MORPHCOLORS":"",F.morphTargetsCount>0&&F.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",F.morphTargetsCount>0&&F.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+F.morphTextureStride:"",F.morphTargetsCount>0&&F.isWebGL2?"#define MORPHTARGETS_COUNT "+F.morphTargetsCount:"",F.doubleSided?"#define DOUBLE_SIDED":"",F.flipSided?"#define FLIP_SIDED":"",F.shadowMapEnabled?"#define USE_SHADOWMAP":"",F.shadowMapEnabled?"#define "+Y:"",F.sizeAttenuation?"#define USE_SIZEATTENUATION":"",F.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",F.logarithmicDepthBuffer&&F.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(filterEmptyLine).join(`
`),ie=[re,generatePrecision(F),"#define SHADER_NAME "+F.shaderName,ne,F.useFog&&F.fog?"#define USE_FOG":"",F.useFog&&F.fogExp2?"#define FOG_EXP2":"",F.map?"#define USE_MAP":"",F.matcap?"#define USE_MATCAP":"",F.envMap?"#define USE_ENVMAP":"",F.envMap?"#define "+J:"",F.envMap?"#define "+te:"",F.envMap?"#define "+Z:"",ee?"#define CUBEUV_TEXEL_WIDTH "+ee.texelWidth:"",ee?"#define CUBEUV_TEXEL_HEIGHT "+ee.texelHeight:"",ee?"#define CUBEUV_MAX_MIP "+ee.maxMip+".0":"",F.lightMap?"#define USE_LIGHTMAP":"",F.aoMap?"#define USE_AOMAP":"",F.bumpMap?"#define USE_BUMPMAP":"",F.normalMap?"#define USE_NORMALMAP":"",F.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",F.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",F.emissiveMap?"#define USE_EMISSIVEMAP":"",F.clearcoat?"#define USE_CLEARCOAT":"",F.clearcoatMap?"#define USE_CLEARCOATMAP":"",F.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",F.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",F.iridescence?"#define USE_IRIDESCENCE":"",F.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",F.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",F.specularMap?"#define USE_SPECULARMAP":"",F.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",F.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",F.roughnessMap?"#define USE_ROUGHNESSMAP":"",F.metalnessMap?"#define USE_METALNESSMAP":"",F.alphaMap?"#define USE_ALPHAMAP":"",F.alphaTest?"#define USE_ALPHATEST":"",F.sheen?"#define USE_SHEEN":"",F.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",F.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",F.transmission?"#define USE_TRANSMISSION":"",F.transmissionMap?"#define USE_TRANSMISSIONMAP":"",F.thicknessMap?"#define USE_THICKNESSMAP":"",F.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",F.vertexTangents?"#define USE_TANGENT":"",F.vertexColors||F.instancingColor?"#define USE_COLOR":"",F.vertexAlphas?"#define USE_COLOR_ALPHA":"",F.vertexUvs2?"#define USE_UV2":"",F.pointsUvs?"#define USE_POINTS_UV":"",F.gradientMap?"#define USE_GRADIENTMAP":"",F.flatShading?"#define FLAT_SHADED":"",F.doubleSided?"#define DOUBLE_SIDED":"",F.flipSided?"#define FLIP_SIDED":"",F.shadowMapEnabled?"#define USE_SHADOWMAP":"",F.shadowMapEnabled?"#define "+Y:"",F.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",F.useLegacyLights?"#define LEGACY_LIGHTS":"",F.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",F.logarithmicDepthBuffer&&F.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",F.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",F.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",F.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",F.toneMapping):"",F.dithering?"#define DITHERING":"",F.opaque?"#define OPAQUE":"",ShaderChunk.encodings_pars_fragment,getTexelEncodingFunction("linearToOutputTexel",F.outputEncoding),F.useDepthPacking?"#define DEPTH_PACKING "+F.depthPacking:"",`
`].filter(filterEmptyLine).join(`
`)),q=resolveIncludes(q),q=replaceLightNums(q,F),q=replaceClippingPlaneNums(q,F),W=resolveIncludes(W),W=replaceLightNums(W,F),W=replaceClippingPlaneNums(W,F),q=unrollLoops(q),W=unrollLoops(W),F.isWebGL2&&F.isRawShaderMaterial!==!0&&(ge=`#version 300 es
`,se=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+se,ie=["#define varying in",F.glslVersion===GLSL3?"":"layout(location = 0) out highp vec4 pc_fragColor;",F.glslVersion===GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+ie);const fe=ge+se+q,ae=ge+ie+W,ue=WebGLShader(Q,35633,fe),pe=WebGLShader(Q,35632,ae);if(Q.attachShader(le,ue),Q.attachShader(le,pe),F.index0AttributeName!==void 0?Q.bindAttribLocation(le,0,F.index0AttributeName):F.morphTargets===!0&&Q.bindAttribLocation(le,0,"position"),Q.linkProgram(le),U.debug.checkShaderErrors){const be=Q.getProgramInfoLog(le).trim(),Te=Q.getShaderInfoLog(ue).trim(),ye=Q.getShaderInfoLog(pe).trim();let Ee=!0,he=!0;if(Q.getProgramParameter(le,35714)===!1)if(Ee=!1,typeof U.debug.onShaderError=="function")U.debug.onShaderError(Q,le,ue,pe);else{const oe=getShaderErrors(Q,ue,"vertex"),me=getShaderErrors(Q,pe,"fragment");console.error("THREE.WebGLProgram: Shader Error "+Q.getError()+" - VALIDATE_STATUS "+Q.getProgramParameter(le,35715)+`

Program Info Log: `+be+`
`+oe+`
`+me)}else be!==""?console.warn("THREE.WebGLProgram: Program Info Log:",be):(Te===""||ye==="")&&(he=!1);he&&(this.diagnostics={runnable:Ee,programLog:be,vertexShader:{log:Te,prefix:se},fragmentShader:{log:ye,prefix:ie}})}Q.deleteShader(ue),Q.deleteShader(pe);let _e;this.getUniforms=function(){return _e===void 0&&(_e=new WebGLUniforms(Q,le)),_e};let xe;return this.getAttributes=function(){return xe===void 0&&(xe=fetchAttributeLocations(Q,le)),xe},this.destroy=function(){G.releaseStatesOfProgram(this),Q.deleteProgram(le),this.program=void 0},this.name=F.shaderName,this.id=programIdCount++,this.cacheKey=D,this.usedTimes=1,this.program=le,this.vertexShader=ue,this.fragmentShader=pe,this}let _id=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(D){const F=D.vertexShader,G=D.fragmentShader,Q=this._getShaderStage(F),X=this._getShaderStage(G),q=this._getShaderCacheForMaterial(D);return q.has(Q)===!1&&(q.add(Q),Q.usedTimes++),q.has(X)===!1&&(q.add(X),X.usedTimes++),this}remove(D){const F=this.materialCache.get(D);for(const G of F)G.usedTimes--,G.usedTimes===0&&this.shaderCache.delete(G.code);return this.materialCache.delete(D),this}getVertexShaderID(D){return this._getShaderStage(D.vertexShader).id}getFragmentShaderID(D){return this._getShaderStage(D.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(D){const F=this.materialCache;let G=F.get(D);return G===void 0&&(G=new Set,F.set(D,G)),G}_getShaderStage(D){const F=this.shaderCache;let G=F.get(D);return G===void 0&&(G=new WebGLShaderStage(D),F.set(D,G)),G}}class WebGLShaderStage{constructor(D){this.id=_id++,this.code=D,this.usedTimes=0}}function WebGLPrograms(U,D,F,G,Q,X,q){const W=new Layers,Y=new WebGLShaderCache,J=[],te=Q.isWebGL2,Z=Q.logarithmicDepthBuffer,ee=Q.vertexTextures;let re=Q.precision;const ne={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function le(be){return be===1?"uv2":"uv"}function se(be,Te,ye,Ee,he){const oe=Ee.fog,me=he.geometry,ve=be.isMeshStandardMaterial?Ee.environment:null,we=(be.isMeshStandardMaterial?F:D).get(be.envMap||ve),Pe=we&&we.mapping===CubeUVReflectionMapping?we.image.height:null,Me=ne[be.type];be.precision!==null&&(re=Q.getMaxPrecision(be.precision),re!==be.precision&&console.warn("THREE.WebGLProgram.getParameters:",be.precision,"not supported, using",re,"instead."));const De=me.morphAttributes.position||me.morphAttributes.normal||me.morphAttributes.color,Oe=De!==void 0?De.length:0;let Ie=0;me.morphAttributes.position!==void 0&&(Ie=1),me.morphAttributes.normal!==void 0&&(Ie=2),me.morphAttributes.color!==void 0&&(Ie=3);let Be,ze,et,qe;if(Me){const Mt=ShaderLib[Me];Be=Mt.vertexShader,ze=Mt.fragmentShader}else Be=be.vertexShader,ze=be.fragmentShader,Y.update(be),et=Y.getVertexShaderID(be),qe=Y.getFragmentShaderID(be);const je=U.getRenderTarget(),it=he.isInstancedMesh===!0,ct=!!be.map,rt=!!be.matcap,ut=!!we,We=!!be.aoMap,Re=!!be.lightMap,Ue=!!be.bumpMap,Le=!!be.normalMap,Ge=!!be.displacementMap,ke=!!be.emissiveMap,He=!!be.metalnessMap,Ke=!!be.roughnessMap,$e=be.clearcoat>0,Qe=be.iridescence>0,Ne=be.sheen>0,Ce=be.transmission>0,Ze=$e&&!!be.clearcoatMap,at=$e&&!!be.clearcoatNormalMap,st=$e&&!!be.clearcoatRoughnessMap,Se=Qe&&!!be.iridescenceMap,ce=Qe&&!!be.iridescenceThicknessMap,de=Ne&&!!be.sheenColorMap,Ae=Ne&&!!be.sheenRoughnessMap,Fe=!!be.specularMap,Ve=!!be.specularColorMap,Je=!!be.specularIntensityMap,dt=Ce&&!!be.transmissionMap,St=Ce&&!!be.thicknessMap,Tt=!!be.gradientMap,At=!!be.alphaMap,wt=be.alphaTest>0,ot=!!be.extensions,pt=!!me.attributes.uv2;return{isWebGL2:te,shaderID:Me,shaderName:be.type,vertexShader:Be,fragmentShader:ze,defines:be.defines,customVertexShaderID:et,customFragmentShaderID:qe,isRawShaderMaterial:be.isRawShaderMaterial===!0,glslVersion:be.glslVersion,precision:re,instancing:it,instancingColor:it&&he.instanceColor!==null,supportsVertexTextures:ee,outputEncoding:je===null?U.outputEncoding:je.isXRRenderTarget===!0?je.texture.encoding:LinearEncoding,map:ct,matcap:rt,envMap:ut,envMapMode:ut&&we.mapping,envMapCubeUVHeight:Pe,aoMap:We,lightMap:Re,bumpMap:Ue,normalMap:Le,displacementMap:ee&&Ge,emissiveMap:ke,normalMapObjectSpace:Le&&be.normalMapType===ObjectSpaceNormalMap,normalMapTangentSpace:Le&&be.normalMapType===TangentSpaceNormalMap,decodeVideoTexture:ct&&be.map.isVideoTexture===!0&&be.map.encoding===sRGBEncoding,metalnessMap:He,roughnessMap:Ke,clearcoat:$e,clearcoatMap:Ze,clearcoatNormalMap:at,clearcoatRoughnessMap:st,iridescence:Qe,iridescenceMap:Se,iridescenceThicknessMap:ce,sheen:Ne,sheenColorMap:de,sheenRoughnessMap:Ae,specularMap:Fe,specularColorMap:Ve,specularIntensityMap:Je,transmission:Ce,transmissionMap:dt,thicknessMap:St,gradientMap:Tt,opaque:be.transparent===!1&&be.blending===NormalBlending,alphaMap:At,alphaTest:wt,combine:be.combine,mapUv:ct&&le(be.map.channel),aoMapUv:We&&le(be.aoMap.channel),lightMapUv:Re&&le(be.lightMap.channel),bumpMapUv:Ue&&le(be.bumpMap.channel),normalMapUv:Le&&le(be.normalMap.channel),displacementMapUv:Ge&&le(be.displacementMap.channel),emissiveMapUv:ke&&le(be.emissiveMap.channel),metalnessMapUv:He&&le(be.metalnessMap.channel),roughnessMapUv:Ke&&le(be.roughnessMap.channel),clearcoatMapUv:Ze&&le(be.clearcoatMap.channel),clearcoatNormalMapUv:at&&le(be.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:st&&le(be.clearcoatRoughnessMap.channel),iridescenceMapUv:Se&&le(be.iridescenceMap.channel),iridescenceThicknessMapUv:ce&&le(be.iridescenceThicknessMap.channel),sheenColorMapUv:de&&le(be.sheenColorMap.channel),sheenRoughnessMapUv:Ae&&le(be.sheenRoughnessMap.channel),specularMapUv:Fe&&le(be.specularMap.channel),specularColorMapUv:Ve&&le(be.specularColorMap.channel),specularIntensityMapUv:Je&&le(be.specularIntensityMap.channel),transmissionMapUv:dt&&le(be.transmissionMap.channel),thicknessMapUv:St&&le(be.thicknessMap.channel),alphaMapUv:At&&le(be.alphaMap.channel),vertexTangents:Le&&!!me.attributes.tangent,vertexColors:be.vertexColors,vertexAlphas:be.vertexColors===!0&&!!me.attributes.color&&me.attributes.color.itemSize===4,vertexUvs2:pt,pointsUvs:he.isPoints===!0&&!!me.attributes.uv&&(ct||At),fog:!!oe,useFog:be.fog===!0,fogExp2:oe&&oe.isFogExp2,flatShading:be.flatShading===!0,sizeAttenuation:be.sizeAttenuation===!0,logarithmicDepthBuffer:Z,skinning:he.isSkinnedMesh===!0,morphTargets:me.morphAttributes.position!==void 0,morphNormals:me.morphAttributes.normal!==void 0,morphColors:me.morphAttributes.color!==void 0,morphTargetsCount:Oe,morphTextureStride:Ie,numDirLights:Te.directional.length,numPointLights:Te.point.length,numSpotLights:Te.spot.length,numSpotLightMaps:Te.spotLightMap.length,numRectAreaLights:Te.rectArea.length,numHemiLights:Te.hemi.length,numDirLightShadows:Te.directionalShadowMap.length,numPointLightShadows:Te.pointShadowMap.length,numSpotLightShadows:Te.spotShadowMap.length,numSpotLightShadowsWithMaps:Te.numSpotLightShadowsWithMaps,numClippingPlanes:q.numPlanes,numClipIntersection:q.numIntersection,dithering:be.dithering,shadowMapEnabled:U.shadowMap.enabled&&ye.length>0,shadowMapType:U.shadowMap.type,toneMapping:be.toneMapped?U.toneMapping:NoToneMapping,useLegacyLights:U.useLegacyLights,premultipliedAlpha:be.premultipliedAlpha,doubleSided:be.side===DoubleSide,flipSided:be.side===BackSide,useDepthPacking:be.depthPacking>=0,depthPacking:be.depthPacking||0,index0AttributeName:be.index0AttributeName,extensionDerivatives:ot&&be.extensions.derivatives===!0,extensionFragDepth:ot&&be.extensions.fragDepth===!0,extensionDrawBuffers:ot&&be.extensions.drawBuffers===!0,extensionShaderTextureLOD:ot&&be.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:te||G.has("EXT_frag_depth"),rendererExtensionDrawBuffers:te||G.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:te||G.has("EXT_shader_texture_lod"),customProgramCacheKey:be.customProgramCacheKey()}}function ie(be){const Te=[];if(be.shaderID?Te.push(be.shaderID):(Te.push(be.customVertexShaderID),Te.push(be.customFragmentShaderID)),be.defines!==void 0)for(const ye in be.defines)Te.push(ye),Te.push(be.defines[ye]);return be.isRawShaderMaterial===!1&&(ge(Te,be),fe(Te,be),Te.push(U.outputEncoding)),Te.push(be.customProgramCacheKey),Te.join()}function ge(be,Te){be.push(Te.precision),be.push(Te.outputEncoding),be.push(Te.envMapMode),be.push(Te.envMapCubeUVHeight),be.push(Te.mapUv),be.push(Te.alphaMapUv),be.push(Te.lightMapUv),be.push(Te.aoMapUv),be.push(Te.bumpMapUv),be.push(Te.normalMapUv),be.push(Te.displacementMapUv),be.push(Te.emissiveMapUv),be.push(Te.metalnessMapUv),be.push(Te.roughnessMapUv),be.push(Te.clearcoatMapUv),be.push(Te.clearcoatNormalMapUv),be.push(Te.clearcoatRoughnessMapUv),be.push(Te.iridescenceMapUv),be.push(Te.iridescenceThicknessMapUv),be.push(Te.sheenColorMapUv),be.push(Te.sheenRoughnessMapUv),be.push(Te.specularMapUv),be.push(Te.specularColorMapUv),be.push(Te.specularIntensityMapUv),be.push(Te.transmissionMapUv),be.push(Te.thicknessMapUv),be.push(Te.combine),be.push(Te.fogExp2),be.push(Te.sizeAttenuation),be.push(Te.morphTargetsCount),be.push(Te.morphAttributeCount),be.push(Te.numDirLights),be.push(Te.numPointLights),be.push(Te.numSpotLights),be.push(Te.numSpotLightMaps),be.push(Te.numHemiLights),be.push(Te.numRectAreaLights),be.push(Te.numDirLightShadows),be.push(Te.numPointLightShadows),be.push(Te.numSpotLightShadows),be.push(Te.numSpotLightShadowsWithMaps),be.push(Te.shadowMapType),be.push(Te.toneMapping),be.push(Te.numClippingPlanes),be.push(Te.numClipIntersection),be.push(Te.depthPacking)}function fe(be,Te){W.disableAll(),Te.isWebGL2&&W.enable(0),Te.supportsVertexTextures&&W.enable(1),Te.instancing&&W.enable(2),Te.instancingColor&&W.enable(3),Te.matcap&&W.enable(4),Te.envMap&&W.enable(5),Te.normalMapObjectSpace&&W.enable(6),Te.normalMapTangentSpace&&W.enable(7),Te.clearcoat&&W.enable(8),Te.iridescence&&W.enable(9),Te.alphaTest&&W.enable(10),Te.vertexColors&&W.enable(11),Te.vertexAlphas&&W.enable(12),Te.vertexUvs2&&W.enable(13),Te.vertexTangents&&W.enable(14),be.push(W.mask),W.disableAll(),Te.fog&&W.enable(0),Te.useFog&&W.enable(1),Te.flatShading&&W.enable(2),Te.logarithmicDepthBuffer&&W.enable(3),Te.skinning&&W.enable(4),Te.morphTargets&&W.enable(5),Te.morphNormals&&W.enable(6),Te.morphColors&&W.enable(7),Te.premultipliedAlpha&&W.enable(8),Te.shadowMapEnabled&&W.enable(9),Te.useLegacyLights&&W.enable(10),Te.doubleSided&&W.enable(11),Te.flipSided&&W.enable(12),Te.useDepthPacking&&W.enable(13),Te.dithering&&W.enable(14),Te.transmission&&W.enable(15),Te.sheen&&W.enable(16),Te.decodeVideoTexture&&W.enable(17),Te.opaque&&W.enable(18),Te.pointsUvs&&W.enable(19),be.push(W.mask)}function ae(be){const Te=ne[be.type];let ye;if(Te){const Ee=ShaderLib[Te];ye=UniformsUtils.clone(Ee.uniforms)}else ye=be.uniforms;return ye}function ue(be,Te){let ye;for(let Ee=0,he=J.length;Ee<he;Ee++){const oe=J[Ee];if(oe.cacheKey===Te){ye=oe,++ye.usedTimes;break}}return ye===void 0&&(ye=new WebGLProgram(U,Te,be,X),J.push(ye)),ye}function pe(be){if(--be.usedTimes===0){const Te=J.indexOf(be);J[Te]=J[J.length-1],J.pop(),be.destroy()}}function _e(be){Y.remove(be)}function xe(){Y.dispose()}return{getParameters:se,getProgramCacheKey:ie,getUniforms:ae,acquireProgram:ue,releaseProgram:pe,releaseShaderCache:_e,programs:J,dispose:xe}}function WebGLProperties(){let U=new WeakMap;function D(X){let q=U.get(X);return q===void 0&&(q={},U.set(X,q)),q}function F(X){U.delete(X)}function G(X,q,W){U.get(X)[q]=W}function Q(){U=new WeakMap}return{get:D,remove:F,update:G,dispose:Q}}function painterSortStable(U,D){return U.groupOrder!==D.groupOrder?U.groupOrder-D.groupOrder:U.renderOrder!==D.renderOrder?U.renderOrder-D.renderOrder:U.material.id!==D.material.id?U.material.id-D.material.id:U.z!==D.z?U.z-D.z:U.id-D.id}function reversePainterSortStable(U,D){return U.groupOrder!==D.groupOrder?U.groupOrder-D.groupOrder:U.renderOrder!==D.renderOrder?U.renderOrder-D.renderOrder:U.z!==D.z?D.z-U.z:U.id-D.id}function WebGLRenderList(){const U=[];let D=0;const F=[],G=[],Q=[];function X(){D=0,F.length=0,G.length=0,Q.length=0}function q(Z,ee,re,ne,le,se){let ie=U[D];return ie===void 0?(ie={id:Z.id,object:Z,geometry:ee,material:re,groupOrder:ne,renderOrder:Z.renderOrder,z:le,group:se},U[D]=ie):(ie.id=Z.id,ie.object=Z,ie.geometry=ee,ie.material=re,ie.groupOrder=ne,ie.renderOrder=Z.renderOrder,ie.z=le,ie.group=se),D++,ie}function W(Z,ee,re,ne,le,se){const ie=q(Z,ee,re,ne,le,se);re.transmission>0?G.push(ie):re.transparent===!0?Q.push(ie):F.push(ie)}function Y(Z,ee,re,ne,le,se){const ie=q(Z,ee,re,ne,le,se);re.transmission>0?G.unshift(ie):re.transparent===!0?Q.unshift(ie):F.unshift(ie)}function J(Z,ee){F.length>1&&F.sort(Z||painterSortStable),G.length>1&&G.sort(ee||reversePainterSortStable),Q.length>1&&Q.sort(ee||reversePainterSortStable)}function te(){for(let Z=D,ee=U.length;Z<ee;Z++){const re=U[Z];if(re.id===null)break;re.id=null,re.object=null,re.geometry=null,re.material=null,re.group=null}}return{opaque:F,transmissive:G,transparent:Q,init:X,push:W,unshift:Y,finish:te,sort:J}}function WebGLRenderLists(){let U=new WeakMap;function D(G,Q){const X=U.get(G);let q;return X===void 0?(q=new WebGLRenderList,U.set(G,[q])):Q>=X.length?(q=new WebGLRenderList,X.push(q)):q=X[Q],q}function F(){U=new WeakMap}return{get:D,dispose:F}}function UniformsCache(){const U={};return{get:function(D){if(U[D.id]!==void 0)return U[D.id];let F;switch(D.type){case"DirectionalLight":F={direction:new Vector3,color:new Color};break;case"SpotLight":F={position:new Vector3,direction:new Vector3,color:new Color,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":F={position:new Vector3,color:new Color,distance:0,decay:0};break;case"HemisphereLight":F={direction:new Vector3,skyColor:new Color,groundColor:new Color};break;case"RectAreaLight":F={color:new Color,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3};break}return U[D.id]=F,F}}}function ShadowUniformsCache(){const U={};return{get:function(D){if(U[D.id]!==void 0)return U[D.id];let F;switch(D.type){case"DirectionalLight":F={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":F={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":F={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break}return U[D.id]=F,F}}}let nextVersion=0;function shadowCastingAndTexturingLightsFirst(U,D){return(D.castShadow?2:0)-(U.castShadow?2:0)+(D.map?1:0)-(U.map?1:0)}function WebGLLights(U,D){const F=new UniformsCache,G=ShadowUniformsCache(),Q={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let te=0;te<9;te++)Q.probe.push(new Vector3);const X=new Vector3,q=new Matrix4,W=new Matrix4;function Y(te,Z){let ee=0,re=0,ne=0;for(let ye=0;ye<9;ye++)Q.probe[ye].set(0,0,0);let le=0,se=0,ie=0,ge=0,fe=0,ae=0,ue=0,pe=0,_e=0,xe=0;te.sort(shadowCastingAndTexturingLightsFirst);const be=Z===!0?Math.PI:1;for(let ye=0,Ee=te.length;ye<Ee;ye++){const he=te[ye],oe=he.color,me=he.intensity,ve=he.distance,we=he.shadow&&he.shadow.map?he.shadow.map.texture:null;if(he.isAmbientLight)ee+=oe.r*me*be,re+=oe.g*me*be,ne+=oe.b*me*be;else if(he.isLightProbe)for(let Pe=0;Pe<9;Pe++)Q.probe[Pe].addScaledVector(he.sh.coefficients[Pe],me);else if(he.isDirectionalLight){const Pe=F.get(he);if(Pe.color.copy(he.color).multiplyScalar(he.intensity*be),he.castShadow){const Me=he.shadow,De=G.get(he);De.shadowBias=Me.bias,De.shadowNormalBias=Me.normalBias,De.shadowRadius=Me.radius,De.shadowMapSize=Me.mapSize,Q.directionalShadow[le]=De,Q.directionalShadowMap[le]=we,Q.directionalShadowMatrix[le]=he.shadow.matrix,ae++}Q.directional[le]=Pe,le++}else if(he.isSpotLight){const Pe=F.get(he);Pe.position.setFromMatrixPosition(he.matrixWorld),Pe.color.copy(oe).multiplyScalar(me*be),Pe.distance=ve,Pe.coneCos=Math.cos(he.angle),Pe.penumbraCos=Math.cos(he.angle*(1-he.penumbra)),Pe.decay=he.decay,Q.spot[ie]=Pe;const Me=he.shadow;if(he.map&&(Q.spotLightMap[_e]=he.map,_e++,Me.updateMatrices(he),he.castShadow&&xe++),Q.spotLightMatrix[ie]=Me.matrix,he.castShadow){const De=G.get(he);De.shadowBias=Me.bias,De.shadowNormalBias=Me.normalBias,De.shadowRadius=Me.radius,De.shadowMapSize=Me.mapSize,Q.spotShadow[ie]=De,Q.spotShadowMap[ie]=we,pe++}ie++}else if(he.isRectAreaLight){const Pe=F.get(he);Pe.color.copy(oe).multiplyScalar(me),Pe.halfWidth.set(he.width*.5,0,0),Pe.halfHeight.set(0,he.height*.5,0),Q.rectArea[ge]=Pe,ge++}else if(he.isPointLight){const Pe=F.get(he);if(Pe.color.copy(he.color).multiplyScalar(he.intensity*be),Pe.distance=he.distance,Pe.decay=he.decay,he.castShadow){const Me=he.shadow,De=G.get(he);De.shadowBias=Me.bias,De.shadowNormalBias=Me.normalBias,De.shadowRadius=Me.radius,De.shadowMapSize=Me.mapSize,De.shadowCameraNear=Me.camera.near,De.shadowCameraFar=Me.camera.far,Q.pointShadow[se]=De,Q.pointShadowMap[se]=we,Q.pointShadowMatrix[se]=he.shadow.matrix,ue++}Q.point[se]=Pe,se++}else if(he.isHemisphereLight){const Pe=F.get(he);Pe.skyColor.copy(he.color).multiplyScalar(me*be),Pe.groundColor.copy(he.groundColor).multiplyScalar(me*be),Q.hemi[fe]=Pe,fe++}}ge>0&&(D.isWebGL2||U.has("OES_texture_float_linear")===!0?(Q.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,Q.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):U.has("OES_texture_half_float_linear")===!0?(Q.rectAreaLTC1=UniformsLib.LTC_HALF_1,Q.rectAreaLTC2=UniformsLib.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),Q.ambient[0]=ee,Q.ambient[1]=re,Q.ambient[2]=ne;const Te=Q.hash;(Te.directionalLength!==le||Te.pointLength!==se||Te.spotLength!==ie||Te.rectAreaLength!==ge||Te.hemiLength!==fe||Te.numDirectionalShadows!==ae||Te.numPointShadows!==ue||Te.numSpotShadows!==pe||Te.numSpotMaps!==_e)&&(Q.directional.length=le,Q.spot.length=ie,Q.rectArea.length=ge,Q.point.length=se,Q.hemi.length=fe,Q.directionalShadow.length=ae,Q.directionalShadowMap.length=ae,Q.pointShadow.length=ue,Q.pointShadowMap.length=ue,Q.spotShadow.length=pe,Q.spotShadowMap.length=pe,Q.directionalShadowMatrix.length=ae,Q.pointShadowMatrix.length=ue,Q.spotLightMatrix.length=pe+_e-xe,Q.spotLightMap.length=_e,Q.numSpotLightShadowsWithMaps=xe,Te.directionalLength=le,Te.pointLength=se,Te.spotLength=ie,Te.rectAreaLength=ge,Te.hemiLength=fe,Te.numDirectionalShadows=ae,Te.numPointShadows=ue,Te.numSpotShadows=pe,Te.numSpotMaps=_e,Q.version=nextVersion++)}function J(te,Z){let ee=0,re=0,ne=0,le=0,se=0;const ie=Z.matrixWorldInverse;for(let ge=0,fe=te.length;ge<fe;ge++){const ae=te[ge];if(ae.isDirectionalLight){const ue=Q.directional[ee];ue.direction.setFromMatrixPosition(ae.matrixWorld),X.setFromMatrixPosition(ae.target.matrixWorld),ue.direction.sub(X),ue.direction.transformDirection(ie),ee++}else if(ae.isSpotLight){const ue=Q.spot[ne];ue.position.setFromMatrixPosition(ae.matrixWorld),ue.position.applyMatrix4(ie),ue.direction.setFromMatrixPosition(ae.matrixWorld),X.setFromMatrixPosition(ae.target.matrixWorld),ue.direction.sub(X),ue.direction.transformDirection(ie),ne++}else if(ae.isRectAreaLight){const ue=Q.rectArea[le];ue.position.setFromMatrixPosition(ae.matrixWorld),ue.position.applyMatrix4(ie),W.identity(),q.copy(ae.matrixWorld),q.premultiply(ie),W.extractRotation(q),ue.halfWidth.set(ae.width*.5,0,0),ue.halfHeight.set(0,ae.height*.5,0),ue.halfWidth.applyMatrix4(W),ue.halfHeight.applyMatrix4(W),le++}else if(ae.isPointLight){const ue=Q.point[re];ue.position.setFromMatrixPosition(ae.matrixWorld),ue.position.applyMatrix4(ie),re++}else if(ae.isHemisphereLight){const ue=Q.hemi[se];ue.direction.setFromMatrixPosition(ae.matrixWorld),ue.direction.transformDirection(ie),se++}}}return{setup:Y,setupView:J,state:Q}}function WebGLRenderState(U,D){const F=new WebGLLights(U,D),G=[],Q=[];function X(){G.length=0,Q.length=0}function q(Z){G.push(Z)}function W(Z){Q.push(Z)}function Y(Z){F.setup(G,Z)}function J(Z){F.setupView(G,Z)}return{init:X,state:{lightsArray:G,shadowsArray:Q,lights:F},setupLights:Y,setupLightsView:J,pushLight:q,pushShadow:W}}function WebGLRenderStates(U,D){let F=new WeakMap;function G(X,q=0){const W=F.get(X);let Y;return W===void 0?(Y=new WebGLRenderState(U,D),F.set(X,[Y])):q>=W.length?(Y=new WebGLRenderState(U,D),W.push(Y)):Y=W[q],Y}function Q(){F=new WeakMap}return{get:G,dispose:Q}}class MeshDepthMaterial extends Material{constructor(D){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(D)}copy(D){return super.copy(D),this.depthPacking=D.depthPacking,this.map=D.map,this.alphaMap=D.alphaMap,this.displacementMap=D.displacementMap,this.displacementScale=D.displacementScale,this.displacementBias=D.displacementBias,this.wireframe=D.wireframe,this.wireframeLinewidth=D.wireframeLinewidth,this}}class MeshDistanceMaterial extends Material{constructor(D){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(D)}copy(D){return super.copy(D),this.map=D.map,this.alphaMap=D.alphaMap,this.displacementMap=D.displacementMap,this.displacementScale=D.displacementScale,this.displacementBias=D.displacementBias,this}}const vertex=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragment=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function WebGLShadowMap(U,D,F){let G=new Frustum;const Q=new Vector2,X=new Vector2,q=new Vector4,W=new MeshDepthMaterial({depthPacking:RGBADepthPacking}),Y=new MeshDistanceMaterial,J={},te=F.maxTextureSize,Z={[FrontSide]:BackSide,[BackSide]:FrontSide,[DoubleSide]:DoubleSide},ee=new ShaderMaterial({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:vertex,fragmentShader:fragment}),re=ee.clone();re.defines.HORIZONTAL_PASS=1;const ne=new BufferGeometry;ne.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const le=new Mesh(ne,ee),se=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap,this.render=function(ae,ue,pe){if(se.enabled===!1||se.autoUpdate===!1&&se.needsUpdate===!1||ae.length===0)return;const _e=U.getRenderTarget(),xe=U.getActiveCubeFace(),be=U.getActiveMipmapLevel(),Te=U.state;Te.setBlending(NoBlending),Te.buffers.color.setClear(1,1,1,1),Te.buffers.depth.setTest(!0),Te.setScissorTest(!1);for(let ye=0,Ee=ae.length;ye<Ee;ye++){const he=ae[ye],oe=he.shadow;if(oe===void 0){console.warn("THREE.WebGLShadowMap:",he,"has no shadow.");continue}if(oe.autoUpdate===!1&&oe.needsUpdate===!1)continue;Q.copy(oe.mapSize);const me=oe.getFrameExtents();if(Q.multiply(me),X.copy(oe.mapSize),(Q.x>te||Q.y>te)&&(Q.x>te&&(X.x=Math.floor(te/me.x),Q.x=X.x*me.x,oe.mapSize.x=X.x),Q.y>te&&(X.y=Math.floor(te/me.y),Q.y=X.y*me.y,oe.mapSize.y=X.y)),oe.map===null){const we=this.type!==VSMShadowMap?{minFilter:NearestFilter,magFilter:NearestFilter}:{};oe.map=new WebGLRenderTarget(Q.x,Q.y,we),oe.map.texture.name=he.name+".shadowMap",oe.camera.updateProjectionMatrix()}U.setRenderTarget(oe.map),U.clear();const ve=oe.getViewportCount();for(let we=0;we<ve;we++){const Pe=oe.getViewport(we);q.set(X.x*Pe.x,X.y*Pe.y,X.x*Pe.z,X.y*Pe.w),Te.viewport(q),oe.updateMatrices(he,we),G=oe.getFrustum(),fe(ue,pe,oe.camera,he,this.type)}oe.isPointLightShadow!==!0&&this.type===VSMShadowMap&&ie(oe,pe),oe.needsUpdate=!1}se.needsUpdate=!1,U.setRenderTarget(_e,xe,be)};function ie(ae,ue){const pe=D.update(le);ee.defines.VSM_SAMPLES!==ae.blurSamples&&(ee.defines.VSM_SAMPLES=ae.blurSamples,re.defines.VSM_SAMPLES=ae.blurSamples,ee.needsUpdate=!0,re.needsUpdate=!0),ae.mapPass===null&&(ae.mapPass=new WebGLRenderTarget(Q.x,Q.y)),ee.uniforms.shadow_pass.value=ae.map.texture,ee.uniforms.resolution.value=ae.mapSize,ee.uniforms.radius.value=ae.radius,U.setRenderTarget(ae.mapPass),U.clear(),U.renderBufferDirect(ue,null,pe,ee,le,null),re.uniforms.shadow_pass.value=ae.mapPass.texture,re.uniforms.resolution.value=ae.mapSize,re.uniforms.radius.value=ae.radius,U.setRenderTarget(ae.map),U.clear(),U.renderBufferDirect(ue,null,pe,re,le,null)}function ge(ae,ue,pe,_e){let xe=null;const be=pe.isPointLight===!0?ae.customDistanceMaterial:ae.customDepthMaterial;if(be!==void 0)xe=be;else if(xe=pe.isPointLight===!0?Y:W,U.localClippingEnabled&&ue.clipShadows===!0&&Array.isArray(ue.clippingPlanes)&&ue.clippingPlanes.length!==0||ue.displacementMap&&ue.displacementScale!==0||ue.alphaMap&&ue.alphaTest>0||ue.map&&ue.alphaTest>0){const Te=xe.uuid,ye=ue.uuid;let Ee=J[Te];Ee===void 0&&(Ee={},J[Te]=Ee);let he=Ee[ye];he===void 0&&(he=xe.clone(),Ee[ye]=he),xe=he}if(xe.visible=ue.visible,xe.wireframe=ue.wireframe,_e===VSMShadowMap?xe.side=ue.shadowSide!==null?ue.shadowSide:ue.side:xe.side=ue.shadowSide!==null?ue.shadowSide:Z[ue.side],xe.alphaMap=ue.alphaMap,xe.alphaTest=ue.alphaTest,xe.map=ue.map,xe.clipShadows=ue.clipShadows,xe.clippingPlanes=ue.clippingPlanes,xe.clipIntersection=ue.clipIntersection,xe.displacementMap=ue.displacementMap,xe.displacementScale=ue.displacementScale,xe.displacementBias=ue.displacementBias,xe.wireframeLinewidth=ue.wireframeLinewidth,xe.linewidth=ue.linewidth,pe.isPointLight===!0&&xe.isMeshDistanceMaterial===!0){const Te=U.properties.get(xe);Te.light=pe}return xe}function fe(ae,ue,pe,_e,xe){if(ae.visible===!1)return;if(ae.layers.test(ue.layers)&&(ae.isMesh||ae.isLine||ae.isPoints)&&(ae.castShadow||ae.receiveShadow&&xe===VSMShadowMap)&&(!ae.frustumCulled||G.intersectsObject(ae))){ae.modelViewMatrix.multiplyMatrices(pe.matrixWorldInverse,ae.matrixWorld);const ye=D.update(ae),Ee=ae.material;if(Array.isArray(Ee)){const he=ye.groups;for(let oe=0,me=he.length;oe<me;oe++){const ve=he[oe],we=Ee[ve.materialIndex];if(we&&we.visible){const Pe=ge(ae,we,_e,xe);U.renderBufferDirect(pe,null,ye,Pe,ae,ve)}}}else if(Ee.visible){const he=ge(ae,Ee,_e,xe);U.renderBufferDirect(pe,null,ye,he,ae,null)}}const Te=ae.children;for(let ye=0,Ee=Te.length;ye<Ee;ye++)fe(Te[ye],ue,pe,_e,xe)}}function WebGLState(U,D,F){const G=F.isWebGL2;function Q(){let ot=!1;const pt=new Vector4;let xt=null;const Mt=new Vector4(0,0,0,0);return{setMask:function(tt){xt!==tt&&!ot&&(U.colorMask(tt,tt,tt,tt),xt=tt)},setLocked:function(tt){ot=tt},setClear:function(tt,ht,Pt,Ct,kt){kt===!0&&(tt*=Ct,ht*=Ct,Pt*=Ct),pt.set(tt,ht,Pt,Ct),Mt.equals(pt)===!1&&(U.clearColor(tt,ht,Pt,Ct),Mt.copy(pt))},reset:function(){ot=!1,xt=null,Mt.set(-1,0,0,0)}}}function X(){let ot=!1,pt=null,xt=null,Mt=null;return{setTest:function(tt){tt?je(2929):it(2929)},setMask:function(tt){pt!==tt&&!ot&&(U.depthMask(tt),pt=tt)},setFunc:function(tt){if(xt!==tt){switch(tt){case NeverDepth:U.depthFunc(512);break;case AlwaysDepth:U.depthFunc(519);break;case LessDepth:U.depthFunc(513);break;case LessEqualDepth:U.depthFunc(515);break;case EqualDepth:U.depthFunc(514);break;case GreaterEqualDepth:U.depthFunc(518);break;case GreaterDepth:U.depthFunc(516);break;case NotEqualDepth:U.depthFunc(517);break;default:U.depthFunc(515)}xt=tt}},setLocked:function(tt){ot=tt},setClear:function(tt){Mt!==tt&&(U.clearDepth(tt),Mt=tt)},reset:function(){ot=!1,pt=null,xt=null,Mt=null}}}function q(){let ot=!1,pt=null,xt=null,Mt=null,tt=null,ht=null,Pt=null,Ct=null,kt=null;return{setTest:function(Qt){ot||(Qt?je(2960):it(2960))},setMask:function(Qt){pt!==Qt&&!ot&&(U.stencilMask(Qt),pt=Qt)},setFunc:function(Qt,tn,Xt){(xt!==Qt||Mt!==tn||tt!==Xt)&&(U.stencilFunc(Qt,tn,Xt),xt=Qt,Mt=tn,tt=Xt)},setOp:function(Qt,tn,Xt){(ht!==Qt||Pt!==tn||Ct!==Xt)&&(U.stencilOp(Qt,tn,Xt),ht=Qt,Pt=tn,Ct=Xt)},setLocked:function(Qt){ot=Qt},setClear:function(Qt){kt!==Qt&&(U.clearStencil(Qt),kt=Qt)},reset:function(){ot=!1,pt=null,xt=null,Mt=null,tt=null,ht=null,Pt=null,Ct=null,kt=null}}}const W=new Q,Y=new X,J=new q,te=new WeakMap,Z=new WeakMap;let ee={},re={},ne=new WeakMap,le=[],se=null,ie=!1,ge=null,fe=null,ae=null,ue=null,pe=null,_e=null,xe=null,be=!1,Te=null,ye=null,Ee=null,he=null,oe=null;const me=U.getParameter(35661);let ve=!1,we=0;const Pe=U.getParameter(7938);Pe.indexOf("WebGL")!==-1?(we=parseFloat(/^WebGL (\d)/.exec(Pe)[1]),ve=we>=1):Pe.indexOf("OpenGL ES")!==-1&&(we=parseFloat(/^OpenGL ES (\d)/.exec(Pe)[1]),ve=we>=2);let Me=null,De={};const Oe=U.getParameter(3088),Ie=U.getParameter(2978),Be=new Vector4().fromArray(Oe),ze=new Vector4().fromArray(Ie);function et(ot,pt,xt){const Mt=new Uint8Array(4),tt=U.createTexture();U.bindTexture(ot,tt),U.texParameteri(ot,10241,9728),U.texParameteri(ot,10240,9728);for(let ht=0;ht<xt;ht++)U.texImage2D(pt+ht,0,6408,1,1,0,6408,5121,Mt);return tt}const qe={};qe[3553]=et(3553,3553,1),qe[34067]=et(34067,34069,6),W.setClear(0,0,0,1),Y.setClear(1),J.setClear(0),je(2929),Y.setFunc(LessEqualDepth),Ge(!1),ke(CullFaceBack),je(2884),Ue(NoBlending);function je(ot){ee[ot]!==!0&&(U.enable(ot),ee[ot]=!0)}function it(ot){ee[ot]!==!1&&(U.disable(ot),ee[ot]=!1)}function ct(ot,pt){return re[ot]!==pt?(U.bindFramebuffer(ot,pt),re[ot]=pt,G&&(ot===36009&&(re[36160]=pt),ot===36160&&(re[36009]=pt)),!0):!1}function rt(ot,pt){let xt=le,Mt=!1;if(ot)if(xt=ne.get(pt),xt===void 0&&(xt=[],ne.set(pt,xt)),ot.isWebGLMultipleRenderTargets){const tt=ot.texture;if(xt.length!==tt.length||xt[0]!==36064){for(let ht=0,Pt=tt.length;ht<Pt;ht++)xt[ht]=36064+ht;xt.length=tt.length,Mt=!0}}else xt[0]!==36064&&(xt[0]=36064,Mt=!0);else xt[0]!==1029&&(xt[0]=1029,Mt=!0);Mt&&(F.isWebGL2?U.drawBuffers(xt):D.get("WEBGL_draw_buffers").drawBuffersWEBGL(xt))}function ut(ot){return se!==ot?(U.useProgram(ot),se=ot,!0):!1}const We={[AddEquation]:32774,[SubtractEquation]:32778,[ReverseSubtractEquation]:32779};if(G)We[MinEquation]=32775,We[MaxEquation]=32776;else{const ot=D.get("EXT_blend_minmax");ot!==null&&(We[MinEquation]=ot.MIN_EXT,We[MaxEquation]=ot.MAX_EXT)}const Re={[ZeroFactor]:0,[OneFactor]:1,[SrcColorFactor]:768,[SrcAlphaFactor]:770,[SrcAlphaSaturateFactor]:776,[DstColorFactor]:774,[DstAlphaFactor]:772,[OneMinusSrcColorFactor]:769,[OneMinusSrcAlphaFactor]:771,[OneMinusDstColorFactor]:775,[OneMinusDstAlphaFactor]:773};function Ue(ot,pt,xt,Mt,tt,ht,Pt,Ct){if(ot===NoBlending){ie===!0&&(it(3042),ie=!1);return}if(ie===!1&&(je(3042),ie=!0),ot!==CustomBlending){if(ot!==ge||Ct!==be){if((fe!==AddEquation||pe!==AddEquation)&&(U.blendEquation(32774),fe=AddEquation,pe=AddEquation),Ct)switch(ot){case NormalBlending:U.blendFuncSeparate(1,771,1,771);break;case AdditiveBlending:U.blendFunc(1,1);break;case SubtractiveBlending:U.blendFuncSeparate(0,769,0,1);break;case MultiplyBlending:U.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ot);break}else switch(ot){case NormalBlending:U.blendFuncSeparate(770,771,1,771);break;case AdditiveBlending:U.blendFunc(770,1);break;case SubtractiveBlending:U.blendFuncSeparate(0,769,0,1);break;case MultiplyBlending:U.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ot);break}ae=null,ue=null,_e=null,xe=null,ge=ot,be=Ct}return}tt=tt||pt,ht=ht||xt,Pt=Pt||Mt,(pt!==fe||tt!==pe)&&(U.blendEquationSeparate(We[pt],We[tt]),fe=pt,pe=tt),(xt!==ae||Mt!==ue||ht!==_e||Pt!==xe)&&(U.blendFuncSeparate(Re[xt],Re[Mt],Re[ht],Re[Pt]),ae=xt,ue=Mt,_e=ht,xe=Pt),ge=ot,be=!1}function Le(ot,pt){ot.side===DoubleSide?it(2884):je(2884);let xt=ot.side===BackSide;pt&&(xt=!xt),Ge(xt),ot.blending===NormalBlending&&ot.transparent===!1?Ue(NoBlending):Ue(ot.blending,ot.blendEquation,ot.blendSrc,ot.blendDst,ot.blendEquationAlpha,ot.blendSrcAlpha,ot.blendDstAlpha,ot.premultipliedAlpha),Y.setFunc(ot.depthFunc),Y.setTest(ot.depthTest),Y.setMask(ot.depthWrite),W.setMask(ot.colorWrite);const Mt=ot.stencilWrite;J.setTest(Mt),Mt&&(J.setMask(ot.stencilWriteMask),J.setFunc(ot.stencilFunc,ot.stencilRef,ot.stencilFuncMask),J.setOp(ot.stencilFail,ot.stencilZFail,ot.stencilZPass)),Ke(ot.polygonOffset,ot.polygonOffsetFactor,ot.polygonOffsetUnits),ot.alphaToCoverage===!0?je(32926):it(32926)}function Ge(ot){Te!==ot&&(ot?U.frontFace(2304):U.frontFace(2305),Te=ot)}function ke(ot){ot!==CullFaceNone?(je(2884),ot!==ye&&(ot===CullFaceBack?U.cullFace(1029):ot===CullFaceFront?U.cullFace(1028):U.cullFace(1032))):it(2884),ye=ot}function He(ot){ot!==Ee&&(ve&&U.lineWidth(ot),Ee=ot)}function Ke(ot,pt,xt){ot?(je(32823),(he!==pt||oe!==xt)&&(U.polygonOffset(pt,xt),he=pt,oe=xt)):it(32823)}function $e(ot){ot?je(3089):it(3089)}function Qe(ot){ot===void 0&&(ot=33984+me-1),Me!==ot&&(U.activeTexture(ot),Me=ot)}function Ne(ot,pt,xt){xt===void 0&&(Me===null?xt=33984+me-1:xt=Me);let Mt=De[xt];Mt===void 0&&(Mt={type:void 0,texture:void 0},De[xt]=Mt),(Mt.type!==ot||Mt.texture!==pt)&&(Me!==xt&&(U.activeTexture(xt),Me=xt),U.bindTexture(ot,pt||qe[ot]),Mt.type=ot,Mt.texture=pt)}function Ce(){const ot=De[Me];ot!==void 0&&ot.type!==void 0&&(U.bindTexture(ot.type,null),ot.type=void 0,ot.texture=void 0)}function Ze(){try{U.compressedTexImage2D.apply(U,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function at(){try{U.compressedTexImage3D.apply(U,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function st(){try{U.texSubImage2D.apply(U,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function Se(){try{U.texSubImage3D.apply(U,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function ce(){try{U.compressedTexSubImage2D.apply(U,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function de(){try{U.compressedTexSubImage3D.apply(U,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function Ae(){try{U.texStorage2D.apply(U,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function Fe(){try{U.texStorage3D.apply(U,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function Ve(){try{U.texImage2D.apply(U,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function Je(){try{U.texImage3D.apply(U,arguments)}catch(ot){console.error("THREE.WebGLState:",ot)}}function dt(ot){Be.equals(ot)===!1&&(U.scissor(ot.x,ot.y,ot.z,ot.w),Be.copy(ot))}function St(ot){ze.equals(ot)===!1&&(U.viewport(ot.x,ot.y,ot.z,ot.w),ze.copy(ot))}function Tt(ot,pt){let xt=Z.get(pt);xt===void 0&&(xt=new WeakMap,Z.set(pt,xt));let Mt=xt.get(ot);Mt===void 0&&(Mt=U.getUniformBlockIndex(pt,ot.name),xt.set(ot,Mt))}function At(ot,pt){const Mt=Z.get(pt).get(ot);te.get(pt)!==Mt&&(U.uniformBlockBinding(pt,Mt,ot.__bindingPointIndex),te.set(pt,Mt))}function wt(){U.disable(3042),U.disable(2884),U.disable(2929),U.disable(32823),U.disable(3089),U.disable(2960),U.disable(32926),U.blendEquation(32774),U.blendFunc(1,0),U.blendFuncSeparate(1,0,1,0),U.colorMask(!0,!0,!0,!0),U.clearColor(0,0,0,0),U.depthMask(!0),U.depthFunc(513),U.clearDepth(1),U.stencilMask(4294967295),U.stencilFunc(519,0,4294967295),U.stencilOp(7680,7680,7680),U.clearStencil(0),U.cullFace(1029),U.frontFace(2305),U.polygonOffset(0,0),U.activeTexture(33984),U.bindFramebuffer(36160,null),G===!0&&(U.bindFramebuffer(36009,null),U.bindFramebuffer(36008,null)),U.useProgram(null),U.lineWidth(1),U.scissor(0,0,U.canvas.width,U.canvas.height),U.viewport(0,0,U.canvas.width,U.canvas.height),ee={},Me=null,De={},re={},ne=new WeakMap,le=[],se=null,ie=!1,ge=null,fe=null,ae=null,ue=null,pe=null,_e=null,xe=null,be=!1,Te=null,ye=null,Ee=null,he=null,oe=null,Be.set(0,0,U.canvas.width,U.canvas.height),ze.set(0,0,U.canvas.width,U.canvas.height),W.reset(),Y.reset(),J.reset()}return{buffers:{color:W,depth:Y,stencil:J},enable:je,disable:it,bindFramebuffer:ct,drawBuffers:rt,useProgram:ut,setBlending:Ue,setMaterial:Le,setFlipSided:Ge,setCullFace:ke,setLineWidth:He,setPolygonOffset:Ke,setScissorTest:$e,activeTexture:Qe,bindTexture:Ne,unbindTexture:Ce,compressedTexImage2D:Ze,compressedTexImage3D:at,texImage2D:Ve,texImage3D:Je,updateUBOMapping:Tt,uniformBlockBinding:At,texStorage2D:Ae,texStorage3D:Fe,texSubImage2D:st,texSubImage3D:Se,compressedTexSubImage2D:ce,compressedTexSubImage3D:de,scissor:dt,viewport:St,reset:wt}}function WebGLTextures(U,D,F,G,Q,X,q){const W=Q.isWebGL2,Y=Q.maxTextures,J=Q.maxCubemapSize,te=Q.maxTextureSize,Z=Q.maxSamples,ee=D.has("WEBGL_multisampled_render_to_texture")?D.get("WEBGL_multisampled_render_to_texture"):null,re=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),ne=new WeakMap;let le;const se=new WeakMap;let ie=!1;try{ie=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function ge(Ne,Ce){return ie?new OffscreenCanvas(Ne,Ce):createElementNS("canvas")}function fe(Ne,Ce,Ze,at){let st=1;if((Ne.width>at||Ne.height>at)&&(st=at/Math.max(Ne.width,Ne.height)),st<1||Ce===!0)if(typeof HTMLImageElement<"u"&&Ne instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ne instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ne instanceof ImageBitmap){const Se=Ce?floorPowerOfTwo:Math.floor,ce=Se(st*Ne.width),de=Se(st*Ne.height);le===void 0&&(le=ge(ce,de));const Ae=Ze?ge(ce,de):le;return Ae.width=ce,Ae.height=de,Ae.getContext("2d").drawImage(Ne,0,0,ce,de),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ne.width+"x"+Ne.height+") to ("+ce+"x"+de+")."),Ae}else return"data"in Ne&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ne.width+"x"+Ne.height+")."),Ne;return Ne}function ae(Ne){return isPowerOfTwo(Ne.width)&&isPowerOfTwo(Ne.height)}function ue(Ne){return W?!1:Ne.wrapS!==ClampToEdgeWrapping||Ne.wrapT!==ClampToEdgeWrapping||Ne.minFilter!==NearestFilter&&Ne.minFilter!==LinearFilter}function pe(Ne,Ce){return Ne.generateMipmaps&&Ce&&Ne.minFilter!==NearestFilter&&Ne.minFilter!==LinearFilter}function _e(Ne){U.generateMipmap(Ne)}function xe(Ne,Ce,Ze,at,st=!1){if(W===!1)return Ce;if(Ne!==null){if(U[Ne]!==void 0)return U[Ne];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ne+"'")}let Se=Ce;return Ce===6403&&(Ze===5126&&(Se=33326),Ze===5131&&(Se=33325),Ze===5121&&(Se=33321)),Ce===33319&&(Ze===5126&&(Se=33328),Ze===5131&&(Se=33327),Ze===5121&&(Se=33323)),Ce===6408&&(Ze===5126&&(Se=34836),Ze===5131&&(Se=34842),Ze===5121&&(Se=at===sRGBEncoding&&st===!1?35907:32856),Ze===32819&&(Se=32854),Ze===32820&&(Se=32855)),(Se===33325||Se===33326||Se===33327||Se===33328||Se===34842||Se===34836)&&D.get("EXT_color_buffer_float"),Se}function be(Ne,Ce,Ze){return pe(Ne,Ze)===!0||Ne.isFramebufferTexture&&Ne.minFilter!==NearestFilter&&Ne.minFilter!==LinearFilter?Math.log2(Math.max(Ce.width,Ce.height))+1:Ne.mipmaps!==void 0&&Ne.mipmaps.length>0?Ne.mipmaps.length:Ne.isCompressedTexture&&Array.isArray(Ne.image)?Ce.mipmaps.length:1}function Te(Ne){return Ne===NearestFilter||Ne===NearestMipmapNearestFilter||Ne===NearestMipmapLinearFilter?9728:9729}function ye(Ne){const Ce=Ne.target;Ce.removeEventListener("dispose",ye),he(Ce),Ce.isVideoTexture&&ne.delete(Ce)}function Ee(Ne){const Ce=Ne.target;Ce.removeEventListener("dispose",Ee),me(Ce)}function he(Ne){const Ce=G.get(Ne);if(Ce.__webglInit===void 0)return;const Ze=Ne.source,at=se.get(Ze);if(at){const st=at[Ce.__cacheKey];st.usedTimes--,st.usedTimes===0&&oe(Ne),Object.keys(at).length===0&&se.delete(Ze)}G.remove(Ne)}function oe(Ne){const Ce=G.get(Ne);U.deleteTexture(Ce.__webglTexture);const Ze=Ne.source,at=se.get(Ze);delete at[Ce.__cacheKey],q.memory.textures--}function me(Ne){const Ce=Ne.texture,Ze=G.get(Ne),at=G.get(Ce);if(at.__webglTexture!==void 0&&(U.deleteTexture(at.__webglTexture),q.memory.textures--),Ne.depthTexture&&Ne.depthTexture.dispose(),Ne.isWebGLCubeRenderTarget)for(let st=0;st<6;st++)U.deleteFramebuffer(Ze.__webglFramebuffer[st]),Ze.__webglDepthbuffer&&U.deleteRenderbuffer(Ze.__webglDepthbuffer[st]);else{if(U.deleteFramebuffer(Ze.__webglFramebuffer),Ze.__webglDepthbuffer&&U.deleteRenderbuffer(Ze.__webglDepthbuffer),Ze.__webglMultisampledFramebuffer&&U.deleteFramebuffer(Ze.__webglMultisampledFramebuffer),Ze.__webglColorRenderbuffer)for(let st=0;st<Ze.__webglColorRenderbuffer.length;st++)Ze.__webglColorRenderbuffer[st]&&U.deleteRenderbuffer(Ze.__webglColorRenderbuffer[st]);Ze.__webglDepthRenderbuffer&&U.deleteRenderbuffer(Ze.__webglDepthRenderbuffer)}if(Ne.isWebGLMultipleRenderTargets)for(let st=0,Se=Ce.length;st<Se;st++){const ce=G.get(Ce[st]);ce.__webglTexture&&(U.deleteTexture(ce.__webglTexture),q.memory.textures--),G.remove(Ce[st])}G.remove(Ce),G.remove(Ne)}let ve=0;function we(){ve=0}function Pe(){const Ne=ve;return Ne>=Y&&console.warn("THREE.WebGLTextures: Trying to use "+Ne+" texture units while this GPU supports only "+Y),ve+=1,Ne}function Me(Ne){const Ce=[];return Ce.push(Ne.wrapS),Ce.push(Ne.wrapT),Ce.push(Ne.wrapR||0),Ce.push(Ne.magFilter),Ce.push(Ne.minFilter),Ce.push(Ne.anisotropy),Ce.push(Ne.internalFormat),Ce.push(Ne.format),Ce.push(Ne.type),Ce.push(Ne.generateMipmaps),Ce.push(Ne.premultiplyAlpha),Ce.push(Ne.flipY),Ce.push(Ne.unpackAlignment),Ce.push(Ne.encoding),Ce.join()}function De(Ne,Ce){const Ze=G.get(Ne);if(Ne.isVideoTexture&&$e(Ne),Ne.isRenderTargetTexture===!1&&Ne.version>0&&Ze.__version!==Ne.version){const at=Ne.image;if(at===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(at.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{it(Ze,Ne,Ce);return}}F.bindTexture(3553,Ze.__webglTexture,33984+Ce)}function Oe(Ne,Ce){const Ze=G.get(Ne);if(Ne.version>0&&Ze.__version!==Ne.version){it(Ze,Ne,Ce);return}F.bindTexture(35866,Ze.__webglTexture,33984+Ce)}function Ie(Ne,Ce){const Ze=G.get(Ne);if(Ne.version>0&&Ze.__version!==Ne.version){it(Ze,Ne,Ce);return}F.bindTexture(32879,Ze.__webglTexture,33984+Ce)}function Be(Ne,Ce){const Ze=G.get(Ne);if(Ne.version>0&&Ze.__version!==Ne.version){ct(Ze,Ne,Ce);return}F.bindTexture(34067,Ze.__webglTexture,33984+Ce)}const ze={[RepeatWrapping]:10497,[ClampToEdgeWrapping]:33071,[MirroredRepeatWrapping]:33648},et={[NearestFilter]:9728,[NearestMipmapNearestFilter]:9984,[NearestMipmapLinearFilter]:9986,[LinearFilter]:9729,[LinearMipmapNearestFilter]:9985,[LinearMipmapLinearFilter]:9987};function qe(Ne,Ce,Ze){if(Ze?(U.texParameteri(Ne,10242,ze[Ce.wrapS]),U.texParameteri(Ne,10243,ze[Ce.wrapT]),(Ne===32879||Ne===35866)&&U.texParameteri(Ne,32882,ze[Ce.wrapR]),U.texParameteri(Ne,10240,et[Ce.magFilter]),U.texParameteri(Ne,10241,et[Ce.minFilter])):(U.texParameteri(Ne,10242,33071),U.texParameteri(Ne,10243,33071),(Ne===32879||Ne===35866)&&U.texParameteri(Ne,32882,33071),(Ce.wrapS!==ClampToEdgeWrapping||Ce.wrapT!==ClampToEdgeWrapping)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),U.texParameteri(Ne,10240,Te(Ce.magFilter)),U.texParameteri(Ne,10241,Te(Ce.minFilter)),Ce.minFilter!==NearestFilter&&Ce.minFilter!==LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),D.has("EXT_texture_filter_anisotropic")===!0){const at=D.get("EXT_texture_filter_anisotropic");if(Ce.magFilter===NearestFilter||Ce.minFilter!==NearestMipmapLinearFilter&&Ce.minFilter!==LinearMipmapLinearFilter||Ce.type===FloatType&&D.has("OES_texture_float_linear")===!1||W===!1&&Ce.type===HalfFloatType&&D.has("OES_texture_half_float_linear")===!1)return;(Ce.anisotropy>1||G.get(Ce).__currentAnisotropy)&&(U.texParameterf(Ne,at.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Ce.anisotropy,Q.getMaxAnisotropy())),G.get(Ce).__currentAnisotropy=Ce.anisotropy)}}function je(Ne,Ce){let Ze=!1;Ne.__webglInit===void 0&&(Ne.__webglInit=!0,Ce.addEventListener("dispose",ye));const at=Ce.source;let st=se.get(at);st===void 0&&(st={},se.set(at,st));const Se=Me(Ce);if(Se!==Ne.__cacheKey){st[Se]===void 0&&(st[Se]={texture:U.createTexture(),usedTimes:0},q.memory.textures++,Ze=!0),st[Se].usedTimes++;const ce=st[Ne.__cacheKey];ce!==void 0&&(st[Ne.__cacheKey].usedTimes--,ce.usedTimes===0&&oe(Ce)),Ne.__cacheKey=Se,Ne.__webglTexture=st[Se].texture}return Ze}function it(Ne,Ce,Ze){let at=3553;(Ce.isDataArrayTexture||Ce.isCompressedArrayTexture)&&(at=35866),Ce.isData3DTexture&&(at=32879);const st=je(Ne,Ce),Se=Ce.source;F.bindTexture(at,Ne.__webglTexture,33984+Ze);const ce=G.get(Se);if(Se.version!==ce.__version||st===!0){F.activeTexture(33984+Ze),U.pixelStorei(37440,Ce.flipY),U.pixelStorei(37441,Ce.premultiplyAlpha),U.pixelStorei(3317,Ce.unpackAlignment),U.pixelStorei(37443,0);const de=ue(Ce)&&ae(Ce.image)===!1;let Ae=fe(Ce.image,de,!1,te);Ae=Qe(Ce,Ae);const Fe=ae(Ae)||W,Ve=X.convert(Ce.format,Ce.encoding);let Je=X.convert(Ce.type),dt=xe(Ce.internalFormat,Ve,Je,Ce.encoding,Ce.isVideoTexture);qe(at,Ce,Fe);let St;const Tt=Ce.mipmaps,At=W&&Ce.isVideoTexture!==!0,wt=ce.__version===void 0||st===!0,ot=be(Ce,Ae,Fe);if(Ce.isDepthTexture)dt=6402,W?Ce.type===FloatType?dt=36012:Ce.type===UnsignedIntType?dt=33190:Ce.type===UnsignedInt248Type?dt=35056:dt=33189:Ce.type===FloatType&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Ce.format===DepthFormat&&dt===6402&&Ce.type!==UnsignedShortType&&Ce.type!==UnsignedIntType&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Ce.type=UnsignedIntType,Je=X.convert(Ce.type)),Ce.format===DepthStencilFormat&&dt===6402&&(dt=34041,Ce.type!==UnsignedInt248Type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Ce.type=UnsignedInt248Type,Je=X.convert(Ce.type))),wt&&(At?F.texStorage2D(3553,1,dt,Ae.width,Ae.height):F.texImage2D(3553,0,dt,Ae.width,Ae.height,0,Ve,Je,null));else if(Ce.isDataTexture)if(Tt.length>0&&Fe){At&&wt&&F.texStorage2D(3553,ot,dt,Tt[0].width,Tt[0].height);for(let pt=0,xt=Tt.length;pt<xt;pt++)St=Tt[pt],At?F.texSubImage2D(3553,pt,0,0,St.width,St.height,Ve,Je,St.data):F.texImage2D(3553,pt,dt,St.width,St.height,0,Ve,Je,St.data);Ce.generateMipmaps=!1}else At?(wt&&F.texStorage2D(3553,ot,dt,Ae.width,Ae.height),F.texSubImage2D(3553,0,0,0,Ae.width,Ae.height,Ve,Je,Ae.data)):F.texImage2D(3553,0,dt,Ae.width,Ae.height,0,Ve,Je,Ae.data);else if(Ce.isCompressedTexture)if(Ce.isCompressedArrayTexture){At&&wt&&F.texStorage3D(35866,ot,dt,Tt[0].width,Tt[0].height,Ae.depth);for(let pt=0,xt=Tt.length;pt<xt;pt++)St=Tt[pt],Ce.format!==RGBAFormat?Ve!==null?At?F.compressedTexSubImage3D(35866,pt,0,0,0,St.width,St.height,Ae.depth,Ve,St.data,0,0):F.compressedTexImage3D(35866,pt,dt,St.width,St.height,Ae.depth,0,St.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):At?F.texSubImage3D(35866,pt,0,0,0,St.width,St.height,Ae.depth,Ve,Je,St.data):F.texImage3D(35866,pt,dt,St.width,St.height,Ae.depth,0,Ve,Je,St.data)}else{At&&wt&&F.texStorage2D(3553,ot,dt,Tt[0].width,Tt[0].height);for(let pt=0,xt=Tt.length;pt<xt;pt++)St=Tt[pt],Ce.format!==RGBAFormat?Ve!==null?At?F.compressedTexSubImage2D(3553,pt,0,0,St.width,St.height,Ve,St.data):F.compressedTexImage2D(3553,pt,dt,St.width,St.height,0,St.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):At?F.texSubImage2D(3553,pt,0,0,St.width,St.height,Ve,Je,St.data):F.texImage2D(3553,pt,dt,St.width,St.height,0,Ve,Je,St.data)}else if(Ce.isDataArrayTexture)At?(wt&&F.texStorage3D(35866,ot,dt,Ae.width,Ae.height,Ae.depth),F.texSubImage3D(35866,0,0,0,0,Ae.width,Ae.height,Ae.depth,Ve,Je,Ae.data)):F.texImage3D(35866,0,dt,Ae.width,Ae.height,Ae.depth,0,Ve,Je,Ae.data);else if(Ce.isData3DTexture)At?(wt&&F.texStorage3D(32879,ot,dt,Ae.width,Ae.height,Ae.depth),F.texSubImage3D(32879,0,0,0,0,Ae.width,Ae.height,Ae.depth,Ve,Je,Ae.data)):F.texImage3D(32879,0,dt,Ae.width,Ae.height,Ae.depth,0,Ve,Je,Ae.data);else if(Ce.isFramebufferTexture){if(wt)if(At)F.texStorage2D(3553,ot,dt,Ae.width,Ae.height);else{let pt=Ae.width,xt=Ae.height;for(let Mt=0;Mt<ot;Mt++)F.texImage2D(3553,Mt,dt,pt,xt,0,Ve,Je,null),pt>>=1,xt>>=1}}else if(Tt.length>0&&Fe){At&&wt&&F.texStorage2D(3553,ot,dt,Tt[0].width,Tt[0].height);for(let pt=0,xt=Tt.length;pt<xt;pt++)St=Tt[pt],At?F.texSubImage2D(3553,pt,0,0,Ve,Je,St):F.texImage2D(3553,pt,dt,Ve,Je,St);Ce.generateMipmaps=!1}else At?(wt&&F.texStorage2D(3553,ot,dt,Ae.width,Ae.height),F.texSubImage2D(3553,0,0,0,Ve,Je,Ae)):F.texImage2D(3553,0,dt,Ve,Je,Ae);pe(Ce,Fe)&&_e(at),ce.__version=Se.version,Ce.onUpdate&&Ce.onUpdate(Ce)}Ne.__version=Ce.version}function ct(Ne,Ce,Ze){if(Ce.image.length!==6)return;const at=je(Ne,Ce),st=Ce.source;F.bindTexture(34067,Ne.__webglTexture,33984+Ze);const Se=G.get(st);if(st.version!==Se.__version||at===!0){F.activeTexture(33984+Ze),U.pixelStorei(37440,Ce.flipY),U.pixelStorei(37441,Ce.premultiplyAlpha),U.pixelStorei(3317,Ce.unpackAlignment),U.pixelStorei(37443,0);const ce=Ce.isCompressedTexture||Ce.image[0].isCompressedTexture,de=Ce.image[0]&&Ce.image[0].isDataTexture,Ae=[];for(let pt=0;pt<6;pt++)!ce&&!de?Ae[pt]=fe(Ce.image[pt],!1,!0,J):Ae[pt]=de?Ce.image[pt].image:Ce.image[pt],Ae[pt]=Qe(Ce,Ae[pt]);const Fe=Ae[0],Ve=ae(Fe)||W,Je=X.convert(Ce.format,Ce.encoding),dt=X.convert(Ce.type),St=xe(Ce.internalFormat,Je,dt,Ce.encoding),Tt=W&&Ce.isVideoTexture!==!0,At=Se.__version===void 0||at===!0;let wt=be(Ce,Fe,Ve);qe(34067,Ce,Ve);let ot;if(ce){Tt&&At&&F.texStorage2D(34067,wt,St,Fe.width,Fe.height);for(let pt=0;pt<6;pt++){ot=Ae[pt].mipmaps;for(let xt=0;xt<ot.length;xt++){const Mt=ot[xt];Ce.format!==RGBAFormat?Je!==null?Tt?F.compressedTexSubImage2D(34069+pt,xt,0,0,Mt.width,Mt.height,Je,Mt.data):F.compressedTexImage2D(34069+pt,xt,St,Mt.width,Mt.height,0,Mt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Tt?F.texSubImage2D(34069+pt,xt,0,0,Mt.width,Mt.height,Je,dt,Mt.data):F.texImage2D(34069+pt,xt,St,Mt.width,Mt.height,0,Je,dt,Mt.data)}}}else{ot=Ce.mipmaps,Tt&&At&&(ot.length>0&&wt++,F.texStorage2D(34067,wt,St,Ae[0].width,Ae[0].height));for(let pt=0;pt<6;pt++)if(de){Tt?F.texSubImage2D(34069+pt,0,0,0,Ae[pt].width,Ae[pt].height,Je,dt,Ae[pt].data):F.texImage2D(34069+pt,0,St,Ae[pt].width,Ae[pt].height,0,Je,dt,Ae[pt].data);for(let xt=0;xt<ot.length;xt++){const tt=ot[xt].image[pt].image;Tt?F.texSubImage2D(34069+pt,xt+1,0,0,tt.width,tt.height,Je,dt,tt.data):F.texImage2D(34069+pt,xt+1,St,tt.width,tt.height,0,Je,dt,tt.data)}}else{Tt?F.texSubImage2D(34069+pt,0,0,0,Je,dt,Ae[pt]):F.texImage2D(34069+pt,0,St,Je,dt,Ae[pt]);for(let xt=0;xt<ot.length;xt++){const Mt=ot[xt];Tt?F.texSubImage2D(34069+pt,xt+1,0,0,Je,dt,Mt.image[pt]):F.texImage2D(34069+pt,xt+1,St,Je,dt,Mt.image[pt])}}}pe(Ce,Ve)&&_e(34067),Se.__version=st.version,Ce.onUpdate&&Ce.onUpdate(Ce)}Ne.__version=Ce.version}function rt(Ne,Ce,Ze,at,st){const Se=X.convert(Ze.format,Ze.encoding),ce=X.convert(Ze.type),de=xe(Ze.internalFormat,Se,ce,Ze.encoding);G.get(Ce).__hasExternalTextures||(st===32879||st===35866?F.texImage3D(st,0,de,Ce.width,Ce.height,Ce.depth,0,Se,ce,null):F.texImage2D(st,0,de,Ce.width,Ce.height,0,Se,ce,null)),F.bindFramebuffer(36160,Ne),Ke(Ce)?ee.framebufferTexture2DMultisampleEXT(36160,at,st,G.get(Ze).__webglTexture,0,He(Ce)):(st===3553||st>=34069&&st<=34074)&&U.framebufferTexture2D(36160,at,st,G.get(Ze).__webglTexture,0),F.bindFramebuffer(36160,null)}function ut(Ne,Ce,Ze){if(U.bindRenderbuffer(36161,Ne),Ce.depthBuffer&&!Ce.stencilBuffer){let at=33189;if(Ze||Ke(Ce)){const st=Ce.depthTexture;st&&st.isDepthTexture&&(st.type===FloatType?at=36012:st.type===UnsignedIntType&&(at=33190));const Se=He(Ce);Ke(Ce)?ee.renderbufferStorageMultisampleEXT(36161,Se,at,Ce.width,Ce.height):U.renderbufferStorageMultisample(36161,Se,at,Ce.width,Ce.height)}else U.renderbufferStorage(36161,at,Ce.width,Ce.height);U.framebufferRenderbuffer(36160,36096,36161,Ne)}else if(Ce.depthBuffer&&Ce.stencilBuffer){const at=He(Ce);Ze&&Ke(Ce)===!1?U.renderbufferStorageMultisample(36161,at,35056,Ce.width,Ce.height):Ke(Ce)?ee.renderbufferStorageMultisampleEXT(36161,at,35056,Ce.width,Ce.height):U.renderbufferStorage(36161,34041,Ce.width,Ce.height),U.framebufferRenderbuffer(36160,33306,36161,Ne)}else{const at=Ce.isWebGLMultipleRenderTargets===!0?Ce.texture:[Ce.texture];for(let st=0;st<at.length;st++){const Se=at[st],ce=X.convert(Se.format,Se.encoding),de=X.convert(Se.type),Ae=xe(Se.internalFormat,ce,de,Se.encoding),Fe=He(Ce);Ze&&Ke(Ce)===!1?U.renderbufferStorageMultisample(36161,Fe,Ae,Ce.width,Ce.height):Ke(Ce)?ee.renderbufferStorageMultisampleEXT(36161,Fe,Ae,Ce.width,Ce.height):U.renderbufferStorage(36161,Ae,Ce.width,Ce.height)}}U.bindRenderbuffer(36161,null)}function We(Ne,Ce){if(Ce&&Ce.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(F.bindFramebuffer(36160,Ne),!(Ce.depthTexture&&Ce.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!G.get(Ce.depthTexture).__webglTexture||Ce.depthTexture.image.width!==Ce.width||Ce.depthTexture.image.height!==Ce.height)&&(Ce.depthTexture.image.width=Ce.width,Ce.depthTexture.image.height=Ce.height,Ce.depthTexture.needsUpdate=!0),De(Ce.depthTexture,0);const at=G.get(Ce.depthTexture).__webglTexture,st=He(Ce);if(Ce.depthTexture.format===DepthFormat)Ke(Ce)?ee.framebufferTexture2DMultisampleEXT(36160,36096,3553,at,0,st):U.framebufferTexture2D(36160,36096,3553,at,0);else if(Ce.depthTexture.format===DepthStencilFormat)Ke(Ce)?ee.framebufferTexture2DMultisampleEXT(36160,33306,3553,at,0,st):U.framebufferTexture2D(36160,33306,3553,at,0);else throw new Error("Unknown depthTexture format")}function Re(Ne){const Ce=G.get(Ne),Ze=Ne.isWebGLCubeRenderTarget===!0;if(Ne.depthTexture&&!Ce.__autoAllocateDepthBuffer){if(Ze)throw new Error("target.depthTexture not supported in Cube render targets");We(Ce.__webglFramebuffer,Ne)}else if(Ze){Ce.__webglDepthbuffer=[];for(let at=0;at<6;at++)F.bindFramebuffer(36160,Ce.__webglFramebuffer[at]),Ce.__webglDepthbuffer[at]=U.createRenderbuffer(),ut(Ce.__webglDepthbuffer[at],Ne,!1)}else F.bindFramebuffer(36160,Ce.__webglFramebuffer),Ce.__webglDepthbuffer=U.createRenderbuffer(),ut(Ce.__webglDepthbuffer,Ne,!1);F.bindFramebuffer(36160,null)}function Ue(Ne,Ce,Ze){const at=G.get(Ne);Ce!==void 0&&rt(at.__webglFramebuffer,Ne,Ne.texture,36064,3553),Ze!==void 0&&Re(Ne)}function Le(Ne){const Ce=Ne.texture,Ze=G.get(Ne),at=G.get(Ce);Ne.addEventListener("dispose",Ee),Ne.isWebGLMultipleRenderTargets!==!0&&(at.__webglTexture===void 0&&(at.__webglTexture=U.createTexture()),at.__version=Ce.version,q.memory.textures++);const st=Ne.isWebGLCubeRenderTarget===!0,Se=Ne.isWebGLMultipleRenderTargets===!0,ce=ae(Ne)||W;if(st){Ze.__webglFramebuffer=[];for(let de=0;de<6;de++)Ze.__webglFramebuffer[de]=U.createFramebuffer()}else{if(Ze.__webglFramebuffer=U.createFramebuffer(),Se)if(Q.drawBuffers){const de=Ne.texture;for(let Ae=0,Fe=de.length;Ae<Fe;Ae++){const Ve=G.get(de[Ae]);Ve.__webglTexture===void 0&&(Ve.__webglTexture=U.createTexture(),q.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(W&&Ne.samples>0&&Ke(Ne)===!1){const de=Se?Ce:[Ce];Ze.__webglMultisampledFramebuffer=U.createFramebuffer(),Ze.__webglColorRenderbuffer=[],F.bindFramebuffer(36160,Ze.__webglMultisampledFramebuffer);for(let Ae=0;Ae<de.length;Ae++){const Fe=de[Ae];Ze.__webglColorRenderbuffer[Ae]=U.createRenderbuffer(),U.bindRenderbuffer(36161,Ze.__webglColorRenderbuffer[Ae]);const Ve=X.convert(Fe.format,Fe.encoding),Je=X.convert(Fe.type),dt=xe(Fe.internalFormat,Ve,Je,Fe.encoding,Ne.isXRRenderTarget===!0),St=He(Ne);U.renderbufferStorageMultisample(36161,St,dt,Ne.width,Ne.height),U.framebufferRenderbuffer(36160,36064+Ae,36161,Ze.__webglColorRenderbuffer[Ae])}U.bindRenderbuffer(36161,null),Ne.depthBuffer&&(Ze.__webglDepthRenderbuffer=U.createRenderbuffer(),ut(Ze.__webglDepthRenderbuffer,Ne,!0)),F.bindFramebuffer(36160,null)}}if(st){F.bindTexture(34067,at.__webglTexture),qe(34067,Ce,ce);for(let de=0;de<6;de++)rt(Ze.__webglFramebuffer[de],Ne,Ce,36064,34069+de);pe(Ce,ce)&&_e(34067),F.unbindTexture()}else if(Se){const de=Ne.texture;for(let Ae=0,Fe=de.length;Ae<Fe;Ae++){const Ve=de[Ae],Je=G.get(Ve);F.bindTexture(3553,Je.__webglTexture),qe(3553,Ve,ce),rt(Ze.__webglFramebuffer,Ne,Ve,36064+Ae,3553),pe(Ve,ce)&&_e(3553)}F.unbindTexture()}else{let de=3553;(Ne.isWebGL3DRenderTarget||Ne.isWebGLArrayRenderTarget)&&(W?de=Ne.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),F.bindTexture(de,at.__webglTexture),qe(de,Ce,ce),rt(Ze.__webglFramebuffer,Ne,Ce,36064,de),pe(Ce,ce)&&_e(de),F.unbindTexture()}Ne.depthBuffer&&Re(Ne)}function Ge(Ne){const Ce=ae(Ne)||W,Ze=Ne.isWebGLMultipleRenderTargets===!0?Ne.texture:[Ne.texture];for(let at=0,st=Ze.length;at<st;at++){const Se=Ze[at];if(pe(Se,Ce)){const ce=Ne.isWebGLCubeRenderTarget?34067:3553,de=G.get(Se).__webglTexture;F.bindTexture(ce,de),_e(ce),F.unbindTexture()}}}function ke(Ne){if(W&&Ne.samples>0&&Ke(Ne)===!1){const Ce=Ne.isWebGLMultipleRenderTargets?Ne.texture:[Ne.texture],Ze=Ne.width,at=Ne.height;let st=16384;const Se=[],ce=Ne.stencilBuffer?33306:36096,de=G.get(Ne),Ae=Ne.isWebGLMultipleRenderTargets===!0;if(Ae)for(let Fe=0;Fe<Ce.length;Fe++)F.bindFramebuffer(36160,de.__webglMultisampledFramebuffer),U.framebufferRenderbuffer(36160,36064+Fe,36161,null),F.bindFramebuffer(36160,de.__webglFramebuffer),U.framebufferTexture2D(36009,36064+Fe,3553,null,0);F.bindFramebuffer(36008,de.__webglMultisampledFramebuffer),F.bindFramebuffer(36009,de.__webglFramebuffer);for(let Fe=0;Fe<Ce.length;Fe++){Se.push(36064+Fe),Ne.depthBuffer&&Se.push(ce);const Ve=de.__ignoreDepthValues!==void 0?de.__ignoreDepthValues:!1;if(Ve===!1&&(Ne.depthBuffer&&(st|=256),Ne.stencilBuffer&&(st|=1024)),Ae&&U.framebufferRenderbuffer(36008,36064,36161,de.__webglColorRenderbuffer[Fe]),Ve===!0&&(U.invalidateFramebuffer(36008,[ce]),U.invalidateFramebuffer(36009,[ce])),Ae){const Je=G.get(Ce[Fe]).__webglTexture;U.framebufferTexture2D(36009,36064,3553,Je,0)}U.blitFramebuffer(0,0,Ze,at,0,0,Ze,at,st,9728),re&&U.invalidateFramebuffer(36008,Se)}if(F.bindFramebuffer(36008,null),F.bindFramebuffer(36009,null),Ae)for(let Fe=0;Fe<Ce.length;Fe++){F.bindFramebuffer(36160,de.__webglMultisampledFramebuffer),U.framebufferRenderbuffer(36160,36064+Fe,36161,de.__webglColorRenderbuffer[Fe]);const Ve=G.get(Ce[Fe]).__webglTexture;F.bindFramebuffer(36160,de.__webglFramebuffer),U.framebufferTexture2D(36009,36064+Fe,3553,Ve,0)}F.bindFramebuffer(36009,de.__webglMultisampledFramebuffer)}}function He(Ne){return Math.min(Z,Ne.samples)}function Ke(Ne){const Ce=G.get(Ne);return W&&Ne.samples>0&&D.has("WEBGL_multisampled_render_to_texture")===!0&&Ce.__useRenderToTexture!==!1}function $e(Ne){const Ce=q.render.frame;ne.get(Ne)!==Ce&&(ne.set(Ne,Ce),Ne.update())}function Qe(Ne,Ce){const Ze=Ne.encoding,at=Ne.format,st=Ne.type;return Ne.isCompressedTexture===!0||Ne.isVideoTexture===!0||Ne.format===_SRGBAFormat||Ze!==LinearEncoding&&(Ze===sRGBEncoding?W===!1?D.has("EXT_sRGB")===!0&&at===RGBAFormat?(Ne.format=_SRGBAFormat,Ne.minFilter=LinearFilter,Ne.generateMipmaps=!1):Ce=ImageUtils.sRGBToLinear(Ce):(at!==RGBAFormat||st!==UnsignedByteType)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",Ze)),Ce}this.allocateTextureUnit=Pe,this.resetTextureUnits=we,this.setTexture2D=De,this.setTexture2DArray=Oe,this.setTexture3D=Ie,this.setTextureCube=Be,this.rebindTextures=Ue,this.setupRenderTarget=Le,this.updateRenderTargetMipmap=Ge,this.updateMultisampleRenderTarget=ke,this.setupDepthRenderbuffer=Re,this.setupFrameBufferTexture=rt,this.useMultisampledRTT=Ke}function WebGLUtils(U,D,F){const G=F.isWebGL2;function Q(X,q=null){let W;if(X===UnsignedByteType)return 5121;if(X===UnsignedShort4444Type)return 32819;if(X===UnsignedShort5551Type)return 32820;if(X===ByteType)return 5120;if(X===ShortType)return 5122;if(X===UnsignedShortType)return 5123;if(X===IntType)return 5124;if(X===UnsignedIntType)return 5125;if(X===FloatType)return 5126;if(X===HalfFloatType)return G?5131:(W=D.get("OES_texture_half_float"),W!==null?W.HALF_FLOAT_OES:null);if(X===AlphaFormat)return 6406;if(X===RGBAFormat)return 6408;if(X===LuminanceFormat)return 6409;if(X===LuminanceAlphaFormat)return 6410;if(X===DepthFormat)return 6402;if(X===DepthStencilFormat)return 34041;if(X===_SRGBAFormat)return W=D.get("EXT_sRGB"),W!==null?W.SRGB_ALPHA_EXT:null;if(X===RedFormat)return 6403;if(X===RedIntegerFormat)return 36244;if(X===RGFormat)return 33319;if(X===RGIntegerFormat)return 33320;if(X===RGBAIntegerFormat)return 36249;if(X===RGB_S3TC_DXT1_Format||X===RGBA_S3TC_DXT1_Format||X===RGBA_S3TC_DXT3_Format||X===RGBA_S3TC_DXT5_Format)if(q===sRGBEncoding)if(W=D.get("WEBGL_compressed_texture_s3tc_srgb"),W!==null){if(X===RGB_S3TC_DXT1_Format)return W.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(X===RGBA_S3TC_DXT1_Format)return W.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(X===RGBA_S3TC_DXT3_Format)return W.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(X===RGBA_S3TC_DXT5_Format)return W.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(W=D.get("WEBGL_compressed_texture_s3tc"),W!==null){if(X===RGB_S3TC_DXT1_Format)return W.COMPRESSED_RGB_S3TC_DXT1_EXT;if(X===RGBA_S3TC_DXT1_Format)return W.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(X===RGBA_S3TC_DXT3_Format)return W.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(X===RGBA_S3TC_DXT5_Format)return W.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(X===RGB_PVRTC_4BPPV1_Format||X===RGB_PVRTC_2BPPV1_Format||X===RGBA_PVRTC_4BPPV1_Format||X===RGBA_PVRTC_2BPPV1_Format)if(W=D.get("WEBGL_compressed_texture_pvrtc"),W!==null){if(X===RGB_PVRTC_4BPPV1_Format)return W.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(X===RGB_PVRTC_2BPPV1_Format)return W.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(X===RGBA_PVRTC_4BPPV1_Format)return W.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(X===RGBA_PVRTC_2BPPV1_Format)return W.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(X===RGB_ETC1_Format)return W=D.get("WEBGL_compressed_texture_etc1"),W!==null?W.COMPRESSED_RGB_ETC1_WEBGL:null;if(X===RGB_ETC2_Format||X===RGBA_ETC2_EAC_Format)if(W=D.get("WEBGL_compressed_texture_etc"),W!==null){if(X===RGB_ETC2_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ETC2:W.COMPRESSED_RGB8_ETC2;if(X===RGBA_ETC2_EAC_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:W.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(X===RGBA_ASTC_4x4_Format||X===RGBA_ASTC_5x4_Format||X===RGBA_ASTC_5x5_Format||X===RGBA_ASTC_6x5_Format||X===RGBA_ASTC_6x6_Format||X===RGBA_ASTC_8x5_Format||X===RGBA_ASTC_8x6_Format||X===RGBA_ASTC_8x8_Format||X===RGBA_ASTC_10x5_Format||X===RGBA_ASTC_10x6_Format||X===RGBA_ASTC_10x8_Format||X===RGBA_ASTC_10x10_Format||X===RGBA_ASTC_12x10_Format||X===RGBA_ASTC_12x12_Format)if(W=D.get("WEBGL_compressed_texture_astc"),W!==null){if(X===RGBA_ASTC_4x4_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:W.COMPRESSED_RGBA_ASTC_4x4_KHR;if(X===RGBA_ASTC_5x4_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:W.COMPRESSED_RGBA_ASTC_5x4_KHR;if(X===RGBA_ASTC_5x5_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:W.COMPRESSED_RGBA_ASTC_5x5_KHR;if(X===RGBA_ASTC_6x5_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:W.COMPRESSED_RGBA_ASTC_6x5_KHR;if(X===RGBA_ASTC_6x6_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:W.COMPRESSED_RGBA_ASTC_6x6_KHR;if(X===RGBA_ASTC_8x5_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:W.COMPRESSED_RGBA_ASTC_8x5_KHR;if(X===RGBA_ASTC_8x6_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:W.COMPRESSED_RGBA_ASTC_8x6_KHR;if(X===RGBA_ASTC_8x8_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:W.COMPRESSED_RGBA_ASTC_8x8_KHR;if(X===RGBA_ASTC_10x5_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:W.COMPRESSED_RGBA_ASTC_10x5_KHR;if(X===RGBA_ASTC_10x6_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:W.COMPRESSED_RGBA_ASTC_10x6_KHR;if(X===RGBA_ASTC_10x8_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:W.COMPRESSED_RGBA_ASTC_10x8_KHR;if(X===RGBA_ASTC_10x10_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:W.COMPRESSED_RGBA_ASTC_10x10_KHR;if(X===RGBA_ASTC_12x10_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:W.COMPRESSED_RGBA_ASTC_12x10_KHR;if(X===RGBA_ASTC_12x12_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:W.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(X===RGBA_BPTC_Format)if(W=D.get("EXT_texture_compression_bptc"),W!==null){if(X===RGBA_BPTC_Format)return q===sRGBEncoding?W.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:W.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(X===RED_RGTC1_Format||X===SIGNED_RED_RGTC1_Format||X===RED_GREEN_RGTC2_Format||X===SIGNED_RED_GREEN_RGTC2_Format)if(W=D.get("EXT_texture_compression_rgtc"),W!==null){if(X===RGBA_BPTC_Format)return W.COMPRESSED_RED_RGTC1_EXT;if(X===SIGNED_RED_RGTC1_Format)return W.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(X===RED_GREEN_RGTC2_Format)return W.COMPRESSED_RED_GREEN_RGTC2_EXT;if(X===SIGNED_RED_GREEN_RGTC2_Format)return W.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return X===UnsignedInt248Type?G?34042:(W=D.get("WEBGL_depth_texture"),W!==null?W.UNSIGNED_INT_24_8_WEBGL:null):U[X]!==void 0?U[X]:null}return{convert:Q}}class ArrayCamera extends PerspectiveCamera{constructor(D=[]){super(),this.isArrayCamera=!0,this.cameras=D}}class Group extends Object3D{constructor(){super(),this.isGroup=!0,this.type="Group"}}const _moveEvent={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Group,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Group,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Group,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3),this._grip}dispatchEvent(D){return this._targetRay!==null&&this._targetRay.dispatchEvent(D),this._grip!==null&&this._grip.dispatchEvent(D),this._hand!==null&&this._hand.dispatchEvent(D),this}connect(D){if(D&&D.hand){const F=this._hand;if(F)for(const G of D.hand.values())this._getHandJoint(F,G)}return this.dispatchEvent({type:"connected",data:D}),this}disconnect(D){return this.dispatchEvent({type:"disconnected",data:D}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(D,F,G){let Q=null,X=null,q=null;const W=this._targetRay,Y=this._grip,J=this._hand;if(D&&F.session.visibilityState!=="visible-blurred"){if(J&&D.hand){q=!0;for(const le of D.hand.values()){const se=F.getJointPose(le,G),ie=this._getHandJoint(J,le);se!==null&&(ie.matrix.fromArray(se.transform.matrix),ie.matrix.decompose(ie.position,ie.rotation,ie.scale),ie.jointRadius=se.radius),ie.visible=se!==null}const te=J.joints["index-finger-tip"],Z=J.joints["thumb-tip"],ee=te.position.distanceTo(Z.position),re=.02,ne=.005;J.inputState.pinching&&ee>re+ne?(J.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:D.handedness,target:this})):!J.inputState.pinching&&ee<=re-ne&&(J.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:D.handedness,target:this}))}else Y!==null&&D.gripSpace&&(X=F.getPose(D.gripSpace,G),X!==null&&(Y.matrix.fromArray(X.transform.matrix),Y.matrix.decompose(Y.position,Y.rotation,Y.scale),X.linearVelocity?(Y.hasLinearVelocity=!0,Y.linearVelocity.copy(X.linearVelocity)):Y.hasLinearVelocity=!1,X.angularVelocity?(Y.hasAngularVelocity=!0,Y.angularVelocity.copy(X.angularVelocity)):Y.hasAngularVelocity=!1));W!==null&&(Q=F.getPose(D.targetRaySpace,G),Q===null&&X!==null&&(Q=X),Q!==null&&(W.matrix.fromArray(Q.transform.matrix),W.matrix.decompose(W.position,W.rotation,W.scale),Q.linearVelocity?(W.hasLinearVelocity=!0,W.linearVelocity.copy(Q.linearVelocity)):W.hasLinearVelocity=!1,Q.angularVelocity?(W.hasAngularVelocity=!0,W.angularVelocity.copy(Q.angularVelocity)):W.hasAngularVelocity=!1,this.dispatchEvent(_moveEvent)))}return W!==null&&(W.visible=Q!==null),Y!==null&&(Y.visible=X!==null),J!==null&&(J.visible=q!==null),this}_getHandJoint(D,F){if(D.joints[F.jointName]===void 0){const G=new Group;G.matrixAutoUpdate=!1,G.visible=!1,D.joints[F.jointName]=G,D.add(G)}return D.joints[F.jointName]}}class DepthTexture extends Texture{constructor(D,F,G,Q,X,q,W,Y,J,te){if(te=te!==void 0?te:DepthFormat,te!==DepthFormat&&te!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");G===void 0&&te===DepthFormat&&(G=UnsignedIntType),G===void 0&&te===DepthStencilFormat&&(G=UnsignedInt248Type),super(null,Q,X,q,W,Y,te,G,J),this.isDepthTexture=!0,this.image={width:D,height:F},this.magFilter=W!==void 0?W:NearestFilter,this.minFilter=Y!==void 0?Y:NearestFilter,this.flipY=!1,this.generateMipmaps=!1}}class WebXRManager extends EventDispatcher{constructor(D,F){super();const G=this;let Q=null,X=1,q=null,W="local-floor",Y=1,J=null,te=null,Z=null,ee=null,re=null,ne=null;const le=F.getContextAttributes();let se=null,ie=null;const ge=[],fe=[],ae=new Set,ue=new Map,pe=new PerspectiveCamera;pe.layers.enable(1),pe.viewport=new Vector4;const _e=new PerspectiveCamera;_e.layers.enable(2),_e.viewport=new Vector4;const xe=[pe,_e],be=new ArrayCamera;be.layers.enable(1),be.layers.enable(2);let Te=null,ye=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Be){let ze=ge[Be];return ze===void 0&&(ze=new WebXRController,ge[Be]=ze),ze.getTargetRaySpace()},this.getControllerGrip=function(Be){let ze=ge[Be];return ze===void 0&&(ze=new WebXRController,ge[Be]=ze),ze.getGripSpace()},this.getHand=function(Be){let ze=ge[Be];return ze===void 0&&(ze=new WebXRController,ge[Be]=ze),ze.getHandSpace()};function Ee(Be){const ze=fe.indexOf(Be.inputSource);if(ze===-1)return;const et=ge[ze];et!==void 0&&et.dispatchEvent({type:Be.type,data:Be.inputSource})}function he(){Q.removeEventListener("select",Ee),Q.removeEventListener("selectstart",Ee),Q.removeEventListener("selectend",Ee),Q.removeEventListener("squeeze",Ee),Q.removeEventListener("squeezestart",Ee),Q.removeEventListener("squeezeend",Ee),Q.removeEventListener("end",he),Q.removeEventListener("inputsourceschange",oe);for(let Be=0;Be<ge.length;Be++){const ze=fe[Be];ze!==null&&(fe[Be]=null,ge[Be].disconnect(ze))}Te=null,ye=null,D.setRenderTarget(se),re=null,ee=null,Z=null,Q=null,ie=null,Ie.stop(),G.isPresenting=!1,G.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Be){X=Be,G.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Be){W=Be,G.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return J||q},this.setReferenceSpace=function(Be){J=Be},this.getBaseLayer=function(){return ee!==null?ee:re},this.getBinding=function(){return Z},this.getFrame=function(){return ne},this.getSession=function(){return Q},this.setSession=async function(Be){if(Q=Be,Q!==null){if(se=D.getRenderTarget(),Q.addEventListener("select",Ee),Q.addEventListener("selectstart",Ee),Q.addEventListener("selectend",Ee),Q.addEventListener("squeeze",Ee),Q.addEventListener("squeezestart",Ee),Q.addEventListener("squeezeend",Ee),Q.addEventListener("end",he),Q.addEventListener("inputsourceschange",oe),le.xrCompatible!==!0&&await F.makeXRCompatible(),Q.renderState.layers===void 0||D.capabilities.isWebGL2===!1){const ze={antialias:Q.renderState.layers===void 0?le.antialias:!0,alpha:le.alpha,depth:le.depth,stencil:le.stencil,framebufferScaleFactor:X};re=new XRWebGLLayer(Q,F,ze),Q.updateRenderState({baseLayer:re}),ie=new WebGLRenderTarget(re.framebufferWidth,re.framebufferHeight,{format:RGBAFormat,type:UnsignedByteType,encoding:D.outputEncoding,stencilBuffer:le.stencil})}else{let ze=null,et=null,qe=null;le.depth&&(qe=le.stencil?35056:33190,ze=le.stencil?DepthStencilFormat:DepthFormat,et=le.stencil?UnsignedInt248Type:UnsignedIntType);const je={colorFormat:32856,depthFormat:qe,scaleFactor:X};Z=new XRWebGLBinding(Q,F),ee=Z.createProjectionLayer(je),Q.updateRenderState({layers:[ee]}),ie=new WebGLRenderTarget(ee.textureWidth,ee.textureHeight,{format:RGBAFormat,type:UnsignedByteType,depthTexture:new DepthTexture(ee.textureWidth,ee.textureHeight,et,void 0,void 0,void 0,void 0,void 0,void 0,ze),stencilBuffer:le.stencil,encoding:D.outputEncoding,samples:le.antialias?4:0});const it=D.properties.get(ie);it.__ignoreDepthValues=ee.ignoreDepthValues}ie.isXRRenderTarget=!0,this.setFoveation(Y),J=null,q=await Q.requestReferenceSpace(W),Ie.setContext(Q),Ie.start(),G.isPresenting=!0,G.dispatchEvent({type:"sessionstart"})}};function oe(Be){for(let ze=0;ze<Be.removed.length;ze++){const et=Be.removed[ze],qe=fe.indexOf(et);qe>=0&&(fe[qe]=null,ge[qe].disconnect(et))}for(let ze=0;ze<Be.added.length;ze++){const et=Be.added[ze];let qe=fe.indexOf(et);if(qe===-1){for(let it=0;it<ge.length;it++)if(it>=fe.length){fe.push(et),qe=it;break}else if(fe[it]===null){fe[it]=et,qe=it;break}if(qe===-1)break}const je=ge[qe];je&&je.connect(et)}}const me=new Vector3,ve=new Vector3;function we(Be,ze,et){me.setFromMatrixPosition(ze.matrixWorld),ve.setFromMatrixPosition(et.matrixWorld);const qe=me.distanceTo(ve),je=ze.projectionMatrix.elements,it=et.projectionMatrix.elements,ct=je[14]/(je[10]-1),rt=je[14]/(je[10]+1),ut=(je[9]+1)/je[5],We=(je[9]-1)/je[5],Re=(je[8]-1)/je[0],Ue=(it[8]+1)/it[0],Le=ct*Re,Ge=ct*Ue,ke=qe/(-Re+Ue),He=ke*-Re;ze.matrixWorld.decompose(Be.position,Be.quaternion,Be.scale),Be.translateX(He),Be.translateZ(ke),Be.matrixWorld.compose(Be.position,Be.quaternion,Be.scale),Be.matrixWorldInverse.copy(Be.matrixWorld).invert();const Ke=ct+ke,$e=rt+ke,Qe=Le-He,Ne=Ge+(qe-He),Ce=ut*rt/$e*Ke,Ze=We*rt/$e*Ke;Be.projectionMatrix.makePerspective(Qe,Ne,Ce,Ze,Ke,$e),Be.projectionMatrixInverse.copy(Be.projectionMatrix).invert()}function Pe(Be,ze){ze===null?Be.matrixWorld.copy(Be.matrix):Be.matrixWorld.multiplyMatrices(ze.matrixWorld,Be.matrix),Be.matrixWorldInverse.copy(Be.matrixWorld).invert()}this.updateCamera=function(Be){if(Q===null)return;be.near=_e.near=pe.near=Be.near,be.far=_e.far=pe.far=Be.far,(Te!==be.near||ye!==be.far)&&(Q.updateRenderState({depthNear:be.near,depthFar:be.far}),Te=be.near,ye=be.far);const ze=Be.parent,et=be.cameras;Pe(be,ze);for(let qe=0;qe<et.length;qe++)Pe(et[qe],ze);et.length===2?we(be,pe,_e):be.projectionMatrix.copy(pe.projectionMatrix),Me(Be,be,ze)};function Me(Be,ze,et){et===null?Be.matrix.copy(ze.matrixWorld):(Be.matrix.copy(et.matrixWorld),Be.matrix.invert(),Be.matrix.multiply(ze.matrixWorld)),Be.matrix.decompose(Be.position,Be.quaternion,Be.scale),Be.updateMatrixWorld(!0);const qe=Be.children;for(let je=0,it=qe.length;je<it;je++)qe[je].updateMatrixWorld(!0);Be.projectionMatrix.copy(ze.projectionMatrix),Be.projectionMatrixInverse.copy(ze.projectionMatrixInverse),Be.isPerspectiveCamera&&(Be.fov=RAD2DEG*2*Math.atan(1/Be.projectionMatrix.elements[5]),Be.zoom=1)}this.getCamera=function(){return be},this.getFoveation=function(){if(!(ee===null&&re===null))return Y},this.setFoveation=function(Be){Y=Be,ee!==null&&(ee.fixedFoveation=Be),re!==null&&re.fixedFoveation!==void 0&&(re.fixedFoveation=Be)},this.getPlanes=function(){return ae};let De=null;function Oe(Be,ze){if(te=ze.getViewerPose(J||q),ne=ze,te!==null){const et=te.views;re!==null&&(D.setRenderTargetFramebuffer(ie,re.framebuffer),D.setRenderTarget(ie));let qe=!1;et.length!==be.cameras.length&&(be.cameras.length=0,qe=!0);for(let je=0;je<et.length;je++){const it=et[je];let ct=null;if(re!==null)ct=re.getViewport(it);else{const ut=Z.getViewSubImage(ee,it);ct=ut.viewport,je===0&&(D.setRenderTargetTextures(ie,ut.colorTexture,ee.ignoreDepthValues?void 0:ut.depthStencilTexture),D.setRenderTarget(ie))}let rt=xe[je];rt===void 0&&(rt=new PerspectiveCamera,rt.layers.enable(je),rt.viewport=new Vector4,xe[je]=rt),rt.matrix.fromArray(it.transform.matrix),rt.matrix.decompose(rt.position,rt.quaternion,rt.scale),rt.projectionMatrix.fromArray(it.projectionMatrix),rt.projectionMatrixInverse.copy(rt.projectionMatrix).invert(),rt.viewport.set(ct.x,ct.y,ct.width,ct.height),je===0&&(be.matrix.copy(rt.matrix),be.matrix.decompose(be.position,be.quaternion,be.scale)),qe===!0&&be.cameras.push(rt)}}for(let et=0;et<ge.length;et++){const qe=fe[et],je=ge[et];qe!==null&&je!==void 0&&je.update(qe,ze,J||q)}if(De&&De(Be,ze),ze.detectedPlanes){G.dispatchEvent({type:"planesdetected",data:ze.detectedPlanes});let et=null;for(const qe of ae)ze.detectedPlanes.has(qe)||(et===null&&(et=[]),et.push(qe));if(et!==null)for(const qe of et)ae.delete(qe),ue.delete(qe),G.dispatchEvent({type:"planeremoved",data:qe});for(const qe of ze.detectedPlanes)if(!ae.has(qe))ae.add(qe),ue.set(qe,ze.lastChangedTime),G.dispatchEvent({type:"planeadded",data:qe});else{const je=ue.get(qe);qe.lastChangedTime>je&&(ue.set(qe,qe.lastChangedTime),G.dispatchEvent({type:"planechanged",data:qe}))}}ne=null}const Ie=new WebGLAnimation;Ie.setAnimationLoop(Oe),this.setAnimationLoop=function(Be){De=Be},this.dispose=function(){}}}function WebGLMaterials(U,D){function F(se,ie){se.matrixAutoUpdate===!0&&se.updateMatrix(),ie.value.copy(se.matrix)}function G(se,ie){ie.color.getRGB(se.fogColor.value,getUnlitUniformColorSpace(U)),ie.isFog?(se.fogNear.value=ie.near,se.fogFar.value=ie.far):ie.isFogExp2&&(se.fogDensity.value=ie.density)}function Q(se,ie,ge,fe,ae){ie.isMeshBasicMaterial||ie.isMeshLambertMaterial?X(se,ie):ie.isMeshToonMaterial?(X(se,ie),Z(se,ie)):ie.isMeshPhongMaterial?(X(se,ie),te(se,ie)):ie.isMeshStandardMaterial?(X(se,ie),ee(se,ie),ie.isMeshPhysicalMaterial&&re(se,ie,ae)):ie.isMeshMatcapMaterial?(X(se,ie),ne(se,ie)):ie.isMeshDepthMaterial?X(se,ie):ie.isMeshDistanceMaterial?(X(se,ie),le(se,ie)):ie.isMeshNormalMaterial?X(se,ie):ie.isLineBasicMaterial?(q(se,ie),ie.isLineDashedMaterial&&W(se,ie)):ie.isPointsMaterial?Y(se,ie,ge,fe):ie.isSpriteMaterial?J(se,ie):ie.isShadowMaterial?(se.color.value.copy(ie.color),se.opacity.value=ie.opacity):ie.isShaderMaterial&&(ie.uniformsNeedUpdate=!1)}function X(se,ie){se.opacity.value=ie.opacity,ie.color&&se.diffuse.value.copy(ie.color),ie.emissive&&se.emissive.value.copy(ie.emissive).multiplyScalar(ie.emissiveIntensity),ie.map&&(se.map.value=ie.map,F(ie.map,se.mapTransform)),ie.alphaMap&&(se.alphaMap.value=ie.alphaMap,F(ie.alphaMap,se.alphaMapTransform)),ie.bumpMap&&(se.bumpMap.value=ie.bumpMap,F(ie.bumpMap,se.bumpMapTransform),se.bumpScale.value=ie.bumpScale,ie.side===BackSide&&(se.bumpScale.value*=-1)),ie.normalMap&&(se.normalMap.value=ie.normalMap,F(ie.normalMap,se.normalMapTransform),se.normalScale.value.copy(ie.normalScale),ie.side===BackSide&&se.normalScale.value.negate()),ie.displacementMap&&(se.displacementMap.value=ie.displacementMap,F(ie.displacementMap,se.displacementMapTransform),se.displacementScale.value=ie.displacementScale,se.displacementBias.value=ie.displacementBias),ie.emissiveMap&&(se.emissiveMap.value=ie.emissiveMap,F(ie.emissiveMap,se.emissiveMapTransform)),ie.specularMap&&(se.specularMap.value=ie.specularMap,F(ie.specularMap,se.specularMapTransform)),ie.alphaTest>0&&(se.alphaTest.value=ie.alphaTest);const ge=D.get(ie).envMap;if(ge&&(se.envMap.value=ge,se.flipEnvMap.value=ge.isCubeTexture&&ge.isRenderTargetTexture===!1?-1:1,se.reflectivity.value=ie.reflectivity,se.ior.value=ie.ior,se.refractionRatio.value=ie.refractionRatio),ie.lightMap){se.lightMap.value=ie.lightMap;const fe=U.useLegacyLights===!0?Math.PI:1;se.lightMapIntensity.value=ie.lightMapIntensity*fe,F(ie.lightMap,se.lightMapTransform)}ie.aoMap&&(se.aoMap.value=ie.aoMap,se.aoMapIntensity.value=ie.aoMapIntensity,F(ie.aoMap,se.aoMapTransform))}function q(se,ie){se.diffuse.value.copy(ie.color),se.opacity.value=ie.opacity,ie.map&&(se.map.value=ie.map,F(ie.map,se.mapTransform))}function W(se,ie){se.dashSize.value=ie.dashSize,se.totalSize.value=ie.dashSize+ie.gapSize,se.scale.value=ie.scale}function Y(se,ie,ge,fe){se.diffuse.value.copy(ie.color),se.opacity.value=ie.opacity,se.size.value=ie.size*ge,se.scale.value=fe*.5,ie.map&&(se.map.value=ie.map,F(ie.map,se.uvTransform)),ie.alphaMap&&(se.alphaMap.value=ie.alphaMap),ie.alphaTest>0&&(se.alphaTest.value=ie.alphaTest)}function J(se,ie){se.diffuse.value.copy(ie.color),se.opacity.value=ie.opacity,se.rotation.value=ie.rotation,ie.map&&(se.map.value=ie.map,F(ie.map,se.mapTransform)),ie.alphaMap&&(se.alphaMap.value=ie.alphaMap),ie.alphaTest>0&&(se.alphaTest.value=ie.alphaTest)}function te(se,ie){se.specular.value.copy(ie.specular),se.shininess.value=Math.max(ie.shininess,1e-4)}function Z(se,ie){ie.gradientMap&&(se.gradientMap.value=ie.gradientMap)}function ee(se,ie){se.metalness.value=ie.metalness,ie.metalnessMap&&(se.metalnessMap.value=ie.metalnessMap,F(ie.metalnessMap,se.metalnessMapTransform)),se.roughness.value=ie.roughness,ie.roughnessMap&&(se.roughnessMap.value=ie.roughnessMap,F(ie.roughnessMap,se.roughnessMapTransform)),D.get(ie).envMap&&(se.envMapIntensity.value=ie.envMapIntensity)}function re(se,ie,ge){se.ior.value=ie.ior,ie.sheen>0&&(se.sheenColor.value.copy(ie.sheenColor).multiplyScalar(ie.sheen),se.sheenRoughness.value=ie.sheenRoughness,ie.sheenColorMap&&(se.sheenColorMap.value=ie.sheenColorMap,F(ie.sheenColorMap,se.sheenColorMapTransform)),ie.sheenRoughnessMap&&(se.sheenRoughnessMap.value=ie.sheenRoughnessMap,F(ie.sheenRoughnessMap,se.sheenRoughnessMapTransform))),ie.clearcoat>0&&(se.clearcoat.value=ie.clearcoat,se.clearcoatRoughness.value=ie.clearcoatRoughness,ie.clearcoatMap&&(se.clearcoatMap.value=ie.clearcoatMap,F(ie.clearcoatMap,se.clearcoatMapTransform)),ie.clearcoatRoughnessMap&&(se.clearcoatRoughnessMap.value=ie.clearcoatRoughnessMap,F(ie.clearcoatRoughnessMap,se.clearcoatRoughnessMapTransform)),ie.clearcoatNormalMap&&(se.clearcoatNormalMap.value=ie.clearcoatNormalMap,F(ie.clearcoatNormalMap,se.clearcoatNormalMapTransform),se.clearcoatNormalScale.value.copy(ie.clearcoatNormalScale),ie.side===BackSide&&se.clearcoatNormalScale.value.negate())),ie.iridescence>0&&(se.iridescence.value=ie.iridescence,se.iridescenceIOR.value=ie.iridescenceIOR,se.iridescenceThicknessMinimum.value=ie.iridescenceThicknessRange[0],se.iridescenceThicknessMaximum.value=ie.iridescenceThicknessRange[1],ie.iridescenceMap&&(se.iridescenceMap.value=ie.iridescenceMap,F(ie.iridescenceMap,se.iridescenceMapTransform)),ie.iridescenceThicknessMap&&(se.iridescenceThicknessMap.value=ie.iridescenceThicknessMap,F(ie.iridescenceThicknessMap,se.iridescenceThicknessMapTransform))),ie.transmission>0&&(se.transmission.value=ie.transmission,se.transmissionSamplerMap.value=ge.texture,se.transmissionSamplerSize.value.set(ge.width,ge.height),ie.transmissionMap&&(se.transmissionMap.value=ie.transmissionMap,F(ie.transmissionMap,se.transmissionMapTransform)),se.thickness.value=ie.thickness,ie.thicknessMap&&(se.thicknessMap.value=ie.thicknessMap,F(ie.thicknessMap,se.thicknessMapTransform)),se.attenuationDistance.value=ie.attenuationDistance,se.attenuationColor.value.copy(ie.attenuationColor)),se.specularIntensity.value=ie.specularIntensity,se.specularColor.value.copy(ie.specularColor),ie.specularColorMap&&(se.specularColorMap.value=ie.specularColorMap,F(ie.specularColorMap,se.specularColorMapTransform)),ie.specularIntensityMap&&(se.specularIntensityMap.value=ie.specularIntensityMap,F(ie.specularIntensityMap,se.specularIntensityMapTransform))}function ne(se,ie){ie.matcap&&(se.matcap.value=ie.matcap)}function le(se,ie){const ge=D.get(ie).light;se.referencePosition.value.setFromMatrixPosition(ge.matrixWorld),se.nearDistance.value=ge.shadow.camera.near,se.farDistance.value=ge.shadow.camera.far}return{refreshFogUniforms:G,refreshMaterialUniforms:Q}}function WebGLUniformsGroups(U,D,F,G){let Q={},X={},q=[];const W=F.isWebGL2?U.getParameter(35375):0;function Y(ge,fe){const ae=fe.program;G.uniformBlockBinding(ge,ae)}function J(ge,fe){let ae=Q[ge.id];ae===void 0&&(ne(ge),ae=te(ge),Q[ge.id]=ae,ge.addEventListener("dispose",se));const ue=fe.program;G.updateUBOMapping(ge,ue);const pe=D.render.frame;X[ge.id]!==pe&&(ee(ge),X[ge.id]=pe)}function te(ge){const fe=Z();ge.__bindingPointIndex=fe;const ae=U.createBuffer(),ue=ge.__size,pe=ge.usage;return U.bindBuffer(35345,ae),U.bufferData(35345,ue,pe),U.bindBuffer(35345,null),U.bindBufferBase(35345,fe,ae),ae}function Z(){for(let ge=0;ge<W;ge++)if(q.indexOf(ge)===-1)return q.push(ge),ge;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function ee(ge){const fe=Q[ge.id],ae=ge.uniforms,ue=ge.__cache;U.bindBuffer(35345,fe);for(let pe=0,_e=ae.length;pe<_e;pe++){const xe=ae[pe];if(re(xe,pe,ue)===!0){const be=xe.__offset,Te=Array.isArray(xe.value)?xe.value:[xe.value];let ye=0;for(let Ee=0;Ee<Te.length;Ee++){const he=Te[Ee],oe=le(he);typeof he=="number"?(xe.__data[0]=he,U.bufferSubData(35345,be+ye,xe.__data)):he.isMatrix3?(xe.__data[0]=he.elements[0],xe.__data[1]=he.elements[1],xe.__data[2]=he.elements[2],xe.__data[3]=he.elements[0],xe.__data[4]=he.elements[3],xe.__data[5]=he.elements[4],xe.__data[6]=he.elements[5],xe.__data[7]=he.elements[0],xe.__data[8]=he.elements[6],xe.__data[9]=he.elements[7],xe.__data[10]=he.elements[8],xe.__data[11]=he.elements[0]):(he.toArray(xe.__data,ye),ye+=oe.storage/Float32Array.BYTES_PER_ELEMENT)}U.bufferSubData(35345,be,xe.__data)}}U.bindBuffer(35345,null)}function re(ge,fe,ae){const ue=ge.value;if(ae[fe]===void 0){if(typeof ue=="number")ae[fe]=ue;else{const pe=Array.isArray(ue)?ue:[ue],_e=[];for(let xe=0;xe<pe.length;xe++)_e.push(pe[xe].clone());ae[fe]=_e}return!0}else if(typeof ue=="number"){if(ae[fe]!==ue)return ae[fe]=ue,!0}else{const pe=Array.isArray(ae[fe])?ae[fe]:[ae[fe]],_e=Array.isArray(ue)?ue:[ue];for(let xe=0;xe<pe.length;xe++){const be=pe[xe];if(be.equals(_e[xe])===!1)return be.copy(_e[xe]),!0}}return!1}function ne(ge){const fe=ge.uniforms;let ae=0;const ue=16;let pe=0;for(let _e=0,xe=fe.length;_e<xe;_e++){const be=fe[_e],Te={boundary:0,storage:0},ye=Array.isArray(be.value)?be.value:[be.value];for(let Ee=0,he=ye.length;Ee<he;Ee++){const oe=ye[Ee],me=le(oe);Te.boundary+=me.boundary,Te.storage+=me.storage}if(be.__data=new Float32Array(Te.storage/Float32Array.BYTES_PER_ELEMENT),be.__offset=ae,_e>0){pe=ae%ue;const Ee=ue-pe;pe!==0&&Ee-Te.boundary<0&&(ae+=ue-pe,be.__offset=ae)}ae+=Te.storage}return pe=ae%ue,pe>0&&(ae+=ue-pe),ge.__size=ae,ge.__cache={},this}function le(ge){const fe={boundary:0,storage:0};return typeof ge=="number"?(fe.boundary=4,fe.storage=4):ge.isVector2?(fe.boundary=8,fe.storage=8):ge.isVector3||ge.isColor?(fe.boundary=16,fe.storage=12):ge.isVector4?(fe.boundary=16,fe.storage=16):ge.isMatrix3?(fe.boundary=48,fe.storage=48):ge.isMatrix4?(fe.boundary=64,fe.storage=64):ge.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",ge),fe}function se(ge){const fe=ge.target;fe.removeEventListener("dispose",se);const ae=q.indexOf(fe.__bindingPointIndex);q.splice(ae,1),U.deleteBuffer(Q[fe.id]),delete Q[fe.id],delete X[fe.id]}function ie(){for(const ge in Q)U.deleteBuffer(Q[ge]);q=[],Q={},X={}}return{bind:Y,update:J,dispose:ie}}function createCanvasElement(){const U=createElementNS("canvas");return U.style.display="block",U}class WebGLRenderer{constructor(D={}){const{canvas:F=createCanvasElement(),context:G=null,depth:Q=!0,stencil:X=!0,alpha:q=!1,antialias:W=!1,premultipliedAlpha:Y=!0,preserveDrawingBuffer:J=!1,powerPreference:te="default",failIfMajorPerformanceCaveat:Z=!1}=D;this.isWebGLRenderer=!0;let ee;G!==null?ee=G.getContextAttributes().alpha:ee=q;let re=null,ne=null;const le=[],se=[];this.domElement=F,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=LinearEncoding,this.useLegacyLights=!0,this.toneMapping=NoToneMapping,this.toneMappingExposure=1;const ie=this;let ge=!1,fe=0,ae=0,ue=null,pe=-1,_e=null;const xe=new Vector4,be=new Vector4;let Te=null,ye=F.width,Ee=F.height,he=1,oe=null,me=null;const ve=new Vector4(0,0,ye,Ee),we=new Vector4(0,0,ye,Ee);let Pe=!1;const Me=new Frustum;let De=!1,Oe=!1,Ie=null;const Be=new Matrix4,ze=new Vector3,et={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function qe(){return ue===null?he:1}let je=G;function it(nt,mt){for(let yt=0;yt<nt.length;yt++){const ft=nt[yt],_t=F.getContext(ft,mt);if(_t!==null)return _t}return null}try{const nt={alpha:!0,depth:Q,stencil:X,antialias:W,premultipliedAlpha:Y,preserveDrawingBuffer:J,powerPreference:te,failIfMajorPerformanceCaveat:Z};if("setAttribute"in F&&F.setAttribute("data-engine",`three.js r${REVISION}`),F.addEventListener("webglcontextlost",St,!1),F.addEventListener("webglcontextrestored",Tt,!1),F.addEventListener("webglcontextcreationerror",At,!1),je===null){const mt=["webgl2","webgl","experimental-webgl"];if(ie.isWebGL1Renderer===!0&&mt.shift(),je=it(mt,nt),je===null)throw it(mt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}je.getShaderPrecisionFormat===void 0&&(je.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(nt){throw console.error("THREE.WebGLRenderer: "+nt.message),nt}let ct,rt,ut,We,Re,Ue,Le,Ge,ke,He,Ke,$e,Qe,Ne,Ce,Ze,at,st,Se,ce,de,Ae,Fe,Ve;function Je(){ct=new WebGLExtensions(je),rt=new WebGLCapabilities(je,ct,D),ct.init(rt),Ae=new WebGLUtils(je,ct,rt),ut=new WebGLState(je,ct,rt),We=new WebGLInfo,Re=new WebGLProperties,Ue=new WebGLTextures(je,ct,ut,Re,rt,Ae,We),Le=new WebGLCubeMaps(ie),Ge=new WebGLCubeUVMaps(ie),ke=new WebGLAttributes(je,rt),Fe=new WebGLBindingStates(je,ct,ke,rt),He=new WebGLGeometries(je,ke,We,Fe),Ke=new WebGLObjects(je,He,ke,We),Se=new WebGLMorphtargets(je,rt,Ue),Ze=new WebGLClipping(Re),$e=new WebGLPrograms(ie,Le,Ge,ct,rt,Fe,Ze),Qe=new WebGLMaterials(ie,Re),Ne=new WebGLRenderLists,Ce=new WebGLRenderStates(ct,rt),st=new WebGLBackground(ie,Le,Ge,ut,Ke,ee,Y),at=new WebGLShadowMap(ie,Ke,rt),Ve=new WebGLUniformsGroups(je,We,rt,ut),ce=new WebGLBufferRenderer(je,ct,We,rt),de=new WebGLIndexedBufferRenderer(je,ct,We,rt),We.programs=$e.programs,ie.capabilities=rt,ie.extensions=ct,ie.properties=Re,ie.renderLists=Ne,ie.shadowMap=at,ie.state=ut,ie.info=We}Je();const dt=new WebXRManager(ie,je);this.xr=dt,this.getContext=function(){return je},this.getContextAttributes=function(){return je.getContextAttributes()},this.forceContextLoss=function(){const nt=ct.get("WEBGL_lose_context");nt&&nt.loseContext()},this.forceContextRestore=function(){const nt=ct.get("WEBGL_lose_context");nt&&nt.restoreContext()},this.getPixelRatio=function(){return he},this.setPixelRatio=function(nt){nt!==void 0&&(he=nt,this.setSize(ye,Ee,!1))},this.getSize=function(nt){return nt.set(ye,Ee)},this.setSize=function(nt,mt,yt=!0){if(dt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ye=nt,Ee=mt,F.width=Math.floor(nt*he),F.height=Math.floor(mt*he),yt===!0&&(F.style.width=nt+"px",F.style.height=mt+"px"),this.setViewport(0,0,nt,mt)},this.getDrawingBufferSize=function(nt){return nt.set(ye*he,Ee*he).floor()},this.setDrawingBufferSize=function(nt,mt,yt){ye=nt,Ee=mt,he=yt,F.width=Math.floor(nt*yt),F.height=Math.floor(mt*yt),this.setViewport(0,0,nt,mt)},this.getCurrentViewport=function(nt){return nt.copy(xe)},this.getViewport=function(nt){return nt.copy(ve)},this.setViewport=function(nt,mt,yt,ft){nt.isVector4?ve.set(nt.x,nt.y,nt.z,nt.w):ve.set(nt,mt,yt,ft),ut.viewport(xe.copy(ve).multiplyScalar(he).floor())},this.getScissor=function(nt){return nt.copy(we)},this.setScissor=function(nt,mt,yt,ft){nt.isVector4?we.set(nt.x,nt.y,nt.z,nt.w):we.set(nt,mt,yt,ft),ut.scissor(be.copy(we).multiplyScalar(he).floor())},this.getScissorTest=function(){return Pe},this.setScissorTest=function(nt){ut.setScissorTest(Pe=nt)},this.setOpaqueSort=function(nt){oe=nt},this.setTransparentSort=function(nt){me=nt},this.getClearColor=function(nt){return nt.copy(st.getClearColor())},this.setClearColor=function(){st.setClearColor.apply(st,arguments)},this.getClearAlpha=function(){return st.getClearAlpha()},this.setClearAlpha=function(){st.setClearAlpha.apply(st,arguments)},this.clear=function(nt=!0,mt=!0,yt=!0){let ft=0;nt&&(ft|=16384),mt&&(ft|=256),yt&&(ft|=1024),je.clear(ft)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){F.removeEventListener("webglcontextlost",St,!1),F.removeEventListener("webglcontextrestored",Tt,!1),F.removeEventListener("webglcontextcreationerror",At,!1),Ne.dispose(),Ce.dispose(),Re.dispose(),Le.dispose(),Ge.dispose(),Ke.dispose(),Fe.dispose(),Ve.dispose(),$e.dispose(),dt.dispose(),dt.removeEventListener("sessionstart",tt),dt.removeEventListener("sessionend",ht),Ie&&(Ie.dispose(),Ie=null),Pt.stop()};function St(nt){nt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),ge=!0}function Tt(){console.log("THREE.WebGLRenderer: Context Restored."),ge=!1;const nt=We.autoReset,mt=at.enabled,yt=at.autoUpdate,ft=at.needsUpdate,_t=at.type;Je(),We.autoReset=nt,at.enabled=mt,at.autoUpdate=yt,at.needsUpdate=ft,at.type=_t}function At(nt){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",nt.statusMessage)}function wt(nt){const mt=nt.target;mt.removeEventListener("dispose",wt),ot(mt)}function ot(nt){pt(nt),Re.remove(nt)}function pt(nt){const mt=Re.get(nt).programs;mt!==void 0&&(mt.forEach(function(yt){$e.releaseProgram(yt)}),nt.isShaderMaterial&&$e.releaseShaderCache(nt))}this.renderBufferDirect=function(nt,mt,yt,ft,_t,Rt){mt===null&&(mt=et);const Nt=_t.isMesh&&_t.matrixWorld.determinant()<0,It=bn(nt,mt,yt,ft,_t);ut.setMaterial(ft,Nt);let Bt=yt.index,Vt=1;ft.wireframe===!0&&(Bt=He.getWireframeAttribute(yt),Vt=2);const Lt=yt.drawRange,jt=yt.attributes.position;let Ht=Lt.start*Vt,cn=(Lt.start+Lt.count)*Vt;Rt!==null&&(Ht=Math.max(Ht,Rt.start*Vt),cn=Math.min(cn,(Rt.start+Rt.count)*Vt)),Bt!==null?(Ht=Math.max(Ht,0),cn=Math.min(cn,Bt.count)):jt!=null&&(Ht=Math.max(Ht,0),cn=Math.min(cn,jt.count));const pn=cn-Ht;if(pn<0||pn===1/0)return;Fe.setup(_t,ft,It,yt,Bt);let Sn,qt=ce;if(Bt!==null&&(Sn=ke.get(Bt),qt=de,qt.setIndex(Sn)),_t.isMesh)ft.wireframe===!0?(ut.setLineWidth(ft.wireframeLinewidth*qe()),qt.setMode(1)):qt.setMode(4);else if(_t.isLine){let Ut=ft.linewidth;Ut===void 0&&(Ut=1),ut.setLineWidth(Ut*qe()),_t.isLineSegments?qt.setMode(1):_t.isLineLoop?qt.setMode(2):qt.setMode(3)}else _t.isPoints?qt.setMode(0):_t.isSprite&&qt.setMode(4);if(_t.isInstancedMesh)qt.renderInstances(Ht,pn,_t.count);else if(yt.isInstancedBufferGeometry){const Ut=yt._maxInstanceCount!==void 0?yt._maxInstanceCount:1/0,Wn=Math.min(yt.instanceCount,Ut);qt.renderInstances(Ht,pn,Wn)}else qt.render(Ht,pn)},this.compile=function(nt,mt){function yt(ft,_t,Rt){ft.transparent===!0&&ft.side===DoubleSide&&ft.forceSinglePass===!1?(ft.side=BackSide,ft.needsUpdate=!0,yn(ft,_t,Rt),ft.side=FrontSide,ft.needsUpdate=!0,yn(ft,_t,Rt),ft.side=DoubleSide):yn(ft,_t,Rt)}ne=Ce.get(nt),ne.init(),se.push(ne),nt.traverseVisible(function(ft){ft.isLight&&ft.layers.test(mt.layers)&&(ne.pushLight(ft),ft.castShadow&&ne.pushShadow(ft))}),ne.setupLights(ie.useLegacyLights),nt.traverse(function(ft){const _t=ft.material;if(_t)if(Array.isArray(_t))for(let Rt=0;Rt<_t.length;Rt++){const Nt=_t[Rt];yt(Nt,nt,ft)}else yt(_t,nt,ft)}),se.pop(),ne=null};let xt=null;function Mt(nt){xt&&xt(nt)}function tt(){Pt.stop()}function ht(){Pt.start()}const Pt=new WebGLAnimation;Pt.setAnimationLoop(Mt),typeof self<"u"&&Pt.setContext(self),this.setAnimationLoop=function(nt){xt=nt,dt.setAnimationLoop(nt),nt===null?Pt.stop():Pt.start()},dt.addEventListener("sessionstart",tt),dt.addEventListener("sessionend",ht),this.render=function(nt,mt){if(mt!==void 0&&mt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(ge===!0)return;nt.matrixWorldAutoUpdate===!0&&nt.updateMatrixWorld(),mt.parent===null&&mt.matrixWorldAutoUpdate===!0&&mt.updateMatrixWorld(),dt.enabled===!0&&dt.isPresenting===!0&&(dt.cameraAutoUpdate===!0&&dt.updateCamera(mt),mt=dt.getCamera()),nt.isScene===!0&&nt.onBeforeRender(ie,nt,mt,ue),ne=Ce.get(nt,se.length),ne.init(),se.push(ne),Be.multiplyMatrices(mt.projectionMatrix,mt.matrixWorldInverse),Me.setFromProjectionMatrix(Be),Oe=this.localClippingEnabled,De=Ze.init(this.clippingPlanes,Oe),re=Ne.get(nt,le.length),re.init(),le.push(re),Ct(nt,mt,0,ie.sortObjects),re.finish(),ie.sortObjects===!0&&re.sort(oe,me),De===!0&&Ze.beginShadows();const yt=ne.state.shadowsArray;if(at.render(yt,nt,mt),De===!0&&Ze.endShadows(),this.info.autoReset===!0&&this.info.reset(),st.render(re,nt),ne.setupLights(ie.useLegacyLights),mt.isArrayCamera){const ft=mt.cameras;for(let _t=0,Rt=ft.length;_t<Rt;_t++){const Nt=ft[_t];kt(re,nt,Nt,Nt.viewport)}}else kt(re,nt,mt);ue!==null&&(Ue.updateMultisampleRenderTarget(ue),Ue.updateRenderTargetMipmap(ue)),nt.isScene===!0&&nt.onAfterRender(ie,nt,mt),Fe.resetDefaultState(),pe=-1,_e=null,se.pop(),se.length>0?ne=se[se.length-1]:ne=null,le.pop(),le.length>0?re=le[le.length-1]:re=null};function Ct(nt,mt,yt,ft){if(nt.visible===!1)return;if(nt.layers.test(mt.layers)){if(nt.isGroup)yt=nt.renderOrder;else if(nt.isLOD)nt.autoUpdate===!0&&nt.update(mt);else if(nt.isLight)ne.pushLight(nt),nt.castShadow&&ne.pushShadow(nt);else if(nt.isSprite){if(!nt.frustumCulled||Me.intersectsSprite(nt)){ft&&ze.setFromMatrixPosition(nt.matrixWorld).applyMatrix4(Be);const Nt=Ke.update(nt),It=nt.material;It.visible&&re.push(nt,Nt,It,yt,ze.z,null)}}else if((nt.isMesh||nt.isLine||nt.isPoints)&&(nt.isSkinnedMesh&&nt.skeleton.frame!==We.render.frame&&(nt.skeleton.update(),nt.skeleton.frame=We.render.frame),!nt.frustumCulled||Me.intersectsObject(nt))){ft&&ze.setFromMatrixPosition(nt.matrixWorld).applyMatrix4(Be);const Nt=Ke.update(nt),It=nt.material;if(Array.isArray(It)){const Bt=Nt.groups;for(let Vt=0,Lt=Bt.length;Vt<Lt;Vt++){const jt=Bt[Vt],Ht=It[jt.materialIndex];Ht&&Ht.visible&&re.push(nt,Nt,Ht,yt,ze.z,jt)}}else It.visible&&re.push(nt,Nt,It,yt,ze.z,null)}}const Rt=nt.children;for(let Nt=0,It=Rt.length;Nt<It;Nt++)Ct(Rt[Nt],mt,yt,ft)}function kt(nt,mt,yt,ft){const _t=nt.opaque,Rt=nt.transmissive,Nt=nt.transparent;ne.setupLightsView(yt),De===!0&&Ze.setGlobalState(ie.clippingPlanes,yt),Rt.length>0&&Qt(_t,Rt,mt,yt),ft&&ut.viewport(xe.copy(ft)),_t.length>0&&tn(_t,mt,yt),Rt.length>0&&tn(Rt,mt,yt),Nt.length>0&&tn(Nt,mt,yt),ut.buffers.depth.setTest(!0),ut.buffers.depth.setMask(!0),ut.buffers.color.setMask(!0),ut.setPolygonOffset(!1)}function Qt(nt,mt,yt,ft){if(Ie===null){const It=rt.isWebGL2;Ie=new WebGLRenderTarget(1024,1024,{generateMipmaps:!0,type:ct.has("EXT_color_buffer_half_float")?HalfFloatType:UnsignedByteType,minFilter:LinearMipmapLinearFilter,samples:It&&W===!0?4:0})}const _t=ie.getRenderTarget();ie.setRenderTarget(Ie),ie.clear();const Rt=ie.toneMapping;ie.toneMapping=NoToneMapping,tn(nt,yt,ft),Ue.updateMultisampleRenderTarget(Ie),Ue.updateRenderTargetMipmap(Ie);let Nt=!1;for(let It=0,Bt=mt.length;It<Bt;It++){const Vt=mt[It],Lt=Vt.object,jt=Vt.geometry,Ht=Vt.material,cn=Vt.group;if(Ht.side===DoubleSide&&Lt.layers.test(ft.layers)){const pn=Ht.side;Ht.side=BackSide,Ht.needsUpdate=!0,Xt(Lt,yt,ft,jt,Ht,cn),Ht.side=pn,Ht.needsUpdate=!0,Nt=!0}}Nt===!0&&(Ue.updateMultisampleRenderTarget(Ie),Ue.updateRenderTargetMipmap(Ie)),ie.setRenderTarget(_t),ie.toneMapping=Rt}function tn(nt,mt,yt){const ft=mt.isScene===!0?mt.overrideMaterial:null;for(let _t=0,Rt=nt.length;_t<Rt;_t++){const Nt=nt[_t],It=Nt.object,Bt=Nt.geometry,Vt=ft===null?Nt.material:ft,Lt=Nt.group;It.layers.test(yt.layers)&&Xt(It,mt,yt,Bt,Vt,Lt)}}function Xt(nt,mt,yt,ft,_t,Rt){nt.onBeforeRender(ie,mt,yt,ft,_t,Rt),nt.modelViewMatrix.multiplyMatrices(yt.matrixWorldInverse,nt.matrixWorld),nt.normalMatrix.getNormalMatrix(nt.modelViewMatrix),_t.onBeforeRender(ie,mt,yt,ft,nt,Rt),_t.transparent===!0&&_t.side===DoubleSide&&_t.forceSinglePass===!1?(_t.side=BackSide,_t.needsUpdate=!0,ie.renderBufferDirect(yt,mt,ft,_t,nt,Rt),_t.side=FrontSide,_t.needsUpdate=!0,ie.renderBufferDirect(yt,mt,ft,_t,nt,Rt),_t.side=DoubleSide):ie.renderBufferDirect(yt,mt,ft,_t,nt,Rt),nt.onAfterRender(ie,mt,yt,ft,_t,Rt)}function yn(nt,mt,yt){mt.isScene!==!0&&(mt=et);const ft=Re.get(nt),_t=ne.state.lights,Rt=ne.state.shadowsArray,Nt=_t.state.version,It=$e.getParameters(nt,_t.state,Rt,mt,yt),Bt=$e.getProgramCacheKey(It);let Vt=ft.programs;ft.environment=nt.isMeshStandardMaterial?mt.environment:null,ft.fog=mt.fog,ft.envMap=(nt.isMeshStandardMaterial?Ge:Le).get(nt.envMap||ft.environment),Vt===void 0&&(nt.addEventListener("dispose",wt),Vt=new Map,ft.programs=Vt);let Lt=Vt.get(Bt);if(Lt!==void 0){if(ft.currentProgram===Lt&&ft.lightsStateVersion===Nt)return Zt(nt,It),Lt}else It.uniforms=$e.getUniforms(nt),nt.onBuild(yt,It,ie),nt.onBeforeCompile(It,ie),Lt=$e.acquireProgram(It,Bt),Vt.set(Bt,Lt),ft.uniforms=It.uniforms;const jt=ft.uniforms;(!nt.isShaderMaterial&&!nt.isRawShaderMaterial||nt.clipping===!0)&&(jt.clippingPlanes=Ze.uniform),Zt(nt,It),ft.needsLights=nn(nt),ft.lightsStateVersion=Nt,ft.needsLights&&(jt.ambientLightColor.value=_t.state.ambient,jt.lightProbe.value=_t.state.probe,jt.directionalLights.value=_t.state.directional,jt.directionalLightShadows.value=_t.state.directionalShadow,jt.spotLights.value=_t.state.spot,jt.spotLightShadows.value=_t.state.spotShadow,jt.rectAreaLights.value=_t.state.rectArea,jt.ltc_1.value=_t.state.rectAreaLTC1,jt.ltc_2.value=_t.state.rectAreaLTC2,jt.pointLights.value=_t.state.point,jt.pointLightShadows.value=_t.state.pointShadow,jt.hemisphereLights.value=_t.state.hemi,jt.directionalShadowMap.value=_t.state.directionalShadowMap,jt.directionalShadowMatrix.value=_t.state.directionalShadowMatrix,jt.spotShadowMap.value=_t.state.spotShadowMap,jt.spotLightMatrix.value=_t.state.spotLightMatrix,jt.spotLightMap.value=_t.state.spotLightMap,jt.pointShadowMap.value=_t.state.pointShadowMap,jt.pointShadowMatrix.value=_t.state.pointShadowMatrix);const Ht=Lt.getUniforms(),cn=WebGLUniforms.seqWithValue(Ht.seq,jt);return ft.currentProgram=Lt,ft.uniformsList=cn,Lt}function Zt(nt,mt){const yt=Re.get(nt);yt.outputEncoding=mt.outputEncoding,yt.instancing=mt.instancing,yt.skinning=mt.skinning,yt.morphTargets=mt.morphTargets,yt.morphNormals=mt.morphNormals,yt.morphColors=mt.morphColors,yt.morphTargetsCount=mt.morphTargetsCount,yt.numClippingPlanes=mt.numClippingPlanes,yt.numIntersection=mt.numClipIntersection,yt.vertexAlphas=mt.vertexAlphas,yt.vertexTangents=mt.vertexTangents,yt.toneMapping=mt.toneMapping}function bn(nt,mt,yt,ft,_t){mt.isScene!==!0&&(mt=et),Ue.resetTextureUnits();const Rt=mt.fog,Nt=ft.isMeshStandardMaterial?mt.environment:null,It=ue===null?ie.outputEncoding:ue.isXRRenderTarget===!0?ue.texture.encoding:LinearEncoding,Bt=(ft.isMeshStandardMaterial?Ge:Le).get(ft.envMap||Nt),Vt=ft.vertexColors===!0&&!!yt.attributes.color&&yt.attributes.color.itemSize===4,Lt=!!ft.normalMap&&!!yt.attributes.tangent,jt=!!yt.morphAttributes.position,Ht=!!yt.morphAttributes.normal,cn=!!yt.morphAttributes.color,pn=ft.toneMapped?ie.toneMapping:NoToneMapping,Sn=yt.morphAttributes.position||yt.morphAttributes.normal||yt.morphAttributes.color,qt=Sn!==void 0?Sn.length:0,Ut=Re.get(ft),Wn=ne.state.lights;if(De===!0&&(Oe===!0||nt!==_e)){const sn=nt===_e&&ft.id===pe;Ze.setState(ft,nt,sn)}let rn=!1;ft.version===Ut.__version?(Ut.needsLights&&Ut.lightsStateVersion!==Wn.state.version||Ut.outputEncoding!==It||_t.isInstancedMesh&&Ut.instancing===!1||!_t.isInstancedMesh&&Ut.instancing===!0||_t.isSkinnedMesh&&Ut.skinning===!1||!_t.isSkinnedMesh&&Ut.skinning===!0||Ut.envMap!==Bt||ft.fog===!0&&Ut.fog!==Rt||Ut.numClippingPlanes!==void 0&&(Ut.numClippingPlanes!==Ze.numPlanes||Ut.numIntersection!==Ze.numIntersection)||Ut.vertexAlphas!==Vt||Ut.vertexTangents!==Lt||Ut.morphTargets!==jt||Ut.morphNormals!==Ht||Ut.morphColors!==cn||Ut.toneMapping!==pn||rt.isWebGL2===!0&&Ut.morphTargetsCount!==qt)&&(rn=!0):(rn=!0,Ut.__version=ft.version);let Tn=Ut.currentProgram;rn===!0&&(Tn=yn(ft,mt,_t));let En=!1,On=!1,Qn=!1;const Kt=Tn.getUniforms(),dn=Ut.uniforms;if(ut.useProgram(Tn.program)&&(En=!0,On=!0,Qn=!0),ft.id!==pe&&(pe=ft.id,On=!0),En||_e!==nt){if(Kt.setValue(je,"projectionMatrix",nt.projectionMatrix),rt.logarithmicDepthBuffer&&Kt.setValue(je,"logDepthBufFC",2/(Math.log(nt.far+1)/Math.LN2)),_e!==nt&&(_e=nt,On=!0,Qn=!0),ft.isShaderMaterial||ft.isMeshPhongMaterial||ft.isMeshToonMaterial||ft.isMeshStandardMaterial||ft.envMap){const sn=Kt.map.cameraPosition;sn!==void 0&&sn.setValue(je,ze.setFromMatrixPosition(nt.matrixWorld))}(ft.isMeshPhongMaterial||ft.isMeshToonMaterial||ft.isMeshLambertMaterial||ft.isMeshBasicMaterial||ft.isMeshStandardMaterial||ft.isShaderMaterial)&&Kt.setValue(je,"isOrthographic",nt.isOrthographicCamera===!0),(ft.isMeshPhongMaterial||ft.isMeshToonMaterial||ft.isMeshLambertMaterial||ft.isMeshBasicMaterial||ft.isMeshStandardMaterial||ft.isShaderMaterial||ft.isShadowMaterial||_t.isSkinnedMesh)&&Kt.setValue(je,"viewMatrix",nt.matrixWorldInverse)}if(_t.isSkinnedMesh){Kt.setOptional(je,_t,"bindMatrix"),Kt.setOptional(je,_t,"bindMatrixInverse");const sn=_t.skeleton;sn&&(rt.floatVertexTextures?(sn.boneTexture===null&&sn.computeBoneTexture(),Kt.setValue(je,"boneTexture",sn.boneTexture,Ue),Kt.setValue(je,"boneTextureSize",sn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const vn=yt.morphAttributes;if((vn.position!==void 0||vn.normal!==void 0||vn.color!==void 0&&rt.isWebGL2===!0)&&Se.update(_t,yt,Tn),(On||Ut.receiveShadow!==_t.receiveShadow)&&(Ut.receiveShadow=_t.receiveShadow,Kt.setValue(je,"receiveShadow",_t.receiveShadow)),ft.isMeshGouraudMaterial&&ft.envMap!==null&&(dn.envMap.value=Bt,dn.flipEnvMap.value=Bt.isCubeTexture&&Bt.isRenderTargetTexture===!1?-1:1),On&&(Kt.setValue(je,"toneMappingExposure",ie.toneMappingExposure),Ut.needsLights&&Jt(dn,Qn),Rt&&ft.fog===!0&&Qe.refreshFogUniforms(dn,Rt),Qe.refreshMaterialUniforms(dn,ft,he,Ee,Ie),WebGLUniforms.upload(je,Ut.uniformsList,dn,Ue)),ft.isShaderMaterial&&ft.uniformsNeedUpdate===!0&&(WebGLUniforms.upload(je,Ut.uniformsList,dn,Ue),ft.uniformsNeedUpdate=!1),ft.isSpriteMaterial&&Kt.setValue(je,"center",_t.center),Kt.setValue(je,"modelViewMatrix",_t.modelViewMatrix),Kt.setValue(je,"normalMatrix",_t.normalMatrix),Kt.setValue(je,"modelMatrix",_t.matrixWorld),ft.isShaderMaterial||ft.isRawShaderMaterial){const sn=ft.uniformsGroups;for(let mn=0,Mn=sn.length;mn<Mn;mn++)if(rt.isWebGL2){const en=sn[mn];Ve.update(en,Tn),Ve.bind(en,Tn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Tn}function Jt(nt,mt){nt.ambientLightColor.needsUpdate=mt,nt.lightProbe.needsUpdate=mt,nt.directionalLights.needsUpdate=mt,nt.directionalLightShadows.needsUpdate=mt,nt.pointLights.needsUpdate=mt,nt.pointLightShadows.needsUpdate=mt,nt.spotLights.needsUpdate=mt,nt.spotLightShadows.needsUpdate=mt,nt.rectAreaLights.needsUpdate=mt,nt.hemisphereLights.needsUpdate=mt}function nn(nt){return nt.isMeshLambertMaterial||nt.isMeshToonMaterial||nt.isMeshPhongMaterial||nt.isMeshStandardMaterial||nt.isShadowMaterial||nt.isShaderMaterial&&nt.lights===!0}this.getActiveCubeFace=function(){return fe},this.getActiveMipmapLevel=function(){return ae},this.getRenderTarget=function(){return ue},this.setRenderTargetTextures=function(nt,mt,yt){Re.get(nt.texture).__webglTexture=mt,Re.get(nt.depthTexture).__webglTexture=yt;const ft=Re.get(nt);ft.__hasExternalTextures=!0,ft.__hasExternalTextures&&(ft.__autoAllocateDepthBuffer=yt===void 0,ft.__autoAllocateDepthBuffer||ct.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ft.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(nt,mt){const yt=Re.get(nt);yt.__webglFramebuffer=mt,yt.__useDefaultFramebuffer=mt===void 0},this.setRenderTarget=function(nt,mt=0,yt=0){ue=nt,fe=mt,ae=yt;let ft=!0,_t=null,Rt=!1,Nt=!1;if(nt){const Bt=Re.get(nt);Bt.__useDefaultFramebuffer!==void 0?(ut.bindFramebuffer(36160,null),ft=!1):Bt.__webglFramebuffer===void 0?Ue.setupRenderTarget(nt):Bt.__hasExternalTextures&&Ue.rebindTextures(nt,Re.get(nt.texture).__webglTexture,Re.get(nt.depthTexture).__webglTexture);const Vt=nt.texture;(Vt.isData3DTexture||Vt.isDataArrayTexture||Vt.isCompressedArrayTexture)&&(Nt=!0);const Lt=Re.get(nt).__webglFramebuffer;nt.isWebGLCubeRenderTarget?(_t=Lt[mt],Rt=!0):rt.isWebGL2&&nt.samples>0&&Ue.useMultisampledRTT(nt)===!1?_t=Re.get(nt).__webglMultisampledFramebuffer:_t=Lt,xe.copy(nt.viewport),be.copy(nt.scissor),Te=nt.scissorTest}else xe.copy(ve).multiplyScalar(he).floor(),be.copy(we).multiplyScalar(he).floor(),Te=Pe;if(ut.bindFramebuffer(36160,_t)&&rt.drawBuffers&&ft&&ut.drawBuffers(nt,_t),ut.viewport(xe),ut.scissor(be),ut.setScissorTest(Te),Rt){const Bt=Re.get(nt.texture);je.framebufferTexture2D(36160,36064,34069+mt,Bt.__webglTexture,yt)}else if(Nt){const Bt=Re.get(nt.texture),Vt=mt||0;je.framebufferTextureLayer(36160,36064,Bt.__webglTexture,yt||0,Vt)}pe=-1},this.readRenderTargetPixels=function(nt,mt,yt,ft,_t,Rt,Nt){if(!(nt&&nt.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let It=Re.get(nt).__webglFramebuffer;if(nt.isWebGLCubeRenderTarget&&Nt!==void 0&&(It=It[Nt]),It){ut.bindFramebuffer(36160,It);try{const Bt=nt.texture,Vt=Bt.format,Lt=Bt.type;if(Vt!==RGBAFormat&&Ae.convert(Vt)!==je.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const jt=Lt===HalfFloatType&&(ct.has("EXT_color_buffer_half_float")||rt.isWebGL2&&ct.has("EXT_color_buffer_float"));if(Lt!==UnsignedByteType&&Ae.convert(Lt)!==je.getParameter(35738)&&!(Lt===FloatType&&(rt.isWebGL2||ct.has("OES_texture_float")||ct.has("WEBGL_color_buffer_float")))&&!jt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}mt>=0&&mt<=nt.width-ft&&yt>=0&&yt<=nt.height-_t&&je.readPixels(mt,yt,ft,_t,Ae.convert(Vt),Ae.convert(Lt),Rt)}finally{const Bt=ue!==null?Re.get(ue).__webglFramebuffer:null;ut.bindFramebuffer(36160,Bt)}}},this.copyFramebufferToTexture=function(nt,mt,yt=0){const ft=Math.pow(2,-yt),_t=Math.floor(mt.image.width*ft),Rt=Math.floor(mt.image.height*ft);Ue.setTexture2D(mt,0),je.copyTexSubImage2D(3553,yt,0,0,nt.x,nt.y,_t,Rt),ut.unbindTexture()},this.copyTextureToTexture=function(nt,mt,yt,ft=0){const _t=mt.image.width,Rt=mt.image.height,Nt=Ae.convert(yt.format),It=Ae.convert(yt.type);Ue.setTexture2D(yt,0),je.pixelStorei(37440,yt.flipY),je.pixelStorei(37441,yt.premultiplyAlpha),je.pixelStorei(3317,yt.unpackAlignment),mt.isDataTexture?je.texSubImage2D(3553,ft,nt.x,nt.y,_t,Rt,Nt,It,mt.image.data):mt.isCompressedTexture?je.compressedTexSubImage2D(3553,ft,nt.x,nt.y,mt.mipmaps[0].width,mt.mipmaps[0].height,Nt,mt.mipmaps[0].data):je.texSubImage2D(3553,ft,nt.x,nt.y,Nt,It,mt.image),ft===0&&yt.generateMipmaps&&je.generateMipmap(3553),ut.unbindTexture()},this.copyTextureToTexture3D=function(nt,mt,yt,ft,_t=0){if(ie.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Rt=nt.max.x-nt.min.x+1,Nt=nt.max.y-nt.min.y+1,It=nt.max.z-nt.min.z+1,Bt=Ae.convert(ft.format),Vt=Ae.convert(ft.type);let Lt;if(ft.isData3DTexture)Ue.setTexture3D(ft,0),Lt=32879;else if(ft.isDataArrayTexture)Ue.setTexture2DArray(ft,0),Lt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}je.pixelStorei(37440,ft.flipY),je.pixelStorei(37441,ft.premultiplyAlpha),je.pixelStorei(3317,ft.unpackAlignment);const jt=je.getParameter(3314),Ht=je.getParameter(32878),cn=je.getParameter(3316),pn=je.getParameter(3315),Sn=je.getParameter(32877),qt=yt.isCompressedTexture?yt.mipmaps[0]:yt.image;je.pixelStorei(3314,qt.width),je.pixelStorei(32878,qt.height),je.pixelStorei(3316,nt.min.x),je.pixelStorei(3315,nt.min.y),je.pixelStorei(32877,nt.min.z),yt.isDataTexture||yt.isData3DTexture?je.texSubImage3D(Lt,_t,mt.x,mt.y,mt.z,Rt,Nt,It,Bt,Vt,qt.data):yt.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),je.compressedTexSubImage3D(Lt,_t,mt.x,mt.y,mt.z,Rt,Nt,It,Bt,qt.data)):je.texSubImage3D(Lt,_t,mt.x,mt.y,mt.z,Rt,Nt,It,Bt,Vt,qt),je.pixelStorei(3314,jt),je.pixelStorei(32878,Ht),je.pixelStorei(3316,cn),je.pixelStorei(3315,pn),je.pixelStorei(32877,Sn),_t===0&&ft.generateMipmaps&&je.generateMipmap(Lt),ut.unbindTexture()},this.initTexture=function(nt){nt.isCubeTexture?Ue.setTextureCube(nt,0):nt.isData3DTexture?Ue.setTexture3D(nt,0):nt.isDataArrayTexture||nt.isCompressedArrayTexture?Ue.setTexture2DArray(nt,0):Ue.setTexture2D(nt,0),ut.unbindTexture()},this.resetState=function(){fe=0,ae=0,ue=null,ut.reset(),Fe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(D){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!D}}class WebGL1Renderer extends WebGLRenderer{}WebGL1Renderer.prototype.isWebGL1Renderer=!0;class Scene extends Object3D{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(D,F){return super.copy(D,F),D.background!==null&&(this.background=D.background.clone()),D.environment!==null&&(this.environment=D.environment.clone()),D.fog!==null&&(this.fog=D.fog.clone()),this.backgroundBlurriness=D.backgroundBlurriness,this.backgroundIntensity=D.backgroundIntensity,D.overrideMaterial!==null&&(this.overrideMaterial=D.overrideMaterial.clone()),this.matrixAutoUpdate=D.matrixAutoUpdate,this}toJSON(D){const F=super.toJSON(D);return this.fog!==null&&(F.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(F.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(F.object.backgroundIntensity=this.backgroundIntensity),F}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(D){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=D}}class InstancedBufferAttribute extends BufferAttribute{constructor(D,F,G,Q=1){super(D,F,G),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=Q}copy(D){return super.copy(D),this.meshPerAttribute=D.meshPerAttribute,this}toJSON(){const D=super.toJSON();return D.meshPerAttribute=this.meshPerAttribute,D.isInstancedBufferAttribute=!0,D}}class CylinderGeometry extends BufferGeometry{constructor(D=1,F=1,G=1,Q=32,X=1,q=!1,W=0,Y=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:D,radiusBottom:F,height:G,radialSegments:Q,heightSegments:X,openEnded:q,thetaStart:W,thetaLength:Y};const J=this;Q=Math.floor(Q),X=Math.floor(X);const te=[],Z=[],ee=[],re=[];let ne=0;const le=[],se=G/2;let ie=0;ge(),q===!1&&(D>0&&fe(!0),F>0&&fe(!1)),this.setIndex(te),this.setAttribute("position",new Float32BufferAttribute(Z,3)),this.setAttribute("normal",new Float32BufferAttribute(ee,3)),this.setAttribute("uv",new Float32BufferAttribute(re,2));function ge(){const ae=new Vector3,ue=new Vector3;let pe=0;const _e=(F-D)/G;for(let xe=0;xe<=X;xe++){const be=[],Te=xe/X,ye=Te*(F-D)+D;for(let Ee=0;Ee<=Q;Ee++){const he=Ee/Q,oe=he*Y+W,me=Math.sin(oe),ve=Math.cos(oe);ue.x=ye*me,ue.y=-Te*G+se,ue.z=ye*ve,Z.push(ue.x,ue.y,ue.z),ae.set(me,_e,ve).normalize(),ee.push(ae.x,ae.y,ae.z),re.push(he,1-Te),be.push(ne++)}le.push(be)}for(let xe=0;xe<Q;xe++)for(let be=0;be<X;be++){const Te=le[be][xe],ye=le[be+1][xe],Ee=le[be+1][xe+1],he=le[be][xe+1];te.push(Te,ye,he),te.push(ye,Ee,he),pe+=6}J.addGroup(ie,pe,0),ie+=pe}function fe(ae){const ue=ne,pe=new Vector2,_e=new Vector3;let xe=0;const be=ae===!0?D:F,Te=ae===!0?1:-1;for(let Ee=1;Ee<=Q;Ee++)Z.push(0,se*Te,0),ee.push(0,Te,0),re.push(.5,.5),ne++;const ye=ne;for(let Ee=0;Ee<=Q;Ee++){const oe=Ee/Q*Y+W,me=Math.cos(oe),ve=Math.sin(oe);_e.x=be*ve,_e.y=se*Te,_e.z=be*me,Z.push(_e.x,_e.y,_e.z),ee.push(0,Te,0),pe.x=me*.5+.5,pe.y=ve*.5*Te+.5,re.push(pe.x,pe.y),ne++}for(let Ee=0;Ee<Q;Ee++){const he=ue+Ee,oe=ye+Ee;ae===!0?te.push(oe,oe+1,he):te.push(oe+1,oe,he),xe+=3}J.addGroup(ie,xe,ae===!0?1:2),ie+=xe}}copy(D){return super.copy(D),this.parameters=Object.assign({},D.parameters),this}static fromJSON(D){return new CylinderGeometry(D.radiusTop,D.radiusBottom,D.height,D.radialSegments,D.heightSegments,D.openEnded,D.thetaStart,D.thetaLength)}}class RawShaderMaterial extends ShaderMaterial{constructor(D){super(D),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class InstancedBufferGeometry extends BufferGeometry{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(D){return super.copy(D),this.instanceCount=D.instanceCount,this}toJSON(){const D=super.toJSON();return D.instanceCount=this.instanceCount,D.isInstancedBufferGeometry=!0,D}}class Uniform{constructor(D){this.value=D}clone(){return new Uniform(this.value.clone===void 0?this.value:this.value.clone())}}let id$1=0;class UniformsGroup extends EventDispatcher{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:id$1++}),this.name="",this.usage=StaticDrawUsage,this.uniforms=[]}add(D){return this.uniforms.push(D),this}remove(D){const F=this.uniforms.indexOf(D);return F!==-1&&this.uniforms.splice(F,1),this}setName(D){return this.name=D,this}setUsage(D){return this.usage=D,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(D){this.name=D.name,this.usage=D.usage;const F=D.uniforms;this.uniforms.length=0;for(let G=0,Q=F.length;G<Q;G++)this.uniforms.push(F[G].clone());return this}clone(){return new this.constructor().copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION);const getCamerasUniforms=moize.infinite(()=>({globalPerspective:new Uniform(new Matrix4),globalView:new Uniform(new Matrix4),zoomedProjection:new Uniform(new Matrix4),zoomedView:new Uniform(new Matrix4),fixedPerspective:new Uniform(new Matrix4),fixedView:new Uniform(new Matrix4),distance:new Uniform(0),center:new Uniform(new Vector3(0,0,0)),rotationCenter:new Uniform(new Vector3(0,0,0))})),getCamerasUniformsGroup=moize.infinite(()=>{const U=new UniformsGroup;U.setName("cameras");const D=getCamerasUniforms();return Object.values(D).forEach(F=>{U.add(F)}),U}),updateCamerasUniformsGroup=proxy((U,D,F,G,Q,X,q)=>{const W=getCamerasUniforms();W.globalPerspective.value.fromArray(U),W.globalView.value.fromArray(D),W.zoomedProjection.value.fromArray(F),W.zoomedView.value.fromArray(G),W.fixedPerspective.value.fromArray(Q),W.fixedView.value.fromArray(X),W.distance.value=q[0],W.center.value.fromArray(q.slice(1,4)),W.rotationCenter.value.fromArray(q.slice(4,7))});var mouse$1={};function mouseButtons(U){if(typeof U=="object"){if("buttons"in U)return U.buttons;if("which"in U){var D=U.which;if(D===2)return 4;if(D===3)return 2;if(D>0)return 1<<D-1}else if("button"in U){var D=U.button;if(D===1)return 4;if(D===2)return 2;if(D>=0)return 1<<D}}return 0}mouse$1.buttons=mouseButtons;function mouseElement(U){return U.target||U.srcElement||window}mouse$1.element=mouseElement;function mouseRelativeX(U){if(typeof U=="object"){if("offsetX"in U)return U.offsetX;var D=mouseElement(U),F=D.getBoundingClientRect();return U.clientX-F.left}return 0}mouse$1.x=mouseRelativeX;function mouseRelativeY(U){if(typeof U=="object"){if("offsetY"in U)return U.offsetY;var D=mouseElement(U),F=D.getBoundingClientRect();return U.clientY-F.top}return 0}mouse$1.y=mouseRelativeY;var mouseListen_1=mouseListen,mouse=mouse$1;function mouseListen(U,D){D||(D=U,U=window);var F=0,G=0,Q=0,X={shift:!1,alt:!1,control:!1,meta:!1},q=!1;function W(ge){var fe=!1;return"altKey"in ge&&(fe=fe||ge.altKey!==X.alt,X.alt=!!ge.altKey),"shiftKey"in ge&&(fe=fe||ge.shiftKey!==X.shift,X.shift=!!ge.shiftKey),"ctrlKey"in ge&&(fe=fe||ge.ctrlKey!==X.control,X.control=!!ge.ctrlKey),"metaKey"in ge&&(fe=fe||ge.metaKey!==X.meta,X.meta=!!ge.metaKey),fe}function Y(ge,fe){var ae=mouse.x(fe),ue=mouse.y(fe);"buttons"in fe&&(ge=fe.buttons|0),(ge!==F||ae!==G||ue!==Q||W(fe))&&(F=ge|0,G=ae||0,Q=ue||0,D&&D(F,G,Q,X))}function J(ge){Y(0,ge)}function te(){(F||G||Q||X.shift||X.alt||X.meta||X.control)&&(G=Q=0,F=0,X.shift=X.alt=X.control=X.meta=!1,D&&D(0,0,0,X))}function Z(ge){W(ge)&&D&&D(F,G,Q,X)}function ee(ge){mouse.buttons(ge)===0?Y(0,ge):Y(F,ge)}function re(ge){Y(F|mouse.buttons(ge),ge)}function ne(ge){Y(F&~mouse.buttons(ge),ge)}function le(){q||(q=!0,U.addEventListener("mousemove",ee),U.addEventListener("mousedown",re),U.addEventListener("mouseup",ne),U.addEventListener("mouseleave",J),U.addEventListener("mouseenter",J),U.addEventListener("mouseout",J),U.addEventListener("mouseover",J),U.addEventListener("blur",te),U.addEventListener("keyup",Z),U.addEventListener("keydown",Z),U.addEventListener("keypress",Z),U!==window&&(window.addEventListener("blur",te),window.addEventListener("keyup",Z),window.addEventListener("keydown",Z),window.addEventListener("keypress",Z)))}function se(){q&&(q=!1,U.removeEventListener("mousemove",ee),U.removeEventListener("mousedown",re),U.removeEventListener("mouseup",ne),U.removeEventListener("mouseleave",J),U.removeEventListener("mouseenter",J),U.removeEventListener("mouseout",J),U.removeEventListener("mouseover",J),U.removeEventListener("blur",te),U.removeEventListener("keyup",Z),U.removeEventListener("keydown",Z),U.removeEventListener("keypress",Z),U!==window&&(window.removeEventListener("blur",te),window.removeEventListener("keyup",Z),window.removeEventListener("keydown",Z),window.removeEventListener("keypress",Z)))}le();var ie={element:U};return Object.defineProperties(ie,{enabled:{get:function(){return q},set:function(ge){ge?le():se()},enumerable:!0},buttons:{get:function(){return F},enumerable:!0},x:{get:function(){return G},enumerable:!0},y:{get:function(){return Q},enumerable:!0},mods:{get:function(){return X},enumerable:!0}}),ie}var rootPosition={left:0,top:0},mouseEventOffset_1=mouseEventOffset;function mouseEventOffset(U,D,F){D=D||U.currentTarget||U.srcElement,Array.isArray(F)||(F=[0,0]);var G=U.clientX||0,Q=U.clientY||0,X=getBoundingClientOffset(D);return F[0]=G-X.left,F[1]=Q-X.top,F}function getBoundingClientOffset(U){return U===window||U===document||U===document.body?rootPosition:U.getBoundingClientRect()}var eventEmitterExports={},eventEmitter$1={get exports(){return eventEmitterExports},set exports(U){eventEmitterExports=U}},dExports={},d$4={get exports(){return dExports},set exports(U){dExports=U}},_undefined$1=void 0,is$4=function(U){return U!==_undefined$1&&U!==null},isValue$3=is$4,possibleTypes={object:!0,function:!0,undefined:!0},is$3=function(U){return isValue$3(U)?hasOwnProperty.call(possibleTypes,typeof U):!1},isObject$2=is$3,is$2=function(U){if(!isObject$2(U))return!1;try{return U.constructor?U.constructor.prototype===U:!1}catch{return!1}},isPrototype=is$2,is$1=function(U){if(typeof U!="function"||!hasOwnProperty.call(U,"length"))return!1;try{if(typeof U.length!="number"||typeof U.call!="function"||typeof U.apply!="function")return!1}catch{return!1}return!isPrototype(U)},isFunction$2=is$1,classRe=/^\s*class[\s{/}]/,functionToString=Function.prototype.toString,is=function(U){return!(!isFunction$2(U)||classRe.test(functionToString.call(U)))},isImplemented$2=function(){var U=Object.assign,D;return typeof U!="function"?!1:(D={foo:"raz"},U(D,{bar:"dwa"},{trzy:"trzy"}),D.foo+D.bar+D.trzy==="razdwatrzy")},isImplemented$1,hasRequiredIsImplemented;function requireIsImplemented(){return hasRequiredIsImplemented||(hasRequiredIsImplemented=1,isImplemented$1=function(){try{return Object.keys("primitive"),!0}catch{return!1}}),isImplemented$1}var noop$5=function(){},_undefined=noop$5(),isValue$2=function(U){return U!==_undefined&&U!==null},shim$2,hasRequiredShim$2;function requireShim$2(){if(hasRequiredShim$2)return shim$2;hasRequiredShim$2=1;var U=isValue$2,D=Object.keys;return shim$2=function(F){return D(U(F)?Object(F):F)},shim$2}var keys,hasRequiredKeys;function requireKeys(){return hasRequiredKeys||(hasRequiredKeys=1,keys=requireIsImplemented()()?Object.keys:requireShim$2()),keys}var validValue,hasRequiredValidValue;function requireValidValue(){if(hasRequiredValidValue)return validValue;hasRequiredValidValue=1;var U=isValue$2;return validValue=function(D){if(!U(D))throw new TypeError("Cannot use null or undefined");return D},validValue}var shim$1,hasRequiredShim$1;function requireShim$1(){if(hasRequiredShim$1)return shim$1;hasRequiredShim$1=1;var U=requireKeys(),D=requireValidValue(),F=Math.max;return shim$1=function(G,Q){var X,q,W=F(arguments.length,2),Y;for(G=Object(D(G)),Y=function(J){try{G[J]=Q[J]}catch(te){X||(X=te)}},q=1;q<W;++q)Q=arguments[q],U(Q).forEach(Y);if(X!==void 0)throw X;return G},shim$1}var assign$1=isImplemented$2()?Object.assign:requireShim$1(),isValue$1=isValue$2,forEach=Array.prototype.forEach,create$2=Object.create,process$1=function(U,D){var F;for(F in U)D[F]=U[F]},normalizeOptions=function(U){var D=create$2(null);return forEach.call(arguments,function(F){isValue$1(F)&&process$1(Object(F),D)}),D},str="razdwatrzy",isImplemented=function(){return typeof str.contains!="function"?!1:str.contains("dwa")===!0&&str.contains("foo")===!1},shim,hasRequiredShim;function requireShim(){if(hasRequiredShim)return shim;hasRequiredShim=1;var U=String.prototype.indexOf;return shim=function(D){return U.call(this,D,arguments[1])>-1},shim}var contains$1=isImplemented()?String.prototype.contains:requireShim(),isValue=is$4,isPlainFunction=is,assign=assign$1,normalizeOpts=normalizeOptions,contains=contains$1,d$3=d$4.exports=function(U,D){var F,G,Q,X,q;return arguments.length<2||typeof U!="string"?(X=D,D=U,U=null):X=arguments[2],isValue(U)?(F=contains.call(U,"c"),G=contains.call(U,"e"),Q=contains.call(U,"w")):(F=Q=!0,G=!1),q={value:D,configurable:F,enumerable:G,writable:Q},X?assign(normalizeOpts(X),q):q};d$3.gs=function(U,D,F){var G,Q,X,q;return typeof U!="string"?(X=F,F=D,D=U,U=null):X=arguments[3],isValue(D)?isPlainFunction(D)?isValue(F)?isPlainFunction(F)||(X=F,F=void 0):F=void 0:(X=D,D=F=void 0):D=void 0,isValue(U)?(G=contains.call(U,"c"),Q=contains.call(U,"e")):(G=!0,Q=!1),q={get:D,set:F,configurable:G,enumerable:Q},X?assign(normalizeOpts(X),q):q};var validCallable=function(U){if(typeof U!="function")throw new TypeError(U+" is not a function");return U};(function(U,D){var F=dExports,G=validCallable,Q=Function.prototype.apply,X=Function.prototype.call,q=Object.create,W=Object.defineProperty,Y=Object.defineProperties,J=Object.prototype.hasOwnProperty,te={configurable:!0,enumerable:!1,writable:!0},Z,ee,re,ne,le,se,ie;Z=function(ge,fe){var ae;return G(fe),J.call(this,"__ee__")?ae=this.__ee__:(ae=te.value=q(null),W(this,"__ee__",te),te.value=null),ae[ge]?typeof ae[ge]=="object"?ae[ge].push(fe):ae[ge]=[ae[ge],fe]:ae[ge]=fe,this},ee=function(ge,fe){var ae,ue;return G(fe),ue=this,Z.call(this,ge,ae=function(){re.call(ue,ge,ae),Q.call(fe,this,arguments)}),ae.__eeOnceListener__=fe,this},re=function(ge,fe){var ae,ue,pe,_e;if(G(fe),!J.call(this,"__ee__"))return this;if(ae=this.__ee__,!ae[ge])return this;if(ue=ae[ge],typeof ue=="object")for(_e=0;pe=ue[_e];++_e)(pe===fe||pe.__eeOnceListener__===fe)&&(ue.length===2?ae[ge]=ue[_e?0:1]:ue.splice(_e,1));else(ue===fe||ue.__eeOnceListener__===fe)&&delete ae[ge];return this},ne=function(ge){var fe,ae,ue,pe,_e;if(J.call(this,"__ee__")&&(pe=this.__ee__[ge],!!pe))if(typeof pe=="object"){for(ae=arguments.length,_e=new Array(ae-1),fe=1;fe<ae;++fe)_e[fe-1]=arguments[fe];for(pe=pe.slice(),fe=0;ue=pe[fe];++fe)Q.call(ue,this,_e)}else switch(arguments.length){case 1:X.call(pe,this);break;case 2:X.call(pe,this,arguments[1]);break;case 3:X.call(pe,this,arguments[1],arguments[2]);break;default:for(ae=arguments.length,_e=new Array(ae-1),fe=1;fe<ae;++fe)_e[fe-1]=arguments[fe];Q.call(pe,this,_e)}},le={on:Z,once:ee,off:re,emit:ne},se={on:F(Z),once:F(ee),off:F(re),emit:F(ne)},ie=Y({},se),U.exports=D=function(ge){return ge==null?q(ie):Y(Object(ge),se)},D.methods=le})(eventEmitter$1,eventEmitterExports);var normalizedInteractionEvents_1=normalizedInteractionEvents,mouseChange=mouseListen_1,eventOffset=mouseEventOffset_1,eventEmitter=eventEmitterExports;function normalizedInteractionEvents(U){U=U||window;var D=eventEmitter(),F=[null,null],G=[null,null],Q=[null,null],X=[null,null],q=0,W={},Y,J,te=U===window?function(){Y=window.innerWidth,J=window.innerHeight}:function(){Y=U.clientWidth,J=U.clientHeight},Z=0,ee,re,ne={},le=mouseChange(U,function(oe,me,ve,we){ee=me,re=ve,Z=oe,ne=we});function se(oe){eventOffset(oe,U,Q),te(),W.buttons=Z,W.mods=ne,W.x0=W.x=W.x1=2*Q[0]/Y-1,W.y0=W.y=W.y1=1-2*Q[1]/J,W.x2=null,W.y2=null,W.dx=2*oe.deltaX/Y,W.dy=-2*oe.deltaY/J,W.dz=2*oe.deltaZ/Y,W.active=1,W.zoomx=1,W.zoomy=1,W.theta=0,W.dtheta=0,W.originalEvent=oe,D.emit("wheel",W),F[0]=Q[0],F[1]=Q[1]}var ie=null,ge=null,fe=0;function ae(oe){eventOffset(oe,U,Q),fe=0,te(),W.buttons=Z,W.mods=ne,W.x=W.x1=2*Q[0]/Y-1,W.y=W.y1=1-2*Q[1]/J,W.x2=null,W.y2=null,W.active=fe,W.x0=2*ie/Y-1,W.y0=1-2*ge/J,W.dx=0,W.dy=0,W.dz=0,W.zoomx=1,W.zoomy=1,W.theta=0,W.dtheta=0,W.originalEvent=oe,D.emit("mouseup",W),ie=ge=null,F[0]=Q[0],F[1]=Q[1]}function ue(oe){eventOffset(oe,U,Q),fe=1,te(),ie=ee,ge=re,W.buttons=Z,W.mods=ne,W.x=W.x0=W.x1=2*Q[0]/Y-1,W.y=W.y0=W.y1=1-2*Q[1]/J,W.x2=null,W.y2=null,W.active=fe,W.dx=0,W.dy=0,W.dz=0,W.zoomx=1,W.zoomy=1,W.theta=0,W.dtheta=0,W.originalEvent=oe,D.emit("mousedown",W),F[0]=Q[0],F[1]=Q[1]}function pe(oe){eventOffset(oe,U,Q),te(),W.buttons=Z,W.mods=ne,W.x0=2*ie/Y-1,W.y0=1-2*ge/J,W.x=W.x1=2*Q[0]/Y-1,W.y=W.y1=1-2*Q[1]/J,W.x2=null,W.y2=null,W.dx=2*(Q[0]-F[0])/Y,W.dy=-2*(Q[1]-F[1])/J,W.active=fe,W.dz=0,W.zoomx=1,W.zoomy=1,W.theta=0,W.dtheta=0,W.originalEvent=oe,D.emit("mousemove",W),F[0]=Q[0],F[1]=Q[1]}function _e(oe){for(var me=oe.identifier,ve=0;ve<X.length;ve++)if(X[ve]&&X[ve].touch&&X[ve].touch.identifier===me)return ve;return-1}function xe(oe){G[0]=null,G[1]=null;for(var me=0;me<oe.changedTouches.length;me++){var ve=oe.changedTouches[me],we=ve.identifier,Pe=_e(we);if(Pe===-1&&q<2){var Me=X[0]?1:0,De=X[0]?0:1,Oe={position:[0,0],touch:null};X[Me]=Oe,q++,Oe.touch=ve,eventOffset(ve,U,Oe.position),X[De]&&X[De].touch}}for(var Ie=0,Be=0,ze=0,me=0;me<X.length;me++)X[me]&&(Ie+=X[me].position[0],Be+=X[me].position[1],ze++);if(Ie/=ze,Be/=ze,q>0){if(W.theta=0,ze>1){var et=X[1].position[0]-X[0].position[0],qe=(X[0].position[1]-X[1].position[1])*Y/J;W.theta=Math.atan2(qe,et)}te(),W.buttons=0,W.mods={},W.active=q,ie=Ie,ge=Be,W.x0=2*ie/Y-1,W.y0=1-2*ge/J,W.x=2*Ie/Y-1,W.y=1-2*Be/J,W.x1=2*X[0].position[0]/Y-1,W.y1=1-2*X[0].position[1]/J,q>1&&(W.x2=2*X[1].position[0]/Y-1,W.y2=1-2*X[1].position[1]/J),W.active=q,W.dx=0,W.dy=0,W.dz=0,W.zoomx=1,W.zoomy=1,W.dtheta=0,W.originalEvent=oe,D.emit(q===1?"touchstart":"pinchstart",W)}}function be(oe){for(var me,ve=!1,we=0;we<oe.changedTouches.length;we++){var Pe=oe.changedTouches[we];me=_e(Pe),me!==-1&&(ve=!0,X[me].touch=Pe,eventOffset(Pe,U,X[me].position))}if(ve){if(q===1){for(me=0;me<X.length&&!X[me];me++);if(X[me]&&G[me]){var Me=X[me].position[0],De=X[me].position[1],Oe=Me-G[me][0],Ie=De-G[me][1];W.buttons=0,W.mods={},W.active=q,W.x=W.x1=2*Me/Y-1,W.y=W.y1=1-2*De/J,W.x2=null,W.y2=null,W.x0=2*ie/Y-1,W.y0=1-2*ge/J,W.dx=2*Oe/Y,W.dy=-2*Ie/J,W.dz=0,W.zoomx=1,W.zoomy=1,W.theta=0,W.dtheta=0,W.originalEvent=oe,D.emit("touchmove",W)}}else if(q===2&&G[0]&&G[1]){var Be=G[0],ze=G[1],et=ze[0]-Be[0],qe=(ze[1]-Be[1])*Y/J,je=X[0].position,it=X[1].position,ct=it[0]-je[0],rt=(je[1]-it[1])*Y/J,ut=Math.sqrt(et*et+qe*qe)*.5,We=Math.atan2(qe,et),Re=Math.sqrt(ct*ct+rt*rt)*.5,Ue=Math.atan2(rt,ct),Le=(ze[0]+Be[0])*.5,Ge=(ze[1]+Be[1])*.5,Oe=.5*(it[0]+je[0]-Be[0]-ze[0]),Ie=.5*(it[1]+je[1]-Be[1]-ze[1]),ke=Re/ut,He=Ue-We;W.buttons=0,W.mods=ne,W.active=q,W.x=2*Le/Y-1,W.y=1-2*Ge/J,W.x0=2*ie/Y-1,W.y0=1-2*ge/J,W.x1=2*je[0]/Y-1,W.y1=1-2*je[1]/J,W.x2=2*it[0]/Y-1,W.y2=1-2*it[1]/J,W.dx=2*Oe/Y,W.dy=-2*Ie/J,W.dz=0,W.zoomx=ke,W.zoomy=ke,W.theta=Ue,W.dtheta=He,W.originalEvent=oe,D.emit("pinchmove",W)}}X[0]&&(G[0]=X[0].position.slice()),X[1]&&(G[1]=X[1].position.slice())}function Te(oe){for(var me,ve=0;ve<oe.changedTouches.length;ve++){var we=oe.changedTouches[ve],Pe=_e(we);if(Pe!==-1){me=X[Pe],X[Pe]=null,q--;var Me=Pe===0?1:0;X[Me]&&X[Me].touch}}var De=0,Oe=0;if(q===0)me&&(De=me.position[0],Oe=me.position[1]);else{for(var Ie=0,ve=0;ve<X.length;ve++)X[ve]&&(De+=X[ve].position[0],Oe+=X[ve].position[1],Ie++);De/=Ie,Oe/=Ie}q<2&&(W.buttons=0,W.mods=ne,W.active=q,W.x=2*De/Y-1,W.y=1-2*Oe/J,W.x0=2*ie/Y-1,W.y0=1-2*ge/J,W.dx=0,W.dy=0,W.dz=0,W.zoomx=1,W.zoomy=1,W.theta=0,W.dtheta=0,W.originalEvent=oe,D.emit(q===0?"touchend":"pinchend",W)),q===0&&(ie=ge=null)}var ye=!1;function Ee(){ye||(ye=!0,le.enabled=!0,U.addEventListener("wheel",se,!1),U.addEventListener("mousedown",ue,!1),window.addEventListener("mousemove",pe,!1),window.addEventListener("mouseup",ae,!1),U.addEventListener("touchstart",xe,!1),window.addEventListener("touchmove",be,!1),window.addEventListener("touchend",Te,!1),window.addEventListener("touchcancel",Te,!1))}function he(){ye&&(ye=!1,le.enabled=!1,U.removeEventListener("wheel",se,!1),U.removeEventListener("mousedown",ue,!1),window.removeEventListener("mousemove",pe,!1),window.removeEventListener("mouseup",ae,!1),U.removeEventListener("touchstart",xe,!1),window.removeEventListener("touchmove",be,!1),window.removeEventListener("touchend",Te,!1),window.removeEventListener("touchcancel",Te,!1))}return Ee(),D.enable=Ee,D.disable=he,D}function WorkerWrapper(){return new Worker("/dat-garden-visualization/assets/worker-9cf34e63.js",{type:"module"})}var abstractLevel$1={},abstractLevel={},levelSupports={};levelSupports.supports=function(...D){const F=D.reduce((G,Q)=>Object.assign(G,Q),{});return Object.assign(F,{snapshots:F.snapshots||!1,permanence:F.permanence||!1,seek:F.seek||!1,clear:F.clear||!1,getMany:F.getMany||!1,keyIterator:F.keyIterator||!1,valueIterator:F.valueIterator||!1,iteratorNextv:F.iteratorNextv||!1,iteratorAll:F.iteratorAll||!1,status:F.status||!1,createIfMissing:F.createIfMissing||!1,errorIfExists:F.errorIfExists||!1,deferredOpen:F.deferredOpen||!1,promises:F.promises||!1,streams:F.streams||!1,encodings:Object.assign({},F.encodings),events:Object.assign({},F.events),additionalMethods:Object.assign({},F.additionalMethods)})};var levelTranscoder={},moduleError=class extends Error{constructor(D,F){super(D||""),typeof F=="object"&&F!==null&&(F.code&&(this.code=String(F.code)),F.expected&&(this.expected=!0),F.transient&&(this.transient=!0),F.cause&&(this.cause=F.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},encodings$1={},buffer$1={},base64Js={};base64Js.byteLength=byteLength;base64Js.toByteArray=toByteArray;base64Js.fromByteArray=fromByteArray;var lookup$1=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i$3=0,len=code.length;i$3<len;++i$3)lookup$1[i$3]=code[i$3],revLookup[code.charCodeAt(i$3)]=i$3;revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(U){var D=U.length;if(D%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var F=U.indexOf("=");F===-1&&(F=D);var G=F===D?0:4-F%4;return[F,G]}function byteLength(U){var D=getLens(U),F=D[0],G=D[1];return(F+G)*3/4-G}function _byteLength(U,D,F){return(D+F)*3/4-F}function toByteArray(U){var D,F=getLens(U),G=F[0],Q=F[1],X=new Arr(_byteLength(U,G,Q)),q=0,W=Q>0?G-4:G,Y;for(Y=0;Y<W;Y+=4)D=revLookup[U.charCodeAt(Y)]<<18|revLookup[U.charCodeAt(Y+1)]<<12|revLookup[U.charCodeAt(Y+2)]<<6|revLookup[U.charCodeAt(Y+3)],X[q++]=D>>16&255,X[q++]=D>>8&255,X[q++]=D&255;return Q===2&&(D=revLookup[U.charCodeAt(Y)]<<2|revLookup[U.charCodeAt(Y+1)]>>4,X[q++]=D&255),Q===1&&(D=revLookup[U.charCodeAt(Y)]<<10|revLookup[U.charCodeAt(Y+1)]<<4|revLookup[U.charCodeAt(Y+2)]>>2,X[q++]=D>>8&255,X[q++]=D&255),X}function tripletToBase64(U){return lookup$1[U>>18&63]+lookup$1[U>>12&63]+lookup$1[U>>6&63]+lookup$1[U&63]}function encodeChunk(U,D,F){for(var G,Q=[],X=D;X<F;X+=3)G=(U[X]<<16&16711680)+(U[X+1]<<8&65280)+(U[X+2]&255),Q.push(tripletToBase64(G));return Q.join("")}function fromByteArray(U){for(var D,F=U.length,G=F%3,Q=[],X=16383,q=0,W=F-G;q<W;q+=X)Q.push(encodeChunk(U,q,q+X>W?W:q+X));return G===1?(D=U[F-1],Q.push(lookup$1[D>>2]+lookup$1[D<<4&63]+"==")):G===2&&(D=(U[F-2]<<8)+U[F-1],Q.push(lookup$1[D>>10]+lookup$1[D>>4&63]+lookup$1[D<<2&63]+"=")),Q.join("")}var ieee754={};ieee754.read=function(U,D,F,G,Q){var X,q,W=Q*8-G-1,Y=(1<<W)-1,J=Y>>1,te=-7,Z=F?Q-1:0,ee=F?-1:1,re=U[D+Z];for(Z+=ee,X=re&(1<<-te)-1,re>>=-te,te+=W;te>0;X=X*256+U[D+Z],Z+=ee,te-=8);for(q=X&(1<<-te)-1,X>>=-te,te+=G;te>0;q=q*256+U[D+Z],Z+=ee,te-=8);if(X===0)X=1-J;else{if(X===Y)return q?NaN:(re?-1:1)*(1/0);q=q+Math.pow(2,G),X=X-J}return(re?-1:1)*q*Math.pow(2,X-G)};ieee754.write=function(U,D,F,G,Q,X){var q,W,Y,J=X*8-Q-1,te=(1<<J)-1,Z=te>>1,ee=Q===23?Math.pow(2,-24)-Math.pow(2,-77):0,re=G?0:X-1,ne=G?1:-1,le=D<0||D===0&&1/D<0?1:0;for(D=Math.abs(D),isNaN(D)||D===1/0?(W=isNaN(D)?1:0,q=te):(q=Math.floor(Math.log(D)/Math.LN2),D*(Y=Math.pow(2,-q))<1&&(q--,Y*=2),q+Z>=1?D+=ee/Y:D+=ee*Math.pow(2,1-Z),D*Y>=2&&(q++,Y/=2),q+Z>=te?(W=0,q=te):q+Z>=1?(W=(D*Y-1)*Math.pow(2,Q),q=q+Z):(W=D*Math.pow(2,Z-1)*Math.pow(2,Q),q=0));Q>=8;U[F+re]=W&255,re+=ne,W/=256,Q-=8);for(q=q<<Q|W,J+=Q;J>0;U[F+re]=q&255,re+=ne,q/=256,J-=8);U[F+re-ne]|=le*128};(function(U){const D=base64Js,F=ieee754,G=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;U.Buffer=W,U.SlowBuffer=ge,U.INSPECT_MAX_BYTES=50;const Q=2147483647;U.kMaxLength=Q,W.TYPED_ARRAY_SUPPORT=X(),!W.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function X(){try{const Se=new Uint8Array(1),ce={foo:function(){return 42}};return Object.setPrototypeOf(ce,Uint8Array.prototype),Object.setPrototypeOf(Se,ce),Se.foo()===42}catch{return!1}}Object.defineProperty(W.prototype,"parent",{enumerable:!0,get:function(){if(W.isBuffer(this))return this.buffer}}),Object.defineProperty(W.prototype,"offset",{enumerable:!0,get:function(){if(W.isBuffer(this))return this.byteOffset}});function q(Se){if(Se>Q)throw new RangeError('The value "'+Se+'" is invalid for option "size"');const ce=new Uint8Array(Se);return Object.setPrototypeOf(ce,W.prototype),ce}function W(Se,ce,de){if(typeof Se=="number"){if(typeof ce=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Z(Se)}return Y(Se,ce,de)}W.poolSize=8192;function Y(Se,ce,de){if(typeof Se=="string")return ee(Se,ce);if(ArrayBuffer.isView(Se))return ne(Se);if(Se==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Se);if(Ne(Se,ArrayBuffer)||Se&&Ne(Se.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ne(Se,SharedArrayBuffer)||Se&&Ne(Se.buffer,SharedArrayBuffer)))return le(Se,ce,de);if(typeof Se=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Ae=Se.valueOf&&Se.valueOf();if(Ae!=null&&Ae!==Se)return W.from(Ae,ce,de);const Fe=se(Se);if(Fe)return Fe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Se[Symbol.toPrimitive]=="function")return W.from(Se[Symbol.toPrimitive]("string"),ce,de);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Se)}W.from=function(Se,ce,de){return Y(Se,ce,de)},Object.setPrototypeOf(W.prototype,Uint8Array.prototype),Object.setPrototypeOf(W,Uint8Array);function J(Se){if(typeof Se!="number")throw new TypeError('"size" argument must be of type number');if(Se<0)throw new RangeError('The value "'+Se+'" is invalid for option "size"')}function te(Se,ce,de){return J(Se),Se<=0?q(Se):ce!==void 0?typeof de=="string"?q(Se).fill(ce,de):q(Se).fill(ce):q(Se)}W.alloc=function(Se,ce,de){return te(Se,ce,de)};function Z(Se){return J(Se),q(Se<0?0:ie(Se)|0)}W.allocUnsafe=function(Se){return Z(Se)},W.allocUnsafeSlow=function(Se){return Z(Se)};function ee(Se,ce){if((typeof ce!="string"||ce==="")&&(ce="utf8"),!W.isEncoding(ce))throw new TypeError("Unknown encoding: "+ce);const de=fe(Se,ce)|0;let Ae=q(de);const Fe=Ae.write(Se,ce);return Fe!==de&&(Ae=Ae.slice(0,Fe)),Ae}function re(Se){const ce=Se.length<0?0:ie(Se.length)|0,de=q(ce);for(let Ae=0;Ae<ce;Ae+=1)de[Ae]=Se[Ae]&255;return de}function ne(Se){if(Ne(Se,Uint8Array)){const ce=new Uint8Array(Se);return le(ce.buffer,ce.byteOffset,ce.byteLength)}return re(Se)}function le(Se,ce,de){if(ce<0||Se.byteLength<ce)throw new RangeError('"offset" is outside of buffer bounds');if(Se.byteLength<ce+(de||0))throw new RangeError('"length" is outside of buffer bounds');let Ae;return ce===void 0&&de===void 0?Ae=new Uint8Array(Se):de===void 0?Ae=new Uint8Array(Se,ce):Ae=new Uint8Array(Se,ce,de),Object.setPrototypeOf(Ae,W.prototype),Ae}function se(Se){if(W.isBuffer(Se)){const ce=ie(Se.length)|0,de=q(ce);return de.length===0||Se.copy(de,0,0,ce),de}if(Se.length!==void 0)return typeof Se.length!="number"||Ce(Se.length)?q(0):re(Se);if(Se.type==="Buffer"&&Array.isArray(Se.data))return re(Se.data)}function ie(Se){if(Se>=Q)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Q.toString(16)+" bytes");return Se|0}function ge(Se){return+Se!=Se&&(Se=0),W.alloc(+Se)}W.isBuffer=function(ce){return ce!=null&&ce._isBuffer===!0&&ce!==W.prototype},W.compare=function(ce,de){if(Ne(ce,Uint8Array)&&(ce=W.from(ce,ce.offset,ce.byteLength)),Ne(de,Uint8Array)&&(de=W.from(de,de.offset,de.byteLength)),!W.isBuffer(ce)||!W.isBuffer(de))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(ce===de)return 0;let Ae=ce.length,Fe=de.length;for(let Ve=0,Je=Math.min(Ae,Fe);Ve<Je;++Ve)if(ce[Ve]!==de[Ve]){Ae=ce[Ve],Fe=de[Ve];break}return Ae<Fe?-1:Fe<Ae?1:0},W.isEncoding=function(ce){switch(String(ce).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},W.concat=function(ce,de){if(!Array.isArray(ce))throw new TypeError('"list" argument must be an Array of Buffers');if(ce.length===0)return W.alloc(0);let Ae;if(de===void 0)for(de=0,Ae=0;Ae<ce.length;++Ae)de+=ce[Ae].length;const Fe=W.allocUnsafe(de);let Ve=0;for(Ae=0;Ae<ce.length;++Ae){let Je=ce[Ae];if(Ne(Je,Uint8Array))Ve+Je.length>Fe.length?(W.isBuffer(Je)||(Je=W.from(Je)),Je.copy(Fe,Ve)):Uint8Array.prototype.set.call(Fe,Je,Ve);else if(W.isBuffer(Je))Je.copy(Fe,Ve);else throw new TypeError('"list" argument must be an Array of Buffers');Ve+=Je.length}return Fe};function fe(Se,ce){if(W.isBuffer(Se))return Se.length;if(ArrayBuffer.isView(Se)||Ne(Se,ArrayBuffer))return Se.byteLength;if(typeof Se!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Se);const de=Se.length,Ae=arguments.length>2&&arguments[2]===!0;if(!Ae&&de===0)return 0;let Fe=!1;for(;;)switch(ce){case"ascii":case"latin1":case"binary":return de;case"utf8":case"utf-8":return ke(Se).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return de*2;case"hex":return de>>>1;case"base64":return $e(Se).length;default:if(Fe)return Ae?-1:ke(Se).length;ce=(""+ce).toLowerCase(),Fe=!0}}W.byteLength=fe;function ae(Se,ce,de){let Ae=!1;if((ce===void 0||ce<0)&&(ce=0),ce>this.length||((de===void 0||de>this.length)&&(de=this.length),de<=0)||(de>>>=0,ce>>>=0,de<=ce))return"";for(Se||(Se="utf8");;)switch(Se){case"hex":return Me(this,ce,de);case"utf8":case"utf-8":return oe(this,ce,de);case"ascii":return we(this,ce,de);case"latin1":case"binary":return Pe(this,ce,de);case"base64":return he(this,ce,de);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return De(this,ce,de);default:if(Ae)throw new TypeError("Unknown encoding: "+Se);Se=(Se+"").toLowerCase(),Ae=!0}}W.prototype._isBuffer=!0;function ue(Se,ce,de){const Ae=Se[ce];Se[ce]=Se[de],Se[de]=Ae}W.prototype.swap16=function(){const ce=this.length;if(ce%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let de=0;de<ce;de+=2)ue(this,de,de+1);return this},W.prototype.swap32=function(){const ce=this.length;if(ce%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let de=0;de<ce;de+=4)ue(this,de,de+3),ue(this,de+1,de+2);return this},W.prototype.swap64=function(){const ce=this.length;if(ce%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let de=0;de<ce;de+=8)ue(this,de,de+7),ue(this,de+1,de+6),ue(this,de+2,de+5),ue(this,de+3,de+4);return this},W.prototype.toString=function(){const ce=this.length;return ce===0?"":arguments.length===0?oe(this,0,ce):ae.apply(this,arguments)},W.prototype.toLocaleString=W.prototype.toString,W.prototype.equals=function(ce){if(!W.isBuffer(ce))throw new TypeError("Argument must be a Buffer");return this===ce?!0:W.compare(this,ce)===0},W.prototype.inspect=function(){let ce="";const de=U.INSPECT_MAX_BYTES;return ce=this.toString("hex",0,de).replace(/(.{2})/g,"$1 ").trim(),this.length>de&&(ce+=" ... "),"<Buffer "+ce+">"},G&&(W.prototype[G]=W.prototype.inspect),W.prototype.compare=function(ce,de,Ae,Fe,Ve){if(Ne(ce,Uint8Array)&&(ce=W.from(ce,ce.offset,ce.byteLength)),!W.isBuffer(ce))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof ce);if(de===void 0&&(de=0),Ae===void 0&&(Ae=ce?ce.length:0),Fe===void 0&&(Fe=0),Ve===void 0&&(Ve=this.length),de<0||Ae>ce.length||Fe<0||Ve>this.length)throw new RangeError("out of range index");if(Fe>=Ve&&de>=Ae)return 0;if(Fe>=Ve)return-1;if(de>=Ae)return 1;if(de>>>=0,Ae>>>=0,Fe>>>=0,Ve>>>=0,this===ce)return 0;let Je=Ve-Fe,dt=Ae-de;const St=Math.min(Je,dt),Tt=this.slice(Fe,Ve),At=ce.slice(de,Ae);for(let wt=0;wt<St;++wt)if(Tt[wt]!==At[wt]){Je=Tt[wt],dt=At[wt];break}return Je<dt?-1:dt<Je?1:0};function pe(Se,ce,de,Ae,Fe){if(Se.length===0)return-1;if(typeof de=="string"?(Ae=de,de=0):de>2147483647?de=2147483647:de<-2147483648&&(de=-2147483648),de=+de,Ce(de)&&(de=Fe?0:Se.length-1),de<0&&(de=Se.length+de),de>=Se.length){if(Fe)return-1;de=Se.length-1}else if(de<0)if(Fe)de=0;else return-1;if(typeof ce=="string"&&(ce=W.from(ce,Ae)),W.isBuffer(ce))return ce.length===0?-1:_e(Se,ce,de,Ae,Fe);if(typeof ce=="number")return ce=ce&255,typeof Uint8Array.prototype.indexOf=="function"?Fe?Uint8Array.prototype.indexOf.call(Se,ce,de):Uint8Array.prototype.lastIndexOf.call(Se,ce,de):_e(Se,[ce],de,Ae,Fe);throw new TypeError("val must be string, number or Buffer")}function _e(Se,ce,de,Ae,Fe){let Ve=1,Je=Se.length,dt=ce.length;if(Ae!==void 0&&(Ae=String(Ae).toLowerCase(),Ae==="ucs2"||Ae==="ucs-2"||Ae==="utf16le"||Ae==="utf-16le")){if(Se.length<2||ce.length<2)return-1;Ve=2,Je/=2,dt/=2,de/=2}function St(At,wt){return Ve===1?At[wt]:At.readUInt16BE(wt*Ve)}let Tt;if(Fe){let At=-1;for(Tt=de;Tt<Je;Tt++)if(St(Se,Tt)===St(ce,At===-1?0:Tt-At)){if(At===-1&&(At=Tt),Tt-At+1===dt)return At*Ve}else At!==-1&&(Tt-=Tt-At),At=-1}else for(de+dt>Je&&(de=Je-dt),Tt=de;Tt>=0;Tt--){let At=!0;for(let wt=0;wt<dt;wt++)if(St(Se,Tt+wt)!==St(ce,wt)){At=!1;break}if(At)return Tt}return-1}W.prototype.includes=function(ce,de,Ae){return this.indexOf(ce,de,Ae)!==-1},W.prototype.indexOf=function(ce,de,Ae){return pe(this,ce,de,Ae,!0)},W.prototype.lastIndexOf=function(ce,de,Ae){return pe(this,ce,de,Ae,!1)};function xe(Se,ce,de,Ae){de=Number(de)||0;const Fe=Se.length-de;Ae?(Ae=Number(Ae),Ae>Fe&&(Ae=Fe)):Ae=Fe;const Ve=ce.length;Ae>Ve/2&&(Ae=Ve/2);let Je;for(Je=0;Je<Ae;++Je){const dt=parseInt(ce.substr(Je*2,2),16);if(Ce(dt))return Je;Se[de+Je]=dt}return Je}function be(Se,ce,de,Ae){return Qe(ke(ce,Se.length-de),Se,de,Ae)}function Te(Se,ce,de,Ae){return Qe(He(ce),Se,de,Ae)}function ye(Se,ce,de,Ae){return Qe($e(ce),Se,de,Ae)}function Ee(Se,ce,de,Ae){return Qe(Ke(ce,Se.length-de),Se,de,Ae)}W.prototype.write=function(ce,de,Ae,Fe){if(de===void 0)Fe="utf8",Ae=this.length,de=0;else if(Ae===void 0&&typeof de=="string")Fe=de,Ae=this.length,de=0;else if(isFinite(de))de=de>>>0,isFinite(Ae)?(Ae=Ae>>>0,Fe===void 0&&(Fe="utf8")):(Fe=Ae,Ae=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ve=this.length-de;if((Ae===void 0||Ae>Ve)&&(Ae=Ve),ce.length>0&&(Ae<0||de<0)||de>this.length)throw new RangeError("Attempt to write outside buffer bounds");Fe||(Fe="utf8");let Je=!1;for(;;)switch(Fe){case"hex":return xe(this,ce,de,Ae);case"utf8":case"utf-8":return be(this,ce,de,Ae);case"ascii":case"latin1":case"binary":return Te(this,ce,de,Ae);case"base64":return ye(this,ce,de,Ae);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ee(this,ce,de,Ae);default:if(Je)throw new TypeError("Unknown encoding: "+Fe);Fe=(""+Fe).toLowerCase(),Je=!0}},W.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function he(Se,ce,de){return ce===0&&de===Se.length?D.fromByteArray(Se):D.fromByteArray(Se.slice(ce,de))}function oe(Se,ce,de){de=Math.min(Se.length,de);const Ae=[];let Fe=ce;for(;Fe<de;){const Ve=Se[Fe];let Je=null,dt=Ve>239?4:Ve>223?3:Ve>191?2:1;if(Fe+dt<=de){let St,Tt,At,wt;switch(dt){case 1:Ve<128&&(Je=Ve);break;case 2:St=Se[Fe+1],(St&192)===128&&(wt=(Ve&31)<<6|St&63,wt>127&&(Je=wt));break;case 3:St=Se[Fe+1],Tt=Se[Fe+2],(St&192)===128&&(Tt&192)===128&&(wt=(Ve&15)<<12|(St&63)<<6|Tt&63,wt>2047&&(wt<55296||wt>57343)&&(Je=wt));break;case 4:St=Se[Fe+1],Tt=Se[Fe+2],At=Se[Fe+3],(St&192)===128&&(Tt&192)===128&&(At&192)===128&&(wt=(Ve&15)<<18|(St&63)<<12|(Tt&63)<<6|At&63,wt>65535&&wt<1114112&&(Je=wt))}}Je===null?(Je=65533,dt=1):Je>65535&&(Je-=65536,Ae.push(Je>>>10&1023|55296),Je=56320|Je&1023),Ae.push(Je),Fe+=dt}return ve(Ae)}const me=4096;function ve(Se){const ce=Se.length;if(ce<=me)return String.fromCharCode.apply(String,Se);let de="",Ae=0;for(;Ae<ce;)de+=String.fromCharCode.apply(String,Se.slice(Ae,Ae+=me));return de}function we(Se,ce,de){let Ae="";de=Math.min(Se.length,de);for(let Fe=ce;Fe<de;++Fe)Ae+=String.fromCharCode(Se[Fe]&127);return Ae}function Pe(Se,ce,de){let Ae="";de=Math.min(Se.length,de);for(let Fe=ce;Fe<de;++Fe)Ae+=String.fromCharCode(Se[Fe]);return Ae}function Me(Se,ce,de){const Ae=Se.length;(!ce||ce<0)&&(ce=0),(!de||de<0||de>Ae)&&(de=Ae);let Fe="";for(let Ve=ce;Ve<de;++Ve)Fe+=Ze[Se[Ve]];return Fe}function De(Se,ce,de){const Ae=Se.slice(ce,de);let Fe="";for(let Ve=0;Ve<Ae.length-1;Ve+=2)Fe+=String.fromCharCode(Ae[Ve]+Ae[Ve+1]*256);return Fe}W.prototype.slice=function(ce,de){const Ae=this.length;ce=~~ce,de=de===void 0?Ae:~~de,ce<0?(ce+=Ae,ce<0&&(ce=0)):ce>Ae&&(ce=Ae),de<0?(de+=Ae,de<0&&(de=0)):de>Ae&&(de=Ae),de<ce&&(de=ce);const Fe=this.subarray(ce,de);return Object.setPrototypeOf(Fe,W.prototype),Fe};function Oe(Se,ce,de){if(Se%1!==0||Se<0)throw new RangeError("offset is not uint");if(Se+ce>de)throw new RangeError("Trying to access beyond buffer length")}W.prototype.readUintLE=W.prototype.readUIntLE=function(ce,de,Ae){ce=ce>>>0,de=de>>>0,Ae||Oe(ce,de,this.length);let Fe=this[ce],Ve=1,Je=0;for(;++Je<de&&(Ve*=256);)Fe+=this[ce+Je]*Ve;return Fe},W.prototype.readUintBE=W.prototype.readUIntBE=function(ce,de,Ae){ce=ce>>>0,de=de>>>0,Ae||Oe(ce,de,this.length);let Fe=this[ce+--de],Ve=1;for(;de>0&&(Ve*=256);)Fe+=this[ce+--de]*Ve;return Fe},W.prototype.readUint8=W.prototype.readUInt8=function(ce,de){return ce=ce>>>0,de||Oe(ce,1,this.length),this[ce]},W.prototype.readUint16LE=W.prototype.readUInt16LE=function(ce,de){return ce=ce>>>0,de||Oe(ce,2,this.length),this[ce]|this[ce+1]<<8},W.prototype.readUint16BE=W.prototype.readUInt16BE=function(ce,de){return ce=ce>>>0,de||Oe(ce,2,this.length),this[ce]<<8|this[ce+1]},W.prototype.readUint32LE=W.prototype.readUInt32LE=function(ce,de){return ce=ce>>>0,de||Oe(ce,4,this.length),(this[ce]|this[ce+1]<<8|this[ce+2]<<16)+this[ce+3]*16777216},W.prototype.readUint32BE=W.prototype.readUInt32BE=function(ce,de){return ce=ce>>>0,de||Oe(ce,4,this.length),this[ce]*16777216+(this[ce+1]<<16|this[ce+2]<<8|this[ce+3])},W.prototype.readBigUInt64LE=at(function(ce){ce=ce>>>0,Re(ce,"offset");const de=this[ce],Ae=this[ce+7];(de===void 0||Ae===void 0)&&Ue(ce,this.length-8);const Fe=de+this[++ce]*2**8+this[++ce]*2**16+this[++ce]*2**24,Ve=this[++ce]+this[++ce]*2**8+this[++ce]*2**16+Ae*2**24;return BigInt(Fe)+(BigInt(Ve)<<BigInt(32))}),W.prototype.readBigUInt64BE=at(function(ce){ce=ce>>>0,Re(ce,"offset");const de=this[ce],Ae=this[ce+7];(de===void 0||Ae===void 0)&&Ue(ce,this.length-8);const Fe=de*2**24+this[++ce]*2**16+this[++ce]*2**8+this[++ce],Ve=this[++ce]*2**24+this[++ce]*2**16+this[++ce]*2**8+Ae;return(BigInt(Fe)<<BigInt(32))+BigInt(Ve)}),W.prototype.readIntLE=function(ce,de,Ae){ce=ce>>>0,de=de>>>0,Ae||Oe(ce,de,this.length);let Fe=this[ce],Ve=1,Je=0;for(;++Je<de&&(Ve*=256);)Fe+=this[ce+Je]*Ve;return Ve*=128,Fe>=Ve&&(Fe-=Math.pow(2,8*de)),Fe},W.prototype.readIntBE=function(ce,de,Ae){ce=ce>>>0,de=de>>>0,Ae||Oe(ce,de,this.length);let Fe=de,Ve=1,Je=this[ce+--Fe];for(;Fe>0&&(Ve*=256);)Je+=this[ce+--Fe]*Ve;return Ve*=128,Je>=Ve&&(Je-=Math.pow(2,8*de)),Je},W.prototype.readInt8=function(ce,de){return ce=ce>>>0,de||Oe(ce,1,this.length),this[ce]&128?(255-this[ce]+1)*-1:this[ce]},W.prototype.readInt16LE=function(ce,de){ce=ce>>>0,de||Oe(ce,2,this.length);const Ae=this[ce]|this[ce+1]<<8;return Ae&32768?Ae|4294901760:Ae},W.prototype.readInt16BE=function(ce,de){ce=ce>>>0,de||Oe(ce,2,this.length);const Ae=this[ce+1]|this[ce]<<8;return Ae&32768?Ae|4294901760:Ae},W.prototype.readInt32LE=function(ce,de){return ce=ce>>>0,de||Oe(ce,4,this.length),this[ce]|this[ce+1]<<8|this[ce+2]<<16|this[ce+3]<<24},W.prototype.readInt32BE=function(ce,de){return ce=ce>>>0,de||Oe(ce,4,this.length),this[ce]<<24|this[ce+1]<<16|this[ce+2]<<8|this[ce+3]},W.prototype.readBigInt64LE=at(function(ce){ce=ce>>>0,Re(ce,"offset");const de=this[ce],Ae=this[ce+7];(de===void 0||Ae===void 0)&&Ue(ce,this.length-8);const Fe=this[ce+4]+this[ce+5]*2**8+this[ce+6]*2**16+(Ae<<24);return(BigInt(Fe)<<BigInt(32))+BigInt(de+this[++ce]*2**8+this[++ce]*2**16+this[++ce]*2**24)}),W.prototype.readBigInt64BE=at(function(ce){ce=ce>>>0,Re(ce,"offset");const de=this[ce],Ae=this[ce+7];(de===void 0||Ae===void 0)&&Ue(ce,this.length-8);const Fe=(de<<24)+this[++ce]*2**16+this[++ce]*2**8+this[++ce];return(BigInt(Fe)<<BigInt(32))+BigInt(this[++ce]*2**24+this[++ce]*2**16+this[++ce]*2**8+Ae)}),W.prototype.readFloatLE=function(ce,de){return ce=ce>>>0,de||Oe(ce,4,this.length),F.read(this,ce,!0,23,4)},W.prototype.readFloatBE=function(ce,de){return ce=ce>>>0,de||Oe(ce,4,this.length),F.read(this,ce,!1,23,4)},W.prototype.readDoubleLE=function(ce,de){return ce=ce>>>0,de||Oe(ce,8,this.length),F.read(this,ce,!0,52,8)},W.prototype.readDoubleBE=function(ce,de){return ce=ce>>>0,de||Oe(ce,8,this.length),F.read(this,ce,!1,52,8)};function Ie(Se,ce,de,Ae,Fe,Ve){if(!W.isBuffer(Se))throw new TypeError('"buffer" argument must be a Buffer instance');if(ce>Fe||ce<Ve)throw new RangeError('"value" argument is out of bounds');if(de+Ae>Se.length)throw new RangeError("Index out of range")}W.prototype.writeUintLE=W.prototype.writeUIntLE=function(ce,de,Ae,Fe){if(ce=+ce,de=de>>>0,Ae=Ae>>>0,!Fe){const dt=Math.pow(2,8*Ae)-1;Ie(this,ce,de,Ae,dt,0)}let Ve=1,Je=0;for(this[de]=ce&255;++Je<Ae&&(Ve*=256);)this[de+Je]=ce/Ve&255;return de+Ae},W.prototype.writeUintBE=W.prototype.writeUIntBE=function(ce,de,Ae,Fe){if(ce=+ce,de=de>>>0,Ae=Ae>>>0,!Fe){const dt=Math.pow(2,8*Ae)-1;Ie(this,ce,de,Ae,dt,0)}let Ve=Ae-1,Je=1;for(this[de+Ve]=ce&255;--Ve>=0&&(Je*=256);)this[de+Ve]=ce/Je&255;return de+Ae},W.prototype.writeUint8=W.prototype.writeUInt8=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,1,255,0),this[de]=ce&255,de+1},W.prototype.writeUint16LE=W.prototype.writeUInt16LE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,2,65535,0),this[de]=ce&255,this[de+1]=ce>>>8,de+2},W.prototype.writeUint16BE=W.prototype.writeUInt16BE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,2,65535,0),this[de]=ce>>>8,this[de+1]=ce&255,de+2},W.prototype.writeUint32LE=W.prototype.writeUInt32LE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,4,4294967295,0),this[de+3]=ce>>>24,this[de+2]=ce>>>16,this[de+1]=ce>>>8,this[de]=ce&255,de+4},W.prototype.writeUint32BE=W.prototype.writeUInt32BE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,4,4294967295,0),this[de]=ce>>>24,this[de+1]=ce>>>16,this[de+2]=ce>>>8,this[de+3]=ce&255,de+4};function Be(Se,ce,de,Ae,Fe){We(ce,Ae,Fe,Se,de,7);let Ve=Number(ce&BigInt(4294967295));Se[de++]=Ve,Ve=Ve>>8,Se[de++]=Ve,Ve=Ve>>8,Se[de++]=Ve,Ve=Ve>>8,Se[de++]=Ve;let Je=Number(ce>>BigInt(32)&BigInt(4294967295));return Se[de++]=Je,Je=Je>>8,Se[de++]=Je,Je=Je>>8,Se[de++]=Je,Je=Je>>8,Se[de++]=Je,de}function ze(Se,ce,de,Ae,Fe){We(ce,Ae,Fe,Se,de,7);let Ve=Number(ce&BigInt(4294967295));Se[de+7]=Ve,Ve=Ve>>8,Se[de+6]=Ve,Ve=Ve>>8,Se[de+5]=Ve,Ve=Ve>>8,Se[de+4]=Ve;let Je=Number(ce>>BigInt(32)&BigInt(4294967295));return Se[de+3]=Je,Je=Je>>8,Se[de+2]=Je,Je=Je>>8,Se[de+1]=Je,Je=Je>>8,Se[de]=Je,de+8}W.prototype.writeBigUInt64LE=at(function(ce,de=0){return Be(this,ce,de,BigInt(0),BigInt("0xffffffffffffffff"))}),W.prototype.writeBigUInt64BE=at(function(ce,de=0){return ze(this,ce,de,BigInt(0),BigInt("0xffffffffffffffff"))}),W.prototype.writeIntLE=function(ce,de,Ae,Fe){if(ce=+ce,de=de>>>0,!Fe){const St=Math.pow(2,8*Ae-1);Ie(this,ce,de,Ae,St-1,-St)}let Ve=0,Je=1,dt=0;for(this[de]=ce&255;++Ve<Ae&&(Je*=256);)ce<0&&dt===0&&this[de+Ve-1]!==0&&(dt=1),this[de+Ve]=(ce/Je>>0)-dt&255;return de+Ae},W.prototype.writeIntBE=function(ce,de,Ae,Fe){if(ce=+ce,de=de>>>0,!Fe){const St=Math.pow(2,8*Ae-1);Ie(this,ce,de,Ae,St-1,-St)}let Ve=Ae-1,Je=1,dt=0;for(this[de+Ve]=ce&255;--Ve>=0&&(Je*=256);)ce<0&&dt===0&&this[de+Ve+1]!==0&&(dt=1),this[de+Ve]=(ce/Je>>0)-dt&255;return de+Ae},W.prototype.writeInt8=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,1,127,-128),ce<0&&(ce=255+ce+1),this[de]=ce&255,de+1},W.prototype.writeInt16LE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,2,32767,-32768),this[de]=ce&255,this[de+1]=ce>>>8,de+2},W.prototype.writeInt16BE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,2,32767,-32768),this[de]=ce>>>8,this[de+1]=ce&255,de+2},W.prototype.writeInt32LE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,4,2147483647,-2147483648),this[de]=ce&255,this[de+1]=ce>>>8,this[de+2]=ce>>>16,this[de+3]=ce>>>24,de+4},W.prototype.writeInt32BE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,4,2147483647,-2147483648),ce<0&&(ce=4294967295+ce+1),this[de]=ce>>>24,this[de+1]=ce>>>16,this[de+2]=ce>>>8,this[de+3]=ce&255,de+4},W.prototype.writeBigInt64LE=at(function(ce,de=0){return Be(this,ce,de,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),W.prototype.writeBigInt64BE=at(function(ce,de=0){return ze(this,ce,de,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function et(Se,ce,de,Ae,Fe,Ve){if(de+Ae>Se.length)throw new RangeError("Index out of range");if(de<0)throw new RangeError("Index out of range")}function qe(Se,ce,de,Ae,Fe){return ce=+ce,de=de>>>0,Fe||et(Se,ce,de,4),F.write(Se,ce,de,Ae,23,4),de+4}W.prototype.writeFloatLE=function(ce,de,Ae){return qe(this,ce,de,!0,Ae)},W.prototype.writeFloatBE=function(ce,de,Ae){return qe(this,ce,de,!1,Ae)};function je(Se,ce,de,Ae,Fe){return ce=+ce,de=de>>>0,Fe||et(Se,ce,de,8),F.write(Se,ce,de,Ae,52,8),de+8}W.prototype.writeDoubleLE=function(ce,de,Ae){return je(this,ce,de,!0,Ae)},W.prototype.writeDoubleBE=function(ce,de,Ae){return je(this,ce,de,!1,Ae)},W.prototype.copy=function(ce,de,Ae,Fe){if(!W.isBuffer(ce))throw new TypeError("argument should be a Buffer");if(Ae||(Ae=0),!Fe&&Fe!==0&&(Fe=this.length),de>=ce.length&&(de=ce.length),de||(de=0),Fe>0&&Fe<Ae&&(Fe=Ae),Fe===Ae||ce.length===0||this.length===0)return 0;if(de<0)throw new RangeError("targetStart out of bounds");if(Ae<0||Ae>=this.length)throw new RangeError("Index out of range");if(Fe<0)throw new RangeError("sourceEnd out of bounds");Fe>this.length&&(Fe=this.length),ce.length-de<Fe-Ae&&(Fe=ce.length-de+Ae);const Ve=Fe-Ae;return this===ce&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(de,Ae,Fe):Uint8Array.prototype.set.call(ce,this.subarray(Ae,Fe),de),Ve},W.prototype.fill=function(ce,de,Ae,Fe){if(typeof ce=="string"){if(typeof de=="string"?(Fe=de,de=0,Ae=this.length):typeof Ae=="string"&&(Fe=Ae,Ae=this.length),Fe!==void 0&&typeof Fe!="string")throw new TypeError("encoding must be a string");if(typeof Fe=="string"&&!W.isEncoding(Fe))throw new TypeError("Unknown encoding: "+Fe);if(ce.length===1){const Je=ce.charCodeAt(0);(Fe==="utf8"&&Je<128||Fe==="latin1")&&(ce=Je)}}else typeof ce=="number"?ce=ce&255:typeof ce=="boolean"&&(ce=Number(ce));if(de<0||this.length<de||this.length<Ae)throw new RangeError("Out of range index");if(Ae<=de)return this;de=de>>>0,Ae=Ae===void 0?this.length:Ae>>>0,ce||(ce=0);let Ve;if(typeof ce=="number")for(Ve=de;Ve<Ae;++Ve)this[Ve]=ce;else{const Je=W.isBuffer(ce)?ce:W.from(ce,Fe),dt=Je.length;if(dt===0)throw new TypeError('The value "'+ce+'" is invalid for argument "value"');for(Ve=0;Ve<Ae-de;++Ve)this[Ve+de]=Je[Ve%dt]}return this};const it={};function ct(Se,ce,de){it[Se]=class extends de{constructor(){super(),Object.defineProperty(this,"message",{value:ce.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Se}]`,this.stack,delete this.name}get code(){return Se}set code(Fe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Fe,writable:!0})}toString(){return`${this.name} [${Se}]: ${this.message}`}}}ct("ERR_BUFFER_OUT_OF_BOUNDS",function(Se){return Se?`${Se} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ct("ERR_INVALID_ARG_TYPE",function(Se,ce){return`The "${Se}" argument must be of type number. Received type ${typeof ce}`},TypeError),ct("ERR_OUT_OF_RANGE",function(Se,ce,de){let Ae=`The value of "${Se}" is out of range.`,Fe=de;return Number.isInteger(de)&&Math.abs(de)>2**32?Fe=rt(String(de)):typeof de=="bigint"&&(Fe=String(de),(de>BigInt(2)**BigInt(32)||de<-(BigInt(2)**BigInt(32)))&&(Fe=rt(Fe)),Fe+="n"),Ae+=` It must be ${ce}. Received ${Fe}`,Ae},RangeError);function rt(Se){let ce="",de=Se.length;const Ae=Se[0]==="-"?1:0;for(;de>=Ae+4;de-=3)ce=`_${Se.slice(de-3,de)}${ce}`;return`${Se.slice(0,de)}${ce}`}function ut(Se,ce,de){Re(ce,"offset"),(Se[ce]===void 0||Se[ce+de]===void 0)&&Ue(ce,Se.length-(de+1))}function We(Se,ce,de,Ae,Fe,Ve){if(Se>de||Se<ce){const Je=typeof ce=="bigint"?"n":"";let dt;throw Ve>3?ce===0||ce===BigInt(0)?dt=`>= 0${Je} and < 2${Je} ** ${(Ve+1)*8}${Je}`:dt=`>= -(2${Je} ** ${(Ve+1)*8-1}${Je}) and < 2 ** ${(Ve+1)*8-1}${Je}`:dt=`>= ${ce}${Je} and <= ${de}${Je}`,new it.ERR_OUT_OF_RANGE("value",dt,Se)}ut(Ae,Fe,Ve)}function Re(Se,ce){if(typeof Se!="number")throw new it.ERR_INVALID_ARG_TYPE(ce,"number",Se)}function Ue(Se,ce,de){throw Math.floor(Se)!==Se?(Re(Se,de),new it.ERR_OUT_OF_RANGE(de||"offset","an integer",Se)):ce<0?new it.ERR_BUFFER_OUT_OF_BOUNDS:new it.ERR_OUT_OF_RANGE(de||"offset",`>= ${de?1:0} and <= ${ce}`,Se)}const Le=/[^+/0-9A-Za-z-_]/g;function Ge(Se){if(Se=Se.split("=")[0],Se=Se.trim().replace(Le,""),Se.length<2)return"";for(;Se.length%4!==0;)Se=Se+"=";return Se}function ke(Se,ce){ce=ce||1/0;let de;const Ae=Se.length;let Fe=null;const Ve=[];for(let Je=0;Je<Ae;++Je){if(de=Se.charCodeAt(Je),de>55295&&de<57344){if(!Fe){if(de>56319){(ce-=3)>-1&&Ve.push(239,191,189);continue}else if(Je+1===Ae){(ce-=3)>-1&&Ve.push(239,191,189);continue}Fe=de;continue}if(de<56320){(ce-=3)>-1&&Ve.push(239,191,189),Fe=de;continue}de=(Fe-55296<<10|de-56320)+65536}else Fe&&(ce-=3)>-1&&Ve.push(239,191,189);if(Fe=null,de<128){if((ce-=1)<0)break;Ve.push(de)}else if(de<2048){if((ce-=2)<0)break;Ve.push(de>>6|192,de&63|128)}else if(de<65536){if((ce-=3)<0)break;Ve.push(de>>12|224,de>>6&63|128,de&63|128)}else if(de<1114112){if((ce-=4)<0)break;Ve.push(de>>18|240,de>>12&63|128,de>>6&63|128,de&63|128)}else throw new Error("Invalid code point")}return Ve}function He(Se){const ce=[];for(let de=0;de<Se.length;++de)ce.push(Se.charCodeAt(de)&255);return ce}function Ke(Se,ce){let de,Ae,Fe;const Ve=[];for(let Je=0;Je<Se.length&&!((ce-=2)<0);++Je)de=Se.charCodeAt(Je),Ae=de>>8,Fe=de%256,Ve.push(Fe),Ve.push(Ae);return Ve}function $e(Se){return D.toByteArray(Ge(Se))}function Qe(Se,ce,de,Ae){let Fe;for(Fe=0;Fe<Ae&&!(Fe+de>=ce.length||Fe>=Se.length);++Fe)ce[Fe+de]=Se[Fe];return Fe}function Ne(Se,ce){return Se instanceof ce||Se!=null&&Se.constructor!=null&&Se.constructor.name!=null&&Se.constructor.name===ce.name}function Ce(Se){return Se!==Se}const Ze=function(){const Se="0123456789abcdef",ce=new Array(256);for(let de=0;de<16;++de){const Ae=de*16;for(let Fe=0;Fe<16;++Fe)ce[Ae+Fe]=Se[de]+Se[Fe]}return ce}();function at(Se){return typeof BigInt>"u"?st:Se}function st(){throw new Error("BigInt not supported")}})(buffer$1);let lazy=null;var textEndec$1=function(){return lazy===null&&(lazy={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),lazy},formats$2={},encoding={};const ModuleError$8=moduleError,formats$1=new Set(["buffer","view","utf8"]);let Encoding$2=class{constructor(D){if(this.encode=D.encode||this.encode,this.decode=D.decode||this.decode,this.name=D.name||this.name,this.format=D.format||this.format,typeof this.encode!="function")throw new TypeError("The 'encode' property must be a function");if(typeof this.decode!="function")throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),typeof this.name!="string"||this.name==="")throw new TypeError("The 'name' property must be a string");if(typeof this.format!="string"||!formats$1.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");D.createViewTranscoder&&(this.createViewTranscoder=D.createViewTranscoder),D.createBufferTranscoder&&(this.createBufferTranscoder=D.createBufferTranscoder),D.createUTF8Transcoder&&(this.createUTF8Transcoder=D.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}};encoding.Encoding=Encoding$2;const{Buffer:Buffer$1}=buffer$1||{},{Encoding:Encoding$1}=encoding,textEndec=textEndec$1;let BufferFormat$2=class extends Encoding$1{constructor(D){super({...D,format:"buffer"})}createViewTranscoder(){return new ViewFormat$2({encode:this.encode,decode:D=>this.decode(Buffer$1.from(D.buffer,D.byteOffset,D.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}},ViewFormat$2=class extends Encoding$1{constructor(D){super({...D,format:"view"})}createBufferTranscoder(){return new BufferFormat$2({encode:D=>{const F=this.encode(D);return Buffer$1.from(F.buffer,F.byteOffset,F.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}},UTF8Format$2=class extends Encoding$1{constructor(D){super({...D,format:"utf8"})}createBufferTranscoder(){return new BufferFormat$2({encode:D=>Buffer$1.from(this.encode(D),"utf8"),decode:D=>this.decode(D.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:D,textDecoder:F}=textEndec();return new ViewFormat$2({encode:G=>D.encode(this.encode(G)),decode:G=>this.decode(F.decode(G)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}};formats$2.BufferFormat=BufferFormat$2;formats$2.ViewFormat=ViewFormat$2;formats$2.UTF8Format=UTF8Format$2;const{Buffer}=buffer$1||{Buffer:{isBuffer:()=>!1}},{textEncoder,textDecoder}=textEndec$1(),{BufferFormat:BufferFormat$1,ViewFormat:ViewFormat$1,UTF8Format:UTF8Format$1}=formats$2,identity$4=U=>U;encodings$1.utf8=new UTF8Format$1({encode:function(U){return Buffer.isBuffer(U)?U.toString("utf8"):ArrayBuffer.isView(U)?textDecoder.decode(U):String(U)},decode:identity$4,name:"utf8",createViewTranscoder(){return new ViewFormat$1({encode:function(U){return ArrayBuffer.isView(U)?U:textEncoder.encode(U)},decode:function(U){return textDecoder.decode(U)},name:`${this.name}+view`})},createBufferTranscoder(){return new BufferFormat$1({encode:function(U){return Buffer.isBuffer(U)?U:ArrayBuffer.isView(U)?Buffer.from(U.buffer,U.byteOffset,U.byteLength):Buffer.from(String(U),"utf8")},decode:function(U){return U.toString("utf8")},name:`${this.name}+buffer`})}});encodings$1.json=new UTF8Format$1({encode:JSON.stringify,decode:JSON.parse,name:"json"});encodings$1.buffer=new BufferFormat$1({encode:function(U){return Buffer.isBuffer(U)?U:ArrayBuffer.isView(U)?Buffer.from(U.buffer,U.byteOffset,U.byteLength):Buffer.from(String(U),"utf8")},decode:identity$4,name:"buffer",createViewTranscoder(){return new ViewFormat$1({encode:function(U){return ArrayBuffer.isView(U)?U:Buffer.from(String(U),"utf8")},decode:function(U){return Buffer.from(U.buffer,U.byteOffset,U.byteLength)},name:`${this.name}+view`})}});encodings$1.view=new ViewFormat$1({encode:function(U){return ArrayBuffer.isView(U)?U:textEncoder.encode(U)},decode:identity$4,name:"view",createBufferTranscoder(){return new BufferFormat$1({encode:function(U){return Buffer.isBuffer(U)?U:ArrayBuffer.isView(U)?Buffer.from(U.buffer,U.byteOffset,U.byteLength):Buffer.from(String(U),"utf8")},decode:identity$4,name:`${this.name}+buffer`})}});encodings$1.hex=new BufferFormat$1({encode:function(U){return Buffer.isBuffer(U)?U:Buffer.from(String(U),"hex")},decode:function(U){return U.toString("hex")},name:"hex"});encodings$1.base64=new BufferFormat$1({encode:function(U){return Buffer.isBuffer(U)?U:Buffer.from(String(U),"base64")},decode:function(U){return U.toString("base64")},name:"base64"});const ModuleError$7=moduleError,encodings=encodings$1,{Encoding}=encoding,{BufferFormat,ViewFormat,UTF8Format}=formats$2,kFormats=Symbol("formats"),kEncodings=Symbol("encodings"),validFormats=new Set(["buffer","view","utf8"]);let Transcoder$1=class{constructor(D){if(Array.isArray(D)){if(!D.every(F=>validFormats.has(F)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}else throw new TypeError("The first argument 'formats' must be an array");this[kEncodings]=new Map,this[kFormats]=new Set(D);for(const F in encodings)try{this.encoding(F)}catch(G){if(G.code!=="LEVEL_ENCODING_NOT_SUPPORTED")throw G}}encodings(){return Array.from(new Set(this[kEncodings].values()))}encoding(D){let F=this[kEncodings].get(D);if(F===void 0){if(typeof D=="string"&&D!==""){if(F=lookup[D],!F)throw new ModuleError$7(`Encoding '${D}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if(typeof D!="object"||D===null)throw new TypeError("First argument 'encoding' must be a string or object");F=from(D)}const{name:G,format:Q}=F;if(!this[kFormats].has(Q))if(this[kFormats].has("view"))F=F.createViewTranscoder();else if(this[kFormats].has("buffer"))F=F.createBufferTranscoder();else if(this[kFormats].has("utf8"))F=F.createUTF8Transcoder();else throw new ModuleError$7(`Encoding '${G}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});for(const X of[D,G,F.name,F.commonName])this[kEncodings].set(X,F)}return F}};levelTranscoder.Transcoder=Transcoder$1;function from(U){if(U instanceof Encoding)return U;const D="type"in U&&typeof U.type=="string"?U.type:void 0,F=U.name||D||`anonymous-${anonymousCount++}`;switch(detectFormat(U)){case"view":return new ViewFormat({...U,name:F});case"utf8":return new UTF8Format({...U,name:F});case"buffer":return new BufferFormat({...U,name:F});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function detectFormat(U){return"format"in U&&U.format!==void 0?U.format:"buffer"in U&&typeof U.buffer=="boolean"?U.buffer?"buffer":"utf8":"code"in U&&Number.isInteger(U.code)?"view":"buffer"}const aliases={binary:encodings.buffer,"utf-8":encodings.utf8},lookup={...encodings,...aliases};let anonymousCount=0;var eventsExports={},events={get exports(){return eventsExports},set exports(U){eventsExports=U}},R$1=typeof Reflect=="object"?Reflect:null,ReflectApply=R$1&&typeof R$1.apply=="function"?R$1.apply:function(D,F,G){return Function.prototype.apply.call(D,F,G)},ReflectOwnKeys;R$1&&typeof R$1.ownKeys=="function"?ReflectOwnKeys=R$1.ownKeys:Object.getOwnPropertySymbols?ReflectOwnKeys=function(D){return Object.getOwnPropertyNames(D).concat(Object.getOwnPropertySymbols(D))}:ReflectOwnKeys=function(D){return Object.getOwnPropertyNames(D)};function ProcessEmitWarning(U){console&&console.warn&&console.warn(U)}var NumberIsNaN=Number.isNaN||function(D){return D!==D};function EventEmitter$1(){EventEmitter$1.init.call(this)}events.exports=EventEmitter$1;eventsExports.once=once;EventEmitter$1.EventEmitter=EventEmitter$1;EventEmitter$1.prototype._events=void 0;EventEmitter$1.prototype._eventsCount=0;EventEmitter$1.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(U){if(typeof U!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof U)}Object.defineProperty(EventEmitter$1,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(U){if(typeof U!="number"||U<0||NumberIsNaN(U))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+U+".");defaultMaxListeners=U}});EventEmitter$1.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};EventEmitter$1.prototype.setMaxListeners=function(D){if(typeof D!="number"||D<0||NumberIsNaN(D))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+D+".");return this._maxListeners=D,this};function _getMaxListeners(U){return U._maxListeners===void 0?EventEmitter$1.defaultMaxListeners:U._maxListeners}EventEmitter$1.prototype.getMaxListeners=function(){return _getMaxListeners(this)};EventEmitter$1.prototype.emit=function(D){for(var F=[],G=1;G<arguments.length;G++)F.push(arguments[G]);var Q=D==="error",X=this._events;if(X!==void 0)Q=Q&&X.error===void 0;else if(!Q)return!1;if(Q){var q;if(F.length>0&&(q=F[0]),q instanceof Error)throw q;var W=new Error("Unhandled error."+(q?" ("+q.message+")":""));throw W.context=q,W}var Y=X[D];if(Y===void 0)return!1;if(typeof Y=="function")ReflectApply(Y,this,F);else for(var J=Y.length,te=arrayClone(Y,J),G=0;G<J;++G)ReflectApply(te[G],this,F);return!0};function _addListener(U,D,F,G){var Q,X,q;if(checkListener(F),X=U._events,X===void 0?(X=U._events=Object.create(null),U._eventsCount=0):(X.newListener!==void 0&&(U.emit("newListener",D,F.listener?F.listener:F),X=U._events),q=X[D]),q===void 0)q=X[D]=F,++U._eventsCount;else if(typeof q=="function"?q=X[D]=G?[F,q]:[q,F]:G?q.unshift(F):q.push(F),Q=_getMaxListeners(U),Q>0&&q.length>Q&&!q.warned){q.warned=!0;var W=new Error("Possible EventEmitter memory leak detected. "+q.length+" "+String(D)+" listeners added. Use emitter.setMaxListeners() to increase limit");W.name="MaxListenersExceededWarning",W.emitter=U,W.type=D,W.count=q.length,ProcessEmitWarning(W)}return U}EventEmitter$1.prototype.addListener=function(D,F){return _addListener(this,D,F,!1)};EventEmitter$1.prototype.on=EventEmitter$1.prototype.addListener;EventEmitter$1.prototype.prependListener=function(D,F){return _addListener(this,D,F,!0)};function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(U,D,F){var G={fired:!1,wrapFn:void 0,target:U,type:D,listener:F},Q=onceWrapper.bind(G);return Q.listener=F,G.wrapFn=Q,Q}EventEmitter$1.prototype.once=function(D,F){return checkListener(F),this.on(D,_onceWrap(this,D,F)),this};EventEmitter$1.prototype.prependOnceListener=function(D,F){return checkListener(F),this.prependListener(D,_onceWrap(this,D,F)),this};EventEmitter$1.prototype.removeListener=function(D,F){var G,Q,X,q,W;if(checkListener(F),Q=this._events,Q===void 0)return this;if(G=Q[D],G===void 0)return this;if(G===F||G.listener===F)--this._eventsCount===0?this._events=Object.create(null):(delete Q[D],Q.removeListener&&this.emit("removeListener",D,G.listener||F));else if(typeof G!="function"){for(X=-1,q=G.length-1;q>=0;q--)if(G[q]===F||G[q].listener===F){W=G[q].listener,X=q;break}if(X<0)return this;X===0?G.shift():spliceOne(G,X),G.length===1&&(Q[D]=G[0]),Q.removeListener!==void 0&&this.emit("removeListener",D,W||F)}return this};EventEmitter$1.prototype.off=EventEmitter$1.prototype.removeListener;EventEmitter$1.prototype.removeAllListeners=function(D){var F,G,Q;if(G=this._events,G===void 0)return this;if(G.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):G[D]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete G[D]),this;if(arguments.length===0){var X=Object.keys(G),q;for(Q=0;Q<X.length;++Q)q=X[Q],q!=="removeListener"&&this.removeAllListeners(q);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(F=G[D],typeof F=="function")this.removeListener(D,F);else if(F!==void 0)for(Q=F.length-1;Q>=0;Q--)this.removeListener(D,F[Q]);return this};function _listeners(U,D,F){var G=U._events;if(G===void 0)return[];var Q=G[D];return Q===void 0?[]:typeof Q=="function"?F?[Q.listener||Q]:[Q]:F?unwrapListeners(Q):arrayClone(Q,Q.length)}EventEmitter$1.prototype.listeners=function(D){return _listeners(this,D,!0)};EventEmitter$1.prototype.rawListeners=function(D){return _listeners(this,D,!1)};EventEmitter$1.listenerCount=function(U,D){return typeof U.listenerCount=="function"?U.listenerCount(D):listenerCount.call(U,D)};EventEmitter$1.prototype.listenerCount=listenerCount;function listenerCount(U){var D=this._events;if(D!==void 0){var F=D[U];if(typeof F=="function")return 1;if(F!==void 0)return F.length}return 0}EventEmitter$1.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(U,D){for(var F=new Array(D),G=0;G<D;++G)F[G]=U[G];return F}function spliceOne(U,D){for(;D+1<U.length;D++)U[D]=U[D+1];U.pop()}function unwrapListeners(U){for(var D=new Array(U.length),F=0;F<D.length;++F)D[F]=U[F].listener||U[F];return D}function once(U,D){return new Promise(function(F,G){function Q(q){U.removeListener(D,X),G(q)}function X(){typeof U.removeListener=="function"&&U.removeListener("error",Q),F([].slice.call(arguments))}eventTargetAgnosticAddListener(U,D,X,{once:!0}),D!=="error"&&addErrorHandlerIfEventEmitter(U,Q,{once:!0})})}function addErrorHandlerIfEventEmitter(U,D,F){typeof U.on=="function"&&eventTargetAgnosticAddListener(U,"error",D,F)}function eventTargetAgnosticAddListener(U,D,F,G){if(typeof U.on=="function")G.once?U.once(D,F):U.on(D,F);else if(typeof U.addEventListener=="function")U.addEventListener(D,function Q(X){G.once&&U.removeEventListener(D,Q),F(X)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof U)}var catering={},nextTickBrowser$1=typeof queueMicrotask=="function"?queueMicrotask:U=>Promise.resolve().then(U),nextTick=nextTickBrowser$1;catering.fromCallback=function(U,D){if(U===void 0){var F=new Promise(function(G,Q){U=function(X,q){X?Q(X):G(q)}});U[D!==void 0?D:"promise"]=F}else if(typeof U!="function")throw new TypeError("Callback must be a function");return U};catering.fromPromise=function(U,D){if(D===void 0)return U;U.then(function(F){nextTick(()=>D(null,F))}).catch(function(F){nextTick(()=>D(F))})};var abstractIterator={},common$6={};common$6.getCallback=function(U,D){return typeof U=="function"?U:D};common$6.getOptions=function(U,D){return typeof U=="object"&&U!==null?U:D!==void 0?D:{}};const{fromCallback:fromCallback$2}=catering,ModuleError$6=moduleError,{getOptions:getOptions$2,getCallback:getCallback$2}=common$6,kPromise$2=Symbol("promise"),kCallback$1=Symbol("callback"),kWorking=Symbol("working"),kHandleOne$1=Symbol("handleOne"),kHandleMany$1=Symbol("handleMany"),kAutoClose=Symbol("autoClose"),kFinishWork=Symbol("finishWork"),kReturnMany=Symbol("returnMany"),kClosing=Symbol("closing"),kHandleClose=Symbol("handleClose"),kClosed=Symbol("closed"),kCloseCallbacks$1=Symbol("closeCallbacks"),kKeyEncoding$1=Symbol("keyEncoding"),kValueEncoding$1=Symbol("valueEncoding"),kAbortOnClose=Symbol("abortOnClose"),kLegacy=Symbol("legacy"),kKeys=Symbol("keys"),kValues=Symbol("values"),kLimit=Symbol("limit"),kCount=Symbol("count"),emptyOptions=Object.freeze({}),noop$4=()=>{};let warnedEnd=!1;class CommonIterator{constructor(D,F,G){if(typeof D!="object"||D===null){const Q=D===null?"null":typeof D;throw new TypeError(`The first argument must be an abstract-level database, received ${Q}`)}if(typeof F!="object"||F===null)throw new TypeError("The second argument must be an options object");this[kClosed]=!1,this[kCloseCallbacks$1]=[],this[kWorking]=!1,this[kClosing]=!1,this[kAutoClose]=!1,this[kCallback$1]=null,this[kHandleOne$1]=this[kHandleOne$1].bind(this),this[kHandleMany$1]=this[kHandleMany$1].bind(this),this[kHandleClose]=this[kHandleClose].bind(this),this[kKeyEncoding$1]=F[kKeyEncoding$1],this[kValueEncoding$1]=F[kValueEncoding$1],this[kLegacy]=G,this[kLimit]=Number.isInteger(F.limit)&&F.limit>=0?F.limit:1/0,this[kCount]=0,this[kAbortOnClose]=!!F.abortOnClose,this.db=D,this.db.attachResource(this),this.nextTick=D.nextTick}get count(){return this[kCount]}get limit(){return this[kLimit]}next(D){let F;if(D===void 0)F=new Promise((G,Q)=>{D=(X,q,W)=>{X?Q(X):this[kLegacy]?q===void 0&&W===void 0?G():G([q,W]):G(q)}});else if(typeof D!="function")throw new TypeError("Callback must be a function");return this[kClosing]?this.nextTick(D,new ModuleError$6("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(D,new ModuleError$6("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[kWorking]=!0,this[kCallback$1]=D,this[kCount]>=this[kLimit]?this.nextTick(this[kHandleOne$1],null):this._next(this[kHandleOne$1])),F}_next(D){this.nextTick(D)}nextv(D,F,G){return G=getCallback$2(F,G),G=fromCallback$2(G,kPromise$2),F=getOptions$2(F,emptyOptions),Number.isInteger(D)?(this[kClosing]?this.nextTick(G,new ModuleError$6("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(G,new ModuleError$6("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(D<1&&(D=1),this[kLimit]<1/0&&(D=Math.min(D,this[kLimit]-this[kCount])),this[kWorking]=!0,this[kCallback$1]=G,D<=0?this.nextTick(this[kHandleMany$1],null,[]):this._nextv(D,F,this[kHandleMany$1])),G[kPromise$2]):(this.nextTick(G,new TypeError("The first argument 'size' must be an integer")),G[kPromise$2])}_nextv(D,F,G){const Q=[],X=(q,W,Y)=>{if(q)return G(q);if(this[kLegacy]?W===void 0&&Y===void 0:W===void 0)return G(null,Q);Q.push(this[kLegacy]?[W,Y]:W),Q.length===D?G(null,Q):this._next(X)};this._next(X)}all(D,F){return F=getCallback$2(D,F),F=fromCallback$2(F,kPromise$2),D=getOptions$2(D,emptyOptions),this[kClosing]?this.nextTick(F,new ModuleError$6("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(F,new ModuleError$6("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[kWorking]=!0,this[kCallback$1]=F,this[kAutoClose]=!0,this[kCount]>=this[kLimit]?this.nextTick(this[kHandleMany$1],null,[]):this._all(D,this[kHandleMany$1])),F[kPromise$2]}_all(D,F){let G=this[kCount];const Q=[],X=()=>{const W=this[kLimit]<1/0?Math.min(1e3,this[kLimit]-G):1e3;W<=0?this.nextTick(F,null,Q):this._nextv(W,emptyOptions,q)},q=(W,Y)=>{W?F(W):Y.length===0?F(null,Q):(Q.push.apply(Q,Y),G+=Y.length,X())};X()}[kFinishWork](){const D=this[kCallback$1];return this[kAbortOnClose]&&D===null?noop$4:(this[kWorking]=!1,this[kCallback$1]=null,this[kClosing]&&this._close(this[kHandleClose]),D)}[kReturnMany](D,F,G){this[kAutoClose]?this.close(D.bind(null,F,G)):D(F,G)}seek(D,F){if(F=getOptions$2(F,emptyOptions),!this[kClosing]){if(this[kWorking])throw new ModuleError$6("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const G=this.db.keyEncoding(F.keyEncoding||this[kKeyEncoding$1]),Q=G.format;F.keyEncoding!==Q&&(F={...F,keyEncoding:Q});const X=this.db.prefixKey(G.encode(D),Q);this._seek(X,F)}}}_seek(D,F){throw new ModuleError$6("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(D){return D=fromCallback$2(D,kPromise$2),this[kClosed]?this.nextTick(D):this[kClosing]?this[kCloseCallbacks$1].push(D):(this[kClosing]=!0,this[kCloseCallbacks$1].push(D),this[kWorking]?this[kAbortOnClose]&&this[kFinishWork]()(new ModuleError$6("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[kHandleClose])),D[kPromise$2]}_close(D){this.nextTick(D)}[kHandleClose](){this[kClosed]=!0,this.db.detachResource(this);const D=this[kCloseCallbacks$1];this[kCloseCallbacks$1]=[];for(const F of D)F()}async *[Symbol.asyncIterator](){try{let D;for(;(D=await this.next())!==void 0;)yield D}finally{this[kClosed]||await this.close()}}}let AbstractIterator$3=class extends CommonIterator{constructor(D,F){super(D,F,!0),this[kKeys]=F.keys!==!1,this[kValues]=F.values!==!1}[kHandleOne$1](D,F,G){const Q=this[kFinishWork]();if(D)return Q(D);try{F=this[kKeys]&&F!==void 0?this[kKeyEncoding$1].decode(F):void 0,G=this[kValues]&&G!==void 0?this[kValueEncoding$1].decode(G):void 0}catch(X){return Q(new IteratorDecodeError("entry",X))}F===void 0&&G===void 0||this[kCount]++,Q(null,F,G)}[kHandleMany$1](D,F){const G=this[kFinishWork]();if(D)return this[kReturnMany](G,D);try{for(const Q of F){const X=Q[0],q=Q[1];Q[0]=this[kKeys]&&X!==void 0?this[kKeyEncoding$1].decode(X):void 0,Q[1]=this[kValues]&&q!==void 0?this[kValueEncoding$1].decode(q):void 0}}catch(Q){return this[kReturnMany](G,new IteratorDecodeError("entries",Q))}this[kCount]+=F.length,this[kReturnMany](G,null,F)}end(D){return!warnedEnd&&typeof console<"u"&&(warnedEnd=!0,console.warn(new ModuleError$6("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(D)}},AbstractKeyIterator$3=class extends CommonIterator{constructor(D,F){super(D,F,!1)}[kHandleOne$1](D,F){const G=this[kFinishWork]();if(D)return G(D);try{F=F!==void 0?this[kKeyEncoding$1].decode(F):void 0}catch(Q){return G(new IteratorDecodeError("key",Q))}F!==void 0&&this[kCount]++,G(null,F)}[kHandleMany$1](D,F){const G=this[kFinishWork]();if(D)return this[kReturnMany](G,D);try{for(let Q=0;Q<F.length;Q++){const X=F[Q];F[Q]=X!==void 0?this[kKeyEncoding$1].decode(X):void 0}}catch(Q){return this[kReturnMany](G,new IteratorDecodeError("keys",Q))}this[kCount]+=F.length,this[kReturnMany](G,null,F)}},AbstractValueIterator$3=class extends CommonIterator{constructor(D,F){super(D,F,!1)}[kHandleOne$1](D,F){const G=this[kFinishWork]();if(D)return G(D);try{F=F!==void 0?this[kValueEncoding$1].decode(F):void 0}catch(Q){return G(new IteratorDecodeError("value",Q))}F!==void 0&&this[kCount]++,G(null,F)}[kHandleMany$1](D,F){const G=this[kFinishWork]();if(D)return this[kReturnMany](G,D);try{for(let Q=0;Q<F.length;Q++){const X=F[Q];F[Q]=X!==void 0?this[kValueEncoding$1].decode(X):void 0}}catch(Q){return this[kReturnMany](G,new IteratorDecodeError("values",Q))}this[kCount]+=F.length,this[kReturnMany](G,null,F)}};class IteratorDecodeError extends ModuleError$6{constructor(D,F){super(`Iterator could not decode ${D}`,{code:"LEVEL_DECODE_ERROR",cause:F})}}for(const U of["_ended property","_nexting property","_end method"])Object.defineProperty(AbstractIterator$3.prototype,U.split(" ")[0],{get(){throw new ModuleError$6(`The ${U} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new ModuleError$6(`The ${U} has been removed`,{code:"LEVEL_LEGACY"})}});AbstractIterator$3.keyEncoding=kKeyEncoding$1;AbstractIterator$3.valueEncoding=kValueEncoding$1;abstractIterator.AbstractIterator=AbstractIterator$3;abstractIterator.AbstractKeyIterator=AbstractKeyIterator$3;abstractIterator.AbstractValueIterator=AbstractValueIterator$3;var defaultKvIterator={};const{AbstractKeyIterator:AbstractKeyIterator$2,AbstractValueIterator:AbstractValueIterator$2}=abstractIterator,kIterator$1=Symbol("iterator"),kCallback=Symbol("callback"),kHandleOne=Symbol("handleOne"),kHandleMany=Symbol("handleMany");let DefaultKeyIterator$1=class extends AbstractKeyIterator$2{constructor(D,F){super(D,F),this[kIterator$1]=D.iterator({...F,keys:!0,values:!1}),this[kHandleOne]=this[kHandleOne].bind(this),this[kHandleMany]=this[kHandleMany].bind(this)}},DefaultValueIterator$1=class extends AbstractValueIterator$2{constructor(D,F){super(D,F),this[kIterator$1]=D.iterator({...F,keys:!1,values:!0}),this[kHandleOne]=this[kHandleOne].bind(this),this[kHandleMany]=this[kHandleMany].bind(this)}};for(const U of[DefaultKeyIterator$1,DefaultValueIterator$1]){const D=U===DefaultKeyIterator$1,F=D?G=>G[0]:G=>G[1];U.prototype._next=function(G){this[kCallback]=G,this[kIterator$1].next(this[kHandleOne])},U.prototype[kHandleOne]=function(G,Q,X){const q=this[kCallback];G?q(G):q(null,D?Q:X)},U.prototype._nextv=function(G,Q,X){this[kCallback]=X,this[kIterator$1].nextv(G,Q,this[kHandleMany])},U.prototype._all=function(G,Q){this[kCallback]=Q,this[kIterator$1].all(G,this[kHandleMany])},U.prototype[kHandleMany]=function(G,Q){const X=this[kCallback];G?X(G):X(null,Q.map(F))},U.prototype._seek=function(G,Q){this[kIterator$1].seek(G,Q)},U.prototype._close=function(G){this[kIterator$1].close(G)}}defaultKvIterator.DefaultKeyIterator=DefaultKeyIterator$1;defaultKvIterator.DefaultValueIterator=DefaultValueIterator$1;var deferredIterator={};const{AbstractIterator:AbstractIterator$2,AbstractKeyIterator:AbstractKeyIterator$1,AbstractValueIterator:AbstractValueIterator$1}=abstractIterator,ModuleError$5=moduleError,kNut=Symbol("nut"),kUndefer$1=Symbol("undefer"),kFactory=Symbol("factory");let DeferredIterator$1=class extends AbstractIterator$2{constructor(D,F){super(D,F),this[kNut]=null,this[kFactory]=()=>D.iterator(F),this.db.defer(()=>this[kUndefer$1]())}},DeferredKeyIterator$1=class extends AbstractKeyIterator$1{constructor(D,F){super(D,F),this[kNut]=null,this[kFactory]=()=>D.keys(F),this.db.defer(()=>this[kUndefer$1]())}},DeferredValueIterator$1=class extends AbstractValueIterator$1{constructor(D,F){super(D,F),this[kNut]=null,this[kFactory]=()=>D.values(F),this.db.defer(()=>this[kUndefer$1]())}};for(const U of[DeferredIterator$1,DeferredKeyIterator$1,DeferredValueIterator$1])U.prototype[kUndefer$1]=function(){this.db.status==="open"&&(this[kNut]=this[kFactory]())},U.prototype._next=function(D){this[kNut]!==null?this[kNut].next(D):this.db.status==="opening"?this.db.defer(()=>this._next(D)):this.nextTick(D,new ModuleError$5("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},U.prototype._nextv=function(D,F,G){this[kNut]!==null?this[kNut].nextv(D,F,G):this.db.status==="opening"?this.db.defer(()=>this._nextv(D,F,G)):this.nextTick(G,new ModuleError$5("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},U.prototype._all=function(D,F){this[kNut]!==null?this[kNut].all(F):this.db.status==="opening"?this.db.defer(()=>this._all(D,F)):this.nextTick(F,new ModuleError$5("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},U.prototype._seek=function(D,F){this[kNut]!==null?this[kNut]._seek(D,F):this.db.status==="opening"&&this.db.defer(()=>this._seek(D,F))},U.prototype._close=function(D){this[kNut]!==null?this[kNut].close(D):this.db.status==="opening"?this.db.defer(()=>this._close(D)):this.nextTick(D)};deferredIterator.DeferredIterator=DeferredIterator$1;deferredIterator.DeferredKeyIterator=DeferredKeyIterator$1;deferredIterator.DeferredValueIterator=DeferredValueIterator$1;var defaultChainedBatch={},abstractChainedBatch={};const{fromCallback:fromCallback$1}=catering,ModuleError$4=moduleError,{getCallback:getCallback$1,getOptions:getOptions$1}=common$6,kPromise$1=Symbol("promise"),kStatus$1=Symbol("status"),kOperations$1=Symbol("operations"),kFinishClose=Symbol("finishClose"),kCloseCallbacks=Symbol("closeCallbacks");let AbstractChainedBatch$1=class{constructor(D){if(typeof D!="object"||D===null){const F=D===null?"null":typeof D;throw new TypeError(`The first argument must be an abstract-level database, received ${F}`)}this[kOperations$1]=[],this[kCloseCallbacks]=[],this[kStatus$1]="open",this[kFinishClose]=this[kFinishClose].bind(this),this.db=D,this.db.attachResource(this),this.nextTick=D.nextTick}get length(){return this[kOperations$1].length}put(D,F,G){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const Q=this.db._checkKey(D)||this.db._checkValue(F);if(Q)throw Q;const X=G&&G.sublevel!=null?G.sublevel:this.db,q=G,W=X.keyEncoding(G&&G.keyEncoding),Y=X.valueEncoding(G&&G.valueEncoding),J=W.format;G={...G,keyEncoding:J,valueEncoding:Y.format},X!==this.db&&(G.sublevel=null);const te=X.prefixKey(W.encode(D),J),Z=Y.encode(F);return this._put(te,Z,G),this[kOperations$1].push({...q,type:"put",key:D,value:F}),this}_put(D,F,G){}del(D,F){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const G=this.db._checkKey(D);if(G)throw G;const Q=F&&F.sublevel!=null?F.sublevel:this.db,X=F,q=Q.keyEncoding(F&&F.keyEncoding),W=q.format;return F={...F,keyEncoding:W},Q!==this.db&&(F.sublevel=null),this._del(Q.prefixKey(q.encode(D),W),F),this[kOperations$1].push({...X,type:"del",key:D}),this}_del(D,F){}clear(){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[kOperations$1]=[],this}_clear(){}write(D,F){return F=getCallback$1(D,F),F=fromCallback$1(F,kPromise$1),D=getOptions$1(D),this[kStatus$1]!=="open"?this.nextTick(F,new ModuleError$4("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):this.length===0?this.close(F):(this[kStatus$1]="writing",this._write(D,G=>{this[kStatus$1]="closing",this[kCloseCallbacks].push(()=>F(G)),G||this.db.emit("batch",this[kOperations$1]),this._close(this[kFinishClose])})),F[kPromise$1]}_write(D,F){}close(D){return D=fromCallback$1(D,kPromise$1),this[kStatus$1]==="closing"?this[kCloseCallbacks].push(D):this[kStatus$1]==="closed"?this.nextTick(D):(this[kCloseCallbacks].push(D),this[kStatus$1]!=="writing"&&(this[kStatus$1]="closing",this._close(this[kFinishClose]))),D[kPromise$1]}_close(D){this.nextTick(D)}[kFinishClose](){this[kStatus$1]="closed",this.db.detachResource(this);const D=this[kCloseCallbacks];this[kCloseCallbacks]=[];for(const F of D)F()}};abstractChainedBatch.AbstractChainedBatch=AbstractChainedBatch$1;const{AbstractChainedBatch}=abstractChainedBatch,ModuleError$3=moduleError,kEncoded=Symbol("encoded");let DefaultChainedBatch$1=class extends AbstractChainedBatch{constructor(D){super(D),this[kEncoded]=[]}_put(D,F,G){this[kEncoded].push({...G,type:"put",key:D,value:F})}_del(D,F){this[kEncoded].push({...F,type:"del",key:D})}_clear(){this[kEncoded]=[]}_write(D,F){this.db.status==="opening"?this.db.defer(()=>this._write(D,F)):this.db.status==="open"?this[kEncoded].length===0?this.nextTick(F):this.db._batch(this[kEncoded],D,F):this.nextTick(F,new ModuleError$3("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}};defaultChainedBatch.DefaultChainedBatch=DefaultChainedBatch$1;const ModuleError$2=moduleError,hasOwnProperty$5=Object.prototype.hasOwnProperty,rangeOptions$2=new Set(["lt","lte","gt","gte"]);var rangeOptions_1=function(U,D){const F={};for(const G in U)if(hasOwnProperty$5.call(U,G)&&!(G==="keyEncoding"||G==="valueEncoding")){if(G==="start"||G==="end")throw new ModuleError$2(`The legacy range option '${G}' has been removed`,{code:"LEVEL_LEGACY"});if(G==="encoding")throw new ModuleError$2("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});rangeOptions$2.has(G)?F[G]=D.encode(U[G]):F[G]=U[G]}return F.reverse=!!F.reverse,F.limit=Number.isInteger(F.limit)&&F.limit>=0?F.limit:-1,F};var queueMicrotask_1,hasRequiredQueueMicrotask;function requireQueueMicrotask(){if(hasRequiredQueueMicrotask)return queueMicrotask_1;hasRequiredQueueMicrotask=1;let U;return queueMicrotask_1=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:commonjsGlobal):D=>(U||(U=Promise.resolve())).then(D).catch(F=>setTimeout(()=>{throw F},0)),queueMicrotask_1}var nextTickBrowser,hasRequiredNextTickBrowser;function requireNextTickBrowser(){if(hasRequiredNextTickBrowser)return nextTickBrowser;hasRequiredNextTickBrowser=1;const U=requireQueueMicrotask();return nextTickBrowser=function(D,...F){F.length===0?U(D):U(()=>D(...F))},nextTickBrowser}var buffer={};var hasRequiredBuffer;function requireBuffer(){return hasRequiredBuffer||(hasRequiredBuffer=1,function(U){const D=base64Js,F=ieee754,G=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;U.Buffer=W,U.SlowBuffer=ge,U.INSPECT_MAX_BYTES=50;const Q=2147483647;U.kMaxLength=Q,W.TYPED_ARRAY_SUPPORT=X(),!W.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function X(){try{const Se=new Uint8Array(1),ce={foo:function(){return 42}};return Object.setPrototypeOf(ce,Uint8Array.prototype),Object.setPrototypeOf(Se,ce),Se.foo()===42}catch{return!1}}Object.defineProperty(W.prototype,"parent",{enumerable:!0,get:function(){if(W.isBuffer(this))return this.buffer}}),Object.defineProperty(W.prototype,"offset",{enumerable:!0,get:function(){if(W.isBuffer(this))return this.byteOffset}});function q(Se){if(Se>Q)throw new RangeError('The value "'+Se+'" is invalid for option "size"');const ce=new Uint8Array(Se);return Object.setPrototypeOf(ce,W.prototype),ce}function W(Se,ce,de){if(typeof Se=="number"){if(typeof ce=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Z(Se)}return Y(Se,ce,de)}W.poolSize=8192;function Y(Se,ce,de){if(typeof Se=="string")return ee(Se,ce);if(ArrayBuffer.isView(Se))return ne(Se);if(Se==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Se);if(Ne(Se,ArrayBuffer)||Se&&Ne(Se.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ne(Se,SharedArrayBuffer)||Se&&Ne(Se.buffer,SharedArrayBuffer)))return le(Se,ce,de);if(typeof Se=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Ae=Se.valueOf&&Se.valueOf();if(Ae!=null&&Ae!==Se)return W.from(Ae,ce,de);const Fe=se(Se);if(Fe)return Fe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Se[Symbol.toPrimitive]=="function")return W.from(Se[Symbol.toPrimitive]("string"),ce,de);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Se)}W.from=function(Se,ce,de){return Y(Se,ce,de)},Object.setPrototypeOf(W.prototype,Uint8Array.prototype),Object.setPrototypeOf(W,Uint8Array);function J(Se){if(typeof Se!="number")throw new TypeError('"size" argument must be of type number');if(Se<0)throw new RangeError('The value "'+Se+'" is invalid for option "size"')}function te(Se,ce,de){return J(Se),Se<=0?q(Se):ce!==void 0?typeof de=="string"?q(Se).fill(ce,de):q(Se).fill(ce):q(Se)}W.alloc=function(Se,ce,de){return te(Se,ce,de)};function Z(Se){return J(Se),q(Se<0?0:ie(Se)|0)}W.allocUnsafe=function(Se){return Z(Se)},W.allocUnsafeSlow=function(Se){return Z(Se)};function ee(Se,ce){if((typeof ce!="string"||ce==="")&&(ce="utf8"),!W.isEncoding(ce))throw new TypeError("Unknown encoding: "+ce);const de=fe(Se,ce)|0;let Ae=q(de);const Fe=Ae.write(Se,ce);return Fe!==de&&(Ae=Ae.slice(0,Fe)),Ae}function re(Se){const ce=Se.length<0?0:ie(Se.length)|0,de=q(ce);for(let Ae=0;Ae<ce;Ae+=1)de[Ae]=Se[Ae]&255;return de}function ne(Se){if(Ne(Se,Uint8Array)){const ce=new Uint8Array(Se);return le(ce.buffer,ce.byteOffset,ce.byteLength)}return re(Se)}function le(Se,ce,de){if(ce<0||Se.byteLength<ce)throw new RangeError('"offset" is outside of buffer bounds');if(Se.byteLength<ce+(de||0))throw new RangeError('"length" is outside of buffer bounds');let Ae;return ce===void 0&&de===void 0?Ae=new Uint8Array(Se):de===void 0?Ae=new Uint8Array(Se,ce):Ae=new Uint8Array(Se,ce,de),Object.setPrototypeOf(Ae,W.prototype),Ae}function se(Se){if(W.isBuffer(Se)){const ce=ie(Se.length)|0,de=q(ce);return de.length===0||Se.copy(de,0,0,ce),de}if(Se.length!==void 0)return typeof Se.length!="number"||Ce(Se.length)?q(0):re(Se);if(Se.type==="Buffer"&&Array.isArray(Se.data))return re(Se.data)}function ie(Se){if(Se>=Q)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Q.toString(16)+" bytes");return Se|0}function ge(Se){return+Se!=Se&&(Se=0),W.alloc(+Se)}W.isBuffer=function(ce){return ce!=null&&ce._isBuffer===!0&&ce!==W.prototype},W.compare=function(ce,de){if(Ne(ce,Uint8Array)&&(ce=W.from(ce,ce.offset,ce.byteLength)),Ne(de,Uint8Array)&&(de=W.from(de,de.offset,de.byteLength)),!W.isBuffer(ce)||!W.isBuffer(de))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(ce===de)return 0;let Ae=ce.length,Fe=de.length;for(let Ve=0,Je=Math.min(Ae,Fe);Ve<Je;++Ve)if(ce[Ve]!==de[Ve]){Ae=ce[Ve],Fe=de[Ve];break}return Ae<Fe?-1:Fe<Ae?1:0},W.isEncoding=function(ce){switch(String(ce).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},W.concat=function(ce,de){if(!Array.isArray(ce))throw new TypeError('"list" argument must be an Array of Buffers');if(ce.length===0)return W.alloc(0);let Ae;if(de===void 0)for(de=0,Ae=0;Ae<ce.length;++Ae)de+=ce[Ae].length;const Fe=W.allocUnsafe(de);let Ve=0;for(Ae=0;Ae<ce.length;++Ae){let Je=ce[Ae];if(Ne(Je,Uint8Array))Ve+Je.length>Fe.length?(W.isBuffer(Je)||(Je=W.from(Je)),Je.copy(Fe,Ve)):Uint8Array.prototype.set.call(Fe,Je,Ve);else if(W.isBuffer(Je))Je.copy(Fe,Ve);else throw new TypeError('"list" argument must be an Array of Buffers');Ve+=Je.length}return Fe};function fe(Se,ce){if(W.isBuffer(Se))return Se.length;if(ArrayBuffer.isView(Se)||Ne(Se,ArrayBuffer))return Se.byteLength;if(typeof Se!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Se);const de=Se.length,Ae=arguments.length>2&&arguments[2]===!0;if(!Ae&&de===0)return 0;let Fe=!1;for(;;)switch(ce){case"ascii":case"latin1":case"binary":return de;case"utf8":case"utf-8":return ke(Se).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return de*2;case"hex":return de>>>1;case"base64":return $e(Se).length;default:if(Fe)return Ae?-1:ke(Se).length;ce=(""+ce).toLowerCase(),Fe=!0}}W.byteLength=fe;function ae(Se,ce,de){let Ae=!1;if((ce===void 0||ce<0)&&(ce=0),ce>this.length||((de===void 0||de>this.length)&&(de=this.length),de<=0)||(de>>>=0,ce>>>=0,de<=ce))return"";for(Se||(Se="utf8");;)switch(Se){case"hex":return Me(this,ce,de);case"utf8":case"utf-8":return oe(this,ce,de);case"ascii":return we(this,ce,de);case"latin1":case"binary":return Pe(this,ce,de);case"base64":return he(this,ce,de);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return De(this,ce,de);default:if(Ae)throw new TypeError("Unknown encoding: "+Se);Se=(Se+"").toLowerCase(),Ae=!0}}W.prototype._isBuffer=!0;function ue(Se,ce,de){const Ae=Se[ce];Se[ce]=Se[de],Se[de]=Ae}W.prototype.swap16=function(){const ce=this.length;if(ce%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let de=0;de<ce;de+=2)ue(this,de,de+1);return this},W.prototype.swap32=function(){const ce=this.length;if(ce%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let de=0;de<ce;de+=4)ue(this,de,de+3),ue(this,de+1,de+2);return this},W.prototype.swap64=function(){const ce=this.length;if(ce%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let de=0;de<ce;de+=8)ue(this,de,de+7),ue(this,de+1,de+6),ue(this,de+2,de+5),ue(this,de+3,de+4);return this},W.prototype.toString=function(){const ce=this.length;return ce===0?"":arguments.length===0?oe(this,0,ce):ae.apply(this,arguments)},W.prototype.toLocaleString=W.prototype.toString,W.prototype.equals=function(ce){if(!W.isBuffer(ce))throw new TypeError("Argument must be a Buffer");return this===ce?!0:W.compare(this,ce)===0},W.prototype.inspect=function(){let ce="";const de=U.INSPECT_MAX_BYTES;return ce=this.toString("hex",0,de).replace(/(.{2})/g,"$1 ").trim(),this.length>de&&(ce+=" ... "),"<Buffer "+ce+">"},G&&(W.prototype[G]=W.prototype.inspect),W.prototype.compare=function(ce,de,Ae,Fe,Ve){if(Ne(ce,Uint8Array)&&(ce=W.from(ce,ce.offset,ce.byteLength)),!W.isBuffer(ce))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof ce);if(de===void 0&&(de=0),Ae===void 0&&(Ae=ce?ce.length:0),Fe===void 0&&(Fe=0),Ve===void 0&&(Ve=this.length),de<0||Ae>ce.length||Fe<0||Ve>this.length)throw new RangeError("out of range index");if(Fe>=Ve&&de>=Ae)return 0;if(Fe>=Ve)return-1;if(de>=Ae)return 1;if(de>>>=0,Ae>>>=0,Fe>>>=0,Ve>>>=0,this===ce)return 0;let Je=Ve-Fe,dt=Ae-de;const St=Math.min(Je,dt),Tt=this.slice(Fe,Ve),At=ce.slice(de,Ae);for(let wt=0;wt<St;++wt)if(Tt[wt]!==At[wt]){Je=Tt[wt],dt=At[wt];break}return Je<dt?-1:dt<Je?1:0};function pe(Se,ce,de,Ae,Fe){if(Se.length===0)return-1;if(typeof de=="string"?(Ae=de,de=0):de>2147483647?de=2147483647:de<-2147483648&&(de=-2147483648),de=+de,Ce(de)&&(de=Fe?0:Se.length-1),de<0&&(de=Se.length+de),de>=Se.length){if(Fe)return-1;de=Se.length-1}else if(de<0)if(Fe)de=0;else return-1;if(typeof ce=="string"&&(ce=W.from(ce,Ae)),W.isBuffer(ce))return ce.length===0?-1:_e(Se,ce,de,Ae,Fe);if(typeof ce=="number")return ce=ce&255,typeof Uint8Array.prototype.indexOf=="function"?Fe?Uint8Array.prototype.indexOf.call(Se,ce,de):Uint8Array.prototype.lastIndexOf.call(Se,ce,de):_e(Se,[ce],de,Ae,Fe);throw new TypeError("val must be string, number or Buffer")}function _e(Se,ce,de,Ae,Fe){let Ve=1,Je=Se.length,dt=ce.length;if(Ae!==void 0&&(Ae=String(Ae).toLowerCase(),Ae==="ucs2"||Ae==="ucs-2"||Ae==="utf16le"||Ae==="utf-16le")){if(Se.length<2||ce.length<2)return-1;Ve=2,Je/=2,dt/=2,de/=2}function St(At,wt){return Ve===1?At[wt]:At.readUInt16BE(wt*Ve)}let Tt;if(Fe){let At=-1;for(Tt=de;Tt<Je;Tt++)if(St(Se,Tt)===St(ce,At===-1?0:Tt-At)){if(At===-1&&(At=Tt),Tt-At+1===dt)return At*Ve}else At!==-1&&(Tt-=Tt-At),At=-1}else for(de+dt>Je&&(de=Je-dt),Tt=de;Tt>=0;Tt--){let At=!0;for(let wt=0;wt<dt;wt++)if(St(Se,Tt+wt)!==St(ce,wt)){At=!1;break}if(At)return Tt}return-1}W.prototype.includes=function(ce,de,Ae){return this.indexOf(ce,de,Ae)!==-1},W.prototype.indexOf=function(ce,de,Ae){return pe(this,ce,de,Ae,!0)},W.prototype.lastIndexOf=function(ce,de,Ae){return pe(this,ce,de,Ae,!1)};function xe(Se,ce,de,Ae){de=Number(de)||0;const Fe=Se.length-de;Ae?(Ae=Number(Ae),Ae>Fe&&(Ae=Fe)):Ae=Fe;const Ve=ce.length;Ae>Ve/2&&(Ae=Ve/2);let Je;for(Je=0;Je<Ae;++Je){const dt=parseInt(ce.substr(Je*2,2),16);if(Ce(dt))return Je;Se[de+Je]=dt}return Je}function be(Se,ce,de,Ae){return Qe(ke(ce,Se.length-de),Se,de,Ae)}function Te(Se,ce,de,Ae){return Qe(He(ce),Se,de,Ae)}function ye(Se,ce,de,Ae){return Qe($e(ce),Se,de,Ae)}function Ee(Se,ce,de,Ae){return Qe(Ke(ce,Se.length-de),Se,de,Ae)}W.prototype.write=function(ce,de,Ae,Fe){if(de===void 0)Fe="utf8",Ae=this.length,de=0;else if(Ae===void 0&&typeof de=="string")Fe=de,Ae=this.length,de=0;else if(isFinite(de))de=de>>>0,isFinite(Ae)?(Ae=Ae>>>0,Fe===void 0&&(Fe="utf8")):(Fe=Ae,Ae=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ve=this.length-de;if((Ae===void 0||Ae>Ve)&&(Ae=Ve),ce.length>0&&(Ae<0||de<0)||de>this.length)throw new RangeError("Attempt to write outside buffer bounds");Fe||(Fe="utf8");let Je=!1;for(;;)switch(Fe){case"hex":return xe(this,ce,de,Ae);case"utf8":case"utf-8":return be(this,ce,de,Ae);case"ascii":case"latin1":case"binary":return Te(this,ce,de,Ae);case"base64":return ye(this,ce,de,Ae);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ee(this,ce,de,Ae);default:if(Je)throw new TypeError("Unknown encoding: "+Fe);Fe=(""+Fe).toLowerCase(),Je=!0}},W.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function he(Se,ce,de){return ce===0&&de===Se.length?D.fromByteArray(Se):D.fromByteArray(Se.slice(ce,de))}function oe(Se,ce,de){de=Math.min(Se.length,de);const Ae=[];let Fe=ce;for(;Fe<de;){const Ve=Se[Fe];let Je=null,dt=Ve>239?4:Ve>223?3:Ve>191?2:1;if(Fe+dt<=de){let St,Tt,At,wt;switch(dt){case 1:Ve<128&&(Je=Ve);break;case 2:St=Se[Fe+1],(St&192)===128&&(wt=(Ve&31)<<6|St&63,wt>127&&(Je=wt));break;case 3:St=Se[Fe+1],Tt=Se[Fe+2],(St&192)===128&&(Tt&192)===128&&(wt=(Ve&15)<<12|(St&63)<<6|Tt&63,wt>2047&&(wt<55296||wt>57343)&&(Je=wt));break;case 4:St=Se[Fe+1],Tt=Se[Fe+2],At=Se[Fe+3],(St&192)===128&&(Tt&192)===128&&(At&192)===128&&(wt=(Ve&15)<<18|(St&63)<<12|(Tt&63)<<6|At&63,wt>65535&&wt<1114112&&(Je=wt))}}Je===null?(Je=65533,dt=1):Je>65535&&(Je-=65536,Ae.push(Je>>>10&1023|55296),Je=56320|Je&1023),Ae.push(Je),Fe+=dt}return ve(Ae)}const me=4096;function ve(Se){const ce=Se.length;if(ce<=me)return String.fromCharCode.apply(String,Se);let de="",Ae=0;for(;Ae<ce;)de+=String.fromCharCode.apply(String,Se.slice(Ae,Ae+=me));return de}function we(Se,ce,de){let Ae="";de=Math.min(Se.length,de);for(let Fe=ce;Fe<de;++Fe)Ae+=String.fromCharCode(Se[Fe]&127);return Ae}function Pe(Se,ce,de){let Ae="";de=Math.min(Se.length,de);for(let Fe=ce;Fe<de;++Fe)Ae+=String.fromCharCode(Se[Fe]);return Ae}function Me(Se,ce,de){const Ae=Se.length;(!ce||ce<0)&&(ce=0),(!de||de<0||de>Ae)&&(de=Ae);let Fe="";for(let Ve=ce;Ve<de;++Ve)Fe+=Ze[Se[Ve]];return Fe}function De(Se,ce,de){const Ae=Se.slice(ce,de);let Fe="";for(let Ve=0;Ve<Ae.length-1;Ve+=2)Fe+=String.fromCharCode(Ae[Ve]+Ae[Ve+1]*256);return Fe}W.prototype.slice=function(ce,de){const Ae=this.length;ce=~~ce,de=de===void 0?Ae:~~de,ce<0?(ce+=Ae,ce<0&&(ce=0)):ce>Ae&&(ce=Ae),de<0?(de+=Ae,de<0&&(de=0)):de>Ae&&(de=Ae),de<ce&&(de=ce);const Fe=this.subarray(ce,de);return Object.setPrototypeOf(Fe,W.prototype),Fe};function Oe(Se,ce,de){if(Se%1!==0||Se<0)throw new RangeError("offset is not uint");if(Se+ce>de)throw new RangeError("Trying to access beyond buffer length")}W.prototype.readUintLE=W.prototype.readUIntLE=function(ce,de,Ae){ce=ce>>>0,de=de>>>0,Ae||Oe(ce,de,this.length);let Fe=this[ce],Ve=1,Je=0;for(;++Je<de&&(Ve*=256);)Fe+=this[ce+Je]*Ve;return Fe},W.prototype.readUintBE=W.prototype.readUIntBE=function(ce,de,Ae){ce=ce>>>0,de=de>>>0,Ae||Oe(ce,de,this.length);let Fe=this[ce+--de],Ve=1;for(;de>0&&(Ve*=256);)Fe+=this[ce+--de]*Ve;return Fe},W.prototype.readUint8=W.prototype.readUInt8=function(ce,de){return ce=ce>>>0,de||Oe(ce,1,this.length),this[ce]},W.prototype.readUint16LE=W.prototype.readUInt16LE=function(ce,de){return ce=ce>>>0,de||Oe(ce,2,this.length),this[ce]|this[ce+1]<<8},W.prototype.readUint16BE=W.prototype.readUInt16BE=function(ce,de){return ce=ce>>>0,de||Oe(ce,2,this.length),this[ce]<<8|this[ce+1]},W.prototype.readUint32LE=W.prototype.readUInt32LE=function(ce,de){return ce=ce>>>0,de||Oe(ce,4,this.length),(this[ce]|this[ce+1]<<8|this[ce+2]<<16)+this[ce+3]*16777216},W.prototype.readUint32BE=W.prototype.readUInt32BE=function(ce,de){return ce=ce>>>0,de||Oe(ce,4,this.length),this[ce]*16777216+(this[ce+1]<<16|this[ce+2]<<8|this[ce+3])},W.prototype.readBigUInt64LE=at(function(ce){ce=ce>>>0,Re(ce,"offset");const de=this[ce],Ae=this[ce+7];(de===void 0||Ae===void 0)&&Ue(ce,this.length-8);const Fe=de+this[++ce]*2**8+this[++ce]*2**16+this[++ce]*2**24,Ve=this[++ce]+this[++ce]*2**8+this[++ce]*2**16+Ae*2**24;return BigInt(Fe)+(BigInt(Ve)<<BigInt(32))}),W.prototype.readBigUInt64BE=at(function(ce){ce=ce>>>0,Re(ce,"offset");const de=this[ce],Ae=this[ce+7];(de===void 0||Ae===void 0)&&Ue(ce,this.length-8);const Fe=de*2**24+this[++ce]*2**16+this[++ce]*2**8+this[++ce],Ve=this[++ce]*2**24+this[++ce]*2**16+this[++ce]*2**8+Ae;return(BigInt(Fe)<<BigInt(32))+BigInt(Ve)}),W.prototype.readIntLE=function(ce,de,Ae){ce=ce>>>0,de=de>>>0,Ae||Oe(ce,de,this.length);let Fe=this[ce],Ve=1,Je=0;for(;++Je<de&&(Ve*=256);)Fe+=this[ce+Je]*Ve;return Ve*=128,Fe>=Ve&&(Fe-=Math.pow(2,8*de)),Fe},W.prototype.readIntBE=function(ce,de,Ae){ce=ce>>>0,de=de>>>0,Ae||Oe(ce,de,this.length);let Fe=de,Ve=1,Je=this[ce+--Fe];for(;Fe>0&&(Ve*=256);)Je+=this[ce+--Fe]*Ve;return Ve*=128,Je>=Ve&&(Je-=Math.pow(2,8*de)),Je},W.prototype.readInt8=function(ce,de){return ce=ce>>>0,de||Oe(ce,1,this.length),this[ce]&128?(255-this[ce]+1)*-1:this[ce]},W.prototype.readInt16LE=function(ce,de){ce=ce>>>0,de||Oe(ce,2,this.length);const Ae=this[ce]|this[ce+1]<<8;return Ae&32768?Ae|4294901760:Ae},W.prototype.readInt16BE=function(ce,de){ce=ce>>>0,de||Oe(ce,2,this.length);const Ae=this[ce+1]|this[ce]<<8;return Ae&32768?Ae|4294901760:Ae},W.prototype.readInt32LE=function(ce,de){return ce=ce>>>0,de||Oe(ce,4,this.length),this[ce]|this[ce+1]<<8|this[ce+2]<<16|this[ce+3]<<24},W.prototype.readInt32BE=function(ce,de){return ce=ce>>>0,de||Oe(ce,4,this.length),this[ce]<<24|this[ce+1]<<16|this[ce+2]<<8|this[ce+3]},W.prototype.readBigInt64LE=at(function(ce){ce=ce>>>0,Re(ce,"offset");const de=this[ce],Ae=this[ce+7];(de===void 0||Ae===void 0)&&Ue(ce,this.length-8);const Fe=this[ce+4]+this[ce+5]*2**8+this[ce+6]*2**16+(Ae<<24);return(BigInt(Fe)<<BigInt(32))+BigInt(de+this[++ce]*2**8+this[++ce]*2**16+this[++ce]*2**24)}),W.prototype.readBigInt64BE=at(function(ce){ce=ce>>>0,Re(ce,"offset");const de=this[ce],Ae=this[ce+7];(de===void 0||Ae===void 0)&&Ue(ce,this.length-8);const Fe=(de<<24)+this[++ce]*2**16+this[++ce]*2**8+this[++ce];return(BigInt(Fe)<<BigInt(32))+BigInt(this[++ce]*2**24+this[++ce]*2**16+this[++ce]*2**8+Ae)}),W.prototype.readFloatLE=function(ce,de){return ce=ce>>>0,de||Oe(ce,4,this.length),F.read(this,ce,!0,23,4)},W.prototype.readFloatBE=function(ce,de){return ce=ce>>>0,de||Oe(ce,4,this.length),F.read(this,ce,!1,23,4)},W.prototype.readDoubleLE=function(ce,de){return ce=ce>>>0,de||Oe(ce,8,this.length),F.read(this,ce,!0,52,8)},W.prototype.readDoubleBE=function(ce,de){return ce=ce>>>0,de||Oe(ce,8,this.length),F.read(this,ce,!1,52,8)};function Ie(Se,ce,de,Ae,Fe,Ve){if(!W.isBuffer(Se))throw new TypeError('"buffer" argument must be a Buffer instance');if(ce>Fe||ce<Ve)throw new RangeError('"value" argument is out of bounds');if(de+Ae>Se.length)throw new RangeError("Index out of range")}W.prototype.writeUintLE=W.prototype.writeUIntLE=function(ce,de,Ae,Fe){if(ce=+ce,de=de>>>0,Ae=Ae>>>0,!Fe){const dt=Math.pow(2,8*Ae)-1;Ie(this,ce,de,Ae,dt,0)}let Ve=1,Je=0;for(this[de]=ce&255;++Je<Ae&&(Ve*=256);)this[de+Je]=ce/Ve&255;return de+Ae},W.prototype.writeUintBE=W.prototype.writeUIntBE=function(ce,de,Ae,Fe){if(ce=+ce,de=de>>>0,Ae=Ae>>>0,!Fe){const dt=Math.pow(2,8*Ae)-1;Ie(this,ce,de,Ae,dt,0)}let Ve=Ae-1,Je=1;for(this[de+Ve]=ce&255;--Ve>=0&&(Je*=256);)this[de+Ve]=ce/Je&255;return de+Ae},W.prototype.writeUint8=W.prototype.writeUInt8=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,1,255,0),this[de]=ce&255,de+1},W.prototype.writeUint16LE=W.prototype.writeUInt16LE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,2,65535,0),this[de]=ce&255,this[de+1]=ce>>>8,de+2},W.prototype.writeUint16BE=W.prototype.writeUInt16BE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,2,65535,0),this[de]=ce>>>8,this[de+1]=ce&255,de+2},W.prototype.writeUint32LE=W.prototype.writeUInt32LE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,4,4294967295,0),this[de+3]=ce>>>24,this[de+2]=ce>>>16,this[de+1]=ce>>>8,this[de]=ce&255,de+4},W.prototype.writeUint32BE=W.prototype.writeUInt32BE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,4,4294967295,0),this[de]=ce>>>24,this[de+1]=ce>>>16,this[de+2]=ce>>>8,this[de+3]=ce&255,de+4};function Be(Se,ce,de,Ae,Fe){We(ce,Ae,Fe,Se,de,7);let Ve=Number(ce&BigInt(4294967295));Se[de++]=Ve,Ve=Ve>>8,Se[de++]=Ve,Ve=Ve>>8,Se[de++]=Ve,Ve=Ve>>8,Se[de++]=Ve;let Je=Number(ce>>BigInt(32)&BigInt(4294967295));return Se[de++]=Je,Je=Je>>8,Se[de++]=Je,Je=Je>>8,Se[de++]=Je,Je=Je>>8,Se[de++]=Je,de}function ze(Se,ce,de,Ae,Fe){We(ce,Ae,Fe,Se,de,7);let Ve=Number(ce&BigInt(4294967295));Se[de+7]=Ve,Ve=Ve>>8,Se[de+6]=Ve,Ve=Ve>>8,Se[de+5]=Ve,Ve=Ve>>8,Se[de+4]=Ve;let Je=Number(ce>>BigInt(32)&BigInt(4294967295));return Se[de+3]=Je,Je=Je>>8,Se[de+2]=Je,Je=Je>>8,Se[de+1]=Je,Je=Je>>8,Se[de]=Je,de+8}W.prototype.writeBigUInt64LE=at(function(ce,de=0){return Be(this,ce,de,BigInt(0),BigInt("0xffffffffffffffff"))}),W.prototype.writeBigUInt64BE=at(function(ce,de=0){return ze(this,ce,de,BigInt(0),BigInt("0xffffffffffffffff"))}),W.prototype.writeIntLE=function(ce,de,Ae,Fe){if(ce=+ce,de=de>>>0,!Fe){const St=Math.pow(2,8*Ae-1);Ie(this,ce,de,Ae,St-1,-St)}let Ve=0,Je=1,dt=0;for(this[de]=ce&255;++Ve<Ae&&(Je*=256);)ce<0&&dt===0&&this[de+Ve-1]!==0&&(dt=1),this[de+Ve]=(ce/Je>>0)-dt&255;return de+Ae},W.prototype.writeIntBE=function(ce,de,Ae,Fe){if(ce=+ce,de=de>>>0,!Fe){const St=Math.pow(2,8*Ae-1);Ie(this,ce,de,Ae,St-1,-St)}let Ve=Ae-1,Je=1,dt=0;for(this[de+Ve]=ce&255;--Ve>=0&&(Je*=256);)ce<0&&dt===0&&this[de+Ve+1]!==0&&(dt=1),this[de+Ve]=(ce/Je>>0)-dt&255;return de+Ae},W.prototype.writeInt8=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,1,127,-128),ce<0&&(ce=255+ce+1),this[de]=ce&255,de+1},W.prototype.writeInt16LE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,2,32767,-32768),this[de]=ce&255,this[de+1]=ce>>>8,de+2},W.prototype.writeInt16BE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,2,32767,-32768),this[de]=ce>>>8,this[de+1]=ce&255,de+2},W.prototype.writeInt32LE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,4,2147483647,-2147483648),this[de]=ce&255,this[de+1]=ce>>>8,this[de+2]=ce>>>16,this[de+3]=ce>>>24,de+4},W.prototype.writeInt32BE=function(ce,de,Ae){return ce=+ce,de=de>>>0,Ae||Ie(this,ce,de,4,2147483647,-2147483648),ce<0&&(ce=4294967295+ce+1),this[de]=ce>>>24,this[de+1]=ce>>>16,this[de+2]=ce>>>8,this[de+3]=ce&255,de+4},W.prototype.writeBigInt64LE=at(function(ce,de=0){return Be(this,ce,de,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),W.prototype.writeBigInt64BE=at(function(ce,de=0){return ze(this,ce,de,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function et(Se,ce,de,Ae,Fe,Ve){if(de+Ae>Se.length)throw new RangeError("Index out of range");if(de<0)throw new RangeError("Index out of range")}function qe(Se,ce,de,Ae,Fe){return ce=+ce,de=de>>>0,Fe||et(Se,ce,de,4),F.write(Se,ce,de,Ae,23,4),de+4}W.prototype.writeFloatLE=function(ce,de,Ae){return qe(this,ce,de,!0,Ae)},W.prototype.writeFloatBE=function(ce,de,Ae){return qe(this,ce,de,!1,Ae)};function je(Se,ce,de,Ae,Fe){return ce=+ce,de=de>>>0,Fe||et(Se,ce,de,8),F.write(Se,ce,de,Ae,52,8),de+8}W.prototype.writeDoubleLE=function(ce,de,Ae){return je(this,ce,de,!0,Ae)},W.prototype.writeDoubleBE=function(ce,de,Ae){return je(this,ce,de,!1,Ae)},W.prototype.copy=function(ce,de,Ae,Fe){if(!W.isBuffer(ce))throw new TypeError("argument should be a Buffer");if(Ae||(Ae=0),!Fe&&Fe!==0&&(Fe=this.length),de>=ce.length&&(de=ce.length),de||(de=0),Fe>0&&Fe<Ae&&(Fe=Ae),Fe===Ae||ce.length===0||this.length===0)return 0;if(de<0)throw new RangeError("targetStart out of bounds");if(Ae<0||Ae>=this.length)throw new RangeError("Index out of range");if(Fe<0)throw new RangeError("sourceEnd out of bounds");Fe>this.length&&(Fe=this.length),ce.length-de<Fe-Ae&&(Fe=ce.length-de+Ae);const Ve=Fe-Ae;return this===ce&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(de,Ae,Fe):Uint8Array.prototype.set.call(ce,this.subarray(Ae,Fe),de),Ve},W.prototype.fill=function(ce,de,Ae,Fe){if(typeof ce=="string"){if(typeof de=="string"?(Fe=de,de=0,Ae=this.length):typeof Ae=="string"&&(Fe=Ae,Ae=this.length),Fe!==void 0&&typeof Fe!="string")throw new TypeError("encoding must be a string");if(typeof Fe=="string"&&!W.isEncoding(Fe))throw new TypeError("Unknown encoding: "+Fe);if(ce.length===1){const Je=ce.charCodeAt(0);(Fe==="utf8"&&Je<128||Fe==="latin1")&&(ce=Je)}}else typeof ce=="number"?ce=ce&255:typeof ce=="boolean"&&(ce=Number(ce));if(de<0||this.length<de||this.length<Ae)throw new RangeError("Out of range index");if(Ae<=de)return this;de=de>>>0,Ae=Ae===void 0?this.length:Ae>>>0,ce||(ce=0);let Ve;if(typeof ce=="number")for(Ve=de;Ve<Ae;++Ve)this[Ve]=ce;else{const Je=W.isBuffer(ce)?ce:W.from(ce,Fe),dt=Je.length;if(dt===0)throw new TypeError('The value "'+ce+'" is invalid for argument "value"');for(Ve=0;Ve<Ae-de;++Ve)this[Ve+de]=Je[Ve%dt]}return this};const it={};function ct(Se,ce,de){it[Se]=class extends de{constructor(){super(),Object.defineProperty(this,"message",{value:ce.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Se}]`,this.stack,delete this.name}get code(){return Se}set code(Fe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Fe,writable:!0})}toString(){return`${this.name} [${Se}]: ${this.message}`}}}ct("ERR_BUFFER_OUT_OF_BOUNDS",function(Se){return Se?`${Se} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ct("ERR_INVALID_ARG_TYPE",function(Se,ce){return`The "${Se}" argument must be of type number. Received type ${typeof ce}`},TypeError),ct("ERR_OUT_OF_RANGE",function(Se,ce,de){let Ae=`The value of "${Se}" is out of range.`,Fe=de;return Number.isInteger(de)&&Math.abs(de)>2**32?Fe=rt(String(de)):typeof de=="bigint"&&(Fe=String(de),(de>BigInt(2)**BigInt(32)||de<-(BigInt(2)**BigInt(32)))&&(Fe=rt(Fe)),Fe+="n"),Ae+=` It must be ${ce}. Received ${Fe}`,Ae},RangeError);function rt(Se){let ce="",de=Se.length;const Ae=Se[0]==="-"?1:0;for(;de>=Ae+4;de-=3)ce=`_${Se.slice(de-3,de)}${ce}`;return`${Se.slice(0,de)}${ce}`}function ut(Se,ce,de){Re(ce,"offset"),(Se[ce]===void 0||Se[ce+de]===void 0)&&Ue(ce,Se.length-(de+1))}function We(Se,ce,de,Ae,Fe,Ve){if(Se>de||Se<ce){const Je=typeof ce=="bigint"?"n":"";let dt;throw Ve>3?ce===0||ce===BigInt(0)?dt=`>= 0${Je} and < 2${Je} ** ${(Ve+1)*8}${Je}`:dt=`>= -(2${Je} ** ${(Ve+1)*8-1}${Je}) and < 2 ** ${(Ve+1)*8-1}${Je}`:dt=`>= ${ce}${Je} and <= ${de}${Je}`,new it.ERR_OUT_OF_RANGE("value",dt,Se)}ut(Ae,Fe,Ve)}function Re(Se,ce){if(typeof Se!="number")throw new it.ERR_INVALID_ARG_TYPE(ce,"number",Se)}function Ue(Se,ce,de){throw Math.floor(Se)!==Se?(Re(Se,de),new it.ERR_OUT_OF_RANGE(de||"offset","an integer",Se)):ce<0?new it.ERR_BUFFER_OUT_OF_BOUNDS:new it.ERR_OUT_OF_RANGE(de||"offset",`>= ${de?1:0} and <= ${ce}`,Se)}const Le=/[^+/0-9A-Za-z-_]/g;function Ge(Se){if(Se=Se.split("=")[0],Se=Se.trim().replace(Le,""),Se.length<2)return"";for(;Se.length%4!==0;)Se=Se+"=";return Se}function ke(Se,ce){ce=ce||1/0;let de;const Ae=Se.length;let Fe=null;const Ve=[];for(let Je=0;Je<Ae;++Je){if(de=Se.charCodeAt(Je),de>55295&&de<57344){if(!Fe){if(de>56319){(ce-=3)>-1&&Ve.push(239,191,189);continue}else if(Je+1===Ae){(ce-=3)>-1&&Ve.push(239,191,189);continue}Fe=de;continue}if(de<56320){(ce-=3)>-1&&Ve.push(239,191,189),Fe=de;continue}de=(Fe-55296<<10|de-56320)+65536}else Fe&&(ce-=3)>-1&&Ve.push(239,191,189);if(Fe=null,de<128){if((ce-=1)<0)break;Ve.push(de)}else if(de<2048){if((ce-=2)<0)break;Ve.push(de>>6|192,de&63|128)}else if(de<65536){if((ce-=3)<0)break;Ve.push(de>>12|224,de>>6&63|128,de&63|128)}else if(de<1114112){if((ce-=4)<0)break;Ve.push(de>>18|240,de>>12&63|128,de>>6&63|128,de&63|128)}else throw new Error("Invalid code point")}return Ve}function He(Se){const ce=[];for(let de=0;de<Se.length;++de)ce.push(Se.charCodeAt(de)&255);return ce}function Ke(Se,ce){let de,Ae,Fe;const Ve=[];for(let Je=0;Je<Se.length&&!((ce-=2)<0);++Je)de=Se.charCodeAt(Je),Ae=de>>8,Fe=de%256,Ve.push(Fe),Ve.push(Ae);return Ve}function $e(Se){return D.toByteArray(Ge(Se))}function Qe(Se,ce,de,Ae){let Fe;for(Fe=0;Fe<Ae&&!(Fe+de>=ce.length||Fe>=Se.length);++Fe)ce[Fe+de]=Se[Fe];return Fe}function Ne(Se,ce){return Se instanceof ce||Se!=null&&Se.constructor!=null&&Se.constructor.name!=null&&Se.constructor.name===ce.name}function Ce(Se){return Se!==Se}const Ze=function(){const Se="0123456789abcdef",ce=new Array(256);for(let de=0;de<16;++de){const Ae=de*16;for(let Fe=0;Fe<16;++Fe)ce[Ae+Fe]=Se[de]+Se[Fe]}return ce}();function at(Se){return typeof BigInt>"u"?st:Se}function st(){throw new Error("BigInt not supported")}}(buffer)),buffer}var abstractSublevelIterator={},hasRequiredAbstractSublevelIterator;function requireAbstractSublevelIterator(){if(hasRequiredAbstractSublevelIterator)return abstractSublevelIterator;hasRequiredAbstractSublevelIterator=1;const{AbstractIterator:U,AbstractKeyIterator:D,AbstractValueIterator:F}=abstractIterator,G=Symbol("unfix"),Q=Symbol("iterator"),X=Symbol("handleOne"),q=Symbol("handleMany"),W=Symbol("callback");class Y extends U{constructor(ee,re,ne,le){super(ee,re),this[Q]=ne,this[G]=le,this[X]=this[X].bind(this),this[q]=this[q].bind(this),this[W]=null}[X](ee,re,ne){const le=this[W];if(ee)return le(ee);re!==void 0&&(re=this[G](re)),le(ee,re,ne)}[q](ee,re){const ne=this[W];if(ee)return ne(ee);for(const le of re){const se=le[0];se!==void 0&&(le[0]=this[G](se))}ne(ee,re)}}class J extends D{constructor(ee,re,ne,le){super(ee,re),this[Q]=ne,this[G]=le,this[X]=this[X].bind(this),this[q]=this[q].bind(this),this[W]=null}[X](ee,re){const ne=this[W];if(ee)return ne(ee);re!==void 0&&(re=this[G](re)),ne(ee,re)}[q](ee,re){const ne=this[W];if(ee)return ne(ee);for(let le=0;le<re.length;le++){const se=re[le];se!==void 0&&(re[le]=this[G](se))}ne(ee,re)}}class te extends F{constructor(ee,re,ne){super(ee,re),this[Q]=ne}}for(const Z of[Y,J])Z.prototype._next=function(ee){this[W]=ee,this[Q].next(this[X])},Z.prototype._nextv=function(ee,re,ne){this[W]=ne,this[Q].nextv(ee,re,this[q])},Z.prototype._all=function(ee,re){this[W]=re,this[Q].all(ee,this[q])};for(const Z of[te])Z.prototype._next=function(ee){this[Q].next(ee)},Z.prototype._nextv=function(ee,re,ne){this[Q].nextv(ee,re,ne)},Z.prototype._all=function(ee,re){this[Q].all(ee,re)};for(const Z of[Y,J,te])Z.prototype._seek=function(ee,re){this[Q].seek(ee,re)},Z.prototype._close=function(ee){this[Q].close(ee)};return abstractSublevelIterator.AbstractSublevelIterator=Y,abstractSublevelIterator.AbstractSublevelKeyIterator=J,abstractSublevelIterator.AbstractSublevelValueIterator=te,abstractSublevelIterator}var abstractSublevel,hasRequiredAbstractSublevel;function requireAbstractSublevel(){if(hasRequiredAbstractSublevel)return abstractSublevel;hasRequiredAbstractSublevel=1;const U=moduleError,{Buffer:D}=requireBuffer()||{},{AbstractSublevelIterator:F,AbstractSublevelKeyIterator:G,AbstractSublevelValueIterator:Q}=requireAbstractSublevelIterator(),X=Symbol("prefix"),q=Symbol("upperBound"),W=Symbol("prefixRange"),Y=Symbol("parent"),J=Symbol("unfix"),te=new TextEncoder,Z={separator:"!"};abstractSublevel=function({AbstractLevel:ie}){class ge extends ie{static defaults(ae){if(typeof ae=="string")throw new U("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(ae&&ae.open)throw new U("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return ae==null?Z:ae.separator?ae:{...ae,separator:"!"}}constructor(ae,ue,pe){const{separator:_e,manifest:xe,...be}=ge.defaults(pe);ue=se(ue,_e);const Te=_e.charCodeAt(0)+1,ye=ae[Y]||ae;if(!te.encode(ue).every(oe=>oe>Te&&oe<127))throw new U(`Prefix must use bytes > ${Te} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(ee(ye,xe),be);const Ee=(ae.prefix||"")+_e+ue+_e,he=Ee.slice(0,-1)+String.fromCharCode(Te);this[Y]=ye,this[X]=new ne(Ee),this[q]=new ne(he),this[J]=new le,this.nextTick=ye.nextTick}prefixKey(ae,ue){if(ue==="utf8")return this[X].utf8+ae;if(ae.byteLength===0)return this[X][ue];if(ue==="view"){const pe=this[X].view,_e=new Uint8Array(pe.byteLength+ae.byteLength);return _e.set(pe,0),_e.set(ae,pe.byteLength),_e}else{const pe=this[X].buffer;return D.concat([pe,ae],pe.byteLength+ae.byteLength)}}[W](ae,ue){ae.gte!==void 0?ae.gte=this.prefixKey(ae.gte,ue):ae.gt!==void 0?ae.gt=this.prefixKey(ae.gt,ue):ae.gte=this[X][ue],ae.lte!==void 0?ae.lte=this.prefixKey(ae.lte,ue):ae.lt!==void 0?ae.lt=this.prefixKey(ae.lt,ue):ae.lte=this[q][ue]}get prefix(){return this[X].utf8}get db(){return this[Y]}_open(ae,ue){this[Y].open({passive:!0},ue)}_put(ae,ue,pe,_e){this[Y].put(ae,ue,pe,_e)}_get(ae,ue,pe){this[Y].get(ae,ue,pe)}_getMany(ae,ue,pe){this[Y].getMany(ae,ue,pe)}_del(ae,ue,pe){this[Y].del(ae,ue,pe)}_batch(ae,ue,pe){this[Y].batch(ae,ue,pe)}_clear(ae,ue){this[W](ae,ae.keyEncoding),this[Y].clear(ae,ue)}_iterator(ae){this[W](ae,ae.keyEncoding);const ue=this[Y].iterator(ae),pe=this[J].get(this[X].utf8.length,ae.keyEncoding);return new F(this,ae,ue,pe)}_keys(ae){this[W](ae,ae.keyEncoding);const ue=this[Y].keys(ae),pe=this[J].get(this[X].utf8.length,ae.keyEncoding);return new G(this,ae,ue,pe)}_values(ae){this[W](ae,ae.keyEncoding);const ue=this[Y].values(ae);return new Q(this,ae,ue)}}return{AbstractSublevel:ge}};const ee=function(ie,ge){return{...ie.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...ge,encodings:{utf8:re(ie,"utf8"),buffer:re(ie,"buffer"),view:re(ie,"view")}}},re=function(ie,ge){return ie.supports.encodings[ge]?ie.keyEncoding(ge).name===ge:!1};class ne{constructor(ge){this.utf8=ge,this.view=te.encode(ge),this.buffer=D?D.from(this.view.buffer,0,this.view.byteLength):{}}}class le{constructor(){this.cache=new Map}get(ge,fe){let ae=this.cache.get(fe);return ae===void 0&&(fe==="view"?ae=function(ue,pe){return pe.subarray(ue)}.bind(null,ge):ae=function(ue,pe){return pe.slice(ue)}.bind(null,ge),this.cache.set(fe,ae)),ae}}const se=function(ie,ge){let fe=0,ae=ie.length;for(;fe<ae&&ie[fe]===ge;)fe++;for(;ae>fe&&ie[ae-1]===ge;)ae--;return ie.slice(fe,ae)};return abstractSublevel}const{supports}=levelSupports,{Transcoder}=levelTranscoder,{EventEmitter}=eventsExports,{fromCallback}=catering,ModuleError$1=moduleError,{AbstractIterator:AbstractIterator$1}=abstractIterator,{DefaultKeyIterator,DefaultValueIterator}=defaultKvIterator,{DeferredIterator,DeferredKeyIterator,DeferredValueIterator}=deferredIterator,{DefaultChainedBatch}=defaultChainedBatch,{getCallback,getOptions}=common$6,rangeOptions$1=rangeOptions_1,kPromise=Symbol("promise"),kLanded=Symbol("landed"),kResources=Symbol("resources"),kCloseResources=Symbol("closeResources"),kOperations=Symbol("operations"),kUndefer=Symbol("undefer"),kDeferOpen=Symbol("deferOpen"),kOptions$1=Symbol("options"),kStatus=Symbol("status"),kDefaultOptions=Symbol("defaultOptions"),kTranscoder=Symbol("transcoder"),kKeyEncoding=Symbol("keyEncoding"),kValueEncoding=Symbol("valueEncoding"),noop$3=()=>{};let AbstractLevel$1=class extends EventEmitter{constructor(D,F){if(super(),typeof D!="object"||D===null)throw new TypeError("The first argument 'manifest' must be an object");F=getOptions(F);const{keyEncoding:G,valueEncoding:Q,passive:X,...q}=F;this[kResources]=new Set,this[kOperations]=[],this[kDeferOpen]=!0,this[kOptions$1]=q,this[kStatus]="opening",this.supports=supports(D,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:D.snapshots!==!1,permanence:D.permanence!==!1,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:D.encodings||{},events:Object.assign({},D.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[kTranscoder]=new Transcoder(formats(this)),this[kKeyEncoding]=this[kTranscoder].encoding(G||"utf8"),this[kValueEncoding]=this[kTranscoder].encoding(Q||"utf8");for(const W of this[kTranscoder].encodings())this.supports.encodings[W.commonName]||(this.supports.encodings[W.commonName]=!0);this[kDefaultOptions]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[kKeyEncoding].commonName,valueEncoding:this[kValueEncoding].commonName}),key:Object.freeze({keyEncoding:this[kKeyEncoding].commonName})},this.nextTick(()=>{this[kDeferOpen]&&this.open({passive:!1},noop$3)})}get status(){return this[kStatus]}keyEncoding(D){return this[kTranscoder].encoding(D??this[kKeyEncoding])}valueEncoding(D){return this[kTranscoder].encoding(D??this[kValueEncoding])}open(D,F){F=getCallback(D,F),F=fromCallback(F,kPromise),D={...this[kOptions$1],...getOptions(D)},D.createIfMissing=D.createIfMissing!==!1,D.errorIfExists=!!D.errorIfExists;const G=Q=>{this[kStatus]==="closing"||this[kStatus]==="opening"?this.once(kLanded,Q?()=>G(Q):G):this[kStatus]!=="open"?F(new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:Q})):F()};return D.passive?this[kStatus]==="opening"?this.once(kLanded,G):this.nextTick(G):this[kStatus]==="closed"||this[kDeferOpen]?(this[kDeferOpen]=!1,this[kStatus]="opening",this.emit("opening"),this._open(D,Q=>{if(Q){this[kStatus]="closed",this[kCloseResources](()=>{this.emit(kLanded),G(Q)}),this[kUndefer]();return}this[kStatus]="open",this[kUndefer](),this.emit(kLanded),this[kStatus]==="open"&&this.emit("open"),this[kStatus]==="open"&&this.emit("ready"),G()})):this[kStatus]==="open"?this.nextTick(G):this.once(kLanded,()=>this.open(D,F)),F[kPromise]}_open(D,F){this.nextTick(F)}close(D){D=fromCallback(D,kPromise);const F=G=>{this[kStatus]==="opening"||this[kStatus]==="closing"?this.once(kLanded,G?F(G):F):this[kStatus]!=="closed"?D(new ModuleError$1("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:G})):D()};if(this[kStatus]==="open"){this[kStatus]="closing",this.emit("closing");const G=Q=>{this[kStatus]="open",this[kUndefer](),this.emit(kLanded),F(Q)};this[kCloseResources](()=>{this._close(Q=>{if(Q)return G(Q);this[kStatus]="closed",this[kUndefer](),this.emit(kLanded),this[kStatus]==="closed"&&this.emit("closed"),F()})})}else this[kStatus]==="closed"?this.nextTick(F):this.once(kLanded,()=>this.close(D));return D[kPromise]}[kCloseResources](D){if(this[kResources].size===0)return this.nextTick(D);let F=this[kResources].size,G=!0;const Q=()=>{--F===0&&(G?this.nextTick(D):D())};for(const X of this[kResources])X.close(Q);G=!1,this[kResources].clear()}_close(D){this.nextTick(D)}get(D,F,G){if(G=getCallback(F,G),G=fromCallback(G,kPromise),F=getOptions(F,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.get(D,F,G)),G[kPromise];if(maybeError(this,G))return G[kPromise];const Q=this._checkKey(D);if(Q)return this.nextTick(G,Q),G[kPromise];const X=this.keyEncoding(F.keyEncoding),q=this.valueEncoding(F.valueEncoding),W=X.format,Y=q.format;return(F.keyEncoding!==W||F.valueEncoding!==Y)&&(F=Object.assign({},F,{keyEncoding:W,valueEncoding:Y})),this._get(this.prefixKey(X.encode(D),W),F,(J,te)=>{if(J)return(J.code==="LEVEL_NOT_FOUND"||J.notFound||/NotFound/i.test(J))&&(J.code||(J.code="LEVEL_NOT_FOUND"),J.notFound||(J.notFound=!0),J.status||(J.status=404)),G(J);try{te=q.decode(te)}catch(Z){return G(new ModuleError$1("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:Z}))}G(null,te)}),G[kPromise]}_get(D,F,G){this.nextTick(G,new Error("NotFound"))}getMany(D,F,G){if(G=getCallback(F,G),G=fromCallback(G,kPromise),F=getOptions(F,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.getMany(D,F,G)),G[kPromise];if(maybeError(this,G))return G[kPromise];if(!Array.isArray(D))return this.nextTick(G,new TypeError("The first argument 'keys' must be an array")),G[kPromise];if(D.length===0)return this.nextTick(G,null,[]),G[kPromise];const Q=this.keyEncoding(F.keyEncoding),X=this.valueEncoding(F.valueEncoding),q=Q.format,W=X.format;(F.keyEncoding!==q||F.valueEncoding!==W)&&(F=Object.assign({},F,{keyEncoding:q,valueEncoding:W}));const Y=new Array(D.length);for(let J=0;J<D.length;J++){const te=D[J],Z=this._checkKey(te);if(Z)return this.nextTick(G,Z),G[kPromise];Y[J]=this.prefixKey(Q.encode(te),q)}return this._getMany(Y,F,(J,te)=>{if(J)return G(J);try{for(let Z=0;Z<te.length;Z++)te[Z]!==void 0&&(te[Z]=X.decode(te[Z]))}catch(Z){return G(new ModuleError$1(`Could not decode one or more of ${te.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:Z}))}G(null,te)}),G[kPromise]}_getMany(D,F,G){this.nextTick(G,null,new Array(D.length).fill(void 0))}put(D,F,G,Q){if(Q=getCallback(G,Q),Q=fromCallback(Q,kPromise),G=getOptions(G,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.put(D,F,G,Q)),Q[kPromise];if(maybeError(this,Q))return Q[kPromise];const X=this._checkKey(D)||this._checkValue(F);if(X)return this.nextTick(Q,X),Q[kPromise];const q=this.keyEncoding(G.keyEncoding),W=this.valueEncoding(G.valueEncoding),Y=q.format,J=W.format;(G.keyEncoding!==Y||G.valueEncoding!==J)&&(G=Object.assign({},G,{keyEncoding:Y,valueEncoding:J}));const te=this.prefixKey(q.encode(D),Y),Z=W.encode(F);return this._put(te,Z,G,ee=>{if(ee)return Q(ee);this.emit("put",D,F),Q()}),Q[kPromise]}_put(D,F,G,Q){this.nextTick(Q)}del(D,F,G){if(G=getCallback(F,G),G=fromCallback(G,kPromise),F=getOptions(F,this[kDefaultOptions].key),this[kStatus]==="opening")return this.defer(()=>this.del(D,F,G)),G[kPromise];if(maybeError(this,G))return G[kPromise];const Q=this._checkKey(D);if(Q)return this.nextTick(G,Q),G[kPromise];const X=this.keyEncoding(F.keyEncoding),q=X.format;return F.keyEncoding!==q&&(F=Object.assign({},F,{keyEncoding:q})),this._del(this.prefixKey(X.encode(D),q),F,W=>{if(W)return G(W);this.emit("del",D),G()}),G[kPromise]}_del(D,F,G){this.nextTick(G)}batch(D,F,G){if(!arguments.length){if(this[kStatus]==="opening")return new DefaultChainedBatch(this);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(typeof D=="function"?G=D:G=getCallback(F,G),G=fromCallback(G,kPromise),F=getOptions(F,this[kDefaultOptions].empty),this[kStatus]==="opening")return this.defer(()=>this.batch(D,F,G)),G[kPromise];if(maybeError(this,G))return G[kPromise];if(!Array.isArray(D))return this.nextTick(G,new TypeError("The first argument 'operations' must be an array")),G[kPromise];if(D.length===0)return this.nextTick(G),G[kPromise];const Q=new Array(D.length),{keyEncoding:X,valueEncoding:q,...W}=F;for(let Y=0;Y<D.length;Y++){if(typeof D[Y]!="object"||D[Y]===null)return this.nextTick(G,new TypeError("A batch operation must be an object")),G[kPromise];const J=Object.assign({},D[Y]);if(J.type!=="put"&&J.type!=="del")return this.nextTick(G,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),G[kPromise];const te=this._checkKey(J.key);if(te)return this.nextTick(G,te),G[kPromise];const Z=J.sublevel!=null?J.sublevel:this,ee=Z.keyEncoding(J.keyEncoding||X),re=ee.format;if(J.key=Z.prefixKey(ee.encode(J.key),re),J.keyEncoding=re,J.type==="put"){const ne=this._checkValue(J.value);if(ne)return this.nextTick(G,ne),G[kPromise];const le=Z.valueEncoding(J.valueEncoding||q);J.value=le.encode(J.value),J.valueEncoding=le.format}Z!==this&&(J.sublevel=null),Q[Y]=J}return this._batch(Q,W,Y=>{if(Y)return G(Y);this.emit("batch",D),G()}),G[kPromise]}_batch(D,F,G){this.nextTick(G)}sublevel(D,F){return this._sublevel(D,AbstractSublevel.defaults(F))}_sublevel(D,F){return new AbstractSublevel(this,D,F)}prefixKey(D,F){return D}clear(D,F){if(F=getCallback(D,F),F=fromCallback(F,kPromise),D=getOptions(D,this[kDefaultOptions].empty),this[kStatus]==="opening")return this.defer(()=>this.clear(D,F)),F[kPromise];if(maybeError(this,F))return F[kPromise];const G=D,Q=this.keyEncoding(D.keyEncoding);return D=rangeOptions$1(D,Q),D.keyEncoding=Q.format,D.limit===0?this.nextTick(F):this._clear(D,X=>{if(X)return F(X);this.emit("clear",G),F()}),F[kPromise]}_clear(D,F){this.nextTick(F)}iterator(D){const F=this.keyEncoding(D&&D.keyEncoding),G=this.valueEncoding(D&&D.valueEncoding);if(D=rangeOptions$1(D,F),D.keys=D.keys!==!1,D.values=D.values!==!1,D[AbstractIterator$1.keyEncoding]=F,D[AbstractIterator$1.valueEncoding]=G,D.keyEncoding=F.format,D.valueEncoding=G.format,this[kStatus]==="opening")return new DeferredIterator(this,D);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(D)}_iterator(D){return new AbstractIterator$1(this,D)}keys(D){const F=this.keyEncoding(D&&D.keyEncoding),G=this.valueEncoding(D&&D.valueEncoding);if(D=rangeOptions$1(D,F),D[AbstractIterator$1.keyEncoding]=F,D[AbstractIterator$1.valueEncoding]=G,D.keyEncoding=F.format,D.valueEncoding=G.format,this[kStatus]==="opening")return new DeferredKeyIterator(this,D);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(D)}_keys(D){return new DefaultKeyIterator(this,D)}values(D){const F=this.keyEncoding(D&&D.keyEncoding),G=this.valueEncoding(D&&D.valueEncoding);if(D=rangeOptions$1(D,F),D[AbstractIterator$1.keyEncoding]=F,D[AbstractIterator$1.valueEncoding]=G,D.keyEncoding=F.format,D.valueEncoding=G.format,this[kStatus]==="opening")return new DeferredValueIterator(this,D);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(D)}_values(D){return new DefaultValueIterator(this,D)}defer(D){if(typeof D!="function")throw new TypeError("The first argument must be a function");this[kOperations].push(D)}[kUndefer](){if(this[kOperations].length===0)return;const D=this[kOperations];this[kOperations]=[];for(const F of D)F()}attachResource(D){if(typeof D!="object"||D===null||typeof D.close!="function")throw new TypeError("The first argument must be a resource object");this[kResources].add(D)}detachResource(D){this[kResources].delete(D)}_chainedBatch(){return new DefaultChainedBatch(this)}_checkKey(D){if(D==null)return new ModuleError$1("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(D){if(D==null)return new ModuleError$1("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}};AbstractLevel$1.prototype.nextTick=requireNextTickBrowser();const{AbstractSublevel}=requireAbstractSublevel()({AbstractLevel:AbstractLevel$1});abstractLevel.AbstractLevel=AbstractLevel$1;abstractLevel.AbstractSublevel=AbstractSublevel;const maybeError=function(U,D){return U[kStatus]!=="open"?(U.nextTick(D,new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0):!1},formats=function(U){return Object.keys(U.supports.encodings).filter(D=>!!U.supports.encodings[D])};abstractLevel$1.AbstractLevel=abstractLevel.AbstractLevel;abstractLevel$1.AbstractSublevel=abstractLevel.AbstractSublevel;abstractLevel$1.AbstractIterator=abstractIterator.AbstractIterator;abstractLevel$1.AbstractKeyIterator=abstractIterator.AbstractKeyIterator;abstractLevel$1.AbstractValueIterator=abstractIterator.AbstractValueIterator;abstractLevel$1.AbstractChainedBatch=abstractChainedBatch.AbstractChainedBatch;var rbtree=createRBTree,RED=0,BLACK=1;function RBNode(U,D,F,G,Q,X){this._color=U,this.key=D,this.value=F,this.left=G,this.right=Q,this._count=X}function cloneNode(U){return new RBNode(U._color,U.key,U.value,U.left,U.right,U._count)}function repaint(U,D){return new RBNode(U,D.key,D.value,D.left,D.right,D._count)}function recount(U){U._count=1+(U.left?U.left._count:0)+(U.right?U.right._count:0)}function RedBlackTree(U,D){this._compare=U,this.root=D}var proto=RedBlackTree.prototype;Object.defineProperty(proto,"keys",{get:function(){var U=[];return this.forEach(function(D,F){U.push(D)}),U}});Object.defineProperty(proto,"values",{get:function(){var U=[];return this.forEach(function(D,F){U.push(F)}),U}});Object.defineProperty(proto,"length",{get:function(){return this.root?this.root._count:0}});proto.insert=function(U,D){for(var F=this._compare,G=this.root,Q=[],X=[];G;){var q=F(U,G.key);Q.push(G),X.push(q),q<=0?G=G.left:G=G.right}Q.push(new RBNode(RED,U,D,null,null,1));for(var W=Q.length-2;W>=0;--W){var G=Q[W];X[W]<=0?Q[W]=new RBNode(G._color,G.key,G.value,Q[W+1],G.right,G._count+1):Q[W]=new RBNode(G._color,G.key,G.value,G.left,Q[W+1],G._count+1)}for(var W=Q.length-1;W>1;--W){var Y=Q[W-1],G=Q[W];if(Y._color===BLACK||G._color===BLACK)break;var J=Q[W-2];if(J.left===Y)if(Y.left===G){var te=J.right;if(te&&te._color===RED)Y._color=BLACK,J.right=repaint(BLACK,te),J._color=RED,W-=1;else{if(J._color=RED,J.left=Y.right,Y._color=BLACK,Y.right=J,Q[W-2]=Y,Q[W-1]=G,recount(J),recount(Y),W>=3){var Z=Q[W-3];Z.left===J?Z.left=Y:Z.right=Y}break}}else{var te=J.right;if(te&&te._color===RED)Y._color=BLACK,J.right=repaint(BLACK,te),J._color=RED,W-=1;else{if(Y.right=G.left,J._color=RED,J.left=G.right,G._color=BLACK,G.left=Y,G.right=J,Q[W-2]=G,Q[W-1]=Y,recount(J),recount(Y),recount(G),W>=3){var Z=Q[W-3];Z.left===J?Z.left=G:Z.right=G}break}}else if(Y.right===G){var te=J.left;if(te&&te._color===RED)Y._color=BLACK,J.left=repaint(BLACK,te),J._color=RED,W-=1;else{if(J._color=RED,J.right=Y.left,Y._color=BLACK,Y.left=J,Q[W-2]=Y,Q[W-1]=G,recount(J),recount(Y),W>=3){var Z=Q[W-3];Z.right===J?Z.right=Y:Z.left=Y}break}}else{var te=J.left;if(te&&te._color===RED)Y._color=BLACK,J.left=repaint(BLACK,te),J._color=RED,W-=1;else{if(Y.left=G.right,J._color=RED,J.right=G.left,G._color=BLACK,G.right=Y,G.left=J,Q[W-2]=G,Q[W-1]=Y,recount(J),recount(Y),recount(G),W>=3){var Z=Q[W-3];Z.right===J?Z.right=G:Z.left=G}break}}}return Q[0]._color=BLACK,new RedBlackTree(F,Q[0])};function doVisitFull(U,D){if(D.left){var F=doVisitFull(U,D.left);if(F)return F}var F=U(D.key,D.value);if(F)return F;if(D.right)return doVisitFull(U,D.right)}function doVisitHalf(U,D,F,G){var Q=D(U,G.key);if(Q<=0){if(G.left){var X=doVisitHalf(U,D,F,G.left);if(X)return X}var X=F(G.key,G.value);if(X)return X}if(G.right)return doVisitHalf(U,D,F,G.right)}function doVisit(U,D,F,G,Q){var X=F(U,Q.key),q=F(D,Q.key),W;if(X<=0&&(Q.left&&(W=doVisit(U,D,F,G,Q.left),W)||q>0&&(W=G(Q.key,Q.value),W)))return W;if(q>0&&Q.right)return doVisit(U,D,F,G,Q.right)}proto.forEach=function(D,F,G){if(this.root)switch(arguments.length){case 1:return doVisitFull(D,this.root);case 2:return doVisitHalf(F,this._compare,D,this.root);case 3:return this._compare(F,G)>=0?void 0:doVisit(F,G,this._compare,D,this.root)}};Object.defineProperty(proto,"begin",{get:function(){for(var U=[],D=this.root;D;)U.push(D),D=D.left;return new RedBlackTreeIterator(this,U)}});Object.defineProperty(proto,"end",{get:function(){for(var U=[],D=this.root;D;)U.push(D),D=D.right;return new RedBlackTreeIterator(this,U)}});proto.at=function(U){if(U<0)return new RedBlackTreeIterator(this,[]);for(var D=this.root,F=[];;){if(F.push(D),D.left){if(U<D.left._count){D=D.left;continue}U-=D.left._count}if(!U)return new RedBlackTreeIterator(this,F);if(U-=1,D.right){if(U>=D.right._count)break;D=D.right}else break}return new RedBlackTreeIterator(this,[])};proto.ge=function(U){for(var D=this._compare,F=this.root,G=[],Q=0;F;){var X=D(U,F.key);G.push(F),X<=0&&(Q=G.length),X<=0?F=F.left:F=F.right}return G.length=Q,new RedBlackTreeIterator(this,G)};proto.gt=function(U){for(var D=this._compare,F=this.root,G=[],Q=0;F;){var X=D(U,F.key);G.push(F),X<0&&(Q=G.length),X<0?F=F.left:F=F.right}return G.length=Q,new RedBlackTreeIterator(this,G)};proto.lt=function(U){for(var D=this._compare,F=this.root,G=[],Q=0;F;){var X=D(U,F.key);G.push(F),X>0&&(Q=G.length),X<=0?F=F.left:F=F.right}return G.length=Q,new RedBlackTreeIterator(this,G)};proto.le=function(U){for(var D=this._compare,F=this.root,G=[],Q=0;F;){var X=D(U,F.key);G.push(F),X>=0&&(Q=G.length),X<0?F=F.left:F=F.right}return G.length=Q,new RedBlackTreeIterator(this,G)};proto.find=function(U){for(var D=this._compare,F=this.root,G=[];F;){var Q=D(U,F.key);if(G.push(F),Q===0)return new RedBlackTreeIterator(this,G);Q<=0?F=F.left:F=F.right}return new RedBlackTreeIterator(this,[])};proto.remove=function(U){var D=this.find(U);return D?D.remove():this};proto.get=function(U){for(var D=this._compare,F=this.root;F;){var G=D(U,F.key);if(G===0)return F.value;G<=0?F=F.left:F=F.right}};function RedBlackTreeIterator(U,D){this.tree=U,this._stack=D}var iproto=RedBlackTreeIterator.prototype;Object.defineProperty(iproto,"valid",{get:function(){return this._stack.length>0}});Object.defineProperty(iproto,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0});iproto.clone=function(){return new RedBlackTreeIterator(this.tree,this._stack.slice())};function swapNode(U,D){U.key=D.key,U.value=D.value,U.left=D.left,U.right=D.right,U._color=D._color,U._count=D._count}function fixDoubleBlack(U){for(var D,F,G,Q,X=U.length-1;X>=0;--X){if(D=U[X],X===0){D._color=BLACK;return}if(F=U[X-1],F.left===D){if(G=F.right,G.right&&G.right._color===RED){if(G=F.right=cloneNode(G),Q=G.right=cloneNode(G.right),F.right=G.left,G.left=F,G.right=Q,G._color=F._color,D._color=BLACK,F._color=BLACK,Q._color=BLACK,recount(F),recount(G),X>1){var q=U[X-2];q.left===F?q.left=G:q.right=G}U[X-1]=G;return}else if(G.left&&G.left._color===RED){if(G=F.right=cloneNode(G),Q=G.left=cloneNode(G.left),F.right=Q.left,G.left=Q.right,Q.left=F,Q.right=G,Q._color=F._color,F._color=BLACK,G._color=BLACK,D._color=BLACK,recount(F),recount(G),recount(Q),X>1){var q=U[X-2];q.left===F?q.left=Q:q.right=Q}U[X-1]=Q;return}if(G._color===BLACK)if(F._color===RED){F._color=BLACK,F.right=repaint(RED,G);return}else{F.right=repaint(RED,G);continue}else{if(G=cloneNode(G),F.right=G.left,G.left=F,G._color=F._color,F._color=RED,recount(F),recount(G),X>1){var q=U[X-2];q.left===F?q.left=G:q.right=G}U[X-1]=G,U[X]=F,X+1<U.length?U[X+1]=D:U.push(D),X=X+2}}else{if(G=F.left,G.left&&G.left._color===RED){if(G=F.left=cloneNode(G),Q=G.left=cloneNode(G.left),F.left=G.right,G.right=F,G.left=Q,G._color=F._color,D._color=BLACK,F._color=BLACK,Q._color=BLACK,recount(F),recount(G),X>1){var q=U[X-2];q.right===F?q.right=G:q.left=G}U[X-1]=G;return}else if(G.right&&G.right._color===RED){if(G=F.left=cloneNode(G),Q=G.right=cloneNode(G.right),F.left=Q.right,G.right=Q.left,Q.right=F,Q.left=G,Q._color=F._color,F._color=BLACK,G._color=BLACK,D._color=BLACK,recount(F),recount(G),recount(Q),X>1){var q=U[X-2];q.right===F?q.right=Q:q.left=Q}U[X-1]=Q;return}if(G._color===BLACK)if(F._color===RED){F._color=BLACK,F.left=repaint(RED,G);return}else{F.left=repaint(RED,G);continue}else{if(G=cloneNode(G),F.left=G.right,G.right=F,G._color=F._color,F._color=RED,recount(F),recount(G),X>1){var q=U[X-2];q.right===F?q.right=G:q.left=G}U[X-1]=G,U[X]=F,X+1<U.length?U[X+1]=D:U.push(D),X=X+2}}}}iproto.remove=function(){var U=this._stack;if(U.length===0)return this.tree;var D=new Array(U.length),F=U[U.length-1];D[D.length-1]=new RBNode(F._color,F.key,F.value,F.left,F.right,F._count);for(var G=U.length-2;G>=0;--G){var F=U[G];F.left===U[G+1]?D[G]=new RBNode(F._color,F.key,F.value,D[G+1],F.right,F._count):D[G]=new RBNode(F._color,F.key,F.value,F.left,D[G+1],F._count)}if(F=D[D.length-1],F.left&&F.right){var Q=D.length;for(F=F.left;F.right;)D.push(F),F=F.right;var X=D[Q-1];D.push(new RBNode(F._color,X.key,X.value,F.left,F.right,F._count)),D[Q-1].key=F.key,D[Q-1].value=F.value;for(var G=D.length-2;G>=Q;--G)F=D[G],D[G]=new RBNode(F._color,F.key,F.value,F.left,D[G+1],F._count);D[Q-1].left=D[Q]}if(F=D[D.length-1],F._color===RED){var q=D[D.length-2];q.left===F?q.left=null:q.right===F&&(q.right=null),D.pop();for(var G=0;G<D.length;++G)D[G]._count--;return new RedBlackTree(this.tree._compare,D[0])}else if(F.left||F.right){F.left?swapNode(F,F.left):F.right&&swapNode(F,F.right),F._color=BLACK;for(var G=0;G<D.length-1;++G)D[G]._count--;return new RedBlackTree(this.tree._compare,D[0])}else{if(D.length===1)return new RedBlackTree(this.tree._compare,null);for(var G=0;G<D.length;++G)D[G]._count--;var W=D[D.length-2];fixDoubleBlack(D),W.left===F?W.left=null:W.right=null}return new RedBlackTree(this.tree._compare,D[0])};Object.defineProperty(iproto,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0});Object.defineProperty(iproto,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0});Object.defineProperty(iproto,"index",{get:function(){var U=0,D=this._stack;if(D.length===0){var F=this.tree.root;return F?F._count:0}else D[D.length-1].left&&(U=D[D.length-1].left._count);for(var G=D.length-2;G>=0;--G)D[G+1]===D[G].right&&(++U,D[G].left&&(U+=D[G].left._count));return U},enumerable:!0});iproto.next=function(){var U=this._stack;if(U.length!==0){var D=U[U.length-1];if(D.right)for(D=D.right;D;)U.push(D),D=D.left;else for(U.pop();U.length>0&&U[U.length-1].right===D;)D=U[U.length-1],U.pop()}};Object.defineProperty(iproto,"hasNext",{get:function(){var U=this._stack;if(U.length===0)return!1;if(U[U.length-1].right)return!0;for(var D=U.length-1;D>0;--D)if(U[D-1].left===U[D])return!0;return!1}});iproto.update=function(U){var D=this._stack;if(D.length===0)throw new Error("Can't update empty node!");var F=new Array(D.length),G=D[D.length-1];F[F.length-1]=new RBNode(G._color,G.key,U,G.left,G.right,G._count);for(var Q=D.length-2;Q>=0;--Q)G=D[Q],G.left===D[Q+1]?F[Q]=new RBNode(G._color,G.key,G.value,F[Q+1],G.right,G._count):F[Q]=new RBNode(G._color,G.key,G.value,G.left,F[Q+1],G._count);return new RedBlackTree(this.tree._compare,F[0])};iproto.prev=function(){var U=this._stack;if(U.length!==0){var D=U[U.length-1];if(D.left)for(D=D.left;D;)U.push(D),D=D.right;else for(U.pop();U.length>0&&U[U.length-1].left===D;)D=U[U.length-1],U.pop()}};Object.defineProperty(iproto,"hasPrev",{get:function(){var U=this._stack;if(U.length===0)return!1;if(U[U.length-1].left)return!0;for(var D=U.length-1;D>0;--D)if(U[D-1].right===U[D])return!0;return!1}});function defaultCompare(U,D){return U<D?-1:U>D?1:0}function createRBTree(U){return new RedBlackTree(U||defaultCompare,null)}const{AbstractLevel,AbstractIterator,AbstractKeyIterator,AbstractValueIterator}=abstractLevel$1,ModuleError=moduleError,createRBT=rbtree,rangeOptions=new Set(["gt","gte","lt","lte"]),kNone=Symbol("none"),kTree=Symbol("tree"),kIterator=Symbol("iterator"),kLowerBound=Symbol("lowerBound"),kUpperBound=Symbol("upperBound"),kOutOfRange=Symbol("outOfRange"),kReverse=Symbol("reverse"),kOptions=Symbol("options"),kTest=Symbol("test"),kAdvance=Symbol("advance"),kInit=Symbol("init");function compare(U,D){if(typeof U=="string")return U<D?-1:U>D?1:0;const F=Math.min(U.byteLength,D.byteLength);for(let G=0;G<F;G++){const Q=U[G]-D[G];if(Q!==0)return Q}return U.byteLength-D.byteLength}function gt(U){return compare(U,this[kUpperBound])>0}function gte(U){return compare(U,this[kUpperBound])>=0}function lt(U){return compare(U,this[kUpperBound])<0}function lte(U){return compare(U,this[kUpperBound])<=0}class MemoryIterator extends AbstractIterator{constructor(D,F){super(D,F),this[kInit](D[kTree],F)}_next(D){if(!this[kIterator].valid)return this.nextTick(D);const F=this[kIterator].key,G=this[kIterator].value;if(!this[kTest](F))return this.nextTick(D);this[kIterator][this[kAdvance]](),this.nextTick(D,null,F,G)}_nextv(D,F,G){const Q=this[kIterator],X=[];for(;Q.valid&&X.length<D&&this[kTest](Q.key);)X.push([Q.key,Q.value]),Q[this[kAdvance]]();this.nextTick(G,null,X)}_all(D,F){const G=this.limit-this.count,Q=this[kIterator],X=[];for(;Q.valid&&X.length<G&&this[kTest](Q.key);)X.push([Q.key,Q.value]),Q[this[kAdvance]]();this.nextTick(F,null,X)}}class MemoryKeyIterator extends AbstractKeyIterator{constructor(D,F){super(D,F),this[kInit](D[kTree],F)}_next(D){if(!this[kIterator].valid)return this.nextTick(D);const F=this[kIterator].key;if(!this[kTest](F))return this.nextTick(D);this[kIterator][this[kAdvance]](),this.nextTick(D,null,F)}_nextv(D,F,G){const Q=this[kIterator],X=[];for(;Q.valid&&X.length<D&&this[kTest](Q.key);)X.push(Q.key),Q[this[kAdvance]]();this.nextTick(G,null,X)}_all(D,F){const G=this.limit-this.count,Q=this[kIterator],X=[];for(;Q.valid&&X.length<G&&this[kTest](Q.key);)X.push(Q.key),Q[this[kAdvance]]();this.nextTick(F,null,X)}}class MemoryValueIterator extends AbstractValueIterator{constructor(D,F){super(D,F),this[kInit](D[kTree],F)}_next(D){if(!this[kIterator].valid)return this.nextTick(D);const F=this[kIterator].key,G=this[kIterator].value;if(!this[kTest](F))return this.nextTick(D);this[kIterator][this[kAdvance]](),this.nextTick(D,null,G)}_nextv(D,F,G){const Q=this[kIterator],X=[];for(;Q.valid&&X.length<D&&this[kTest](Q.key);)X.push(Q.value),Q[this[kAdvance]]();this.nextTick(G,null,X)}_all(D,F){const G=this.limit-this.count,Q=this[kIterator],X=[];for(;Q.valid&&X.length<G&&this[kTest](Q.key);)X.push(Q.value),Q[this[kAdvance]]();this.nextTick(F,null,X)}}for(const U of[MemoryIterator,MemoryKeyIterator,MemoryValueIterator])U.prototype[kInit]=function(D,F){this[kReverse]=F.reverse,this[kOptions]=F,this[kReverse]?(this[kAdvance]="prev",this[kLowerBound]="lte"in F?F.lte:"lt"in F?F.lt:kNone,this[kUpperBound]="gte"in F?F.gte:"gt"in F?F.gt:kNone,this[kLowerBound]===kNone?this[kIterator]=D.end:"lte"in F?this[kIterator]=D.le(this[kLowerBound]):this[kIterator]=D.lt(this[kLowerBound]),this[kUpperBound]!==kNone&&(this[kTest]="gte"in F?gte:gt)):(this[kAdvance]="next",this[kLowerBound]="gte"in F?F.gte:"gt"in F?F.gt:kNone,this[kUpperBound]="lte"in F?F.lte:"lt"in F?F.lt:kNone,this[kLowerBound]===kNone?this[kIterator]=D.begin:"gte"in F?this[kIterator]=D.ge(this[kLowerBound]):this[kIterator]=D.gt(this[kLowerBound]),this[kUpperBound]!==kNone&&(this[kTest]="lte"in F?lte:lt))},U.prototype[kTest]=function(){return!0},U.prototype[kOutOfRange]=function(D){return this[kTest](D)?this[kLowerBound]===kNone?!1:this[kReverse]?"lte"in this[kOptions]?compare(D,this[kLowerBound])>0:compare(D,this[kLowerBound])>=0:"gte"in this[kOptions]?compare(D,this[kLowerBound])<0:compare(D,this[kLowerBound])<=0:!0},U.prototype._seek=function(D,F){this[kOutOfRange](D)?(this[kIterator]=this[kIterator].tree.end,this[kIterator].next()):this[kReverse]?this[kIterator]=this[kIterator].tree.le(D):this[kIterator]=this[kIterator].tree.ge(D)};class MemoryLevel extends AbstractLevel{constructor(D,F,G){if(typeof D=="object"&&D!==null&&(F=D),typeof D=="function"||typeof F=="function"||typeof G=="function")throw new ModuleError("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});let{storeEncoding:Q,...X}=F||{};if(Q=Q||"buffer",!["buffer","view","utf8"].includes(Q))throw new ModuleError("The storeEncoding option must be 'buffer', 'view' or 'utf8'",{code:"LEVEL_ENCODING_NOT_SUPPORTED"});super({seek:!0,permanence:!1,createIfMissing:!1,errorIfExists:!1,encodings:{[Q]:!0}},X),this[kTree]=createRBT(compare)}_put(D,F,G,Q){const X=this[kTree].find(D);X.valid?this[kTree]=X.update(F):this[kTree]=this[kTree].insert(D,F),this.nextTick(Q)}_get(D,F,G){const Q=this[kTree].get(D);if(typeof Q>"u")return this.nextTick(G,new Error("NotFound"));this.nextTick(G,null,Q)}_getMany(D,F,G){this.nextTick(G,null,D.map(Q=>this[kTree].get(Q)))}_del(D,F,G){this[kTree]=this[kTree].remove(D),this.nextTick(G)}_batch(D,F,G){let Q=this[kTree];for(const X of D){const q=X.key,W=Q.find(q);X.type==="put"?Q=W.valid?W.update(X.value):Q.insert(q,X.value):Q=W.remove()}this[kTree]=Q,this.nextTick(G)}_clear(D,F){if(D.limit===-1&&!Object.keys(D).some(isRangeOption))return this[kTree]=createRBT(compare),this.nextTick(F);const G=this._keys({...D}),Q=G.limit;let X=0;const q=()=>{for(let W=0;W<500;W++){if(++X>Q||!G[kIterator].valid||!G[kTest](G[kIterator].key))return F();this[kTree]=this[kTree].remove(G[kIterator].key),G[kIterator][G[kAdvance]]()}this.nextTick(q)};this.nextTick(q)}_iterator(D){return new MemoryIterator(this,D)}_keys(D){return new MemoryKeyIterator(this,D)}_values(D){return new MemoryValueIterator(this,D)}}var MemoryLevel_1=MemoryLevel;if(typeof process<"u"&&!process.browser&&typeof commonjsGlobal<"u"&&typeof commonjsGlobal.setImmediate=="function"){const U=commonjsGlobal.setImmediate;MemoryLevel.prototype.nextTick=function(D,...F){F.length===0?U(D):U(()=>D(...F))}}function isRangeOption(U){return rangeOptions.has(U)}var rdfDataFactory={},BlankNode$1={};Object.defineProperty(BlankNode$1,"__esModule",{value:!0});BlankNode$1.BlankNode=void 0;class BlankNode{constructor(D){this.termType="BlankNode",this.value=D}equals(D){return!!D&&D.termType==="BlankNode"&&D.value===this.value}}BlankNode$1.BlankNode=BlankNode;var DataFactory$2={},DefaultGraph$1={};Object.defineProperty(DefaultGraph$1,"__esModule",{value:!0});DefaultGraph$1.DefaultGraph=void 0;class DefaultGraph{constructor(){this.termType="DefaultGraph",this.value=""}equals(D){return!!D&&D.termType==="DefaultGraph"}}DefaultGraph$1.DefaultGraph=DefaultGraph;DefaultGraph.INSTANCE=new DefaultGraph;var Literal$1={},NamedNode$1={};Object.defineProperty(NamedNode$1,"__esModule",{value:!0});NamedNode$1.NamedNode=void 0;class NamedNode{constructor(D){this.termType="NamedNode",this.value=D}equals(D){return!!D&&D.termType==="NamedNode"&&D.value===this.value}}NamedNode$1.NamedNode=NamedNode;Object.defineProperty(Literal$1,"__esModule",{value:!0});Literal$1.Literal=void 0;const NamedNode_1$1=NamedNode$1;class Literal{constructor(D,F){this.termType="Literal",this.value=D,typeof F=="string"?(this.language=F,this.datatype=Literal.RDF_LANGUAGE_STRING):F?(this.language="",this.datatype=F):(this.language="",this.datatype=Literal.XSD_STRING)}equals(D){return!!D&&D.termType==="Literal"&&D.value===this.value&&D.language===this.language&&D.datatype.equals(this.datatype)}}Literal$1.Literal=Literal;Literal.RDF_LANGUAGE_STRING=new NamedNode_1$1.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString");Literal.XSD_STRING=new NamedNode_1$1.NamedNode("http://www.w3.org/2001/XMLSchema#string");var Quad$2={};Object.defineProperty(Quad$2,"__esModule",{value:!0});Quad$2.Quad=void 0;let Quad$1=class{constructor(D,F,G,Q){this.termType="Quad",this.value="",this.subject=D,this.predicate=F,this.object=G,this.graph=Q}equals(D){return!!D&&(D.termType==="Quad"||!D.termType)&&this.subject.equals(D.subject)&&this.predicate.equals(D.predicate)&&this.object.equals(D.object)&&this.graph.equals(D.graph)}};Quad$2.Quad=Quad$1;var Variable$1={};Object.defineProperty(Variable$1,"__esModule",{value:!0});Variable$1.Variable=void 0;class Variable{constructor(D){this.termType="Variable",this.value=D}equals(D){return!!D&&D.termType==="Variable"&&D.value===this.value}}Variable$1.Variable=Variable;Object.defineProperty(DataFactory$2,"__esModule",{value:!0});DataFactory$2.DataFactory=void 0;const BlankNode_1=BlankNode$1,DefaultGraph_1=DefaultGraph$1,Literal_1=Literal$1,NamedNode_1=NamedNode$1,Quad_1=Quad$2,Variable_1=Variable$1;let dataFactoryCounter=0,DataFactory$1=class{constructor(D){this.blankNodeCounter=0,D=D||{},this.blankNodePrefix=D.blankNodePrefix||`df_${dataFactoryCounter++}_`}namedNode(D){return new NamedNode_1.NamedNode(D)}blankNode(D){return new BlankNode_1.BlankNode(D||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(D,F){return new Literal_1.Literal(D,F)}variable(D){return new Variable_1.Variable(D)}defaultGraph(){return DefaultGraph_1.DefaultGraph.INSTANCE}quad(D,F,G,Q){return new Quad_1.Quad(D,F,G,Q||this.defaultGraph())}fromTerm(D){switch(D.termType){case"NamedNode":return this.namedNode(D.value);case"BlankNode":return this.blankNode(D.value);case"Literal":return D.language?this.literal(D.value,D.language):D.datatype.equals(Literal_1.Literal.XSD_STRING)?this.literal(D.value):this.literal(D.value,this.fromTerm(D.datatype));case"Variable":return this.variable(D.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(D.subject),this.fromTerm(D.predicate),this.fromTerm(D.object),this.fromTerm(D.graph))}}fromQuad(D){return this.fromTerm(D)}resetBlankNodeCounter(){this.blankNodeCounter=0}};DataFactory$2.DataFactory=DataFactory$1;(function(U){var D=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(G,Q,X,q){q===void 0&&(q=X),Object.defineProperty(G,q,{enumerable:!0,get:function(){return Q[X]}})}:function(G,Q,X,q){q===void 0&&(q=X),G[q]=Q[X]}),F=commonjsGlobal&&commonjsGlobal.__exportStar||function(G,Q){for(var X in G)X!=="default"&&!Object.prototype.hasOwnProperty.call(Q,X)&&D(Q,G,X)};Object.defineProperty(U,"__esModule",{value:!0}),F(BlankNode$1,U),F(DataFactory$2,U),F(DefaultGraph$1,U),F(Literal$1,U),F(NamedNode$1,U),F(Quad$2,U),F(Variable$1,U)})(rdfDataFactory);var ResultType;(function(U){U.VOID="void",U.QUADS="quads",U.APPROXIMATE_SIZE="approximate_size"})(ResultType||(ResultType={}));class LinkedList{constructor(){this._length=0,this._head=null,this._tail=null}get length(){return this._length}get first(){var D;return(D=this._head)===null||D===void 0?void 0:D.value}get last(){var D;return(D=this._tail)===null||D===void 0?void 0:D.value}get empty(){return this._head===null}push(D){const F={value:D,next:null};this._tail===null?this._head=this._tail=F:this._tail.next=this._tail=F,this._length++}shift(){if(this._head===null)return;const{value:D,next:F}=this._head;return this._head=F,F===null&&(this._tail=null),this._length--,D}clear(){this._length=0,this._head=this._tail=null}}const resolved=Promise.resolve(void 0);function createTaskScheduler(){const U=typeof queueMicrotask=="function"?queueMicrotask:Q=>resolved.then(Q),D=typeof setImmediate=="function"?setImmediate:Q=>setTimeout(Q,0);let F=0,G=null;return Q=>{G!==null?G.push(Q):++F<100?U(Q):(G=[Q],D(()=>{for(const X of G)U(X);G=null,F=0}))}}let taskScheduler=createTaskScheduler();function scheduleTask(U){taskScheduler(U)}function getTaskScheduler(){return taskScheduler}function setTaskScheduler(U){taskScheduler=U}const INIT=1<<0,OPEN=1<<1,CLOSING=1<<2,CLOSED=1<<3,ENDED=1<<4,DESTROYED=1<<5;class AsyncIterator extends eventsExports.EventEmitter{constructor(D=OPEN){super(),this._readable=!1,this._state=D,this.on("newListener",waitForDataListener)}_changeState(D,F=!1){const G=D>this._state&&this._state<ENDED;return G&&(this._state=D,D===ENDED&&(F?taskScheduler(()=>this.emit("end")):this.emit("end"))),G}read(){return null}forEach(D,F){this.on("data",bind(D,F))}close(){this._changeState(CLOSED)&&this._endAsync()}destroy(D){this.done||this._destroy(D,F=>{D=D||F,D&&this.emit("error",D),this._end(!0)})}_destroy(D,F){F()}_end(D=!1){this._changeState(D?DESTROYED:ENDED)&&(this._readable=!1,this.removeAllListeners("readable"),this.removeAllListeners("data"),this.removeAllListeners("end"))}_endAsync(){taskScheduler(()=>this._end())}get readable(){return this._readable}set readable(D){D=!!D&&!this.done,this._readable!==D&&(this._readable=D,D&&taskScheduler(()=>this.emit("readable")))}get closed(){return this._state>=CLOSING}get ended(){return this._state===ENDED}get destroyed(){return this._state===DESTROYED}get done(){return this._state>=ENDED}toString(){const D=this._toStringDetails();return`[${this.constructor.name}${D?` ${D}`:""}]`}_toStringDetails(){return""}toArray(D){const F=[],G=typeof D?.limit=="number"?D.limit:1/0;return this.ended||G<=0?Promise.resolve(F):new Promise((Q,X)=>{const q=()=>Q(F),W=Y=>{F.push(Y),F.length>=G&&(this.removeListener("error",X),this.removeListener("data",W),this.removeListener("end",q),Q(F))};this.on("error",X),this.on("data",W),this.on("end",q)})}getProperty(D,F){const G=this._properties;if(!F)return G&&G[D];if(G&&D in G)taskScheduler(()=>F(G[D]));else{let Q;(Q=this._propertyCallbacks)||(this._propertyCallbacks=Q=Object.create(null)),D in Q?Q[D].push(F):Q[D]=[F]}}setProperty(D,F){const G=this._properties||(this._properties=Object.create(null));G[D]=F;const Q=this._propertyCallbacks||{},X=Q[D];if(X){delete Q[D],taskScheduler(()=>{for(const q of X)q(F)});for(D in Q)return;delete this._propertyCallbacks}}getProperties(){const D=this._properties,F={};for(const G in D)F[G]=D[G];return F}setProperties(D){for(const F in D)this.setProperty(F,D[F])}copyProperties(D,F){for(const G of F)D.getProperty(G,Q=>this.setProperty(G,Q))}transform(D){return new SimpleTransformIterator(this,D)}map(D,F){return new MappingIterator(this,bind(D,F))}filter(D,F){return this.map(function(G){return D.call(F||this,G)?G:null})}uniq(D=identity$3){const F=new Set;return this.filter(function(G){const Q=D.call(this,G);return F.has(Q)?!1:(F.add(Q),!0)})}prepend(D){return this.transform({prepend:D})}append(D){return this.transform({append:D})}surround(D,F){return this.transform({prepend:D,append:F})}skip(D){return this.map(F=>D-- >0?null:F)}take(D){return this.transform({limit:D})}range(D,F){return this.transform({offset:D,limit:Math.max(F-D+1,0)})}clone(){return new ClonedIterator(this)}}function waitForDataListener(U){U==="data"&&(this.removeListener("newListener",waitForDataListener),addSingleListener(this,"readable",emitData),this.readable&&taskScheduler(()=>emitData.call(this)))}function emitData(){let U;for(;this.listenerCount("data")!==0&&(U=this.read())!==null;)this.emit("data",U);this.listenerCount("data")===0&&!this.done&&(this.removeListener("readable",emitData),addSingleListener(this,"newListener",waitForDataListener))}function addSingleListener(U,D,F){U.listeners(D).includes(F)||U.on(D,F)}class EmptyIterator extends AsyncIterator{constructor(){super(),this._changeState(ENDED,!0)}}class SingletonIterator extends AsyncIterator{constructor(D){super(),this._item=D,D===null?this.close():this.readable=!0}read(){const D=this._item;return this._item=null,this.close(),D}_toStringDetails(){return this._item===null?"":`(${this._item})`}}class ArrayIterator extends AsyncIterator{constructor(D=[],{autoStart:F=!0,preserve:G=!0}={}){super();const Q=G||!Array.isArray(D)?[...D]:D;this._index=0,this._sourceStarted=F!==!1,this._truncateThreshold=G?-1:64,this._sourceStarted&&Q.length===0?this.close():this._buffer=Q,this.readable=!0}read(){this._sourceStarted||(this._sourceStarted=!0);let D=null;return this._buffer&&(this._index<this._buffer.length&&(D=this._buffer[this._index++]),this._index===this._buffer.length?(delete this._buffer,this.close()):this._index===this._truncateThreshold&&(this._buffer.splice(0,this._truncateThreshold),this._index=0)),D}_toStringDetails(){return`(${this._buffer?this._buffer.length-this._index:0})`}_destroy(D,F){delete this._buffer,F()}toArray(D={}){if(!this._buffer)return Promise.resolve([]);const{length:F}=this._buffer,G=this._index,Q=typeof D.limit!="number"?F:G+D.limit,X=this._buffer.slice(G,Q);return this._index=Q,Q>=F&&this.close(),Promise.resolve(X)}}class IntegerIterator extends AsyncIterator{constructor({start:D=0,step:F=1,end:G}={}){super(),Number.isFinite(D)&&(D=Math.trunc(D)),this._next=D,Number.isFinite(F)&&(F=Math.trunc(F)),this._step=F;const Q=F>=0,X=Q?1/0:-1/0;Number.isFinite(G)?G=Math.trunc(G):G!==-X&&(G=X),this._last=G,!Number.isFinite(D)||(Q?D>G:D<G)?this.close():this.readable=!0}read(){if(this.closed)return null;const D=this._next,F=this._step,G=this._last,Q=this._next+=F;return(F>=0?Q>G:Q<G)&&this.close(),D}_toStringDetails(){return`(${this._next}...${this._last})`}}function identity$3(U){return U}const DESTINATION=Symbol("destination");class MappingIterator extends AsyncIterator{constructor(D,F=identity$3,G={}){super(),this._map=F,this._source=ensureSourceAvailable(D),this._destroySource=G.destroySource!==!1,D.done?this.close():(this._source[DESTINATION]=this,this._source.on("end",destinationClose),this._source.on("error",destinationEmitError),this._source.on("readable",destinationSetReadable),this.readable=this._source.readable)}read(){if(!this.done){if(this._source.readable){let D,F;for(;(D=this._source.read())!==null;)if((F=this._map(D))!==null)return F}this.readable=!1,this._source.done&&this.close()}return null}_end(D){this._source.removeListener("end",destinationClose),this._source.removeListener("error",destinationEmitError),this._source.removeListener("readable",destinationSetReadable),delete this._source[DESTINATION],this._destroySource&&this._source.destroy(),super._end(D)}}function ensureSourceAvailable(U,D=!1){if(!U||!isFunction$1(U.read)||!isFunction$1(U.on))throw new TypeError(`Invalid source: ${U}`);if(!D&&U[DESTINATION])throw new Error("The source already has a destination");return U}class BufferedIterator extends AsyncIterator{constructor({maxBufferSize:D=4,autoStart:F=!0}={}){super(INIT),this._buffer=new LinkedList,this._maxBufferSize=4,this._reading=!0,this._pushedCount=0,this.maxBufferSize=D,taskScheduler(()=>this._init(F)),this._sourceStarted=F!==!1}get maxBufferSize(){return this._maxBufferSize}set maxBufferSize(D){D!==1/0&&(D=Number.isFinite(D)?Math.max(Math.trunc(D),1):4),this._maxBufferSize!==D&&(this._maxBufferSize=D,this._state===OPEN&&this._fillBuffer())}_init(D){let F=!1;this._reading=!0,this._begin(()=>{if(F)throw new Error("done callback called multiple times");F=!0,this._reading=!1,this._changeState(OPEN),D?this._fillBufferAsync():this.readable=!0})}_begin(D){D()}read(){if(this.done)return null;this._sourceStarted||(this._sourceStarted=!0);const D=this._buffer;let F;return D.empty?(F=null,this.readable=!1):F=D.shift(),!this._reading&&D.length<this._maxBufferSize&&(this.closed?D.empty&&this._endAsync():this._fillBufferAsync()),F}_read(D,F){F()}_push(D){this.done||(this._pushedCount++,this._buffer.push(D),this.readable=!0)}_fillBuffer(){let D;this._reading||(this.closed?this._completeClose():(D=Math.min(this._maxBufferSize-this._buffer.length,128))>0&&(this._pushedCount=0,this._reading=!0,this._read(D,()=>{if(!D)throw new Error("done callback called multiple times");D=0,this._reading=!1,this.closed?this._completeClose():this._pushedCount&&(this.readable=!0,this._buffer.length<this._maxBufferSize/2&&this._fillBufferAsync())})))}_fillBufferAsync(){this._reading||(this._reading=!0,taskScheduler(()=>{this._reading=!1,this._fillBuffer()}))}close(){this._reading?this._changeState(CLOSING):this._completeClose()}_completeClose(){this._changeState(CLOSED)&&(this._reading=!0,this._flush(()=>{if(!this._reading)throw new Error("done callback called multiple times");this._reading=!1,this._buffer.empty&&this._endAsync()}))}_destroy(D,F){this._buffer.clear(),F()}_flush(D){D()}_toStringDetails(){const D=this._buffer;return`{${D.empty?"":`next: ${D.first}, `}buffer: ${D.length}}`}}class TransformIterator extends BufferedIterator{constructor(D,F=D||{}){super(F),this._boundPush=G=>this._push(G),isSourceExpression(D)||(D=F.source),isEventEmitter(D)?this.source=D:D&&(this._createSource=isPromise(D)?()=>D:D,this._sourceStarted&&this._loadSourceAsync()),this._optional=!!F.optional,this._destroySource=F.destroySource!==!1}get source(){return isFunction$1(this._createSource)&&this._loadSourceAsync(),this._source}set source(D){const F=this._source=this._validateSource(D);F[DESTINATION]=this,this.done?this._destroySource&&F.destroy():F.done?this.close():(F.on("end",destinationCloseWhenDone),F.on("readable",destinationFillBuffer),F.on("error",destinationEmitError))}_loadSourceAsync(){isFunction$1(this._createSource)&&(Promise.resolve(this._createSource()).then(D=>{delete this._createSource,this.source=D,this._fillBuffer()},D=>this.emit("error",D)),this._createSource=null)}_validateSource(D,F=!1){if(this._source||typeof this._createSource<"u")throw new Error("The source cannot be changed after it has been set");return ensureSourceAvailable(D,F)}_read(D,F){const G=()=>{this._pushedCount<D&&!this.closed?taskScheduler(()=>this._readAndTransform(G,F)):F()};this._readAndTransform(G,F)}_readAndTransform(D,F){let G;const Q=this.source;!Q||Q.done||(G=Q.read())===null?F():this._optional?this._optionalTransform(G,D):this._transform(G,D,this._boundPush)}_optionalTransform(D,F){const G=this._pushedCount;this._transform(D,()=>{G===this._pushedCount&&this._push(D),F()},this._boundPush)}_transform(D,F,G){G(D),F()}_closeWhenDone(){this.close()}_end(D){const F=this._source;F&&(F.removeListener("end",destinationCloseWhenDone),F.removeListener("error",destinationEmitError),F.removeListener("readable",destinationFillBuffer),delete F[DESTINATION],this._destroySource&&F.destroy()),super._end(D)}}function destinationSetReadable(){this[DESTINATION].readable=!0}function destinationEmitError(U){this[DESTINATION].emit("error",U)}function destinationClose(){this[DESTINATION].close()}function destinationCloseWhenDone(){this[DESTINATION]._closeWhenDone()}function destinationFillBuffer(){this[DESTINATION]._sourceStarted!==!1&&this[DESTINATION]._fillBuffer()}class SimpleTransformIterator extends TransformIterator{constructor(D,F){if(super(D,F),this._offset=0,this._limit=1/0,this._filter=G=>!0,F=F||(isSourceExpression(D)?null:D),F){const G=isFunction$1(F)?F:F.transform,{limit:Q,offset:X,filter:q,map:W,prepend:Y,append:J}=F;X===1/0||Q===-1/0?this._limit=0:(Number.isFinite(X)&&(this._offset=Math.max(Math.trunc(X),0)),Number.isFinite(Q)&&(this._limit=Math.max(Math.trunc(Q),0)),isFunction$1(q)&&(this._filter=q),isFunction$1(W)&&(this._map=W),this._transform=isFunction$1(G)?G:null),Y&&(this._prepender=isEventEmitter(Y)?Y:fromArray(Y)),J&&(this._appender=isEventEmitter(J)?J:fromArray(J))}}_read(D,F){const G=()=>this._readAndTransformSimple(D,Q,F);this._readAndTransformSimple(D,Q,F);function Q(){taskScheduler(G)}}_readAndTransformSimple(D,F,G){let Q;const{source:X}=this;if(!X||X.done){G();return}for(this._limit===0&&this.close();!this.closed&&this._pushedCount<D&&(Q=X.read())!==null;){if(!this._filter(Q)||this._offset!==0&&this._offset--)continue;const q=typeof this._map>"u"?Q:this._map(Q);if(q===null)this._optional&&this._push(Q);else if(!isFunction$1(this._transform))this._push(q);else{this._optional?this._optionalTransform(q,F):this._transform(q,F,this._boundPush);return}--this._limit===0&&this.close()}G()}_begin(D){this._insert(this._prepender,D),delete this._prepender}_flush(D){this._insert(this._appender,D),delete this._appender}_insert(D,F){const G=X=>this._push(X);!D||D.done?F():(D.on("data",G),D.on("end",Q));function Q(){D.removeListener("data",G),D.removeListener("end",Q),F()}}}class MultiTransformIterator extends TransformIterator{constructor(D,F){if(super(D,F),this._transformerQueue=[],F){const G=isFunction$1(F)?F:F.multiTransform;G&&(this._createTransformer=G)}}_read(D,F){const G=this._transformerQueue,Q=this._optional;let X,q;for(;(X=G[0])&&X.transformer.done;){Q&&X.item!==null&&(D--,this._push(X.item)),G.shift();const{transformer:Y}=X;Y.removeListener("end",destinationFillBuffer),Y.removeListener("readable",destinationFillBuffer),Y.removeListener("error",destinationEmitError)}const{source:W}=this;for(;W&&!W.done&&G.length<this.maxBufferSize&&(q=W.read(),q!==null);){const Y=this._createTransformer(q)||new EmptyIterator;Y[DESTINATION]=this,Y.on("end",destinationFillBuffer),Y.on("readable",destinationFillBuffer),Y.on("error",destinationEmitError),G.push({transformer:Y,item:q})}if(X=G[0],X){const{transformer:Y}=X;for(;D-- >0&&(q=Y.read())!==null;)this._push(q),Q&&(X.item=null)}else W&&W.done&&this.close();F()}_createTransformer(D){return new SingletonIterator(D)}_closeWhenDone(){this._transformerQueue.length||this.close()}_end(D){if(super._end(D),this._destroySource)for(const F of this._transformerQueue)F.transformer.destroy()}}class UnionIterator extends BufferedIterator{constructor(D,F={}){super(F),this._sources=[],this._currentSource=-1;const G=F.autoStart!==!1;if(isEventEmitter(D))D.on("error",Q=>this.emit("error",Q)),this._pending={loading:!1,sources:D},G&&this._loadSources();else if(Array.isArray(D)&&D.length>0)for(const Q of D)this._addSource(Q);else G&&this.close();this._destroySources=F.destroySources!==!1}_loadSources(){const D=this._pending.sources;this._pending.loading=!0,D.done?(delete this._pending,this.close()):(D.on("data",F=>{this._addSource(F),this._fillBufferAsync()}),D.on("end",()=>{delete this._pending,this._fillBuffer()}))}_addSource(D){isPromise(D)&&(D=wrap(D)),D.done||(this._sources.push(D),D[DESTINATION]=this,D.on("error",destinationEmitError),D.on("readable",destinationFillBuffer),D.on("end",destinationRemoveEmptySources))}_removeEmptySources(){this._sources=this._sources.filter((D,F)=>(D.done&&F<=this._currentSource&&this._currentSource--,!D.done)),this._fillBuffer()}_read(D,F){var G;((G=this._pending)===null||G===void 0?void 0:G.loading)===!1&&this._loadSources();let Q=0,X;for(;Q!==(Q=D);)for(let q=0;q<this._sources.length&&D>0;q++)this._currentSource=(this._currentSource+1)%this._sources.length,(X=this._sources[this._currentSource].read())!==null&&(D--,this._push(X));!this._pending&&this._sources.length===0&&this.close(),F()}_end(D=!1){if(super._end(D),this._destroySources){for(const F of this._sources)F.destroy();this._pending&&(this._pending.sources.destroy(),delete this._pending)}}}function destinationRemoveEmptySources(){this[DESTINATION]._removeEmptySources()}class ClonedIterator extends TransformIterator{constructor(D){super(D,{autoStart:!1}),this._readPosition=0,this._reading=!1}_init(){}close(){AsyncIterator.prototype.close.call(this)}get source(){return super.source}set source(D){const F=this._source=this._validateSource(D),G=F&&F[DESTINATION]||(F[DESTINATION]=new HistoryReader(F));this.done?this._destroySource&&F.destroy():G.endsAt(0)?this.close():(G.register(this),(F._sourceStarted===!1||G.readAt(0)!==null)&&(this.readable=!0));const Q=this._propertyCallbacks;for(const X in Q){const q=Q[X];for(const W of q)this._getSourceProperty(X,W)}}_validateSource(D,F=!1){const G=D&&D[DESTINATION];return super._validateSource(D,!G||G instanceof HistoryReader)}getProperty(D,F){const{source:G}=this,Q=this._properties,X=Q&&D in Q;if(!F)return X?Q&&Q[D]:G&&G.getProperty(D);super.getProperty(D,F),G&&!X&&this._getSourceProperty(D,F)}_getSourceProperty(D,F){this.source.getProperty(D,G=>{(!this._properties||!(D in this._properties))&&F(G)})}getProperties(){const D=this.source?this.source.getProperties():{},F=this._properties;for(const G in F)D[G]=F[G];return D}_toStringDetails(){return`{source: ${this.source?this.source.toString():"none"}}`}read(){this._sourceStarted||(this._sourceStarted=!0);const D=this.source;let F=null;if(!this.done&&D){const G=D[DESTINATION];(F=G.readAt(this._readPosition))!==null?this._readPosition++:this.readable=!1,G.endsAt(this._readPosition)&&this.close()}return F}_end(D){const F=this.source,G=F?.[DESTINATION];G&&G.unregister(this),BufferedIterator.prototype._end.call(this,D)}}class HistoryReader{constructor(D){if(this._history=[],this._trackers=new Set,this._source=D,!D.done){const F=()=>{for(const X of this._trackers)X.readable=!0},G=X=>{for(const q of this._trackers)q.emit("error",X)},Q=()=>{for(const X of this._trackers)X._sourceStarted!==!1&&X._readPosition===this._history.length&&X.close();this._trackers.clear(),D.removeListener("end",Q),D.removeListener("error",G),D.removeListener("readable",F)};D.on("end",Q),D.on("error",G),D.on("readable",F)}}register(D){this._source.done||this._trackers.add(D)}unregister(D){this._trackers.delete(D)}readAt(D){let F=null;return D<this._history.length?F=this._history[D]:!this._source.done&&(F=this._source.read())!==null&&(this._history[D]=F),F}endsAt(D){return this._source.done&&this._history.length===D}}class WrappingIterator extends AsyncIterator{constructor(D,F){super(),this._source=null,this._destroySource=F?.destroySource!==!1,isPromise(D)?(this._source=new AsyncIterator,D.then(G=>{this._source=null,this.source=G}).catch(G=>this.emit("error",G))):D&&(this.source=D)}set source(D){let F=D;if(this._source!==null)throw new Error("The source cannot be changed after it has been set");if(isIterable(F)&&(F=F[Symbol.iterator]()),isIterator(F)){let G=F;F=new eventsExports.EventEmitter,F.read=()=>{if(G!==null){let Q;for(;!(Q=G.next()).done;)if(Q.value!==null)return Q.value;G=null,this.close()}return null}}else F=ensureSourceAvailable(F);if(this.done){this._destroySource&&isFunction$1(F.destroy)&&F.destroy();return}F[DESTINATION]=this,F.on("end",destinationClose),F.on("error",destinationEmitError),F.on("readable",destinationSetReadable),this._source=F,this.readable=F.readable!==!1}read(){if(this._source!==null&&this._source.readable!==!1){const D=this._source.read();if(D!==null)return D;this.readable=!1}return null}_end(D=!1){this._source!==null&&(this._source.removeListener("end",destinationClose),this._source.removeListener("error",destinationEmitError),this._source.removeListener("readable",destinationSetReadable),delete this._source[DESTINATION],this._destroySource&&isFunction$1(this._source.destroy)&&this._source.destroy(),this._source=null),super._end(D)}}function wrap(U,D){if(D&&("autoStart"in D||"optional"in D||"source"in D||"maxBufferSize"in D))return U&&!isEventEmitter(U)&&(U=new WrappingIterator(U)),new TransformIterator(U,D);if(!U)return empty();if(isPromise(U))return new WrappingIterator(U,D);if(U instanceof AsyncIterator)return U;if(Array.isArray(U))return fromArray(U);if(isIterable(U)||isIterator(U)||isEventEmitter(U))return new WrappingIterator(U,D);throw new TypeError(`Invalid source: ${U}`)}function empty(){return new EmptyIterator}function single(U){return new SingletonIterator(U)}function fromArray(U){return new ArrayIterator(U)}function fromIterator(U){return new WrappingIterator(U)}function fromIterable(U){return new WrappingIterator(U)}function union(U){return new UnionIterator(U)}function range(U,D,F){return new IntegerIterator({start:U,end:D,step:F})}function bind(U,D){return D?U.bind(D):U}function isFunction$1(U){return typeof U=="function"}function isEventEmitter(U){return isFunction$1(U?.on)}function isPromise(U){return isFunction$1(U?.then)}function isSourceExpression(U){return U&&(isEventEmitter(U)||isPromise(U)||isFunction$1(U))}function isIterable(U){return U&&Symbol.iterator in U}function isIterator(U){return isFunction$1(U?.next)}const __QUADSTORE_COMUNICA_EXTERNAL_MODULE_asynciterator__=Object.freeze(Object.defineProperty({__proto__:null,ArrayIterator,AsyncIterator,BufferedIterator,CLOSED,CLOSING,ClonedIterator,DESTINATION,DESTROYED,ENDED,EmptyIterator,INIT,IntegerIterator,LinkedList,MappingIterator,MultiTransformIterator,OPEN,SimpleTransformIterator,SingletonIterator,TransformIterator,UnionIterator,WrappingIterator,empty,fromArray,fromIterable,fromIterator,getTaskScheduler,identity:identity$3,isEventEmitter,isFunction:isFunction$1,isIterable,isIterator,isPromise,isSourceExpression,range,scheduleTask,setTaskScheduler,single,union,wrap},Symbol.toStringTag,{value:"Module"})),isObject$1=U=>typeof U=="object"&&U!==null,isAbstractLevel=U=>isObject$1(U)&&typeof U.open=="function"&&typeof U.batch=="function",ensureAbstractLevel=(U,D)=>{if(!isAbstractLevel(U))throw new Error(`${D} is not an AbstractLevel instance`)},streamToArray=U=>new Promise((D,F)=>{const G=[],Q=Y=>{G.push(Y)},X=()=>{U.removeListener("data",Q),U.removeListener("error",W),U.destroy()},q=()=>{X(),D(G)},W=Y=>{X(),F(Y)};U.on("error",W),U.on("end",q),U.on("data",Q)}),arrStartsWith=(U,D)=>{for(let F=0;F<D.length;F+=1)if(D[F]!==U[F])return!1;return!0},RESOLVED=Promise.resolve(),emptyObject={},boundary="\uDBFF\uDFFF",separator="\0\0",defaultIndexes=[["subject","predicate","object","graph"],["object","graph","subject","predicate"],["graph","subject","predicate","object"],["subject","object","predicate","graph"],["predicate","object","graph","subject"],["graph","predicate","object","subject"]],levelPutOpts={keyEncoding:"utf8",valueEncoding:"view"},levelDelOpts={keyEncoding:"utf8"},emptyValue=new Uint8Array(0),consumeOneByOne=async(U,D)=>new Promise((F,G)=>{let Q,X=!1,q=!1;const W=()=>{if(q=!0,(Q=U.read())!==null){Promise.resolve(D(Q)).then(W).catch(Y);return}q=!1,X&&F()},Y=ee=>{G(ee),Z()},J=()=>{X=!0,q||F(),Z()},te=()=>{q||W()},Z=()=>{U.removeListener("end",J),U.removeListener("error",Y),U.removeListener("readable",te),typeof U.destroy=="function"&&U.destroy()};U.on("end",J),U.on("error",Y),U.on("readable",te),U.readable!==!1&&W()}),consumeInBatches=async(U,D,F)=>new Promise((G,Q)=>{let X=0,q=!1,W=!1,Y=new Array(D);const J=()=>{if(le(),X>0){Promise.resolve(F(Y.slice(0,X))).then(G).catch(Z);return}G()},te=()=>{W=!0,q||J()},Z=se=>{le(),Q(se)},ee=()=>{q||ne()};let re=null;const ne=()=>{if(q=!0,W){J();return}for(;X<D&&(re=U.read())!==null;)Y[X++]=re;if(re===null){q=!1;return}X===D&&(Promise.resolve(F(Y.slice())).then(ne).catch(Z),X=0)},le=()=>{U.removeListener("end",te),U.removeListener("error",Z),U.removeListener("readable",ee),typeof U.destroy=="function"&&U.destroy()};U.on("end",te),U.on("error",Z),U.on("readable",ee),U.readable!==!1&&ne()});let IDX=256;const HEX=[];for(;IDX--;)HEX[IDX]=(IDX+256).toString(16).substring(1);const createUid=U=>{U=U||16;let D="",F=0;return()=>{if(!D||F===256){for(D="",F=(1+U)/2|0;F--;)D+=HEX[256*Math.random()|0];D=D.substring(F=0,U-2)}return D+HEX[F++]}},uid=createUid(11);class LevelIterator extends BufferedIterator{level;mapFn;levelEnded;constructor(D,F){super({maxBufferSize:64}),this.mapFn=F,this.level=D,this.levelEnded=!1}_read(D,F){const G={remaining:D};G.next=this._onNextValue.bind(this,G,F),this.level.next(G.next)}_onNextValue(D,F,G,Q,X){if(G){F(G);return}if(Q===void 0&&X===void 0){this.close(),this.levelEnded=!0,F();return}if(this._push(this.mapFn(Q,X)),D.remaining-=1,D.remaining===0){F();return}this.level.next(D.next)}_endLevel(D){if(this.levelEnded){D();return}this.level.close(F=>{F||(this.levelEnded=!0),D(F)})}_end(D){this.ended||(super._end(D),this._endLevel(F=>{F&&this.emit("error",F)}))}_destroy(D,F){if(this.destroyed){F();return}this._endLevel(G=>{if(G){F(G);return}super._destroy(D,F)})}}const xsd="http://www.w3.org/2001/XMLSchema#",string=`${xsd}string`,dateTime=`${xsd}dateTime`,integer=`${xsd}integer`,decimal=`${xsd}decimal`,double=`${xsd}double`,nonPositiveInteger=`${xsd}nonPositiveInteger`,negativeInteger=`${xsd}negativeInteger`,long=`${xsd}long`,int=`${xsd}int`,short=`${xsd}short`,byte=`${xsd}byte`,nonNegativeInteger=`${xsd}nonNegativeInteger`,unsignedLong=`${xsd}unsignedLong`,unsignedInt=`${xsd}unsignedInt`,unsignedShort=`${xsd}unsignedShort`,unsignedByte=`${xsd}unsignedByte`,positiveInteger=`${xsd}positiveInteger`,sliceString=(U,D,F)=>U.slice(D,D+F),padNumStart=U=>{if(U<10)return"000"+U;if(U<100)return"00"+U;if(U<1e3)return"0"+U;if(U<1e4)return""+U;throw new Error("too long: "+U)},join=(U,D,F)=>{let G=""+U;return D<10?G+="00"+D:D<100?G+="0"+D:G+=D,G+=F.toFixed(17),G},ZERO=join(3,0,0),NEG_INF=join(0,0,0),POS_INF=join(6,0,0),encode=U=>{let D=typeof U!="number"?parseFloat(U):U;if(Number.isNaN(D))throw new Error("Cannot serialize NaN");if(D===-1/0)return NEG_INF;if(D===1/0)return POS_INF;if(D===0)return ZERO;let F=0,G=0;for(D<0&&(G=1,D*=-1);D>10;)D/=10,F+=1;for(;D<1;)D*=10,F-=1;return G===1?F>=0?join(1,999-F,10-D):join(2,F*-1,10-D):F<0?join(4,999+F,D):join(5,F,D)},namedNodeWriter={write(U,D,F){const G=F.compactIri(U.value);D.lengths=padNumStart(G.length),D.value=G}},namedNodeReader={read(U,D,F,G){const{keyOffset:Q,lengthsOffset:X}=D,q=parseInt(sliceString(U,X,4));return D.lengthsOffset+=4,D.keyOffset+=q,F.namedNode(G.expandTerm(sliceString(U,Q,q)))}},blankNodeWriter={write(U,D){D.lengths=padNumStart(U.value.length),D.value=U.value}},blankNodeReader={read(U,D,F){const{keyOffset:G,lengthsOffset:Q}=D,X=parseInt(sliceString(U,Q,4));return D.lengthsOffset+=4,D.keyOffset+=X,F.blankNode(sliceString(U,G,X))}},genericLiteralWriter={write(U,D){D.lengths=padNumStart(U.value.length)+padNumStart(U.datatype.value.length),D.value=U.datatype.value+separator+U.value}},genericLiteralReader={read(U,D,F,G){const{keyOffset:Q,lengthsOffset:X}=D,q=parseInt(sliceString(U,X,4)),W=parseInt(sliceString(U,X+4,4));return D.lengthsOffset+=8,D.keyOffset+=q+W+separator.length,F.literal(sliceString(U,Q+W+separator.length,q),F.namedNode(sliceString(U,Q,W)))}},stringLiteralWriter={write(U,D){D.lengths=padNumStart(U.value.length),D.value=U.value}},stringLiteralReader={read(U,D,F){const{keyOffset:G,lengthsOffset:Q}=D,X=parseInt(sliceString(U,Q,4));return D.lengthsOffset+=4,D.keyOffset+=X,F.literal(sliceString(U,G,X))}},langStringLiteralWriter={write(U,D){D.lengths=padNumStart(U.value.length)+padNumStart(U.language.length),D.value=U.language+separator+U.value}},langStringLiteralReader={read(U,D,F,G){const{keyOffset:Q,lengthsOffset:X}=D,q=parseInt(sliceString(U,X,4)),W=parseInt(sliceString(U,X+4,4));return D.lengthsOffset+=8,D.keyOffset+=q+W+separator.length,F.literal(sliceString(U,Q+W+separator.length,q),sliceString(U,Q,W))}},numericLiteralWriter={write(U,D,F,G,Q){D.lengths=padNumStart(U.value.length)+padNumStart(U.datatype.value.length)+padNumStart(Q.length),G?D.value=Q:D.value=Q+separator+U.datatype.value+separator+U.value}},numericLiteralReader={read(U,D,F,G){const{keyOffset:Q,lengthsOffset:X}=D,q=parseInt(sliceString(U,X,4)),W=parseInt(sliceString(U,X+4,4)),Y=parseInt(sliceString(U,X+8,4));return D.lengthsOffset+=12,D.keyOffset+=Y+W+q+separator.length*2,F.literal(sliceString(U,Q+Y+separator.length+W+separator.length,q),F.namedNode(sliceString(U,Q+Y+separator.length,W)))}},defaultGraphWriter={write(U,D){D.value="dg",D.lengths="2"}},defaultGraphReader={read(U,D,F,G){return D.keyOffset+=2,D.lengthsOffset+=1,F.defaultGraph()}},termWriter={write(U,D,F){switch(U.termType){case"NamedNode":D.type="0",namedNodeWriter.write(U,D,F);break;case"BlankNode":D.type="1",blankNodeWriter.write(U,D,F);break;case"DefaultGraph":D.type="6",defaultGraphWriter.write(U,D,F);break;case"Literal":if(U.language)D.type="4",langStringLiteralWriter.write(U,D,F);else if(U.datatype)switch(U.datatype.value){case string:D.type="3",stringLiteralWriter.write(U,D,F);break;case integer:case double:case decimal:case nonPositiveInteger:case negativeInteger:case long:case int:case short:case byte:case nonNegativeInteger:case unsignedLong:case unsignedInt:case unsignedShort:case unsignedByte:case positiveInteger:D.type="5",numericLiteralWriter.write(U,D,F,!1,encode(U.value));break;case dateTime:D.type="7",numericLiteralWriter.write(U,D,F,!1,encode(new Date(U.value).valueOf()));break;default:D.type="2",genericLiteralWriter.write(U,D,F)}else D.type="3",stringLiteralWriter.write(U,D,F)}}},termReader={read(U,D,F,G){let Q;const X=U.charAt(D.lengthsOffset);switch(D.lengthsOffset+=1,X){case"0":Q=namedNodeReader.read(U,D,F,G);break;case"1":Q=blankNodeReader.read(U,D,F,G);break;case"2":Q=genericLiteralReader.read(U,D,F,G);break;case"3":Q=stringLiteralReader.read(U,D,F,G);break;case"4":Q=langStringLiteralReader.read(U,D,F,G);break;case"5":Q=numericLiteralReader.read(U,D,F,G);break;case"6":Q=defaultGraphReader.read(U,D,F,G);break;case"7":Q=numericLiteralReader.read(U,D,F,G);break;default:throw new Error(`Unexpected encoded term type "${X}"`)}return Q}},twoStepsQuadWriter={subject:{type:"",value:"",lengths:""},predicate:{type:"",value:"",lengths:""},object:{type:"",value:"",lengths:""},graph:{type:"",value:"",lengths:""},ingest(U,D){return termWriter.write(U.subject,this.subject,D),termWriter.write(U.predicate,this.predicate,D),termWriter.write(U.object,this.object,D),termWriter.write(U.graph,this.graph,D),this},write(U,D){let F=U,G="";for(let Q=0,X;Q<D.length;Q+=1)X=this[D[Q]],F+=X.value+separator,G+=X.type+X.lengths;return F+G+padNumStart(G.length)}},quadReader={subject:null,predicate:null,object:null,graph:null,keyOffset:0,lengthsOffset:0,read(U,D,F,G,Q){this.lengthsOffset=U.length-parseInt(U.slice(-4))-4,this.keyOffset=D;for(let X=0,q;X<F.length;X+=1)q=F[X],this[q]=termReader.read(U,this,G,Q),this.keyOffset+=separator.length;return G.quad(this.subject,this.predicate,this.object,this.graph)}},serialized={type:"",value:"",lengths:""},patternLiteralWriter={write(U,D){if(U.language){langStringLiteralWriter.write(U,serialized,D);return}if(U.datatype)switch(U.datatype.value){case string:stringLiteralWriter.write(U,serialized,D);return;case integer:case double:case decimal:case nonPositiveInteger:case negativeInteger:case long:case int:case short:case byte:case nonNegativeInteger:case unsignedLong:case unsignedInt:case unsignedShort:case unsignedByte:case positiveInteger:numericLiteralWriter.write(U,serialized,D,!0,encode(U.value));return;case dateTime:numericLiteralWriter.write(U,serialized,D,!0,encode(new Date(U.value).valueOf()));return;default:genericLiteralWriter.write(U,serialized,D);return}stringLiteralWriter.write(U,serialized,D)}},writePattern=(U,D,F)=>{let G=D.prefix,Q=D.prefix,X=!0,q=!0,W=!1,Y=!1,J=Object.entries(U).filter(([Z,ee])=>ee).length;if(J===0)return Q+=boundary,{gt:G,lt:Q,gte:X,lte:q,order:D.terms,index:D};let te=0;for(;te<D.terms.length&&J>0;te+=1){const Z=U[D.terms[te]];if(!Z||W||Y)return null;switch(Z.termType){case"Range":W=!0,Z.gt?(patternLiteralWriter.write(Z.gt,F),G+=serialized.value,X=!1):Z.gte&&(patternLiteralWriter.write(Z.gte,F),G+=serialized.value,X=!0),Z.lt?(patternLiteralWriter.write(Z.lt,F),Q+=serialized.value,q=!1):Z.lte&&(patternLiteralWriter.write(Z.lte,F),Q+=serialized.value,q=!0);break;case"Literal":Y=!0,patternLiteralWriter.write(Z,F),G+=serialized.value,X=!0,patternLiteralWriter.write(Z,F),Q+=serialized.value,q=!0;break;case"NamedNode":namedNodeWriter.write(Z,serialized,F),G+=serialized.value,X=!0,namedNodeWriter.write(Z,serialized,F),Q+=serialized.value,q=!0;break;case"BlankNode":blankNodeWriter.write(Z,serialized,F),G+=serialized.value,X=!0,blankNodeWriter.write(Z,serialized,F),Q+=serialized.value,q=!0;break;case"DefaultGraph":defaultGraphWriter.write(Z,serialized,F),G+=serialized.value,X=!0,defaultGraphWriter.write(Z,serialized,F),Q+=serialized.value,q=!0;break}J-=1,J>0&&te<D.terms.length-1&&(G+=separator,Q+=separator)}return q?W||Y?Q+=boundary:Q+=separator+boundary:Q+=separator,X?!W&&!Y&&(G+=separator):W||Y?G+=boundary:G+=separator+boundary,{gt:G,lt:Q,gte:X,lte:q,order:D.terms.slice(W?te-1:1),index:D}};var sortedSetExports={},sortedSet={get exports(){return sortedSetExports},set exports(U){sortedSetExports=U}};(function(U,D){(function(F,G){U.exports=G()})(commonjsGlobal,function(){class F{constructor(oe){if(oe?.strategy==null)throw"Must pass options.strategy, a strategy";if(oe?.comparator==null)throw"Must pass options.comparator, a comparator";if(oe?.onInsertConflict==null)throw"Must pass options.onInsertConflict, a function";this.priv=new oe.strategy(oe),this.length=0}insert(oe){return this.priv.insert(oe),this.length+=1,this}remove(oe){return this.priv.remove(oe),this.length-=1,this}clear(){return this.priv.clear(),this.length=0,this}contains(oe){return this.priv.contains(oe)}toArray(){return this.priv.toArray()}forEach(oe,me){return this.priv.forEachImpl(oe,this,me),this}map(oe,me){const ve=[];return this.forEach(function(we,Pe,Me){return ve.push(oe.call(me,we,Pe,Me))}),ve}filter(oe,me){const ve=[];return this.forEach(function(we,Pe,Me){if(oe.call(me,we,Pe,Me))return ve.push(we)}),ve}every(oe,me){let ve=!0;return this.forEach(function(we,Pe,Me){ve&&!oe.call(me,we,Pe,Me)&&(ve=!1)}),ve}some(oe,me){let ve=!1;return this.forEach(function(we,Pe,Me){!ve&&oe.call(me,we,Pe,Me)&&(ve=!0)}),ve}findIterator(oe){return this.priv.findIterator(oe)}beginIterator(){return this.priv.beginIterator()}endIterator(){return this.priv.endIterator()}}class G{constructor(oe,me){this.priv=oe,this.index=me,this.data=this.priv.data}hasNext(){return this.index<this.data.length}hasPrevious(){return this.index>0}value(){return this.index<this.data.length?this.data[this.index]:null}setValue(oe){if(!this.priv.options.allowSetValue)throw"Must set options.allowSetValue";if(!this.hasNext())throw"Cannot set value at end of set";return this.data[this.index]=oe}next(){return this.index>=this.data.length?null:new G(this.priv,this.index+1)}previous(){return this.index<=0?null:new G(this.priv,this.index-1)}}const Q=(he,oe,me)=>{let ve=0,we=he.length;for(;ve<we;){const Pe=ve+we>>>1;me(he[Pe],oe)<0?ve=Pe+1:we=Pe}return ve};class X{constructor(oe){this.options=oe,this.onInsertConflict=this.options.onInsertConflict,this.comparator=this.options.comparator,this.data=[]}toArray(){return this.data}insert(oe){const me=Q(this.data,oe,this.comparator);return this.data[me]!==void 0&&this.comparator(this.data[me],oe)===0?this.data.splice(me,1,this.onInsertConflict(this.data[me],oe)):this.data.splice(me,0,oe)}remove(oe){const me=Q(this.data,oe,this.comparator);if(this.comparator(this.data[me],oe)!==0)throw"Value not in set";return this.data.splice(me,1)}clear(){return this.data.length=0}contains(oe){const me=Q(this.data,oe,this.comparator);return this.index!==this.data.length&&this.comparator(this.data[me],oe)===0}forEachImpl(oe,me,ve){const we=this.data,Pe=we.length;for(let Me=0;Me<Pe;Me++)oe.call(ve,we[Me],Me,me)}findIterator(oe){const me=Q(this.data,oe,this.comparator);return new G(this,me)}beginIterator(){return new G(this,0)}endIterator(){return new G(this,this.data.length)}}const q=(he,oe)=>{for(;oe[he]!==null;){const me=oe;oe=oe[he],oe._iteratorParentNode=me}return oe},W=(he,oe)=>{let me,ve;if(oe[he]!==null)me=oe,oe=oe[he],oe._iteratorParentNode=me,ve=he==="left"?"right":"left",oe=q(ve,oe);else{for(;(me=oe._iteratorParentNode)!==null&&me[he]===oe;)oe=me;oe=me}return oe};class Y{constructor(oe,me){this.tree=oe,this.node=me}next(){if(this.node===null)return null;{const oe=W("right",this.node);return new Y(this.tree,oe)}}previous(){if(this.node===null){if(this.tree.root===null)return null;{this.tree.root._iteratorParentNode=null;const oe=q("right",this.tree.root);return new Y(this.tree,oe)}}else{const oe=W("left",this.node);return oe===null?null:new Y(this.tree,oe)}}hasNext(){return this.node!==null}hasPrevious(){return this.previous()!==null}value(){return this.node===null?null:this.node.value}setValue(oe){if(!this.tree.options.allowSetValue)throw"Must set options.allowSetValue";if(!this.hasNext())throw"Cannot set value at end of set";return this.node.value=oe}}Y.find=function(he,oe,me){const ve=he.root;ve!=null&&(ve._iteratorParentNode=null);let we=ve,Pe=null;for(;we!==null;){const Me=me(oe,we.value);if(Me===0)break;if(Me<0){if(we.left===null)break;Pe=we,we.left._iteratorParentNode=we,we=we.left}else if(we.right!==null)we.right._iteratorParentNode=we,we=we.right;else{we=Pe;break}}return new Y(he,we)},Y.left=he=>{if(he.root===null)return new Y(he,null);{he.root._iteratorParentNode=null;const oe=q("left",he.root);return new Y(he,oe)}},Y.right=he=>new Y(he,null);const J=(he,oe)=>{he!==null&&(J(he.left,oe),oe(he.value),J(he.right,oe))};class te{toArray(){const oe=[];return J(this.root,function(me){return oe.push(me)}),oe}clear(){return this.root=null}forEachImpl(oe,me,ve){let we=0;J(this.root,function(Pe){oe.call(ve,Pe,we,me),we+=1})}contains(oe){const me=this.comparator;let ve=this.root;for(;ve!==null;){const we=me(oe,ve.value);if(we===0)break;we<0?ve=ve.left:ve=ve.right}return ve!==null&&me(ve.value,oe)===0}findIterator(oe){return Y.find(this,oe,this.comparator)}beginIterator(){return Y.left(this)}endIterator(){return Y.right(this)}}class Z{constructor(oe){this.value=oe,this.left=null,this.right=null}}const ee=(he,oe)=>{for(;he[oe]!==null;)he=he[oe];return he},re=(he,oe,me)=>{if(he===null)throw"Value not in set";const ve=me(oe,he.value);if(ve<0)he.left=re(he.left,oe,me);else if(ve>0)he.right=re(he.right,oe,me);else if(he.left===null&&he.right===null)he=null;else if(he.right===null)he=he.left;else if(he.left===null)he=he.right;else{const we=ee(he.right,"left");he.value=we.value,he.right=re(he.right,we.value,me)}return he};class ne extends te{constructor(oe){super(),this.options=oe,this.comparator=this.options.comparator,this.onInsertConflict=this.options.onInsertConflict,this.root=null}insert(oe){const me=this.comparator;if(this.root!==null){let ve=this.root,we=null;for(;;){const Pe=me(oe,ve.value);if(Pe===0){ve.value=this.onInsertConflict(ve.value,oe);return}else{if(we=Pe<0?"left":"right",ve[we]===null)break;ve=ve[we]}}return ve[we]=new Z(oe)}else return this.root=new Z(oe)}remove(oe){return this.root=re(this.root,oe,this.comparator)}}class le{constructor(oe){this.value=oe,this.left=null,this.right=null,this.isRed=!0}}const se=he=>{const oe=he.right;return he.right=oe.left,oe.left=he,oe.isRed=he.isRed,he.isRed=!0,oe},ie=he=>{const oe=he.left;return he.left=oe.right,oe.right=he,oe.isRed=he.isRed,he.isRed=!0,oe},ge=he=>{he.isRed=!he.isRed,he.left.isRed=!he.left.isRed,he.right.isRed=!he.right.isRed},fe=he=>(ge(he),he.right!==null&&he.right.left!==null&&he.right.left.isRed&&(he.right=ie(he.right),he=se(he),ge(he)),he),ae=he=>(ge(he),he.left!==null&&he.left.left!==null&&he.left.left.isRed&&(he=ie(he),ge(he)),he),ue=(he,oe,me,ve)=>{if(he===null)return new le(oe);const we=me(oe,he.value);return we===0?he.value=ve(he.value,oe):we<0?he.left=ue(he.left,oe,me,ve):he.right=ue(he.right,oe,me,ve),he.right!==null&&he.right.isRed&&!(he.left!==null&&he.left.isRed)&&(he=se(he)),he.left!==null&&he.left.isRed&&he.left.left!==null&&he.left.left.isRed&&(he=ie(he)),he.left!==null&&he.left.isRed&&he.right!==null&&he.right.isRed&&ge(he),he},pe=he=>{for(;he.left!==null;)he=he.left;return he},_e=he=>(he.right!==null&&he.right.isRed&&(he=se(he)),he.left!==null&&he.left.isRed&&he.left.left!==null&&he.left.left.isRed&&(he=ie(he)),he.left!==null&&he.left.isRed&&he.right!==null&&he.right.isRed&&ge(he),he),xe=he=>he.left===null?null:(!he.left.isRed&&!(he.left.left!==null&&he.left.left.isRed)&&(he=fe(he)),he.left=xe(he.left),_e(he)),be=(he,oe,me)=>{if(he===null)throw"Value not in set";if(me(oe,he.value)<0){if(he.left===null)throw"Value not in set";!he.left.isRed&&!(he.left.left!==null&&he.left.left.isRed)&&(he=fe(he)),he.left=be(he.left,oe,me)}else{if(he.left!==null&&he.left.isRed&&(he=ie(he)),he.right===null){if(me(oe,he.value)===0)return null;throw"Value not in set"}!he.right.isRed&&!(he.right.left!==null&&he.right.left.isRed)&&(he=ae(he)),me(oe,he.value)===0?(he.value=pe(he.right).value,he.right=xe(he.right)):he.right=be(he.right,oe,me)}return he!==null&&(he=_e(he)),he};class Te extends te{constructor(oe){super(),this.options=oe,this.comparator=this.options.comparator,this.onInsertConflict=this.options.onInsertConflict,this.root=null}insert(oe){this.root=ue(this.root,oe,this.comparator,this.onInsertConflict),this.root.isRed=!1}remove(oe){this.root=be(this.root,oe,this.comparator),this.root!==null&&(this.root.isRed=!1)}}const ye={OnInsertConflictThrow:(he,oe)=>{throw new Error("Value already in set")},OnInsertConflictReplace:(he,oe)=>oe,OnInsertConflictIgnore:(he,oe)=>he};class Ee extends F{constructor(oe){oe||(oe={}),oe.strategy||(oe.strategy=Te),oe.comparator||(oe.comparator=function(me,ve){return(me||0)-(ve||0)}),oe.onInsertConflict||(oe.onInsertConflict=ye.OnInsertConflictThrow),super(oe)}}return Ee.ArrayStrategy=X,Ee.BinaryTreeStrategy=ne,Ee.RedBlackTreeStrategy=Te,Object.assign(Ee,ye),Ee})})(sortedSet);class SortingIterator extends AsyncIterator{constructor(D,F,G,Q){super();let X;const q=()=>{const W=new sortedSetExports({comparator:F}),Y=()=>{D.removeListener("data",J),D.removeListener("error",te),D.removeListener("end",Z),D.destroy()},J=ee=>{W.insert(G(ee))},te=ee=>{Y(),this.emit("error",ee)},Z=()=>{Y(),X=W.beginIterator(),this.readable=!0};D.on("data",J),D.on("error",te),D.on("end",Z)};this.read=()=>{if(X){const W=X.value();return W===null?(this.close(),null):(X=X.next(),Q(W))}return this.readable=!1,null},RESOLVED.then(q).catch(W=>{RESOLVED.then(()=>this.emit("error",W))})}}const SORTING_KEY=Symbol(),compareSortableQuadsReverse=(U,D)=>U[SORTING_KEY]>D[SORTING_KEY]?-1:1,compareSortableQuads=(U,D)=>U[SORTING_KEY]>D[SORTING_KEY]?1:-1,emitSortableQuad=U=>U,getLevelQueryForIndex=(U,D,F,G)=>{const Q=writePattern(U,D,F);if(Q===null)return null;const X={[Q.gte?"gte":"gt"]:Q.gt,[Q.lte?"lte":"lt"]:Q.lt,keys:!0,values:!1,keyEncoding:"utf8"};return typeof G.limit=="number"&&(X.limit=G.limit),typeof G.reverse=="boolean"&&(X.reverse=G.reverse),{level:X,order:Q.order,index:Q.index}},getLevelQuery=(U,D,F,G)=>{for(let Q=0,X;Q<D.length;Q+=1){X=D[Q];const q=getLevelQueryForIndex(U,X,F,G);if(q!==null&&(!G.order||arrStartsWith(q.order,G.order)))return q}return null},getStream=async(U,D,F)=>{const{dataFactory:G,prefixes:Q,indexes:X}=U,q=getLevelQuery(D,X,Q,F);if(q!==null){const{index:Y,level:J,order:te}=q;let Z=new LevelIterator(U.db.iterator(J),ee=>quadReader.read(ee,Y.prefix.length,Y.terms,G,Q));return{type:ResultType.QUADS,order:te,iterator:Z,index:Y.terms,resorted:!1}}const W=getLevelQuery(D,X,Q,emptyObject);if(W!==null){const{index:Y,level:J,order:te}=W;let Z=new LevelIterator(U.db.iterator(J),ee=>quadReader.read(ee,Y.prefix.length,Y.terms,G,Q));if(typeof F.order<"u"&&!arrStartsWith(F.order,te)){const ee=ne=>(ne[SORTING_KEY]=twoStepsQuadWriter.ingest(ne,Q).write("",F.order)+separator,ne),re=F.reverse===!0?compareSortableQuadsReverse:compareSortableQuads;if(Z=new SortingIterator(Z,re,ee,emitSortableQuad),typeof F.limit<"u"){const ne=function(){this.removeListener("end",ne),this.removeListener("error",ne),this.destroy()};Z=Z.take(F.limit).on("end",ne).on("error",ne)}}return{type:ResultType.QUADS,order:F.order||te,iterator:Z,index:Y.terms,resorted:!0}}throw new Error(`No index compatible with pattern ${JSON.stringify(D)} and options ${JSON.stringify(F)}`)},getApproximateSize=async(U,D,F)=>{if(!U.db.approximateSize)return{type:ResultType.APPROXIMATE_SIZE,approximateSize:1/0};const{indexes:G,prefixes:Q}=U,X=getLevelQuery(D,G,Q,F);if(X===null)throw new Error(`No index compatible with pattern ${JSON.stringify(D)} and options ${JSON.stringify(F)}`);const{level:q}=X,W=q.gte||q.gt,Y=q.lte||q.lt;return new Promise((J,te)=>{U.db.approximateSize(W,Y,(Z,ee)=>{if(Z){te(Z);return}J({type:ResultType.APPROXIMATE_SIZE,approximateSize:Math.max(1,ee)})})})};class Scope{id;blankNodes;factory;static async init(D){return new Scope(D.dataFactory,uid(),new Map)}static async load(D,F){const G=Scope.getLevelIteratorOpts(!1,!0,F),Q=new LevelIterator(D.db.iterator(G),(W,Y)=>Y),X=new Map,{dataFactory:q}=D;return await consumeOneByOne(Q,W=>{const{originalLabel:Y,randomLabel:J}=JSON.parse(W);X.set(Y,q.blankNode(J))}),new Scope(q,F,X)}static async delete(D,F){const G=D.db.batch(),Q=Scope.getLevelIteratorOpts(!0,!1,F),X=new LevelIterator(D.db.iterator(Q),(q,W)=>q);await consumeOneByOne(X,q=>{G.del(q)}),await G.write()}static getLevelIteratorOpts(D,F,G){const Q=G?`SCOPE${separator}${G}${separator}`:`SCOPE${separator}`;return{keys:D,values:F,keyEncoding:"utf8",valueEncoding:"utf8",gte:Q,lte:`${Q}${boundary}`}}static addMappingToLevelBatch(D,F,G,Q){F.put(`SCOPE${separator}${D}${separator}${G}`,JSON.stringify({originalLabel:G,randomLabel:Q}))}constructor(D,F,G){this.blankNodes=G,this.factory=D,this.id=F}parseBlankNode(D,F){let G=this.blankNodes.get(D.value);return G||(G=this.factory.blankNode(uid()),this.blankNodes.set(D.value,G),Scope.addMappingToLevelBatch(this.id,F,D.value,G.value)),G}parseSubject(D,F){switch(D.termType){case"BlankNode":return this.parseBlankNode(D,F);default:return D}}parseObject(D,F){switch(D.termType){case"BlankNode":return this.parseBlankNode(D,F);default:return D}}parseGraph(D,F){switch(D.termType){case"BlankNode":return this.parseBlankNode(D,F);default:return D}}parseQuad(D,F){return this.factory.quad(this.parseSubject(D.subject,F),D.predicate,this.parseObject(D.object,F),this.parseGraph(D.graph,F))}}class Quadstore{db;indexes;id;prefixes;dataFactory;constructor(D){ensureAbstractLevel(D.backend,'"opts.backend"'),this.dataFactory=D.dataFactory,this.db=D.backend,this.indexes=[],this.id=uid(),(D.indexes||defaultIndexes).forEach(F=>this._addIndex(F)),this.prefixes=D.prefixes||{expandTerm:F=>F,compactIri:F=>F}}ensureReady(){if(this.db.status!=="open")throw new Error(`Store is not ready (status: "${this.db.status}"). Did you call store.open()?`)}async open(){this.db.status!=="open"&&await this.db.open()}async close(){this.db.status!=="closed"&&await this.db.close()}toString(){return this.toJSON()}toJSON(){return`[object ${this.constructor.name}::${this.id}]`}_addIndex(D){const F=D.map(G=>G.charAt(0).toUpperCase()).join("");this.indexes.push({terms:D,prefix:F+separator})}async clear(){if(typeof this.db.clear=="function")return new Promise((D,F)=>{this.db.clear(G=>{G?F(G):D()})});await this.delStream((await this.getStream({})).iterator,{batchSize:20})}match(D,F,G,Q,X=emptyObject){if(D&&D.termType==="Literal")return new EmptyIterator;const q={subject:D,predicate:F,object:G,graph:Q};return wrap(this.getStream(q,X).then(W=>W.iterator))}async countQuads(D,F,G,Q,X=emptyObject){if(D&&D.termType==="Literal")return 0;const q={subject:D,predicate:F,object:G,graph:Q};return(await this.getApproximateSize(q,X)).approximateSize}import(D){const F=new eventsExports.EventEmitter;return this.putStream(D,{}).then(()=>{F.emit("end")}).catch(G=>{F.emit("error",G)}),F}remove(D){const F=new eventsExports.EventEmitter;return this.delStream(D,{}).then(()=>F.emit("end")).catch(G=>F.emit("error",G)),F}removeMatches(D,F,G,Q,X=emptyObject){const q=this.match(D,F,G,Q,X);return this.remove(q)}deleteGraph(D){return this.removeMatches(void 0,void 0,void 0,D)}async getApproximateSize(D,F=emptyObject){return await this.ensureReady(),await getApproximateSize(this,D,F)}_batchPut(D,F){const{indexes:G,prefixes:Q}=this;twoStepsQuadWriter.ingest(D,Q);for(let X=0,q=G.length,W;X<q;X+=1){W=G[X];const Y=twoStepsQuadWriter.write(W.prefix,W.terms);F=F.put(Y,emptyValue,levelPutOpts)}return F}async put(D,F=emptyObject){this.ensureReady();const{indexes:G,db:Q}=this;let X=Q.batch();return F.scope&&(D=F.scope.parseQuad(D,X)),this._batchPut(D,X),await this.writeBatch(X,F),{type:ResultType.VOID}}async multiPut(D,F=emptyObject){this.ensureReady();const{indexes:G,db:Q}=this;let X=Q.batch();for(let q=0,W=D.length,Y;q<W;q+=1)Y=D[q],F.scope&&(Y=F.scope.parseQuad(Y,X)),this._batchPut(Y,X);return await this.writeBatch(X,F),{type:ResultType.VOID}}_batchDel(D,F){const{indexes:G,prefixes:Q}=this;twoStepsQuadWriter.ingest(D,Q);for(let X=0,q=G.length,W;X<q;X+=1){W=G[X];const Y=twoStepsQuadWriter.write(W.prefix,W.terms);F=F.del(Y,levelDelOpts)}return F}async del(D,F=emptyObject){this.ensureReady();const G=this.db.batch();return this._batchDel(D,G),await this.writeBatch(G,F),{type:ResultType.VOID}}async multiDel(D,F=emptyObject){this.ensureReady();const G=this.db.batch();for(let Q=0,X=D.length,q;Q<X;Q+=1)q=D[Q],this._batchDel(q,G);return await this.writeBatch(G,F),{type:ResultType.VOID}}async patch(D,F,G=emptyObject){this.ensureReady();const{indexes:Q,db:X}=this,q=X.batch();return this._batchDel(D,q),this._batchPut(F,q),await this.writeBatch(q,G),{type:ResultType.VOID}}async multiPatch(D,F,G=emptyObject){this.ensureReady();const{indexes:Q,db:X}=this;let q=X.batch();for(let W=0,Y=D.length,J;W<Y;W+=1)J=D[W],this._batchDel(J,q);for(let W=0,Y=F.length,J;W<Y;W+=1)J=F[W],this._batchPut(J,q);return await this.writeBatch(q,G),{type:ResultType.VOID}}async writeBatch(D,F){F.preWrite&&await F.preWrite(D),await D.write()}async get(D,F=emptyObject){this.ensureReady();const G=await this.getStream(D,F);return{items:await streamToArray(G.iterator),type:G.type,order:G.order,index:G.index,resorted:G.resorted}}async getStream(D,F=emptyObject){return this.ensureReady(),await getStream(this,D,F)}async putStream(D,F=emptyObject){this.ensureReady();const G=F.batchSize||1;return G===1?await consumeOneByOne(D,Q=>this.put(Q,F)):await consumeInBatches(D,G,Q=>this.multiPut(Q,F)),{type:ResultType.VOID}}async delStream(D,F=emptyObject){this.ensureReady();const G=F.batchSize||1;return G===1?await consumeOneByOne(D,Q=>this.del(Q)):await consumeInBatches(D,G,Q=>this.multiDel(Q)),{type:ResultType.VOID}}async initScope(){return await this.ensureReady(),await Scope.init(this)}async loadScope(D){return await this.ensureReady(),await Scope.load(this,D)}async deleteScope(D){await this.ensureReady(),await Scope.delete(this,D)}async deleteAllScopes(){await this.ensureReady(),await Scope.delete(this)}}var sparqlalgebrajs={},sparqlAlgebra={},es6=function U(D,F){if(D===F)return!0;if(D&&F&&typeof D=="object"&&typeof F=="object"){if(D.constructor!==F.constructor)return!1;var G,Q,X;if(Array.isArray(D)){if(G=D.length,G!=F.length)return!1;for(Q=G;Q--!==0;)if(!U(D[Q],F[Q]))return!1;return!0}if(D instanceof Map&&F instanceof Map){if(D.size!==F.size)return!1;for(Q of D.entries())if(!F.has(Q[0]))return!1;for(Q of D.entries())if(!U(Q[1],F.get(Q[0])))return!1;return!0}if(D instanceof Set&&F instanceof Set){if(D.size!==F.size)return!1;for(Q of D.entries())if(!F.has(Q[0]))return!1;return!0}if(ArrayBuffer.isView(D)&&ArrayBuffer.isView(F)){if(G=D.length,G!=F.length)return!1;for(Q=G;Q--!==0;)if(D[Q]!==F[Q])return!1;return!0}if(D.constructor===RegExp)return D.source===F.source&&D.flags===F.flags;if(D.valueOf!==Object.prototype.valueOf)return D.valueOf()===F.valueOf();if(D.toString!==Object.prototype.toString)return D.toString()===F.toString();if(X=Object.keys(D),G=X.length,G!==Object.keys(F).length)return!1;for(Q=G;Q--!==0;)if(!Object.prototype.hasOwnProperty.call(F,X[Q]))return!1;for(Q=G;Q--!==0;){var q=X[Q];if(!U(D[q],F[q]))return!1}return!0}return D!==D&&F!==F},rdfString={},TermUtil$1={};Object.defineProperty(TermUtil$1,"__esModule",{value:!0});TermUtil$1.stringQuadToQuad=TermUtil$1.quadToStringQuad=TermUtil$1.stringToTerm=TermUtil$1.getLiteralLanguage=TermUtil$1.getLiteralType=TermUtil$1.getLiteralValue=TermUtil$1.termToString=void 0;const rdf_data_factory_1$2=rdfDataFactory,FACTORY=new rdf_data_factory_1$2.DataFactory;function termToString(U){if(U)switch(U.termType){case"NamedNode":return U.value;case"BlankNode":return"_:"+U.value;case"Literal":const D=U;return'"'+D.value+'"'+(D.datatype&&D.datatype.value!=="http://www.w3.org/2001/XMLSchema#string"&&D.datatype.value!=="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"?"^^"+D.datatype.value:"")+(D.language?"@"+D.language:"");case"Quad":return`<<${termToString(U.subject)} ${termToString(U.predicate)} ${termToString(U.object)}${U.graph.termType==="DefaultGraph"?"":" "+termToString(U.graph)}>>`;case"Variable":return"?"+U.value;case"DefaultGraph":return U.value}}TermUtil$1.termToString=termToString;function getLiteralValue(U){const D=/^"([^]*)"/.exec(U);if(!D)throw new Error(U+" is not a literal");return D[1]}TermUtil$1.getLiteralValue=getLiteralValue;function getLiteralType(U){const D=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(U);if(!D)throw new Error(U+" is not a literal");return D[1]||(D[2]?"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":"http://www.w3.org/2001/XMLSchema#string")}TermUtil$1.getLiteralType=getLiteralType;function getLiteralLanguage(U){const D=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(U);if(!D)throw new Error(U+" is not a literal");return D[1]?D[1].toLowerCase():""}TermUtil$1.getLiteralLanguage=getLiteralLanguage;function stringToTerm(U,D){if(D=D||FACTORY,!U||!U.length)return D.defaultGraph();switch(U[0]){case"_":return D.blankNode(U.substr(2));case"?":if(!D.variable)throw new Error("Missing 'variable()' method on the given DataFactory");return D.variable(U.substr(1));case'"':const F=getLiteralLanguage(U),G=D.namedNode(getLiteralType(U));return D.literal(getLiteralValue(U),F||G);case"<":default:if(U.startsWith("<<")&&U.endsWith(">>")){const Q=U.slice(2,-2).trim();let X=[],q=0,W=0,Y=!1;for(let J=0;J<Q.length;J++){const te=Q[J];if(te==="<"&&q++,te===">"){if(q===0)throw new Error("Found closing tag without opening tag in "+U);q--}if(te==='"'){let Z=!1,ee=J;for(;ee-- >0&&Q[ee]==="\\";)Z=!Z;Z||(Y=!Y)}if(te===" "&&!Y&&q===0){for(X.push(Q.slice(W,J));Q[J+1]===" ";)J+=1;W=J+1}}if(q!==0)throw new Error("Found opening tag without closing tag in "+U);if(X.push(Q.slice(W,Q.length)),X.length!==3&&X.length!==4)throw new Error("Nested quad syntax error "+U);return X=X.map(J=>J.startsWith("<")&&!J.includes(" ")?J.slice(1,-1):J),D.quad(stringToTerm(X[0]),stringToTerm(X[1]),stringToTerm(X[2]),X[3]?stringToTerm(X[3]):void 0)}return D.namedNode(U)}}TermUtil$1.stringToTerm=stringToTerm;function quadToStringQuad(U){return{subject:termToString(U.subject),predicate:termToString(U.predicate),object:termToString(U.object),graph:termToString(U.graph)}}TermUtil$1.quadToStringQuad=quadToStringQuad;function stringQuadToQuad(U,D){return D=D||FACTORY,D.quad(stringToTerm(U.subject,D),stringToTerm(U.predicate,D),stringToTerm(U.object,D),stringToTerm(U.graph,D))}TermUtil$1.stringQuadToQuad=stringQuadToQuad;(function(U){Object.defineProperty(U,"__esModule",{value:!0}),U.termToString=U.stringToTerm=U.stringQuadToQuad=U.quadToStringQuad=U.getLiteralValue=U.getLiteralType=U.getLiteralLanguage=void 0;const D=TermUtil$1;Object.defineProperty(U,"getLiteralLanguage",{enumerable:!0,get:function(){return D.getLiteralLanguage}}),Object.defineProperty(U,"getLiteralType",{enumerable:!0,get:function(){return D.getLiteralType}}),Object.defineProperty(U,"getLiteralValue",{enumerable:!0,get:function(){return D.getLiteralValue}}),Object.defineProperty(U,"quadToStringQuad",{enumerable:!0,get:function(){return D.quadToStringQuad}}),Object.defineProperty(U,"stringQuadToQuad",{enumerable:!0,get:function(){return D.stringQuadToQuad}}),Object.defineProperty(U,"stringToTerm",{enumerable:!0,get:function(){return D.stringToTerm}}),Object.defineProperty(U,"termToString",{enumerable:!0,get:function(){return D.termToString}})})(rdfString);var algebra={};(function(U){Object.defineProperty(U,"__esModule",{value:!0}),U.expressionTypes=U.types=void 0,function(D){D.ALT="alt",D.ASK="ask",D.BGP="bgp",D.CONSTRUCT="construct",D.DESCRIBE="describe",D.DISTINCT="distinct",D.EXPRESSION="expression",D.EXTEND="extend",D.FILTER="filter",D.FROM="from",D.GRAPH="graph",D.GROUP="group",D.INV="inv",D.JOIN="join",D.LEFT_JOIN="leftjoin",D.LINK="link",D.MINUS="minus",D.NOP="nop",D.NPS="nps",D.ONE_OR_MORE_PATH="OneOrMorePath",D.ORDER_BY="orderby",D.PATH="path",D.PATTERN="pattern",D.PROJECT="project",D.REDUCED="reduced",D.SEQ="seq",D.SERVICE="service",D.SLICE="slice",D.UNION="union",D.VALUES="values",D.ZERO_OR_MORE_PATH="ZeroOrMorePath",D.ZERO_OR_ONE_PATH="ZeroOrOnePath",D.COMPOSITE_UPDATE="compositeupdate",D.DELETE_INSERT="deleteinsert",D.LOAD="load",D.CLEAR="clear",D.CREATE="create",D.DROP="drop",D.ADD="add",D.MOVE="move",D.COPY="copy"}(U.types||(U.types={})),function(D){D.AGGREGATE="aggregate",D.EXISTENCE="existence",D.NAMED="named",D.OPERATOR="operator",D.TERM="term",D.WILDCARD="wildcard"}(U.expressionTypes||(U.expressionTypes={}))})(algebra);var factory$2={},Wildcard$2={};let Wildcard$1=class{constructor(){return WILDCARD||this}equals(D){return D&&this.termType===D.termType}};Object.defineProperty(Wildcard$1.prototype,"value",{enumerable:!0,value:"*"});Object.defineProperty(Wildcard$1.prototype,"termType",{enumerable:!0,value:"Wildcard"});var WILDCARD=new Wildcard$1;Wildcard$2.Wildcard=Wildcard$1;var SparqlParser=function(){var U=function(bt,vt,Et,Ot){for(Et=Et||{},Ot=bt.length;Ot--;Et[bt[Ot]]=vt);return Et},D=[6,12,13,15,16,28,35,41,50,55,107,117,120,122,123,132,133,138,195,219,224,312,322,323,324,325,326],F=[2,211],G=[107,117,120,122,123,132,133,138,322,323,324,325,326],Q=[2,389],X=[1,22],q=[1,31],W=[13,16,35,195,219,224,312],Y=[6,90],J=[45,46,58],te=[45,58],Z=[1,62],ee=[1,64],re=[1,60],ne=[1,63],le=[1,69],se=[1,70],ie=[26,34,35],ge=[13,16,35,195,219,312],fe=[13,16,312],ae=[119,141,320,327],ue=[13,16,119,141,312],pe=[1,96],_e=[1,100],xe=[1,102],be=[119,141,320,321,327],Te=[13,16,119,141,312,321],ye=[1,108],Ee=[2,253],he=[1,107],oe=[13,16,34,35,87,93,226,231,245,246,299,300,301,302,303,304,305,306,307,308,309,310,311,312],me=[6,45,46,58,68,75,78,86,88,90],ve=[6,13,16,34,45,46,58,68,75,78,86,88,90,312],we=[6,13,16,26,34,35,37,38,45,46,48,58,68,75,78,86,87,88,90,93,100,116,119,132,133,135,140,167,168,170,173,174,191,195,219,224,226,227,231,235,245,246,250,254,258,271,273,278,295,299,300,301,302,303,304,305,306,307,308,309,310,311,312,328,330,331,333,334,335,336,337,338,339],Pe=[34,35,45,46,58],Me=[1,139],De=[1,140],Oe=[1,151],Ie=[1,131],Be=[1,125],ze=[1,130],et=[1,132],qe=[1,142],je=[1,143],it=[1,144],ct=[1,145],rt=[1,147],ut=[1,148],We=[2,461],Re=[1,157],Ue=[1,158],Le=[1,159],Ge=[1,152],ke=[1,153],He=[1,156],Ke=[1,166],$e=[1,167],Qe=[1,168],Ne=[1,169],Ce=[1,170],Ze=[1,171],at=[1,172],st=[1,173],Se=[1,174],ce=[1,175],de=[1,165],Ae=[1,160],Fe=[1,161],Ve=[1,162],Je=[1,163],dt=[1,164],St=[6,13,16,34,35,46,48,87,90,93,119,167,168,170,173,174,226,231,245,246,299,300,301,302,303,304,305,306,307,308,309,310,311,312,328],Tt=[2,312],At=[1,199],wt=[1,197],ot=[6,191],pt=[2,329],xt=[2,317],Mt=[45,135],tt=[6,48,78,86,88,90],ht=[2,257],Pt=[1,213],Ct=[1,215],kt=[6,48,75,78,86,88,90],Qt=[2,255],tn=[1,221],Xt=[1,233],yn=[1,231],Zt=[1,239],bn=[1,232],Jt=[1,237],nn=[1,238],nt=[6,68,75,78,86,88,90],mt=[37,38,191,250,278],yt=[37,38,191,250,254,278],ft=[37,38,191,250,254,258,271,273,278,295,306,307,308,309,310,311,334,335,336,337,338,339],_t=[26,37,38,191,250,254,258,271,273,278,295,306,307,308,309,310,311,331,334,335,336,337,338,339],Rt=[1,267],Nt=[1,266],It=[6,13,16,26,34,35,37,38,46,48,75,78,81,83,86,87,88,90,93,119,167,168,170,173,174,191,226,231,245,246,250,254,258,271,273,275,276,277,278,279,281,282,284,285,288,290,295,299,300,301,302,303,304,305,306,307,308,309,310,311,312,328,331,334,335,336,337,338,339,340,341,342,343,344],Bt=[1,275],Vt=[1,274],Lt=[13,16,26,34,35,37,38,46,48,87,90,93,100,119,167,168,170,173,174,191,195,219,224,226,227,231,235,245,246,250,254,258,271,273,278,295,299,300,301,302,303,304,305,306,307,308,309,310,311,312,328,331,334,335,336,337,338,339],jt=[35,93],Ht=[13,16,26,34,35,37,38,46,48,87,90,93,100,119,167,168,170,173,174,191,195,219,224,226,227,231,235,245,246,250,254,258,271,273,278,295,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,328,331,334,335,336,337,338,339],cn=[13,16,48,87,100,231,299,300,301,302,303,304,305,306,307,308,309,310,311,312],pn=[48,93],Sn=[34,38],qt=[6,13,16,34,35,38,87,93,226,231,245,246,299,300,301,302,303,304,305,306,307,308,309,310,311,312,330,331],Ut=[6,13,16,26,34,35,38,87,93,226,231,245,246,271,299,300,301,302,303,304,305,306,307,308,309,310,311,312,330,331,333],Wn=[1,299],rn=[1,300],Tn=[6,116,191],En=[48,119],On=[6,48,86,88,90],Qn=[2,341],Kt=[2,333],dn=[1,340],vn=[1,342],sn=[48,119,328],mn=[13,16,34,195,312],Mn=[13,16,34,35,38,46,48,87,90,93,119,167,168,170,173,174,191,195,219,224,226,227,231,235,245,246,278,299,300,301,302,303,304,305,306,307,308,309,310,311,312,328],en=[13,16,34,35,87,219,271,273,275,276,277,279,281,282,284,285,288,290,299,300,301,302,303,304,305,306,307,308,309,310,311,312,339,340,341,342,343,344],br=[1,374],Sr=[1,375],Ur=[13,16,26,34,35,87,219,271,273,275,276,277,279,281,282,284,285,288,290,299,300,301,302,303,304,305,306,307,308,309,310,311,312,339,340,341,342,343,344],Tr=[1,398],Bn=[1,399],Br=[13,16,38,195,224,312],jr=[1,416],Ln=[6,48,90],Gr=[6,13,16,35,48,78,86,88,90,275,276,277,279,281,282,284,285,288,290,312,339,340,341,342,343,344],Er=[6,13,16,34,35,46,48,78,81,83,86,87,88,90,93,119,167,168,170,173,174,226,231,245,246,275,276,277,279,281,282,284,285,288,290,299,300,301,302,303,304,305,306,307,308,309,310,311,312,328,339,340,341,342,343,344],jn=[46,48,90,119,167,168,170,173,174],er=[1,435],tr=[1,436],kr=[1,442],Vr=[1,441],Gn=[48,119,191,227,328],or=[13,16,34,35,38,87,93,226,231,245,246,299,300,301,302,303,304,305,306,307,308,309,310,311,312],sr=[13,16,34,35,38,48,87,93,119,191,226,227,231,245,246,278,299,300,301,302,303,304,305,306,307,308,309,310,311,312,328],cr=[13,16,38,48,87,100,231,299,300,301,302,303,304,305,306,307,308,309,310,311,312],xr=[35,48],$r=[2,332],zr=[1,497],Hr=[1,494],Wr=[1,495],Qr=[6,13,16,26,34,35,37,38,46,48,68,75,78,81,83,86,87,88,90,93,119,167,168,170,173,174,191,226,231,245,246,250,254,258,271,273,275,276,277,278,279,281,282,284,285,288,290,295,299,300,301,302,303,304,305,306,307,308,309,310,311,312,328,329,331,334,335,336,337,338,339,340,341,342,343,344],wr=[1,515],ur=[46,48,90,119,167,168,170,173,174,328],Xr=[13,16,34,35,195,219,224,312],kn=[6,13,16,34,35,48,75,78,86,88,90,275,276,277,279,281,282,284,285,288,290,312,339,340,341,342,343,344],qr=[13,16,34,35,38,48,87,93,119,191,195,226,227,231,245,246,278,299,300,301,302,303,304,305,306,307,308,309,310,311,312,328],Xn=[6,13,16,34,35,48,81,83,86,88,90,275,276,277,279,281,282,284,285,288,290,312,339,340,341,342,343,344],Kr=[13,16,34,35,46,48,87,90,93,119,167,168,170,173,174,226,231,245,246,299,300,301,302,303,304,305,306,307,308,309,310,311,312],Yr=[13,16,34,312],Pn=[13,16,34,35,46,48,87,90,93,119,167,168,170,173,174,226,231,245,246,299,300,301,302,303,304,305,306,307,308,309,310,311,312,328],In=[2,344],lr=[13,16,34,35,38,46,48,87,90,93,119,167,168,170,173,174,191,226,227,231,245,246,278,299,300,301,302,303,304,305,306,307,308,309,310,311,312,328],Jr=[13,16,34,35,37,38,46,48,87,90,93,119,167,168,170,173,174,191,195,219,224,226,227,231,235,245,246,278,299,300,301,302,303,304,305,306,307,308,309,310,311,312,328],Rn=[2,339],Zr=[13,16,34,35,38,46,48,87,90,93,119,167,168,170,173,174,191,195,219,224,226,227,231,245,246,278,299,300,301,302,303,304,305,306,307,308,309,310,311,312,328],ei=[13,16,38,87,100,231,299,300,301,302,303,304,305,306,307,308,309,310,311,312],nr=[46,48,90,119,167,168,170,173,174,191,227,328],ti=[13,16,34,38,48,87,100,195,231,235,299,300,301,302,303,304,305,306,307,308,309,310,311,312],ni=[13,16,34,35,48,87,93,119,226,231,245,246,299,300,301,302,303,304,305,306,307,308,309,310,311,312],ri=[2,327],Ar={trace:function(){},yy:{},symbols_:{error:2,QueryOrUpdate:3,Prologue:4,QueryOrUpdate_group0:5,EOF:6,Prologue_repetition0:7,Query:8,Query_group0:9,Query_option0:10,BaseDecl:11,BASE:12,IRIREF:13,PrefixDecl:14,PREFIX:15,PNAME_NS:16,SelectQuery:17,SelectClauseWildcard:18,SelectQuery_repetition0:19,WhereClause:20,SolutionModifierNoGroup:21,SelectClauseVars:22,SelectQuery_repetition1:23,SolutionModifier:24,SelectClauseBase:25,"*":26,SelectClauseVars_repetition_plus0:27,SELECT:28,SelectClauseBase_option0:29,SubSelect:30,SubSelect_option0:31,SubSelect_option1:32,SelectClauseItem:33,VAR:34,"(":35,Expression:36,AS:37,")":38,VarTriple:39,ConstructQuery:40,CONSTRUCT:41,ConstructTemplate:42,ConstructQuery_repetition0:43,ConstructQuery_repetition1:44,WHERE:45,"{":46,ConstructQuery_option0:47,"}":48,DescribeQuery:49,DESCRIBE:50,DescribeQuery_group0:51,DescribeQuery_repetition0:52,DescribeQuery_option0:53,AskQuery:54,ASK:55,AskQuery_repetition0:56,DatasetClause:57,FROM:58,DatasetClause_option0:59,iri:60,WhereClause_option0:61,GroupGraphPattern:62,SolutionModifier_option0:63,SolutionModifierNoGroup_option0:64,SolutionModifierNoGroup_option1:65,SolutionModifierNoGroup_option2:66,GroupClause:67,GROUP:68,BY:69,GroupClause_repetition_plus0:70,GroupCondition:71,BuiltInCall:72,FunctionCall:73,HavingClause:74,HAVING:75,HavingClause_repetition_plus0:76,OrderClause:77,ORDER:78,OrderClause_repetition_plus0:79,OrderCondition:80,ASC:81,BrackettedExpression:82,DESC:83,Constraint:84,LimitOffsetClauses:85,LIMIT:86,INTEGER:87,OFFSET:88,ValuesClause:89,VALUES:90,InlineData:91,InlineData_repetition0:92,NIL:93,InlineData_repetition1:94,InlineData_repetition_plus2:95,InlineData_repetition3:96,DataBlockValue:97,Literal:98,ConstTriple:99,UNDEF:100,DataBlockValueList:101,DataBlockValueList_repetition_plus0:102,Update:103,Update_repetition0:104,Update1:105,Update_option0:106,LOAD:107,Update1_option0:108,Update1_option1:109,Update1_group0:110,Update1_option2:111,GraphRefAll:112,Update1_group1:113,Update1_option3:114,GraphOrDefault:115,TO:116,CREATE:117,Update1_option4:118,GRAPH:119,INSERTDATA:120,QuadPattern:121,DELETEDATA:122,DELETEWHERE:123,Update1_option5:124,InsertClause:125,Update1_option6:126,Update1_repetition0:127,Update1_option7:128,DeleteClause:129,Update1_option8:130,Update1_repetition1:131,DELETE:132,INSERT:133,UsingClause:134,USING:135,UsingClause_option0:136,WithClause:137,WITH:138,IntoGraphClause:139,INTO:140,DEFAULT:141,GraphOrDefault_option0:142,GraphRefAll_group0:143,QuadPattern_option0:144,QuadPattern_repetition0:145,QuadsNotTriples:146,QuadsNotTriples_group0:147,QuadsNotTriples_option0:148,QuadsNotTriples_option1:149,QuadsNotTriples_option2:150,TriplesTemplate:151,TriplesTemplate_repetition0:152,TriplesSameSubject:153,TriplesTemplate_option0:154,GroupGraphPatternSub:155,GroupGraphPatternSub_option0:156,GroupGraphPatternSub_repetition0:157,GroupGraphPatternSubTail:158,GraphPatternNotTriples:159,GroupGraphPatternSubTail_option0:160,GroupGraphPatternSubTail_option1:161,TriplesBlock:162,TriplesBlock_repetition0:163,TriplesSameSubjectPath:164,TriplesBlock_option0:165,GraphPatternNotTriples_repetition0:166,OPTIONAL:167,MINUS:168,GraphPatternNotTriples_group0:169,SERVICE:170,GraphPatternNotTriples_option0:171,GraphPatternNotTriples_group1:172,FILTER:173,BIND:174,FunctionCall_option0:175,FunctionCall_repetition0:176,ExpressionList:177,ExpressionList_repetition0:178,ConstructTemplate_option0:179,ConstructTriples:180,ConstructTriples_repetition0:181,ConstructTriples_option0:182,TriplesSameSubject_group0:183,PropertyListNotEmpty:184,TriplesNode:185,PropertyList:186,PropertyList_option0:187,VerbObjectList:188,PropertyListNotEmpty_repetition0:189,SemiOptionalVerbObjectList:190,";":191,SemiOptionalVerbObjectList_option0:192,Verb:193,ObjectList:194,a:195,ObjectList_repetition0:196,GraphNode:197,ObjectListPath:198,ObjectListPath_repetition0:199,GraphNodePath:200,TriplesSameSubjectPath_group0:201,PropertyListPathNotEmpty:202,TriplesNodePath:203,TriplesSameSubjectPath_option0:204,PropertyListPathNotEmpty_group0:205,PropertyListPathNotEmpty_repetition0:206,PropertyListPathNotEmpty_repetition1:207,PropertyListPathNotEmptyTail:208,PropertyListPathNotEmptyTail_group0:209,Path:210,Path_repetition0:211,PathSequence:212,PathSequence_repetition0:213,PathEltOrInverse:214,PathElt:215,PathPrimary:216,PathElt_option0:217,PathEltOrInverse_option0:218,"!":219,PathNegatedPropertySet:220,PathOneInPropertySet:221,PathNegatedPropertySet_repetition0:222,PathNegatedPropertySet_option0:223,"^":224,TriplesNode_repetition_plus0:225,"[":226,"]":227,TriplesNodePath_repetition_plus0:228,GraphNode_group0:229,GraphNodePath_group0:230,"<<":231,VarTriple_group0:232,VarTriple_group1:233,VarTriple_group2:234,">>":235,VarTriple_group3:236,VarTriple_group4:237,ConstTriple_group0:238,ConstTriple_group1:239,ConstTriple_group2:240,ConstTriple_group3:241,ConstTriple_group4:242,VarOrTerm:243,Term:244,BLANK_NODE_LABEL:245,ANON:246,ConditionalAndExpression:247,Expression_repetition0:248,ExpressionTail:249,"||":250,RelationalExpression:251,ConditionalAndExpression_repetition0:252,ConditionalAndExpressionTail:253,"&&":254,AdditiveExpression:255,RelationalExpression_group0:256,RelationalExpression_option0:257,IN:258,MultiplicativeExpression:259,AdditiveExpression_repetition0:260,AdditiveExpressionTail:261,AdditiveExpressionTail_group0:262,NumericLiteralPositive:263,AdditiveExpressionTail_repetition0:264,NumericLiteralNegative:265,AdditiveExpressionTail_repetition1:266,UnaryExpression:267,MultiplicativeExpression_repetition0:268,MultiplicativeExpressionTail:269,MultiplicativeExpressionTail_group0:270,"+":271,PrimaryExpression:272,"-":273,Aggregate:274,FUNC_ARITY0:275,FUNC_ARITY1:276,FUNC_ARITY2:277,",":278,IF:279,BuiltInCall_group0:280,BOUND:281,BNODE:282,BuiltInCall_option0:283,EXISTS:284,COUNT:285,Aggregate_option0:286,Aggregate_group0:287,FUNC_AGGREGATE:288,Aggregate_option1:289,GROUP_CONCAT:290,Aggregate_option2:291,Aggregate_option3:292,GroupConcatSeparator:293,SEPARATOR:294,"=":295,String:296,LANGTAG:297,"^^":298,DECIMAL:299,DOUBLE:300,BOOLEAN:301,STRING_LITERAL1:302,STRING_LITERAL2:303,STRING_LITERAL_LONG1:304,STRING_LITERAL_LONG2:305,INTEGER_POSITIVE:306,DECIMAL_POSITIVE:307,DOUBLE_POSITIVE:308,INTEGER_NEGATIVE:309,DECIMAL_NEGATIVE:310,DOUBLE_NEGATIVE:311,PNAME_LN:312,QueryOrUpdate_group0_option0:313,Prologue_repetition0_group0:314,SelectClauseBase_option0_group0:315,DISTINCT:316,REDUCED:317,DescribeQuery_group0_repetition_plus0_group0:318,DescribeQuery_group0_repetition_plus0:319,NAMED:320,SILENT:321,CLEAR:322,DROP:323,ADD:324,MOVE:325,COPY:326,ALL:327,".":328,UNION:329,"|":330,"/":331,PathElt_option0_group0:332,"?":333,"!=":334,"<":335,">":336,"<=":337,">=":338,NOT:339,CONCAT:340,COALESCE:341,SUBSTR:342,REGEX:343,REPLACE:344,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",12:"BASE",13:"IRIREF",15:"PREFIX",16:"PNAME_NS",26:"*",28:"SELECT",34:"VAR",35:"(",37:"AS",38:")",41:"CONSTRUCT",45:"WHERE",46:"{",48:"}",50:"DESCRIBE",55:"ASK",58:"FROM",68:"GROUP",69:"BY",75:"HAVING",78:"ORDER",81:"ASC",83:"DESC",86:"LIMIT",87:"INTEGER",88:"OFFSET",90:"VALUES",93:"NIL",100:"UNDEF",107:"LOAD",116:"TO",117:"CREATE",119:"GRAPH",120:"INSERTDATA",122:"DELETEDATA",123:"DELETEWHERE",132:"DELETE",133:"INSERT",135:"USING",138:"WITH",140:"INTO",141:"DEFAULT",167:"OPTIONAL",168:"MINUS",170:"SERVICE",173:"FILTER",174:"BIND",191:";",195:"a",219:"!",224:"^",226:"[",227:"]",231:"<<",235:">>",245:"BLANK_NODE_LABEL",246:"ANON",250:"||",254:"&&",258:"IN",271:"+",273:"-",275:"FUNC_ARITY0",276:"FUNC_ARITY1",277:"FUNC_ARITY2",278:",",279:"IF",281:"BOUND",282:"BNODE",284:"EXISTS",285:"COUNT",288:"FUNC_AGGREGATE",290:"GROUP_CONCAT",294:"SEPARATOR",295:"=",297:"LANGTAG",298:"^^",299:"DECIMAL",300:"DOUBLE",301:"BOOLEAN",302:"STRING_LITERAL1",303:"STRING_LITERAL2",304:"STRING_LITERAL_LONG1",305:"STRING_LITERAL_LONG2",306:"INTEGER_POSITIVE",307:"DECIMAL_POSITIVE",308:"DOUBLE_POSITIVE",309:"INTEGER_NEGATIVE",310:"DECIMAL_NEGATIVE",311:"DOUBLE_NEGATIVE",312:"PNAME_LN",316:"DISTINCT",317:"REDUCED",320:"NAMED",321:"SILENT",322:"CLEAR",323:"DROP",324:"ADD",325:"MOVE",326:"COPY",327:"ALL",328:".",329:"UNION",330:"|",331:"/",333:"?",334:"!=",335:"<",336:">",337:"<=",338:">=",339:"NOT",340:"CONCAT",341:"COALESCE",342:"SUBSTR",343:"REGEX",344:"REPLACE"},productions_:[0,[3,3],[4,1],[8,2],[11,2],[14,3],[17,4],[17,4],[18,2],[22,2],[25,2],[30,4],[30,4],[33,1],[33,5],[33,5],[40,5],[40,7],[49,5],[54,4],[57,3],[20,2],[24,2],[21,3],[67,3],[71,1],[71,1],[71,3],[71,5],[71,1],[74,2],[77,3],[80,2],[80,2],[80,1],[80,1],[85,2],[85,2],[85,4],[85,4],[89,2],[91,4],[91,4],[91,6],[97,1],[97,1],[97,1],[97,1],[101,3],[103,3],[105,4],[105,3],[105,5],[105,4],[105,2],[105,2],[105,2],[105,6],[105,6],[129,2],[125,2],[134,3],[137,2],[139,3],[115,1],[115,2],[112,2],[112,1],[121,4],[146,7],[151,3],[62,3],[62,3],[155,2],[158,3],[162,3],[159,2],[159,2],[159,2],[159,3],[159,4],[159,2],[159,6],[159,6],[159,1],[84,1],[84,1],[84,1],[73,2],[73,6],[177,1],[177,4],[42,3],[180,3],[153,2],[153,2],[186,1],[184,2],[190,2],[188,2],[193,1],[193,1],[193,1],[194,2],[198,2],[164,2],[164,2],[202,4],[208,1],[208,3],[210,2],[212,2],[215,2],[214,2],[216,1],[216,1],[216,2],[216,3],[220,1],[220,1],[220,4],[221,1],[221,1],[221,2],[221,2],[185,3],[185,3],[203,3],[203,3],[197,1],[197,1],[200,1],[200,1],[39,9],[39,5],[99,9],[99,5],[243,1],[243,1],[244,1],[244,1],[244,1],[244,1],[244,1],[36,2],[249,2],[247,2],[253,2],[251,1],[251,3],[251,4],[255,2],[261,2],[261,2],[261,2],[259,2],[269,2],[267,2],[267,2],[267,2],[267,1],[272,1],[272,1],[272,1],[272,1],[272,1],[272,1],[82,3],[72,1],[72,2],[72,4],[72,6],[72,8],[72,2],[72,4],[72,2],[72,4],[72,3],[274,5],[274,5],[274,6],[293,4],[98,1],[98,2],[98,3],[98,1],[98,1],[98,1],[98,1],[98,1],[98,1],[296,1],[296,1],[296,1],[296,1],[263,1],[263,1],[263,1],[265,1],[265,1],[265,1],[60,1],[60,1],[60,1],[313,0],[313,1],[5,1],[5,1],[5,1],[314,1],[314,1],[7,0],[7,2],[9,1],[9,1],[9,1],[9,1],[10,0],[10,1],[19,0],[19,2],[23,0],[23,2],[27,1],[27,2],[315,1],[315,1],[29,0],[29,1],[31,0],[31,1],[32,0],[32,1],[43,0],[43,2],[44,0],[44,2],[47,0],[47,1],[318,1],[318,1],[319,1],[319,2],[51,1],[51,1],[52,0],[52,2],[53,0],[53,1],[56,0],[56,2],[59,0],[59,1],[61,0],[61,1],[63,0],[63,1],[64,0],[64,1],[65,0],[65,1],[66,0],[66,1],[70,1],[70,2],[76,1],[76,2],[79,1],[79,2],[92,0],[92,2],[94,0],[94,2],[95,1],[95,2],[96,0],[96,2],[102,1],[102,2],[104,0],[104,4],[106,0],[106,2],[108,0],[108,1],[109,0],[109,1],[110,1],[110,1],[111,0],[111,1],[113,1],[113,1],[113,1],[114,0],[114,1],[118,0],[118,1],[124,0],[124,1],[126,0],[126,1],[127,0],[127,2],[128,0],[128,1],[130,0],[130,1],[131,0],[131,2],[136,0],[136,1],[142,0],[142,1],[143,1],[143,1],[143,1],[144,0],[144,1],[145,0],[145,2],[147,1],[147,1],[148,0],[148,1],[149,0],[149,1],[150,0],[150,1],[152,0],[152,3],[154,0],[154,1],[156,0],[156,1],[157,0],[157,2],[160,0],[160,1],[161,0],[161,1],[163,0],[163,3],[165,0],[165,1],[166,0],[166,3],[169,1],[169,1],[171,0],[171,1],[172,1],[172,1],[175,0],[175,1],[176,0],[176,3],[178,0],[178,3],[179,0],[179,1],[181,0],[181,3],[182,0],[182,1],[183,1],[183,1],[187,0],[187,1],[189,0],[189,2],[192,0],[192,1],[196,0],[196,3],[199,0],[199,3],[201,1],[201,1],[204,0],[204,1],[205,1],[205,1],[206,0],[206,3],[207,0],[207,2],[209,1],[209,1],[211,0],[211,3],[213,0],[213,3],[332,1],[332,1],[332,1],[217,0],[217,1],[218,0],[218,1],[222,0],[222,3],[223,0],[223,1],[225,1],[225,2],[228,1],[228,2],[229,1],[229,1],[230,1],[230,1],[232,1],[232,1],[233,1],[233,1],[234,1],[234,1],[236,1],[236,1],[237,1],[237,1],[238,1],[238,1],[239,1],[239,1],[240,1],[240,1],[241,1],[241,1],[242,1],[242,1],[248,0],[248,2],[252,0],[252,2],[256,1],[256,1],[256,1],[256,1],[256,1],[256,1],[257,0],[257,1],[260,0],[260,2],[262,1],[262,1],[264,0],[264,2],[266,0],[266,2],[268,0],[268,2],[270,1],[270,1],[280,1],[280,1],[280,1],[280,1],[280,1],[283,0],[283,1],[286,0],[286,1],[287,1],[287,1],[289,0],[289,1],[291,0],[291,1],[292,0],[292,1]],performAction:function(vt,Et,Ot,Dt,Ft,Xe,_n){var Ye=Xe.length-1;switch(Ft){case 1:if(Xe[Ye-1]=Xe[Ye-1]||{},$t.base&&(Xe[Ye-1].base=$t.base),$t.base="",Xe[Ye-1].prefixes=$t.prefixes,$t.prefixes=null,$t.pathOnly){if(Xe[Ye-1].type==="path"||"termType"in Xe[Ye-1])return Xe[Ye-1];throw new Error("Received full SPARQL query in path only mode")}else if(Xe[Ye-1].type==="path"||"termType"in Xe[Ye-1])throw new Error("Received only path in full SPARQL mode");if(Xe[Ye-1].type==="update"){const zt={};for(const Wt of Xe[Ye-1].updates)if(Wt.updateType==="insert"){const Gt={};for(const un of Wt.insert)if(un.type==="bgp"||un.type==="graph")for(const ln of un.triples)ln.subject.termType==="BlankNode"&&(Gt[ln.subject.value]=!0),ln.predicate.termType==="BlankNode"&&(Gt[ln.predicate.value]=!0),ln.object.termType==="BlankNode"&&(Gt[ln.object.value]=!0);for(const un of Object.keys(Gt)){if(zt[un])throw new Error("Detected reuse blank node across different INSERT DATA clauses");zt[un]=!0}}}return Xe[Ye-1];case 3:this.$=Yt(Xe[Ye-1],Xe[Ye],{type:"query"});break;case 4:$t.base=rr(Xe[Ye]);break;case 5:$t.prefixes||($t.prefixes={}),Xe[Ye-1]=Xe[Ye-1].substr(0,Xe[Ye-1].length-1),Xe[Ye]=rr(Xe[Ye]),$t.prefixes[Xe[Ye-1]]=Xe[Ye];break;case 6:this.$=Yt(Xe[Ye-3],Fn(Xe[Ye-2]),Xe[Ye-1],Xe[Ye]);break;case 7:if(!$t.skipValidation&&(Cr(Xe[Ye-3].variables.map(Wt=>Rr(Wt.expression))).some(Wt=>Wt.aggregation==="count"&&!(Wt.expression instanceof dr))||Xe[Ye].group)){for(const Wt of Xe[Ye-3].variables)if(Wt.termType==="Variable"){if(!Xe[Ye].group||!Xe[Ye].group.map(Gt=>Yn(Gt)).includes(Yn(Wt)))throw Error("Projection of ungrouped variable (?"+Yn(Wt)+")")}else if(Rr(Wt.expression).length===0){const Gt=Ai(Wt.expression);for(const un of Gt)if(!Xe[Ye].group||!Xe[Ye].group.map||!Xe[Ye].group.map(ln=>Yn(ln)).includes(Yn(un)))throw Error("Use of ungrouped variable in projection of operation (?"+Yn(un)+")")}}const Jn=Xe[Ye-1].where.filter(zt=>zt.type==="query");if(Jn.length>0){const zt=Xe[Ye-3].variables.filter(Gt=>Gt.variable&&Gt.variable.value).map(Gt=>Gt.variable.value),Wt=Cr(Jn.map(Gt=>Gt.variables)).map(Gt=>Gt.value||Gt.variable.value);for(const Gt of zt)if(Wt.indexOf(Gt)>=0)throw Error("Target id of 'AS' (?"+Gt+") already used in subquery")}this.$=Yt(Xe[Ye-3],Fn(Xe[Ye-2]),Xe[Ye-1],Xe[Ye]);break;case 8:this.$=Yt(Xe[Ye-1],{variables:[new dr]});break;case 9:const Dr=Xe[Ye].map(zt=>zt.value||zt.variable.value),_r=Oi(Dr);if(_r.length>0)throw Error("Two or more of the resulting columns have the same name (?"+_r[0]+")");this.$=Yt(Xe[Ye-1],{variables:Xe[Ye]});break;case 10:this.$=Yt({queryType:"SELECT"},Xe[Ye]&&(Xe[Ye-1]=gn(Xe[Ye]),Xe[Ye]={},Xe[Ye][Xe[Ye-1]]=!0,Xe[Ye]));break;case 11:case 12:this.$=Yt(Xe[Ye-3],Xe[Ye-2],Xe[Ye-1],Xe[Ye],{type:"query"});break;case 13:case 100:case 137:case 166:this.$=fn(Xe[Ye]);break;case 14:case 28:this.$=Dn(Xe[Ye-3],{variable:fn(Xe[Ye-1])});break;case 15:this.$=ar(Dn(Xe[Ye-3],{variable:fn(Xe[Ye-1])}));break;case 16:this.$=Yt({queryType:"CONSTRUCT",template:Xe[Ye-3]},Fn(Xe[Ye-2]),Xe[Ye-1],Xe[Ye]);break;case 17:this.$=Yt({queryType:"CONSTRUCT",template:Xe[Ye-2]=Xe[Ye-2]?Xe[Ye-2].triples:[]},Fn(Xe[Ye-5]),{where:[{type:"bgp",triples:qn([],Xe[Ye-2])}]},Xe[Ye]);break;case 18:this.$=Yt({queryType:"DESCRIBE",variables:Xe[Ye-3]==="*"?[new dr]:Xe[Ye-3].map(fn)},Fn(Xe[Ye-2]),Xe[Ye-1],Xe[Ye]);break;case 19:this.$=Yt({queryType:"ASK"},Fn(Xe[Ye-2]),Xe[Ye-1],Xe[Ye]);break;case 20:case 61:this.$={iri:Xe[Ye],named:!!Xe[Ye-1]};break;case 21:this.$={where:Xe[Ye].patterns};break;case 22:this.$=Yt(Xe[Ye-1],Xe[Ye]);break;case 23:this.$=Yt(Xe[Ye-2],Xe[Ye-1],Xe[Ye]);break;case 24:this.$={group:Xe[Ye]};break;case 25:case 26:case 32:case 34:this.$=Dn(Xe[Ye]);break;case 27:this.$=Dn(Xe[Ye-1]);break;case 29:case 35:this.$=Dn(fn(Xe[Ye]));break;case 30:this.$={having:Xe[Ye]};break;case 31:this.$={order:Xe[Ye]};break;case 33:this.$=Dn(Xe[Ye],{descending:!0});break;case 36:this.$={limit:Kn(Xe[Ye])};break;case 37:this.$={offset:Kn(Xe[Ye])};break;case 38:this.$={limit:Kn(Xe[Ye-2]),offset:Kn(Xe[Ye])};break;case 39:this.$={limit:Kn(Xe[Ye]),offset:Kn(Xe[Ye-2])};break;case 40:this.$={type:"values",values:Xe[Ye]};break;case 41:this.$=Xe[Ye-1].map(function(zt){var Wt={};return Wt[Xe[Ye-3]]=zt,Wt});break;case 42:this.$=Xe[Ye-1].map(function(){return{}});break;case 43:var Un=Xe[Ye-4].length;Xe[Ye-4]=Xe[Ye-4].map(fn),this.$=Xe[Ye-1].map(function(zt){if(zt.length!==Un)throw Error("Inconsistent VALUES length");for(var Wt={},Gt=0;Gt<Un;Gt++)Wt["?"+Xe[Ye-4][Gt].value]=zt[Gt];return Wt});break;case 46:this.$=ar(Xe[Ye]);break;case 47:this.$=void 0;break;case 48:case 92:case 117:case 167:this.$=Xe[Ye-1];break;case 49:this.$={type:"update",updates:Nn(Xe[Ye-2],Xe[Ye-1])};break;case 50:this.$=Yt({type:"load",silent:!!Xe[Ye-2],source:Xe[Ye-1]},Xe[Ye]&&{destination:Xe[Ye]});break;case 51:this.$={type:gn(Xe[Ye-2]),silent:!!Xe[Ye-1],graph:Xe[Ye]};break;case 52:this.$={type:gn(Xe[Ye-4]),silent:!!Xe[Ye-3],source:Xe[Ye-2],destination:Xe[Ye]};break;case 53:this.$={type:"create",silent:!!Xe[Ye-2],graph:{type:"graph",name:Xe[Ye]}};break;case 54:this.$={updateType:"insert",insert:pi(Xe[Ye])};break;case 55:this.$={updateType:"delete",delete:Nr(pi(Xe[Ye]))};break;case 56:this.$={updateType:"deletewhere",delete:Nr(Xe[Ye])};break;case 57:this.$=Yt({updateType:"insertdelete"},Xe[Ye-5],{insert:Xe[Ye-4]||[]},{delete:Xe[Ye-3]||[]},Fn(Xe[Ye-2],"using"),{where:Xe[Ye].patterns});break;case 58:this.$=Yt({updateType:"insertdelete"},Xe[Ye-5],{delete:Xe[Ye-4]||[]},{insert:Xe[Ye-3]||[]},Fn(Xe[Ye-2],"using"),{where:Xe[Ye].patterns});break;case 59:this.$=Nr(Xe[Ye]);break;case 60:case 63:case 160:case 181:this.$=Xe[Ye];break;case 62:this.$={graph:Xe[Ye]};break;case 64:this.$={type:"graph",default:!0};break;case 65:case 66:this.$={type:"graph",name:Xe[Ye]};break;case 67:this.$={},this.$[gn(Xe[Ye])]=!0;break;case 68:this.$=Xe[Ye-2]?xn(Xe[Ye-1],[Xe[Ye-2]]):xn(Xe[Ye-1]);break;case 69:var pr=Yt(Xe[Ye-3]||{triples:[]},{type:"graph",name:fn(Xe[Ye-5])});this.$=Xe[Ye]?[pr,Xe[Ye]]:[pr];break;case 70:case 75:this.$={type:"bgp",triples:xn(Xe[Ye-2],[Xe[Ye-1]])};break;case 71:this.$={type:"group",patterns:[Xe[Ye-1]]};break;case 72:for(const zt of Xe[Ye-1].filter(Wt=>Wt.type==="bind")){const Wt=Xe[Ye-1].indexOf(zt),Gt=new Set;for(const un of Xe[Ye-1].slice(0,Wt))(un.type==="group"||un.type==="bgp")&&hi(un).forEach(ln=>Gt.add(ln));if(Gt.has(zt.variable.value))throw Error("Variable used to bind is already bound (?"+zt.variable.value+")")}this.$={type:"group",patterns:Xe[Ye-1]};break;case 73:this.$=Xe[Ye-1]?xn([Xe[Ye-1]],Xe[Ye]):xn(Xe[Ye]);break;case 74:this.$=Xe[Ye]?[Xe[Ye-2],Xe[Ye]]:Xe[Ye-2];break;case 76:Xe[Ye-1].length?this.$={type:"union",patterns:xn(Xe[Ye-1].map(Mr),[Mr(Xe[Ye])])}:this.$=Xe[Ye];break;case 77:this.$=Yt(Xe[Ye],{type:"optional"});break;case 78:this.$=Yt(Xe[Ye],{type:"minus"});break;case 79:this.$=Yt(Xe[Ye],{type:"graph",name:fn(Xe[Ye-1])});break;case 80:this.$=Yt(Xe[Ye],{type:"service",name:fn(Xe[Ye-1]),silent:!!Xe[Ye-2]});break;case 81:this.$={type:"filter",expression:Xe[Ye]};break;case 82:this.$={type:"bind",variable:fn(Xe[Ye-1]),expression:Xe[Ye-3]};break;case 83:this.$=ar({type:"bind",variable:fn(Xe[Ye-1]),expression:Xe[Ye-3]});break;case 88:this.$={type:"functionCall",function:Xe[Ye-1],args:[]};break;case 89:this.$={type:"functionCall",function:Xe[Ye-5],args:Nn(Xe[Ye-2],Xe[Ye-1]),distinct:!!Xe[Ye-3]};break;case 90:case 108:case 119:case 211:case 219:case 221:case 233:case 235:case 245:case 249:case 269:case 271:case 275:case 279:case 302:case 308:case 319:case 329:case 335:case 341:case 345:case 355:case 357:case 361:case 369:case 373:case 375:case 383:case 385:case 389:case 391:case 400:case 432:case 434:case 444:case 448:case 450:case 452:this.$=[];break;case 91:this.$=Nn(Xe[Ye-2],Xe[Ye-1]);break;case 93:this.$=xn(Xe[Ye-2],[Xe[Ye-1]]);break;case 94:case 105:this.$=Xe[Ye].map(function(zt){return Yt(zn(Xe[Ye-1]),zt)});break;case 95:this.$=qn(Xe[Ye].map(function(zt){return Yt(zn(Xe[Ye-1].entity),zt)}),Xe[Ye-1].triples);break;case 97:this.$=xn([Xe[Ye-1]],Xe[Ye]);break;case 98:this.$=xn(Xe[Ye]);break;case 99:this.$=Ir(Xe[Ye-1],Xe[Ye]);break;case 102:case 115:case 122:this.$=$t.factory.namedNode(ii);break;case 103:case 104:this.$=Nn(Xe[Ye-1],Xe[Ye]);break;case 106:this.$=Xe[Ye]?qn(Xe[Ye].map(function(zt){return Yt(zn(Xe[Ye-1].entity),zt)}),Xe[Ye-1].triples):Xe[Ye-1].triples;break;case 107:this.$=Ir(fn(Xe[Ye-3]),Nn(Xe[Ye-2],Xe[Ye-1]),Xe[Ye]);break;case 109:this.$=Ir(fn(Xe[Ye-1]),Xe[Ye]);break;case 110:this.$=Xe[Ye-1].length?$n("|",Nn(Xe[Ye-1],Xe[Ye])):Xe[Ye];break;case 111:this.$=Xe[Ye-1].length?$n("/",Nn(Xe[Ye-1],Xe[Ye])):Xe[Ye];break;case 112:this.$=Xe[Ye]?$n(Xe[Ye],[Xe[Ye-1]]):Xe[Ye-1];break;case 113:this.$=Xe[Ye-1]?$n(Xe[Ye-1],[Xe[Ye]]):Xe[Ye];break;case 116:case 123:this.$=$n(Xe[Ye-1],[Xe[Ye]]);break;case 120:this.$=$n("|",Nn(Xe[Ye-2],Xe[Ye-1]));break;case 124:this.$=$n(Xe[Ye-1],[$t.factory.namedNode(ii)]);break;case 125:case 127:this.$=xi(Xe[Ye-1]);break;case 126:case 128:this.$=wi(Xe[Ye-1]);break;case 129:this.$={entity:Xe[Ye],triples:[]};break;case 131:this.$={entity:Xe[Ye],triples:[]};break;case 133:case 135:this.$=ar($t.factory.quad(Xe[Ye-4],Xe[Ye-3],Xe[Ye-2],fn(Xe[Ye-6])));break;case 134:case 136:this.$=ar($t.factory.quad(Xe[Ye-3],Xe[Ye-2],Xe[Ye-1]));break;case 141:this.$=ir(Xe[Ye].replace(/^(_:)/,""));break;case 142:this.$=ir();break;case 143:this.$=$t.factory.namedNode(ai);break;case 144:case 146:case 151:case 155:this.$=Or(Xe[Ye-1],Xe[Ye]);break;case 145:this.$=["||",Xe[Ye]];break;case 147:this.$=["&&",Xe[Ye]];break;case 149:this.$=hn(Xe[Ye-1],[Xe[Ye-2],Xe[Ye]]);break;case 150:this.$=hn(Xe[Ye-2]?"notin":"in",[Xe[Ye-3],Xe[Ye]]);break;case 152:case 156:this.$=[Xe[Ye-1],Xe[Ye]];break;case 153:this.$=["+",Or(Xe[Ye-1],Xe[Ye])];break;case 154:var mr=wn(Xe[Ye-1].value.replace("-",""),Xe[Ye-1].datatype);this.$=["-",Or(mr,Xe[Ye])];break;case 157:this.$=hn("UPLUS",[Xe[Ye]]);break;case 158:this.$=hn(Xe[Ye-1],[Xe[Ye]]);break;case 159:this.$=hn("UMINUS",[Xe[Ye]]);break;case 169:this.$=hn(gn(Xe[Ye-1]));break;case 170:this.$=hn(gn(Xe[Ye-3]),[Xe[Ye-1]]);break;case 171:this.$=hn(gn(Xe[Ye-5]),[Xe[Ye-3],Xe[Ye-1]]);break;case 172:this.$=hn(gn(Xe[Ye-7]),[Xe[Ye-5],Xe[Ye-3],Xe[Ye-1]]);break;case 173:this.$=hn(gn(Xe[Ye-1]),Xe[Ye]);break;case 174:this.$=hn("bound",[fn(Xe[Ye-1])]);break;case 175:this.$=hn(Xe[Ye-1],[]);break;case 176:this.$=hn(Xe[Ye-3],[Xe[Ye-1]]);break;case 177:this.$=hn(Xe[Ye-2]?"notexists":"exists",[Mr(Xe[Ye])]);break;case 178:case 179:this.$=Dn(Xe[Ye-1],{type:"aggregate",aggregation:gn(Xe[Ye-4]),distinct:!!Xe[Ye-2]});break;case 180:this.$=Dn(Xe[Ye-2],{type:"aggregate",aggregation:gn(Xe[Ye-5]),distinct:!!Xe[Ye-3],separator:typeof Xe[Ye-1]=="string"?Xe[Ye-1]:" "});break;case 182:this.$=wn(Xe[Ye]);break;case 183:this.$=bi(Xe[Ye-1],gn(Xe[Ye].substr(1)));break;case 184:this.$=wn(Xe[Ye-2],Xe[Ye]);break;case 185:case 198:this.$=wn(Xe[Ye],oi);break;case 186:case 199:this.$=wn(Xe[Ye],si);break;case 187:case 200:this.$=wn(gn(Xe[Ye]),ci);break;case 190:this.$=wn(Xe[Ye].toLowerCase(),vi);break;case 191:case 192:this.$=fi(Xe[Ye],1);break;case 193:case 194:this.$=fi(Xe[Ye],3);break;case 195:this.$=wn(Xe[Ye].substr(1),oi);break;case 196:this.$=wn(Xe[Ye].substr(1),si);break;case 197:this.$=wn(Xe[Ye].substr(1).toLowerCase(),ci);break;case 201:this.$=$t.factory.namedNode(rr(Xe[Ye]));break;case 202:var gr=Xe[Ye].indexOf(":"),an=Xe[Ye].substr(0,gr),An=$t.prefixes[an];if(!An)throw new Error("Unknown prefix: "+an);var Hn=rr(An+Xe[Ye].substr(gr+1));this.$=$t.factory.namedNode(Hn);break;case 203:if(Xe[Ye]=Xe[Ye].substr(0,Xe[Ye].length-1),!(Xe[Ye]in $t.prefixes))throw new Error("Unknown prefix: "+Xe[Ye]);var Hn=rr($t.prefixes[Xe[Ye]]);this.$=$t.factory.namedNode(Hn);break;case 212:case 220:case 222:case 224:case 234:case 236:case 242:case 246:case 250:case 264:case 266:case 268:case 270:case 272:case 274:case 276:case 278:case 303:case 309:case 320:case 336:case 370:case 386:case 405:case 407:case 433:case 435:case 445:case 449:case 451:case 453:Xe[Ye-1].push(Xe[Ye]);break;case 223:case 241:case 263:case 265:case 267:case 273:case 277:case 404:case 406:this.$=[Xe[Ye]];break;case 280:Xe[Ye-3].push(Xe[Ye-2]);break;case 330:case 342:case 346:case 356:case 358:case 362:case 374:case 376:case 384:case 390:case 392:case 401:Xe[Ye-2].push(Xe[Ye-1]);break}},table:[U(D,F,{3:1,4:2,7:3}),{1:[3]},U(G,[2,279],{5:4,8:5,313:6,210:7,9:8,103:9,211:10,17:11,40:12,49:13,54:14,104:15,18:16,22:17,25:21,6:[2,204],13:Q,16:Q,35:Q,195:Q,219:Q,224:Q,312:Q,28:X,41:[1,18],50:[1,19],55:[1,20]}),U([6,13,16,28,35,41,50,55,107,117,120,122,123,132,133,138,195,219,224,312,322,323,324,325,326],[2,2],{314:23,11:24,14:25,12:[1,26],15:[1,27]}),{6:[1,28]},{6:[2,206]},{6:[2,207]},{6:[2,208]},{6:[2,217],10:29,89:30,90:q},{6:[2,205]},U(W,[2,391],{212:32,213:33}),U(Y,[2,213]),U(Y,[2,214]),U(Y,[2,215]),U(Y,[2,216]),{105:34,107:[1,35],110:36,113:37,117:[1,38],120:[1,39],122:[1,40],123:[1,41],124:42,128:43,132:[2,304],133:[2,298],137:49,138:[1,50],322:[1,44],323:[1,45],324:[1,46],325:[1,47],326:[1,48]},U(J,[2,219],{19:51}),U(J,[2,221],{23:52}),U(te,[2,235],{42:53,44:54,46:[1,55]}),{13:Z,16:ee,26:[1,58],34:re,51:56,60:61,312:ne,318:59,319:57},U(J,[2,249],{56:65}),{26:[1,66],27:67,33:68,34:le,35:se},U(ie,[2,227],{29:71,315:72,316:[1,73],317:[1,74]}),U(D,[2,212]),U(D,[2,209]),U(D,[2,210]),{13:[1,75]},{16:[1,76]},{1:[2,1]},{6:[2,3]},{6:[2,218]},{34:[1,78],35:[1,80],91:77,93:[1,79]},U([6,13,16,34,35,38,87,93,226,231,245,246,299,300,301,302,303,304,305,306,307,308,309,310,311,312],[2,110],{330:[1,81]}),U(ge,[2,398],{214:82,218:83,224:[1,84]}),{6:[2,281],106:85,191:[1,86]},U(fe,[2,283],{108:87,321:[1,88]}),U(ae,[2,289],{111:89,321:[1,90]}),U(ue,[2,294],{114:91,321:[1,92]}),{118:93,119:[2,296],321:[1,94]},{46:pe,121:95},{46:pe,121:97},{46:pe,121:98},{125:99,133:_e},{129:101,132:xe},U(be,[2,287]),U(be,[2,288]),U(Te,[2,291]),U(Te,[2,292]),U(Te,[2,293]),{132:[2,305],133:[2,299]},{13:Z,16:ee,60:103,312:ne},{20:104,45:ye,46:Ee,57:105,58:he,61:106},{20:109,45:ye,46:Ee,57:110,58:he,61:106},U(J,[2,233],{43:111}),{45:[1,112],57:113,58:he},U(oe,[2,361],{179:114,180:115,181:116,48:[2,359]}),U(me,[2,245],{52:117}),U(me,[2,243],{60:61,318:118,13:Z,16:ee,34:re,312:ne}),U(me,[2,244]),U(ve,[2,241]),U(ve,[2,239]),U(ve,[2,240]),U(we,[2,201]),U(we,[2,202]),U(we,[2,203]),{20:119,45:ye,46:Ee,57:120,58:he,61:106},U(J,[2,8]),U(J,[2,9],{33:121,34:le,35:se}),U(Pe,[2,223]),U(Pe,[2,13]),{13:Z,16:ee,34:Me,35:De,36:122,39:123,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,231:Be,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U(ie,[2,10]),U(ie,[2,228]),U(ie,[2,225]),U(ie,[2,226]),U(D,[2,4]),{13:[1,176]},U(St,[2,40]),{46:[1,177]},{46:[1,178]},{34:[1,180],95:179},U(W,[2,390]),U([6,13,16,34,35,38,87,93,226,231,245,246,299,300,301,302,303,304,305,306,307,308,309,310,311,312,330],[2,111],{331:[1,181]}),{13:Z,16:ee,35:[1,187],60:184,195:[1,185],215:182,216:183,219:[1,186],312:ne},U(ge,[2,399]),{6:[2,49]},U(D,F,{7:3,4:188}),{13:Z,16:ee,60:189,312:ne},U(fe,[2,284]),{112:190,119:[1,191],141:[1,193],143:192,320:[1,194],327:[1,195]},U(ae,[2,290]),U(fe,Tt,{115:196,142:198,119:At,141:wt}),U(ue,[2,295]),{119:[1,200]},{119:[2,297]},U(ot,[2,54]),U(oe,pt,{144:201,151:202,152:203,48:xt,119:xt}),U(ot,[2,55]),U(ot,[2,56]),U(Mt,[2,300],{126:204,129:205,132:xe}),{46:pe,121:206},U(Mt,[2,306],{130:207,125:208,133:_e}),{46:pe,121:209},U([132,133],[2,62]),U(tt,ht,{21:210,64:211,74:212,75:Pt}),U(J,[2,220]),{46:Ct,62:214},U(fe,[2,251],{59:216,320:[1,217]}),{46:[2,254]},U(kt,Qt,{24:218,63:219,67:220,68:tn}),U(J,[2,222]),{20:222,45:ye,46:Ee,57:223,58:he,61:106},{46:[1,224]},U(te,[2,236]),{48:[1,225]},{48:[2,360]},{13:Z,16:ee,34:Xt,35:yn,39:230,60:235,87:Oe,93:Zt,98:236,153:226,183:227,185:228,226:bn,231:Be,243:229,244:234,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(nt,[2,247],{61:106,53:240,57:241,20:242,45:ye,46:Ee,58:he}),U(ve,[2,242]),U(kt,Qt,{63:219,67:220,24:243,68:tn}),U(J,[2,250]),U(Pe,[2,224]),{37:[1,244]},{37:[1,245]},U(mt,[2,432],{248:246}),{13:Z,16:ee,34:Xt,39:249,60:235,87:Oe,93:Zt,98:236,119:[1,247],231:Be,236:248,243:250,244:234,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(yt,[2,434],{252:251}),U(yt,[2,148],{256:252,257:253,258:[2,442],295:[1,254],334:[1,255],335:[1,256],336:[1,257],337:[1,258],338:[1,259],339:[1,260]}),U(ft,[2,444],{260:261}),U(_t,[2,452],{268:262}),{13:Z,16:ee,34:Me,35:De,60:136,72:135,73:137,82:134,87:Oe,98:138,263:154,265:155,272:263,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},{13:Z,16:ee,34:Me,35:De,60:136,72:135,73:137,82:134,87:Oe,98:138,263:154,265:155,272:264,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},{13:Z,16:ee,34:Me,35:De,60:136,72:135,73:137,82:134,87:Oe,98:138,263:154,265:155,272:265,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U(_t,[2,160]),U(_t,[2,161]),U(_t,[2,162]),U(_t,[2,163],{35:Rt,93:Nt}),U(_t,[2,164]),U(_t,[2,165]),U(_t,[2,166]),{13:Z,16:ee,34:Me,35:De,36:268,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U(It,[2,168]),{93:[1,269]},{35:[1,270]},{35:[1,271]},{35:[1,272]},{35:Bt,93:Vt,177:273},{35:[1,276]},{35:[1,278],93:[1,277]},{284:[1,279]},U(Lt,[2,182],{297:[1,280],298:[1,281]}),U(Lt,[2,185]),U(Lt,[2,186]),U(Lt,[2,187]),U(Lt,[2,188]),U(Lt,[2,189]),U(Lt,[2,190]),{35:[1,282]},{35:[1,283]},{35:[1,284]},U(jt,[2,456]),U(jt,[2,457]),U(jt,[2,458]),U(jt,[2,459]),U(jt,[2,460]),{284:[2,462]},U(Ht,[2,191]),U(Ht,[2,192]),U(Ht,[2,193]),U(Ht,[2,194]),U(Lt,[2,195]),U(Lt,[2,196]),U(Lt,[2,197]),U(Lt,[2,198]),U(Lt,[2,199]),U(Lt,[2,200]),U(D,[2,5]),U(cn,[2,269],{92:285}),U(pn,[2,271],{94:286}),{34:[1,288],38:[1,287]},U(Sn,[2,273]),U(W,[2,392]),U(qt,[2,113]),U(qt,[2,396],{217:289,332:290,26:[1,292],271:[1,293],333:[1,291]}),U(Ut,[2,114]),U(Ut,[2,115]),{13:Z,16:ee,35:[1,297],60:298,93:[1,296],195:Wn,220:294,221:295,224:rn,312:ne},U(W,Q,{211:10,210:301}),U(G,[2,280],{6:[2,282]}),U(ot,[2,285],{109:302,139:303,140:[1,304]}),U(ot,[2,51]),{13:Z,16:ee,60:305,312:ne},U(ot,[2,67]),U(ot,[2,314]),U(ot,[2,315]),U(ot,[2,316]),{116:[1,306]},U(Tn,[2,64]),{13:Z,16:ee,60:307,312:ne},U(fe,[2,313]),{13:Z,16:ee,60:308,312:ne},U(En,[2,319],{145:309}),U(En,[2,318]),{13:Z,16:ee,34:Xt,35:yn,39:230,60:235,87:Oe,93:Zt,98:236,153:310,183:227,185:228,226:bn,231:Be,243:229,244:234,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(Mt,[2,302],{127:311}),U(Mt,[2,301]),U([45,132,135],[2,60]),U(Mt,[2,308],{131:312}),U(Mt,[2,307]),U([45,133,135],[2,59]),U(Y,[2,6]),U(On,[2,259],{65:313,77:314,78:[1,315]}),U(tt,[2,258]),{13:Z,16:ee,35:De,60:321,72:319,73:320,76:316,82:318,84:317,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U([6,48,68,75,78,86,88,90],[2,21]),U(oe,Qn,{25:21,30:322,155:323,18:324,22:325,156:326,162:327,163:328,28:X,46:Kt,48:Kt,90:Kt,119:Kt,167:Kt,168:Kt,170:Kt,173:Kt,174:Kt}),{13:Z,16:ee,60:329,312:ne},U(fe,[2,252]),U(Y,[2,7]),U(tt,ht,{64:211,74:212,21:330,75:Pt}),U(kt,[2,256]),{69:[1,331]},U(kt,Qt,{63:219,67:220,24:332,68:tn}),U(J,[2,234]),U(oe,pt,{152:203,47:333,151:334,48:[2,237]}),U(J,[2,92]),{48:[2,363],182:335,328:[1,336]},{13:Z,16:ee,34:dn,60:341,184:337,188:338,193:339,195:vn,312:ne},U(sn,[2,367],{188:338,193:339,60:341,186:343,187:344,184:345,13:Z,16:ee,34:dn,195:vn,312:ne}),U(mn,[2,365]),U(mn,[2,366]),{13:Z,16:ee,34:Xt,35:yn,39:351,60:235,87:Oe,93:Zt,98:236,185:349,197:347,225:346,226:bn,229:348,231:Be,243:350,244:234,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},{13:Z,16:ee,34:dn,60:341,184:352,188:338,193:339,195:vn,312:ne},U(Mn,[2,137]),U(Mn,[2,138]),U(Mn,[2,139]),U(Mn,[2,140]),U(Mn,[2,141]),U(Mn,[2,142]),U(Mn,[2,143]),U(kt,Qt,{63:219,67:220,24:353,68:tn}),U(me,[2,246]),U(nt,[2,248]),U(Y,[2,19]),{34:[1,354]},{34:[1,355]},U([37,38,191,278],[2,144],{249:356,250:[1,357]}),{13:Z,16:ee,34:[1,359],60:360,232:358,312:ne},{13:Z,16:ee,34:dn,60:341,193:361,195:vn,312:ne},U(mn,[2,418]),U(mn,[2,419]),U(mt,[2,146],{253:362,254:[1,363]}),{13:Z,16:ee,34:Me,35:De,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,255:364,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},{258:[1,365]},U(en,[2,436]),U(en,[2,437]),U(en,[2,438]),U(en,[2,439]),U(en,[2,440]),U(en,[2,441]),{258:[2,443]},U([37,38,191,250,254,258,278,295,334,335,336,337,338,339],[2,151],{261:366,262:367,263:368,265:369,271:[1,370],273:[1,371],306:Ce,307:Ze,308:at,309:st,310:Se,311:ce}),U(ft,[2,155],{269:372,270:373,26:br,331:Sr}),U(_t,[2,157]),U(_t,[2,158]),U(_t,[2,159]),U(It,[2,88]),U(en,[2,353],{175:376,316:[1,377]}),{38:[1,378]},U(It,[2,169]),{13:Z,16:ee,34:Me,35:De,36:379,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},{13:Z,16:ee,34:Me,35:De,36:380,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},{13:Z,16:ee,34:Me,35:De,36:381,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U(It,[2,173]),U(It,[2,90]),U(en,[2,357],{178:382}),{34:[1,383]},U(It,[2,175]),{13:Z,16:ee,34:Me,35:De,36:384,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},{46:Ct,62:385},U(Lt,[2,183]),{13:Z,16:ee,60:386,312:ne},U(Ur,[2,463],{286:387,316:[1,388]}),U(en,[2,467],{289:389,316:[1,390]}),U(en,[2,469],{291:391,316:[1,392]}),{13:Z,16:ee,48:[1,393],60:395,87:Oe,97:394,98:396,99:397,100:Tr,231:Bn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},{48:[1,400],93:[1,401]},{46:[1,402]},U(Sn,[2,274]),U(qt,[2,112]),U(qt,[2,397]),U(qt,[2,393]),U(qt,[2,394]),U(qt,[2,395]),U(Ut,[2,116]),U(Ut,[2,118]),U(Ut,[2,119]),U(Br,[2,400],{222:403}),U(Ut,[2,121]),U(Ut,[2,122]),{13:Z,16:ee,60:404,195:[1,405],312:ne},{38:[1,406]},U(ot,[2,50]),U(ot,[2,286]),{119:[1,407]},U(ot,[2,66]),U(fe,Tt,{142:198,115:408,119:At,141:wt}),U(Tn,[2,65]),U(ot,[2,53]),{48:[1,409],119:[1,411],146:410},U(En,[2,331],{154:412,328:[1,413]}),{45:[1,414],134:415,135:jr},{45:[1,417],134:418,135:jr},U(Ln,[2,261],{66:419,85:420,86:[1,421],88:[1,422]}),U(On,[2,260]),{69:[1,423]},U(tt,[2,30],{274:141,280:146,283:149,82:318,72:319,73:320,60:321,84:424,13:Z,16:ee,35:De,275:qe,276:je,277:it,279:ct,281:rt,282:ut,284:We,285:Re,288:Ue,290:Le,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt}),U(Gr,[2,265]),U(Er,[2,85]),U(Er,[2,86]),U(Er,[2,87]),{35:Rt,93:Nt},{48:[1,425]},{48:[1,426]},{20:427,45:ye,46:Ee,61:106},{20:428,45:ye,46:Ee,61:106},U(jn,[2,335],{157:429}),U(jn,[2,334]),{13:Z,16:ee,34:Xt,35:er,39:434,60:235,87:Oe,93:Zt,98:236,164:430,201:431,203:432,226:tr,231:Be,243:433,244:234,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(me,[2,20]),U(Ln,[2,22]),{13:Z,16:ee,34:kr,35:Vr,60:321,70:437,71:438,72:439,73:440,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U(Y,[2,16]),{48:[1,443]},{48:[2,238]},{48:[2,93]},U(oe,[2,362],{48:[2,364]}),U(sn,[2,94]),U(Gn,[2,369],{189:444}),U(oe,[2,373],{194:445,196:446}),U(oe,[2,100]),U(oe,[2,101]),U(oe,[2,102]),U(sn,[2,95]),U(sn,[2,96]),U(sn,[2,368]),{13:Z,16:ee,34:Xt,35:yn,38:[1,447],39:351,60:235,87:Oe,93:Zt,98:236,185:349,197:448,226:bn,229:348,231:Be,243:350,244:234,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(or,[2,404]),U(sr,[2,129]),U(sr,[2,130]),U(sr,[2,408]),U(sr,[2,409]),{227:[1,449]},U(Y,[2,18]),{38:[1,450]},{38:[1,451]},U(mt,[2,433]),{13:Z,16:ee,34:Me,35:De,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,247:452,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},{46:[1,453]},{46:[2,412]},{46:[2,413]},{13:Z,16:ee,34:Xt,39:455,60:235,87:Oe,93:Zt,98:236,231:Be,237:454,243:456,244:234,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(yt,[2,435]),{13:Z,16:ee,34:Me,35:De,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,251:457,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U(yt,[2,149]),{35:Bt,93:Vt,177:458},U(ft,[2,445]),{13:Z,16:ee,34:Me,35:De,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,259:459,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U(_t,[2,448],{264:460}),U(_t,[2,450],{266:461}),U(en,[2,446]),U(en,[2,447]),U(_t,[2,453]),{13:Z,16:ee,34:Me,35:De,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,263:154,265:155,267:462,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U(en,[2,454]),U(en,[2,455]),U(en,[2,355],{176:463}),U(en,[2,354]),U([6,13,16,26,34,35,37,38,46,48,78,81,83,86,87,88,90,93,119,167,168,170,173,174,191,226,231,245,246,250,254,258,271,273,275,276,277,278,279,281,282,284,285,288,290,295,299,300,301,302,303,304,305,306,307,308,309,310,311,312,328,331,334,335,336,337,338,339,340,341,342,343,344],[2,167]),{38:[1,464]},{278:[1,465]},{278:[1,466]},{13:Z,16:ee,34:Me,35:De,36:467,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},{38:[1,468]},{38:[1,469]},U(It,[2,177]),U(Lt,[2,184]),{13:Z,16:ee,26:[1,471],34:Me,35:De,36:472,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,287:470,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U(Ur,[2,464]),{13:Z,16:ee,34:Me,35:De,36:473,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U(en,[2,468]),{13:Z,16:ee,34:Me,35:De,36:474,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U(en,[2,470]),U(St,[2,41]),U(cn,[2,270]),U(cr,[2,44]),U(cr,[2,45]),U(cr,[2,46]),U(cr,[2,47]),{13:Z,16:ee,60:235,87:Oe,93:Zt,98:236,99:477,119:[1,475],231:Bn,241:476,244:478,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(St,[2,42]),U(pn,[2,272]),U(xr,[2,275],{96:479}),{13:Z,16:ee,38:[2,402],60:298,195:Wn,221:481,223:480,224:rn,312:ne},U(Ut,[2,123]),U(Ut,[2,124]),U(Ut,[2,117]),{13:Z,16:ee,60:482,312:ne},U(ot,[2,52]),U([6,45,132,133,135,191],[2,68]),U(En,[2,320]),{13:Z,16:ee,34:[1,484],60:485,147:483,312:ne},U(En,[2,70]),U(oe,[2,330],{48:$r,119:$r}),{46:Ct,62:486},U(Mt,[2,303]),U(fe,[2,310],{136:487,320:[1,488]}),{46:Ct,62:489},U(Mt,[2,309]),U(Ln,[2,23]),U(Ln,[2,262]),{87:[1,490]},{87:[1,491]},{13:Z,16:ee,34:zr,35:De,60:321,72:319,73:320,79:492,80:493,81:Hr,82:318,83:Wr,84:496,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U(Gr,[2,266]),U(Qr,[2,71]),U(Qr,[2,72]),U(tt,ht,{64:211,74:212,21:498,75:Pt}),U(kt,Qt,{63:219,67:220,24:499,68:tn}),{46:[2,345],48:[2,73],89:509,90:q,119:[1,505],158:500,159:501,166:502,167:[1,503],168:[1,504],170:[1,506],173:[1,507],174:[1,508]},U(jn,[2,343],{165:510,328:[1,511]}),U(W,Q,{211:10,202:512,205:513,210:514,34:wr}),U(ur,[2,379],{211:10,205:513,210:514,204:516,202:517,13:Q,16:Q,35:Q,195:Q,219:Q,224:Q,312:Q,34:wr}),U(Xr,[2,377]),U(Xr,[2,378]),{13:Z,16:ee,34:Xt,35:er,39:523,60:235,87:Oe,93:Zt,98:236,200:519,203:521,226:tr,228:518,230:520,231:Be,243:522,244:234,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(W,Q,{211:10,205:513,210:514,202:524,34:wr}),U(kt,[2,24],{274:141,280:146,283:149,60:321,72:439,73:440,71:525,13:Z,16:ee,34:kr,35:Vr,275:qe,276:je,277:it,279:ct,281:rt,282:ut,284:We,285:Re,288:Ue,290:Le,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt}),U(kn,[2,263]),U(kn,[2,25]),U(kn,[2,26]),{13:Z,16:ee,34:Me,35:De,36:526,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U(kn,[2,29]),U(kt,Qt,{63:219,67:220,24:527,68:tn}),U([48,119,227,328],[2,97],{190:528,191:[1,529]}),U(Gn,[2,99]),{13:Z,16:ee,34:Xt,35:yn,39:351,60:235,87:Oe,93:Zt,98:236,185:349,197:530,226:bn,229:348,231:Be,243:350,244:234,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(qr,[2,125]),U(or,[2,405]),U(qr,[2,126]),U(Pe,[2,14]),U(Pe,[2,15]),U(mt,[2,145]),{13:Z,16:ee,34:Xt,39:532,60:235,87:Oe,93:Zt,98:236,231:Be,233:531,243:533,244:234,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},{235:[1,534]},{235:[2,420]},{235:[2,421]},U(yt,[2,147]),U(yt,[2,150]),U(ft,[2,152]),U(ft,[2,153],{270:373,269:535,26:br,331:Sr}),U(ft,[2,154],{270:373,269:536,26:br,331:Sr}),U(_t,[2,156]),{13:Z,16:ee,34:Me,35:De,36:537,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U(It,[2,170]),{13:Z,16:ee,34:Me,35:De,36:538,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},{13:Z,16:ee,34:Me,35:De,36:539,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},{38:[1,540],278:[1,541]},U(It,[2,174]),U(It,[2,176]),{38:[1,542]},{38:[2,465]},{38:[2,466]},{38:[1,543]},{38:[2,471],191:[1,546],292:544,293:545},{13:Z,16:ee,34:[1,548],60:549,238:547,312:ne},{13:Z,16:ee,34:dn,60:341,193:550,195:vn,312:ne},U(mn,[2,428]),U(mn,[2,429]),{35:[1,553],48:[1,551],101:552},{38:[1,554]},{38:[2,403],330:[1,555]},U(ot,[2,63]),{46:[1,556]},{46:[2,321]},{46:[2,322]},U(ot,[2,57]),{13:Z,16:ee,60:557,312:ne},U(fe,[2,311]),U(ot,[2,58]),U(Ln,[2,36],{88:[1,558]}),U(Ln,[2,37],{86:[1,559]}),U(On,[2,31],{274:141,280:146,283:149,82:318,72:319,73:320,60:321,84:496,80:560,13:Z,16:ee,34:zr,35:De,81:Hr,83:Wr,275:qe,276:je,277:it,279:ct,281:rt,282:ut,284:We,285:Re,288:Ue,290:Le,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt}),U(Xn,[2,267]),{35:De,82:561},{35:De,82:562},U(Xn,[2,34]),U(Xn,[2,35]),{31:563,48:[2,229],89:564,90:q},{32:565,48:[2,231],89:566,90:q},U(jn,[2,336]),U(Kr,[2,337],{160:567,328:[1,568]}),{46:Ct,62:569},{46:Ct,62:570},{46:Ct,62:571},{13:Z,16:ee,34:[1,573],60:574,169:572,312:ne},U(Yr,[2,349],{171:575,321:[1,576]}),{13:Z,16:ee,35:De,60:321,72:319,73:320,82:318,84:577,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},{35:[1,578]},U(Pn,[2,84]),U(jn,[2,75]),U(oe,[2,342],{46:In,48:In,90:In,119:In,167:In,168:In,170:In,173:In,174:In}),U(ur,[2,105]),U(oe,[2,383],{206:579}),U(oe,[2,381]),U(oe,[2,382]),U(ur,[2,106]),U(ur,[2,380]),{13:Z,16:ee,34:Xt,35:er,38:[1,580],39:523,60:235,87:Oe,93:Zt,98:236,200:581,203:521,226:tr,230:520,231:Be,243:522,244:234,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(or,[2,406]),U(lr,[2,131]),U(lr,[2,132]),U(lr,[2,410]),U(lr,[2,411]),{227:[1,582]},U(kn,[2,264]),{37:[1,584],38:[1,583]},U(Y,[2,17]),U(Gn,[2,370]),U(Gn,[2,371],{193:339,60:341,192:585,188:586,13:Z,16:ee,34:dn,195:vn,312:ne}),U(Gn,[2,103],{278:[1,587]}),{13:Z,16:ee,34:dn,60:341,193:588,195:vn,312:ne},U(mn,[2,414]),U(mn,[2,415]),U(Jr,[2,134]),U(_t,[2,449]),U(_t,[2,451]),{38:[1,589],278:[1,590]},{38:[1,591]},{278:[1,592]},U(It,[2,91]),U(en,[2,358]),U(It,[2,178]),U(It,[2,179]),{38:[1,593]},{38:[2,472]},{294:[1,594]},{46:[1,595]},{46:[2,422]},{46:[2,423]},{13:Z,16:ee,60:235,87:Oe,93:Zt,98:236,99:597,231:Bn,242:596,244:598,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(St,[2,43]),U(xr,[2,276]),{13:Z,16:ee,60:395,87:Oe,97:600,98:396,99:397,100:Tr,102:599,231:Bn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(Ut,[2,120]),U(Br,[2,401]),U(oe,pt,{152:203,148:601,151:602,48:[2,323]}),U(Mt,[2,61]),{87:[1,603]},{87:[1,604]},U(Xn,[2,268]),U(Xn,[2,32]),U(Xn,[2,33]),{48:[2,11]},{48:[2,230]},{48:[2,12]},{48:[2,232]},U(oe,Qn,{163:328,161:605,162:606,46:Rn,48:Rn,90:Rn,119:Rn,167:Rn,168:Rn,170:Rn,173:Rn,174:Rn}),U(Kr,[2,338]),U(Pn,[2,76],{329:[1,607]}),U(Pn,[2,77]),U(Pn,[2,78]),{46:Ct,62:608},{46:[2,347]},{46:[2,348]},{13:Z,16:ee,34:[1,610],60:611,172:609,312:ne},U(Yr,[2,350]),U(Pn,[2,81]),{13:Z,16:ee,34:Me,35:De,36:612,39:613,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,231:Be,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},{13:Z,16:ee,34:Xt,35:er,39:523,60:235,87:Oe,93:Zt,98:236,200:614,203:521,226:tr,230:520,231:Be,243:522,244:234,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(Zr,[2,127]),U(or,[2,407]),U(Zr,[2,128]),U(kn,[2,27]),{34:[1,615]},U(Gn,[2,98]),U(Gn,[2,372]),U(oe,[2,374]),{13:Z,16:ee,34:Xt,39:617,60:235,87:Oe,93:Zt,98:236,231:Be,234:616,243:618,244:234,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(It,[2,89]),U(en,[2,356]),U(It,[2,171]),{13:Z,16:ee,34:Me,35:De,36:619,60:136,72:135,73:137,82:134,87:Oe,98:138,219:Ie,247:124,251:126,255:127,259:128,263:154,265:155,267:129,271:ze,272:133,273:et,274:141,275:qe,276:je,277:it,279:ct,280:146,281:rt,282:ut,283:149,284:We,285:Re,288:Ue,290:Le,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne,339:de,340:Ae,341:Fe,342:Ve,343:Je,344:dt},U(It,[2,180]),{295:[1,620]},{13:Z,16:ee,60:235,87:Oe,93:Zt,98:236,99:622,231:Bn,239:621,244:623,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},{235:[1,624]},{235:[2,430]},{235:[2,431]},{13:Z,16:ee,38:[1,625],60:395,87:Oe,97:626,98:396,99:397,100:Tr,231:Bn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(ei,[2,277]),{48:[1,627]},{48:[2,324]},U(Ln,[2,38]),U(Ln,[2,39]),U(jn,[2,74]),U(jn,[2,340]),{46:[2,346]},U(Pn,[2,79]),{46:Ct,62:628},{46:[2,351]},{46:[2,352]},{37:[1,629]},{37:[1,630]},U(nr,[2,385],{207:631,278:[1,632]}),{38:[1,633]},{48:[1,634]},{48:[2,416]},{48:[2,417]},{38:[1,635]},{296:636,302:Ke,303:$e,304:Qe,305:Ne},{13:Z,16:ee,34:dn,60:341,193:637,195:vn,312:ne},U(mn,[2,424]),U(mn,[2,425]),U(ti,[2,136]),U(xr,[2,48]),U(ei,[2,278]),U(ni,[2,325],{149:638,328:[1,639]}),U(Pn,[2,80]),{34:[1,640]},{34:[1,641]},U([46,48,90,119,167,168,170,173,174,227,328],[2,107],{208:642,191:[1,643]}),U(oe,[2,384]),U(kn,[2,28]),{235:[1,644]},U(It,[2,172]),{38:[2,181]},{13:Z,16:ee,60:235,87:Oe,93:Zt,98:236,99:646,231:Bn,240:645,244:647,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(oe,pt,{152:203,150:648,151:649,48:ri,119:ri}),U(ni,[2,326]),{38:[1,650]},{38:[1,651]},U(nr,[2,386]),U(nr,[2,108],{211:10,209:652,210:653,13:Q,16:Q,35:Q,195:Q,219:Q,224:Q,312:Q,34:[1,654]}),U(Jr,[2,133]),{48:[1,655]},{48:[2,426]},{48:[2,427]},U(En,[2,69]),U(En,[2,328]),U(Pn,[2,82]),U(Pn,[2,83]),U(oe,[2,375],{198:656,199:657}),U(oe,[2,387]),U(oe,[2,388]),{235:[1,658]},U(nr,[2,109]),{13:Z,16:ee,34:Xt,35:er,39:523,60:235,87:Oe,93:Zt,98:236,200:659,203:521,226:tr,230:520,231:Be,243:522,244:234,245:Jt,246:nn,263:154,265:155,296:150,299:Ge,300:ke,301:He,302:Ke,303:$e,304:Qe,305:Ne,306:Ce,307:Ze,308:at,309:st,310:Se,311:ce,312:ne},U(ti,[2,135]),U(nr,[2,104],{278:[1,660]}),U(oe,[2,376])],defaultActions:{5:[2,206],6:[2,207],7:[2,208],9:[2,205],28:[2,1],29:[2,3],30:[2,218],85:[2,49],94:[2,297],108:[2,254],115:[2,360],165:[2,462],260:[2,443],334:[2,238],335:[2,93],359:[2,412],360:[2,413],455:[2,420],456:[2,421],471:[2,465],472:[2,466],484:[2,321],485:[2,322],545:[2,472],548:[2,422],549:[2,423],563:[2,11],564:[2,230],565:[2,12],566:[2,232],573:[2,347],574:[2,348],597:[2,430],598:[2,431],602:[2,324],607:[2,346],610:[2,351],611:[2,352],617:[2,416],618:[2,417],636:[2,181],646:[2,426],647:[2,427]},parseError:function(vt,Et){if(Et.recoverable)this.trace(vt);else{var Ot=new Error(vt);throw Ot.hash=Et,Ot}},parse:function(vt){var Et=this,Ot=[0],Dt=[null],Ft=[],Xe=this.table,_n="",Ye=0,Un=0,pr=2,mr=1,gr=Ft.slice.call(arguments,1),an=Object.create(this.lexer),An={yy:{}};for(var Hn in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Hn)&&(An.yy[Hn]=this.yy[Hn]);an.setInput(vt,An.yy),An.yy.lexer=an,An.yy.parser=this,typeof an.yylloc>"u"&&(an.yylloc={});var Jn=an.yylloc;Ft.push(Jn);var Dr=an.options&&an.options.ranges;typeof An.yy.parseError=="function"?this.parseError=An.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var _r=function(){var Zn;return Zn=an.lex()||mr,typeof Zn!="number"&&(Zn=Et.symbols_[Zn]||Zn),Zn},zt,Wt,Gt,un,ln={},yr,Cn,mi,vr;;){if(Wt=Ot[Ot.length-1],this.defaultActions[Wt]?Gt=this.defaultActions[Wt]:((zt===null||typeof zt>"u")&&(zt=_r()),Gt=Xe[Wt]&&Xe[Wt][zt]),typeof Gt>"u"||!Gt.length||!Gt[0]){var Fr="";vr=[];for(yr in Xe[Wt])this.terminals_[yr]&&yr>pr&&vr.push("'"+this.terminals_[yr]+"'");an.showPosition?Fr="Parse error on line "+(Ye+1)+`:
`+an.showPosition()+`
Expecting `+vr.join(", ")+", got '"+(this.terminals_[zt]||zt)+"'":Fr="Parse error on line "+(Ye+1)+": Unexpected "+(zt==mr?"end of input":"'"+(this.terminals_[zt]||zt)+"'"),this.parseError(Fr,{text:an.match,token:this.terminals_[zt]||zt,line:an.yylineno,loc:Jn,expected:vr})}if(Gt[0]instanceof Array&&Gt.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Wt+", token: "+zt);switch(Gt[0]){case 1:Ot.push(zt),Dt.push(an.yytext),Ft.push(an.yylloc),Ot.push(Gt[1]),zt=null,Un=an.yyleng,_n=an.yytext,Ye=an.yylineno,Jn=an.yylloc;break;case 2:if(Cn=this.productions_[Gt[1]][1],ln.$=Dt[Dt.length-Cn],ln._$={first_line:Ft[Ft.length-(Cn||1)].first_line,last_line:Ft[Ft.length-1].last_line,first_column:Ft[Ft.length-(Cn||1)].first_column,last_column:Ft[Ft.length-1].last_column},Dr&&(ln._$.range=[Ft[Ft.length-(Cn||1)].range[0],Ft[Ft.length-1].range[1]]),un=this.performAction.apply(ln,[_n,Un,Ye,An.yy,Gt[1],Dt,Ft].concat(gr)),typeof un<"u")return un;Cn&&(Ot=Ot.slice(0,-1*Cn*2),Dt=Dt.slice(0,-1*Cn),Ft=Ft.slice(0,-1*Cn)),Ot.push(this.productions_[Gt[1]][0]),Dt.push(ln.$),Ft.push(ln._$),mi=Xe[Ot[Ot.length-2]][Ot[Ot.length-1]],Ot.push(mi);break;case 3:return!0}}return!0}},dr=Wildcard$2.Wildcard,fr="http://www.w3.org/1999/02/22-rdf-syntax-ns#",ii=fr+"type",_i=fr+"first",yi=fr+"rest",ai=fr+"nil",hr="http://www.w3.org/2001/XMLSchema#",oi=hr+"integer",si=hr+"decimal",ci=hr+"double",vi=hr+"boolean",Vn="",ui="",li="";function gn(bt){return bt.toLowerCase()}function Nn(bt,vt){return bt.push(vt),bt}function qn(bt,vt){return bt.push.apply(bt,vt),bt}function Yt(bt){bt||(bt={});for(var vt=1,Et=arguments.length,Ot;vt<Et&&(Ot=arguments[vt]||{});vt++)for(var Dt in Ot)bt[Dt]=Ot[Dt];return bt}function xn(){for(var bt=[],vt=0,Et=arguments.length;vt<Et;vt++)bt=bt.concat.apply(bt,arguments[vt]);return bt}function rr(bt){if(bt[0]==="<"&&(bt=bt.substring(1,bt.length-1)),/^[a-z]+:/i.test(bt))return bt;if(!$t.base)throw new Error("Cannot resolve relative IRI "+bt+" because no base IRI was set.");switch(Vn!==$t.base&&(Vn=$t.base,ui=Vn.replace(/[^\/:]*$/,""),li=Vn.match(/^(?:[a-z]+:\/*)?[^\/]*/)[0]),bt[0]){case void 0:return Vn;case"#":return Vn+bt;case"?":return Vn.replace(/(?:\?.*)?$/,bt);case"/":return li+bt;default:return ui+bt}}function fn(bt){if(bt){var vt=bt[0];if(vt==="?"||vt==="$")return $t.factory.variable(bt.substr(1))}return bt}function hn(bt,vt){return{type:"operation",operator:bt,args:vt||[]}}function Dn(bt,vt){var Et={expression:bt==="*"?new dr:bt};if(vt)for(var Ot in vt)Et[Ot]=vt[Ot];return Et}function $n(bt,vt){return{type:"path",pathType:bt,items:vt}}function Or(bt,vt){for(var Et=0,Ot=vt.length,Dt;Et<Ot&&(Dt=vt[Et]);Et++)bt=hn(Dt[0],[bt,Dt[1]]);return bt}function Fn(bt,vt){var Et=[],Ot=[],Dt=bt.length,Ft,Xe={};if(!Dt)return null;for(var _n=0;_n<Dt&&(Ft=bt[_n]);_n++)(Ft.named?Ot:Et).push(Ft.iri);return Xe[vt||"from"]={default:Et,named:Ot},Xe}function Kn(bt){return parseInt(bt,10)}function Mr(bt){return bt.type==="group"&&bt.patterns.length===1?bt.patterns[0]:bt}function wn(bt,vt){return vt&&vt.termType!=="NamedNode"&&(vt=$t.factory.namedNode(vt)),$t.factory.literal(bt,vt)}function bi(bt,vt){return $t.factory.literal(bt,vt)}function zn(bt,vt,Et){var Ot={};return bt!=null&&(Ot.subject=bt),vt!=null&&(Ot.predicate=vt),Et!=null&&(Ot.object=Et),Ot}function ir(bt){return typeof bt=="string"?bt.startsWith("e_")?$t.factory.blankNode(bt):$t.factory.blankNode("e_"+bt):$t.factory.blankNode("g_"+di++)}var di=0;$t._resetBlanks=function(){di=0};var Si=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\(.)/g,Ti={"\\":"\\","'":"'",'"':'"',t:"	",b:"\b",n:`
`,r:"\r",f:"\f"},Ei=/[\uD800-\uDBFF]([^\uDC00-\uDFFF]|$)/,Pr=String.fromCharCode;function fi(bt,vt){bt=bt.substring(vt,bt.length-vt);try{bt=bt.replace(Si,function(Et,Ot,Dt,Ft){var Xe;if(Ot){if(Xe=parseInt(Ot,16),isNaN(Xe))throw new Error;return Pr(Xe)}else if(Dt){if(Xe=parseInt(Dt,16),isNaN(Xe))throw new Error;return Xe<65535?Pr(Xe):Pr(55296+((Xe-=65536)>>10),56320+(Xe&1023))}else{var _n=Ti[Ft];if(!_n)throw new Error;return _n}})}catch{return""}if(Ei.exec(bt))throw new Error("Invalid unicode codepoint of surrogate pair without corresponding codepoint in "+bt);return bt}function xi(bt){var vt=ir(),Et=vt,Ot=[],Dt,Ft=[];bt.forEach(function(Un){Ot.push(Un.entity),qn(Ft,Un.triples)});for(var Xe=0,_n=0,Ye=Ot.length,Dt=Array(Ye*2);Xe<Ye;)Dt[_n++]=zn(Et,$t.factory.namedNode(_i),Ot[Xe]),Dt[_n++]=zn(Et,$t.factory.namedNode(yi),Et=++Xe<Ye?ir():$t.factory.namedNode(ai));return{entity:vt,triples:qn(Dt,Ft)}}function wi(bt){var vt=ir();return{entity:vt,triples:bt.map(function(Et){return Yt(zn(vt),Et)})}}function Ir(bt,vt,Et){var Ot=[],Dt=[];return vt.forEach(function(Ft){Ot.push(zn(null,bt,Ft.entity)),qn(Dt,Ft.triples)}),xn(Ot,Et||[],Dt)}function Yn(bt){return bt.variable?bt.variable.value:bt.value||bt.expression.value}function Rr(bt){if(!bt)return[];if(bt.type==="aggregate")return[bt];if(bt.type==="operation"){const vt=[];for(const Et of bt.args)vt.push(...Rr(Et));return vt}return[]}function Ai(bt){const vt=new Set,Et=function(Ot){Ot&&(Ot.termType==="Variable"?vt.add(Ot):Ot.type==="operation"&&Ot.args.forEach(Et))};return Et(bt),vt}function Cr(bt,vt=1,Et=[]){for(const Ot of bt)vt>0&&Ot instanceof Array?Cr(Ot,vt-1,Et):Et.push(Ot);return Et}function Lr(bt){return bt.termType==="Variable"}function hi(bt){if(bt.triples){const vt=[];for(const Et of bt.triples)Lr(Et.subject)&&vt.push(Et.subject.value),Lr(Et.predicate)&&vt.push(Et.predicate.value),Lr(Et.object)&&vt.push(Et.object.value);return vt}else if(bt.patterns){const vt=[];for(const Et of bt.patterns)vt.push(...hi(Et));return vt}return[]}function Oi(bt){const vt=bt.slice().sort(),Et=[];for(let Ot=0;Ot<vt.length-1;Ot++)vt[Ot+1]==vt[Ot]&&Et.push(vt[Ot]);return Et}function ar(bt){if(!$t.sparqlStar)throw new Error("SPARQL* support is not enabled");return bt}function pi(bt){for(const vt of bt){if(vt.type==="graph"&&vt.name.termType==="Variable")throw new Error("Detected illegal variable in GRAPH");if(vt.type==="bgp"||vt.type==="graph"){for(const Et of vt.triples)if(Et.subject.termType==="Variable"||Et.predicate.termType==="Variable"||Et.object.termType==="Variable")throw new Error("Detected illegal variable in BGP")}}return bt}function Nr(bt){for(const vt of bt)if(vt.type==="bgp"){for(const Et of vt.triples)if(Et.subject.termType==="BlankNode"||Et.predicate.termType==="BlankNode"||Et.object.termType==="BlankNode")throw new Error("Detected illegal blank node in BGP")}return bt}var Mi=function(){var bt={EOF:1,parseError:function(Et,Ot){if(this.yy.parser)this.yy.parser.parseError(Et,Ot);else throw new Error(Et)},setInput:function(vt,Et){return this.yy=Et||this.yy||{},this._input=vt,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var vt=this._input[0];this.yytext+=vt,this.yyleng++,this.offset++,this.match+=vt,this.matched+=vt;var Et=vt.match(/(?:\r\n?|\n).*/g);return Et?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),vt},unput:function(vt){var Et=vt.length,Ot=vt.split(/(?:\r\n?|\n)/g);this._input=vt+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-Et),this.offset-=Et;var Dt=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),Ot.length-1&&(this.yylineno-=Ot.length-1);var Ft=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:Ot?(Ot.length===Dt.length?this.yylloc.first_column:0)+Dt[Dt.length-Ot.length].length-Ot[0].length:this.yylloc.first_column-Et},this.options.ranges&&(this.yylloc.range=[Ft[0],Ft[0]+this.yyleng-Et]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(vt){this.unput(this.match.slice(vt))},pastInput:function(){var vt=this.matched.substr(0,this.matched.length-this.match.length);return(vt.length>20?"...":"")+vt.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var vt=this.match;return vt.length<20&&(vt+=this._input.substr(0,20-vt.length)),(vt.substr(0,20)+(vt.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var vt=this.pastInput(),Et=new Array(vt.length+1).join("-");return vt+this.upcomingInput()+`
`+Et+"^"},test_match:function(vt,Et){var Ot,Dt,Ft;if(this.options.backtrack_lexer&&(Ft={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(Ft.yylloc.range=this.yylloc.range.slice(0))),Dt=vt[0].match(/(?:\r\n?|\n).*/g),Dt&&(this.yylineno+=Dt.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:Dt?Dt[Dt.length-1].length-Dt[Dt.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+vt[0].length},this.yytext+=vt[0],this.match+=vt[0],this.matches=vt,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(vt[0].length),this.matched+=vt[0],Ot=this.performAction.call(this,this.yy,this,Et,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),Ot)return Ot;if(this._backtrack){for(var Xe in Ft)this[Xe]=Ft[Xe];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var vt,Et,Ot,Dt;this._more||(this.yytext="",this.match="");for(var Ft=this._currentRules(),Xe=0;Xe<Ft.length;Xe++)if(Ot=this._input.match(this.rules[Ft[Xe]]),Ot&&(!Et||Ot[0].length>Et[0].length)){if(Et=Ot,Dt=Xe,this.options.backtrack_lexer){if(vt=this.test_match(Ot,Ft[Xe]),vt!==!1)return vt;if(this._backtrack){Et=!1;continue}else return!1}else if(!this.options.flex)break}return Et?(vt=this.test_match(Et,Ft[Dt]),vt!==!1?vt:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var Et=this.next();return Et||this.lex()},begin:function(Et){this.conditionStack.push(Et)},popState:function(){var Et=this.conditionStack.length-1;return Et>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(Et){return Et=this.conditionStack.length-1-Math.abs(Et||0),Et>=0?this.conditionStack[Et]:"INITIAL"},pushState:function(Et){this.begin(Et)},stateStackSize:function(){return this.conditionStack.length},options:{flex:!0,"case-insensitive":!0},performAction:function(Et,Ot,Dt,Ft){switch(Dt){case 0:break;case 1:return 12;case 2:return 15;case 3:return 28;case 4:return 316;case 5:return 317;case 6:return 35;case 7:return 37;case 8:return 38;case 9:return 26;case 10:return 41;case 11:return 45;case 12:return 46;case 13:return 48;case 14:return 50;case 15:return 55;case 16:return 58;case 17:return 320;case 18:return 68;case 19:return 69;case 20:return 75;case 21:return 78;case 22:return 81;case 23:return 83;case 24:return 86;case 25:return 88;case 26:return 90;case 27:return 191;case 28:return 107;case 29:return 321;case 30:return 140;case 31:return 322;case 32:return 323;case 33:return 117;case 34:return 324;case 35:return 116;case 36:return 325;case 37:return 326;case 38:return 120;case 39:return 122;case 40:return 123;case 41:return 138;case 42:return 132;case 43:return 133;case 44:return 135;case 45:return 141;case 46:return 119;case 47:return 327;case 48:return 328;case 49:return 167;case 50:return 170;case 51:return 174;case 52:return 100;case 53:return 168;case 54:return 329;case 55:return 173;case 56:return 231;case 57:return 235;case 58:return 278;case 59:return 195;case 60:return 330;case 61:return 331;case 62:return 224;case 63:return 333;case 64:return 271;case 65:return 219;case 66:return 226;case 67:return 227;case 68:return 250;case 69:return 254;case 70:return 295;case 71:return 334;case 72:return 335;case 73:return 336;case 74:return 337;case 75:return 338;case 76:return 258;case 77:return 339;case 78:return 273;case 79:return 281;case 80:return 282;case 81:return 275;case 82:return 276;case 83:return 277;case 84:return 340;case 85:return 341;case 86:return 279;case 87:return 343;case 88:return 342;case 89:return 344;case 90:return 284;case 91:return 285;case 92:return 288;case 93:return 290;case 94:return 294;case 95:return 298;case 96:return 301;case 97:return 13;case 98:return 16;case 99:return 312;case 100:return 245;case 101:return 34;case 102:return 297;case 103:return 87;case 104:return 299;case 105:return 300;case 106:return 306;case 107:return 307;case 108:return 308;case 109:return 309;case 110:return 310;case 111:return 311;case 112:return"EXPONENT";case 113:return 302;case 114:return 303;case 115:return 304;case 116:return 305;case 117:return 93;case 118:return 246;case 119:return 6;case 120:return"INVALID";case 121:console.log(Ot.yytext);break}},rules:[/^(?:\s+|(#[^\n\r]*))/i,/^(?:BASE)/i,/^(?:PREFIX)/i,/^(?:SELECT)/i,/^(?:DISTINCT)/i,/^(?:REDUCED)/i,/^(?:\()/i,/^(?:AS)/i,/^(?:\))/i,/^(?:\*)/i,/^(?:CONSTRUCT)/i,/^(?:WHERE)/i,/^(?:\{)/i,/^(?:\})/i,/^(?:DESCRIBE)/i,/^(?:ASK)/i,/^(?:FROM)/i,/^(?:NAMED)/i,/^(?:GROUP)/i,/^(?:BY)/i,/^(?:HAVING)/i,/^(?:ORDER)/i,/^(?:ASC)/i,/^(?:DESC)/i,/^(?:LIMIT)/i,/^(?:OFFSET)/i,/^(?:VALUES)/i,/^(?:;)/i,/^(?:LOAD)/i,/^(?:SILENT)/i,/^(?:INTO)/i,/^(?:CLEAR)/i,/^(?:DROP)/i,/^(?:CREATE)/i,/^(?:ADD)/i,/^(?:TO)/i,/^(?:MOVE)/i,/^(?:COPY)/i,/^(?:INSERT((\s+|(#[^\n\r]*)\n\r?)+)DATA)/i,/^(?:DELETE((\s+|(#[^\n\r]*)\n\r?)+)DATA)/i,/^(?:DELETE((\s+|(#[^\n\r]*)\n\r?)+)WHERE)/i,/^(?:WITH)/i,/^(?:DELETE)/i,/^(?:INSERT)/i,/^(?:USING)/i,/^(?:DEFAULT)/i,/^(?:GRAPH)/i,/^(?:ALL)/i,/^(?:\.)/i,/^(?:OPTIONAL)/i,/^(?:SERVICE)/i,/^(?:BIND)/i,/^(?:UNDEF)/i,/^(?:MINUS)/i,/^(?:UNION)/i,/^(?:FILTER)/i,/^(?:<<)/i,/^(?:>>)/i,/^(?:,)/i,/^(?:a)/i,/^(?:\|)/i,/^(?:\/)/i,/^(?:\^)/i,/^(?:\?)/i,/^(?:\+)/i,/^(?:!)/i,/^(?:\[)/i,/^(?:\])/i,/^(?:\|\|)/i,/^(?:&&)/i,/^(?:=)/i,/^(?:!=)/i,/^(?:<)/i,/^(?:>)/i,/^(?:<=)/i,/^(?:>=)/i,/^(?:IN)/i,/^(?:NOT)/i,/^(?:-)/i,/^(?:BOUND)/i,/^(?:BNODE)/i,/^(?:(RAND|NOW|UUID|STRUUID))/i,/^(?:(LANG|DATATYPE|IRI|URI|ABS|CEIL|FLOOR|ROUND|STRLEN|STR|UCASE|LCASE|ENCODE_FOR_URI|YEAR|MONTH|DAY|HOURS|MINUTES|SECONDS|TIMEZONE|TZ|MD5|SHA1|SHA256|SHA384|SHA512|isIRI|isURI|isBLANK|isLITERAL|isNUMERIC))/i,/^(?:(LANGMATCHES|CONTAINS|STRSTARTS|STRENDS|STRBEFORE|STRAFTER|STRLANG|STRDT|sameTerm))/i,/^(?:CONCAT)/i,/^(?:COALESCE)/i,/^(?:IF)/i,/^(?:REGEX)/i,/^(?:SUBSTR)/i,/^(?:REPLACE)/i,/^(?:EXISTS)/i,/^(?:COUNT)/i,/^(?:SUM|MIN|MAX|AVG|SAMPLE)/i,/^(?:GROUP_CONCAT)/i,/^(?:SEPARATOR)/i,/^(?:\^\^)/i,/^(?:true|false)/i,/^(?:(<(?:[^<>\"\{\}\|\^`\\\u0000-\u0020])*>))/i,/^(?:((([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.)*(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040]))?)?:))/i,/^(?:(((([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.)*(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040]))?)?:)((?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|:|[0-9]|((%([0-9A-Fa-f])([0-9A-Fa-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.|:|((%([0-9A-Fa-f])([0-9A-Fa-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%))))*(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|:|((%([0-9A-Fa-f])([0-9A-Fa-f]))|(\\(_|~|\.|-|!|\$|&|'|\(|\)|\*|\+|,|;|=|\/|\?|#|@|%)))))?)))/i,/^(?:(_:(?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|[0-9])(?:(?:(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])|\.)*(((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|-|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040]))?))/i,/^(?:([\?\$]((?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|[0-9])(?:((?:([A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])|_))|[0-9]|\u00B7|[\u0300-\u036F\u203F-\u2040])*)))/i,/^(?:(@[a-zA-Z]+(?:-[a-zA-Z0-9]+)*))/i,/^(?:([0-9]+))/i,/^(?:([0-9]*\.[0-9]+))/i,/^(?:([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.([0-9])+([eE][+-]?[0-9]+)|([0-9])+([eE][+-]?[0-9]+)))/i,/^(?:(\+([0-9]+)))/i,/^(?:(\+([0-9]*\.[0-9]+)))/i,/^(?:(\+([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.([0-9])+([eE][+-]?[0-9]+)|([0-9])+([eE][+-]?[0-9]+))))/i,/^(?:(-([0-9]+)))/i,/^(?:(-([0-9]*\.[0-9]+)))/i,/^(?:(-([0-9]+\.[0-9]*([eE][+-]?[0-9]+)|\.([0-9])+([eE][+-]?[0-9]+)|([0-9])+([eE][+-]?[0-9]+))))/i,/^(?:([eE][+-]?[0-9]+))/i,/^(?:('(?:(?:[^\u0027\u005C\u000A\u000D])|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])))*'))/i,/^(?:("(?:(?:[^\u0022\u005C\u000A\u000D])|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])))*"))/i,/^(?:('''(?:(?:'|'')?(?:[^'\\]|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f]))))*'''))/i,/^(?:("""(?:(?:"|"")?(?:[^\"\\]|(\\[tbnrf\\\"']|\\u([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])|\\U([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f]))))*"""))/i,/^(?:(\((\u0020|\u0009|\u000D|\u000A)*\)))/i,/^(?:(\[(\u0020|\u0009|\u000D|\u000A)*\]))/i,/^(?:$)/i,/^(?:.)/i,/^(?:.)/i],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121],inclusive:!0}}};return bt}();Ar.lexer=Mi;function $t(){this.yy={}}return $t.prototype=Ar,Ar.Parser=$t,new $t}(),SparqlParser_1=SparqlParser,XSD_INTEGER="http://www.w3.org/2001/XMLSchema#integer",XSD_STRING="http://www.w3.org/2001/XMLSchema#string";function Generator$1(U){this._options=U=U||{};var D=U.prefixes||{};this._prefixByIri={};var F=[];for(var G in D){var Q=D[G];isString$1(Q)&&(this._prefixByIri[Q]=G,F.push(Q))}var X=F.join("|").replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&");this._prefixRegex=new RegExp("^("+X+")([a-zA-Z][\\-_a-zA-Z0-9]*)$"),this._usedPrefixes={},this._sparqlStar=U.sparqlStar,this._indent=isString$1(U.indent)?U.indent:"  ",this._newline=isString$1(U.newline)?U.newline:`
`,this._explicitDatatype=!!U.explicitDatatype}Generator$1.prototype.toQuery=function(U){var D="";return U.queryType&&(D+=U.queryType.toUpperCase()+" "),U.reduced&&(D+="REDUCED "),U.distinct&&(D+="DISTINCT "),U.variables?D+=mapJoin(U.variables,void 0,function(F){return isTerm$1(F)?this.toEntity(F):"("+this.toExpression(F.expression)+" AS "+variableToString(F.variable)+")"},this)+" ":U.template&&(D+=this.group(U.template,!0)+this._newline),U.from&&(D+=this.graphs("FROM ",U.from.default)+this.graphs("FROM NAMED ",U.from.named)),U.where&&(D+="WHERE "+this.group(U.where,!0)+this._newline),U.updates&&(D+=mapJoin(U.updates,";"+this._newline,this.toUpdate,this)),U.group&&(D+="GROUP BY "+mapJoin(U.group,void 0,function(F){var G=isTerm$1(F.expression)?this.toEntity(F.expression):"("+this.toExpression(F.expression)+")";return F.variable?"("+G+" AS "+variableToString(F.variable)+")":G},this)+this._newline),U.having&&(D+="HAVING ("+mapJoin(U.having,void 0,this.toExpression,this)+")"+this._newline),U.order&&(D+="ORDER BY "+mapJoin(U.order,void 0,function(F){var G="("+this.toExpression(F.expression)+")";return F.descending?"DESC "+G:G},this)+this._newline),U.offset&&(D+="OFFSET "+U.offset+this._newline),U.limit&&(D+="LIMIT "+U.limit+this._newline),U.values&&(D+=this.values(U)),D=this.baseAndPrefixes(U)+D,D.trim()};Generator$1.prototype.baseAndPrefixes=function(U){var D=U.base?"BASE <"+U.base+">"+this._newline:"",F="";for(var G in U.prefixes)(this._options.allPrefixes||this._usedPrefixes[G])&&(F+="PREFIX "+G+": <"+U.prefixes[G]+">"+this._newline);return D+F};Generator$1.prototype.toPattern=function(U){var D=U.type||U instanceof Array&&"array"||(U.subject&&U.predicate&&U.object?"triple":"");if(!(D in this))throw new Error("Unknown entry type: "+D);return this[D](U)};Generator$1.prototype.triple=function(U){return this.toEntity(U.subject)+" "+this.toEntity(U.predicate)+" "+this.toEntity(U.object)+"."};Generator$1.prototype.array=function(U){return mapJoin(U,this._newline,this.toPattern,this)};Generator$1.prototype.bgp=function(U){return this.encodeTriples(U.triples)};Generator$1.prototype.encodeTriples=function(U){if(!U.length)return"";for(var D=[],F=void 0,G=void 0,Q=0;Q<U.length;Q++){var X=U[Q];equalTerms(X.subject,F)?equalTerms(X.predicate,G)?D.push(","):(G=X.predicate,D.push(";"+this._newline,this._indent,this.toEntity(G))):(F&&D.push("."+this._newline),F=X.subject,G=X.predicate,D.push(this.toEntity(F)," ",this.toEntity(G))),D.push(" ",this.toEntity(X.object))}return D.push("."),D.join("")};Generator$1.prototype.graph=function(U){return"GRAPH "+this.toEntity(U.name)+" "+this.group(U)};Generator$1.prototype.graphs=function(U,D){return!D||D.length===0?"":mapJoin(D,"",function(F){return U+this.toEntity(F)+this._newline},this)};Generator$1.prototype.group=function(U,D){return U=D!==!0?this.array(U.patterns||U.triples):this.toPattern(U.type!=="group"?U:U.patterns),U.indexOf(this._newline)===-1?"{ "+U+" }":"{"+this._newline+this.indent(U)+this._newline+"}"};Generator$1.prototype.query=function(U){return this.toQuery(U)};Generator$1.prototype.filter=function(U){return"FILTER("+this.toExpression(U.expression)+")"};Generator$1.prototype.bind=function(U){return"BIND("+this.toExpression(U.expression)+" AS "+variableToString(U.variable)+")"};Generator$1.prototype.optional=function(U){return"OPTIONAL "+this.group(U)};Generator$1.prototype.union=function(U){return mapJoin(U.patterns,this._newline+"UNION"+this._newline,function(D){return this.group(D,!0)},this)};Generator$1.prototype.minus=function(U){return"MINUS "+this.group(U)};Generator$1.prototype.values=function(U){var D=Object.keys(U.values.reduce(function(Q,X){for(var q in X)Q[q]=!0;return Q},{})),F,G;return D.length===1?F=G="":(F="(",G=")"),"VALUES "+F+D.join(" ")+G+" {"+this._newline+mapJoin(U.values,this._newline,function(Q){return"  "+F+mapJoin(D,void 0,function(X){return Q[X]?this.toEntity(Q[X]):"UNDEF"},this)+G},this)+this._newline+"}"};Generator$1.prototype.service=function(U){return"SERVICE "+(U.silent?"SILENT ":"")+this.toEntity(U.name)+" "+this.group(U)};Generator$1.prototype.toExpression=function(U){if(isTerm$1(U))return this.toEntity(U);switch(U.type.toLowerCase()){case"aggregate":return U.aggregation.toUpperCase()+"("+(U.distinct?"DISTINCT ":"")+this.toExpression(U.expression)+(typeof U.separator=="string"?'; SEPARATOR = "'+U.separator.replace(escape,escapeReplacer)+'"':"")+")";case"functioncall":return this.toEntity(U.function)+"("+mapJoin(U.args,", ",this.toExpression,this)+")";case"operation":var D=U.operator.toUpperCase(),F=U.args||[];switch(U.operator.toLowerCase()){case"<":case">":case">=":case"<=":case"&&":case"||":case"=":case"!=":case"+":case"-":case"*":case"/":return(isTerm$1(F[0])?this.toEntity(F[0]):"("+this.toExpression(F[0])+")")+" "+D+" "+(isTerm$1(F[1])?this.toEntity(F[1]):"("+this.toExpression(F[1])+")");case"!":return"!("+this.toExpression(F[0])+")";case"uplus":return"+("+this.toExpression(F[0])+")";case"uminus":return"-("+this.toExpression(F[0])+")";case"notin":D="NOT IN";case"in":return this.toExpression(F[0])+" "+D+"("+(isString$1(F[1])?F[1]:mapJoin(F[1],", ",this.toExpression,this))+")";case"notexists":D="NOT EXISTS";case"exists":return D+" "+this.group(F[0],!0);default:return D+"("+mapJoin(F,", ",this.toExpression,this)+")"}default:throw new Error("Unknown expression type: "+U.type)}};Generator$1.prototype.toEntity=function(U){if(isTerm$1(U))switch(U.termType){case"Wildcard":return"*";case"Variable":return variableToString(U);case"BlankNode":return"_:"+U.value;case"Literal":var D=U.value||"",F=U.language||"",G=U.datatype;if(U='"'+D.replace(escape,escapeReplacer)+'"',F)U+="@"+F;else if(G){if(!this._explicitDatatype)switch(G.value){case XSD_STRING:return U;case XSD_INTEGER:if(/^\d+$/.test(D))return D+" "}U+="^^"+this.encodeIRI(G.value)}return U;case"Quad":if(!this._sparqlStar)throw new Error("SPARQL* support is not enabled");return U.graph&&U.graph.termType!=="DefaultGraph"?"<< GRAPH "+this.toEntity(U.graph)+" { "+this.toEntity(U.subject)+" "+this.toEntity(U.predicate)+" "+this.toEntity(U.object)+" }  >>":"<< "+this.toEntity(U.subject)+" "+this.toEntity(U.predicate)+" "+this.toEntity(U.object)+" >>";default:return this.encodeIRI(U.value)}else{var Q=U.items.map(this.toEntity,this),X=U.pathType;switch(X){case"^":case"!":return X+Q[0];case"*":case"+":case"?":return"("+Q[0]+X+")";default:return"("+Q.join(X)+")"}}};var escape=/["\\\t\n\r\b\f]/g,escapeReplacer=function(U){return escapeReplacements[U]},escapeReplacements={"\\":"\\\\",'"':'\\"',"	":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};Generator$1.prototype.encodeIRI=function(U){var D=this._prefixRegex.exec(U);if(D){var F=this._prefixByIri[D[1]];return this._usedPrefixes[F]=!0,F+":"+D[2]}return"<"+U+">"};Generator$1.prototype.toUpdate=function(U){switch(U.type||U.updateType){case"load":return"LOAD"+(U.source?" "+this.toEntity(U.source):"")+(U.destination?" INTO GRAPH "+this.toEntity(U.destination):"");case"insert":return"INSERT DATA "+this.group(U.insert,!0);case"delete":return"DELETE DATA "+this.group(U.delete,!0);case"deletewhere":return"DELETE WHERE "+this.group(U.delete,!0);case"insertdelete":return(U.graph?"WITH "+this.toEntity(U.graph)+this._newline:"")+(U.delete.length?"DELETE "+this.group(U.delete,!0)+this._newline:"")+(U.insert.length?"INSERT "+this.group(U.insert,!0)+this._newline:"")+(U.using?this.graphs("USING ",U.using.default):"")+(U.using?this.graphs("USING NAMED ",U.using.named):"")+"WHERE "+this.group(U.where,!0);case"add":case"copy":case"move":return U.type.toUpperCase()+" "+(U.silent?"SILENT ":"")+(U.source.default?"DEFAULT":this.toEntity(U.source.name))+" TO "+this.toEntity(U.destination.name);case"create":case"clear":case"drop":return U.type.toUpperCase()+(U.silent?" SILENT ":" ")+(U.graph.default?"DEFAULT":U.graph.named?"NAMED":U.graph.all?"ALL":"GRAPH "+this.toEntity(U.graph.name));default:throw new Error("Unknown update query type: "+U.type)}};Generator$1.prototype.indent=function(U){return U.replace(/^/gm,this._indent)};function variableToString(U){return"?"+U.value}function isString$1(U){return typeof U=="string"}function isTerm$1(U){return typeof U.termType=="string"}function equalTerms(U,D){if(!U||!isTerm$1(U)||!D||!isTerm$1(D)||U.termType!==D.termType)return!1;switch(U.termType){case"Literal":return U.value===D.value&&U.language===D.language&&equalTerms(U.datatype,D.datatype);case"Quad":return equalTerms(U.subject,D.subject)&&equalTerms(U.predicate,D.predicate)&&equalTerms(U.object,D.object)&&equalTerms(U.graph,D.graph);default:return U.value===D.value}}function mapJoin(U,D,F,G){return U.map(F,G).join(isString$1(D)?D:" ")}var SparqlGenerator=function(D={}){return{stringify:function(F){var G=Object.create(D);return G.prefixes=F.prefixes,new Generator$1(G).toQuery(F)},createGenerator:function(){return new Generator$1(D)}}},Parser$1=SparqlParser_1.Parser,Generator=SparqlGenerator,Wildcard=Wildcard$2.Wildcard,{DataFactory}=rdfDataFactory,sparql$1={Parser:function({prefixes:U,baseIRI:D,factory:F,sparqlStar:G,skipValidation:Q,skipUngroupedVariableCheck:X,pathOnly:q}={}){var W={};for(var Y in U||{})W[Y]=U[Y];var J=new Parser$1;return J.parse=function(){return Parser$1.base=D||"",Parser$1.prefixes=Object.create(W),Parser$1.factory=F||new DataFactory,Parser$1.sparqlStar=!!G,Parser$1.pathOnly=!!q,Parser$1.skipValidation=!!Q||!!X,Parser$1.prototype.parse.apply(J,arguments)},J._resetBlanks=Parser$1._resetBlanks,J},Generator,Wildcard};const __QUADSTORE_COMUNICA_EXTERNAL_MODULE_sparqljs__=_mergeNamespaces({__proto__:null,default:sparql$1},[sparql$1]);var __createBinding$2=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(U,D,F,G){G===void 0&&(G=F);var Q=Object.getOwnPropertyDescriptor(D,F);(!Q||("get"in Q?!D.__esModule:Q.writable||Q.configurable))&&(Q={enumerable:!0,get:function(){return D[F]}}),Object.defineProperty(U,G,Q)}:function(U,D,F,G){G===void 0&&(G=F),U[G]=D[F]}),__setModuleDefault$2=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(U,D){Object.defineProperty(U,"default",{enumerable:!0,value:D})}:function(U,D){U.default=D}),__importStar$2=commonjsGlobal&&commonjsGlobal.__importStar||function(U){if(U&&U.__esModule)return U;var D={};if(U!=null)for(var F in U)F!=="default"&&Object.prototype.hasOwnProperty.call(U,F)&&__createBinding$2(D,U,F);return __setModuleDefault$2(D,U),D};Object.defineProperty(factory$2,"__esModule",{value:!0});const A$1=__importStar$2(algebra),rdf_data_factory_1$1=rdfDataFactory,rdf_string_1$4=rdfString,sparqljs_1$1=sparql$1;class Factory{constructor(D){this.dataFactory=D||new rdf_data_factory_1$1.DataFactory,this.stringType=this.createTerm("http://www.w3.org/2001/XMLSchema#string")}createAlt(D,F=!0){return this.flattenMulti({type:A$1.types.ALT,input:D},F)}createAsk(D){return{type:A$1.types.ASK,input:D}}createBoundAggregate(D,F,G,Q,X){const q=this.createAggregateExpression(F,G,Q,X);return q.variable=D,q}createBgp(D){return{type:A$1.types.BGP,patterns:D}}createConstruct(D,F){return{type:A$1.types.CONSTRUCT,input:D,template:F}}createDescribe(D,F){return{type:A$1.types.DESCRIBE,input:D,terms:F}}createDistinct(D){return{type:A$1.types.DISTINCT,input:D}}createExtend(D,F,G){return{type:A$1.types.EXTEND,input:D,variable:F,expression:G}}createFrom(D,F,G){return{type:A$1.types.FROM,input:D,default:F,named:G}}createFilter(D,F){return{type:A$1.types.FILTER,input:D,expression:F}}createGraph(D,F){return{type:A$1.types.GRAPH,input:D,name:F}}createGroup(D,F,G){return{type:A$1.types.GROUP,input:D,variables:F,aggregates:G}}createInv(D){return{type:A$1.types.INV,path:D}}createJoin(D,F=!0){return this.flattenMulti({type:A$1.types.JOIN,input:D},F)}createLeftJoin(D,F,G){return G?{type:A$1.types.LEFT_JOIN,input:[D,F],expression:G}:{type:A$1.types.LEFT_JOIN,input:[D,F]}}createLink(D){return{type:A$1.types.LINK,iri:D}}createMinus(D,F){return{type:A$1.types.MINUS,input:[D,F]}}createNop(){return{type:A$1.types.NOP}}createNps(D){return{type:A$1.types.NPS,iris:D}}createOneOrMorePath(D){return{type:A$1.types.ONE_OR_MORE_PATH,path:D}}createOrderBy(D,F){return{type:A$1.types.ORDER_BY,input:D,expressions:F}}createPath(D,F,G,Q){return Q?{type:A$1.types.PATH,subject:D,predicate:F,object:G,graph:Q}:{type:A$1.types.PATH,subject:D,predicate:F,object:G,graph:this.dataFactory.defaultGraph()}}createPattern(D,F,G,Q){const X=this.dataFactory.quad(D,F,G,Q);return X.type=A$1.types.PATTERN,X}createProject(D,F){return{type:A$1.types.PROJECT,input:D,variables:F}}createReduced(D){return{type:A$1.types.REDUCED,input:D}}createSeq(D,F=!0){return this.flattenMulti({type:A$1.types.SEQ,input:D},F)}createService(D,F,G){return{type:A$1.types.SERVICE,input:D,name:F,silent:!!G}}createSlice(D,F,G){return F=F||0,G!==void 0?{type:A$1.types.SLICE,input:D,start:F,length:G}:{type:A$1.types.SLICE,input:D,start:F}}createUnion(D,F=!0){return this.flattenMulti({type:A$1.types.UNION,input:D},F)}createValues(D,F){return{type:A$1.types.VALUES,variables:D,bindings:F}}createZeroOrMorePath(D){return{type:A$1.types.ZERO_OR_MORE_PATH,path:D}}createZeroOrOnePath(D){return{type:A$1.types.ZERO_OR_ONE_PATH,path:D}}createAggregateExpression(D,F,G,Q){return Q?{type:A$1.types.EXPRESSION,expressionType:A$1.expressionTypes.AGGREGATE,aggregator:D,expression:F,separator:Q,distinct:G}:{type:A$1.types.EXPRESSION,expressionType:A$1.expressionTypes.AGGREGATE,aggregator:D,expression:F,distinct:G}}createExistenceExpression(D,F){return{type:A$1.types.EXPRESSION,expressionType:A$1.expressionTypes.EXISTENCE,not:D,input:F}}createNamedExpression(D,F){return{type:A$1.types.EXPRESSION,expressionType:A$1.expressionTypes.NAMED,name:D,args:F}}createOperatorExpression(D,F){return{type:A$1.types.EXPRESSION,expressionType:A$1.expressionTypes.OPERATOR,operator:D,args:F}}createTermExpression(D){return{type:A$1.types.EXPRESSION,expressionType:A$1.expressionTypes.TERM,term:D}}createWildcardExpression(){return{type:A$1.types.EXPRESSION,expressionType:A$1.expressionTypes.WILDCARD,wildcard:new sparqljs_1$1.Wildcard}}createTerm(D){return(0,rdf_string_1$4.stringToTerm)(D,this.dataFactory)}createCompositeUpdate(D){return{type:A$1.types.COMPOSITE_UPDATE,updates:D}}createDeleteInsert(D,F,G){const Q={type:A$1.types.DELETE_INSERT};return D&&(Q.delete=D),F&&(Q.insert=F),G&&(Q.where=G),Q}createLoad(D,F,G){const Q={type:A$1.types.LOAD,source:D};return F&&(Q.destination=F),this.addSilent(Q,!!G)}createClear(D,F){return this.addSilent({type:A$1.types.CLEAR,source:D},!!F)}createCreate(D,F){return this.addSilent({type:A$1.types.CREATE,source:D},!!F)}createDrop(D,F){return this.addSilent({type:A$1.types.DROP,source:D},!!F)}createAdd(D,F,G){return this.addSilent({type:A$1.types.ADD,source:D,destination:F},!!G)}createMove(D,F,G){return this.addSilent({type:A$1.types.MOVE,source:D,destination:F},!!G)}createCopy(D,F,G){return this.addSilent({type:A$1.types.COPY,source:D,destination:F},!!G)}addSilent(D,F){return F&&(D.silent=F),D}flattenMulti(D,F){if(!F)return D;const G=D.type,Q=D.input;let X=[];for(const q of Q)q.type===G?X.push(...q.input):X.push(q);return D.input=X,D}}factory$2.default=Factory;var util={},__importDefault$2=commonjsGlobal&&commonjsGlobal.__importDefault||function(U){return U&&U.__esModule?U:{default:U}};Object.defineProperty(util,"__esModule",{value:!0});const algebra_1=algebra,factory_1$2=__importDefault$2(factory$2);class Util{static flatten(D){return Array.prototype.concat(...D).filter(F=>F)}static objectify(D){if(D.termType){if(D.termType==="Quad")return{type:"pattern",termType:"Quad",subject:Util.objectify(D.subject),predicate:Util.objectify(D.predicate),object:Util.objectify(D.object),graph:Util.objectify(D.graph)};{let F={termType:D.termType,value:D.value};return D.language&&(F.language=D.language),D.datatype&&(F.datatype=Util.objectify(D.datatype)),F}}if(Array.isArray(D))return D.map(F=>Util.objectify(F));if(D===Object(D)){let F={};for(let G of Object.keys(D))F[G]=Util.objectify(D[G]);return F}return D}static inScopeVariables(D){const F=[];function G(X){F.find(q=>X.value===q.value)||F.push(X)}function Q(X){X.subject.termType==="Variable"&&G(X.subject),X.predicate.termType==="Variable"&&G(X.predicate),X.object.termType==="Variable"&&G(X.object),X.graph.termType==="Variable"&&G(X.graph),X.subject.termType==="Quad"&&Q(X.subject),X.predicate.termType==="Quad"&&Q(X.predicate),X.object.termType==="Quad"&&Q(X.object),X.graph.termType==="Quad"&&Q(X.graph)}return Util.recurseOperation(D,{[algebra_1.types.EXPRESSION]:X=>(X.expressionType===algebra_1.expressionTypes.AGGREGATE&&X.variable&&G(X.variable),!0),[algebra_1.types.EXTEND]:X=>(G(X.variable),!0),[algebra_1.types.GRAPH]:X=>(X.name.termType==="Variable"&&G(X.name),!0),[algebra_1.types.GROUP]:X=>(X.variables.forEach(G),!0),[algebra_1.types.PATH]:X=>(X.subject.termType==="Variable"&&G(X.subject),X.object.termType==="Variable"&&G(X.object),X.graph.termType==="Variable"&&G(X.graph),X.subject.termType==="Quad"&&Q(X.subject),X.object.termType==="Quad"&&Q(X.object),X.graph.termType==="Quad"&&Q(X.graph),!0),[algebra_1.types.PATTERN]:X=>(Q(X),!0),[algebra_1.types.PROJECT]:X=>(X.variables.forEach(G),!1),[algebra_1.types.SERVICE]:X=>(X.name.termType==="Variable"&&G(X.name),!0),[algebra_1.types.VALUES]:X=>(X.variables.forEach(G),!0)}),F}static recurseOperation(D,F){let G=D,Q=!0;const X=F[D.type];if(X&&(Q=X(D)),!Q)return;let q=W=>Util.recurseOperation(W,F);switch(G.type){case algebra_1.types.ALT:G.input.map(q);break;case algebra_1.types.ASK:q(G.input);break;case algebra_1.types.BGP:G.patterns.forEach(q);break;case algebra_1.types.CONSTRUCT:q(G.input),G.template.map(q);break;case algebra_1.types.DESCRIBE:q(G.input);break;case algebra_1.types.DISTINCT:q(G.input);break;case algebra_1.types.EXPRESSION:G.expressionType===algebra_1.expressionTypes.EXISTENCE&&q(G.input);break;case algebra_1.types.EXTEND:q(G.input),q(G.expression);break;case algebra_1.types.FILTER:q(G.input),q(G.expression);break;case algebra_1.types.FROM:q(G.input);break;case algebra_1.types.GRAPH:q(G.input);break;case algebra_1.types.GROUP:q(G.input),G.aggregates.forEach(q);break;case algebra_1.types.INV:q(G.path);break;case algebra_1.types.JOIN:G.input.map(q);break;case algebra_1.types.LEFT_JOIN:G.input.map(q),G.expression&&q(G.expression);break;case algebra_1.types.LINK:break;case algebra_1.types.MINUS:G.input.map(q);break;case algebra_1.types.NOP:break;case algebra_1.types.NPS:break;case algebra_1.types.ONE_OR_MORE_PATH:q(G.path);break;case algebra_1.types.ORDER_BY:q(G.input),G.expressions.forEach(q);break;case algebra_1.types.PATH:q(G.predicate);break;case algebra_1.types.PATTERN:break;case algebra_1.types.PROJECT:q(G.input);break;case algebra_1.types.REDUCED:q(G.input);break;case algebra_1.types.SEQ:G.input.map(q);break;case algebra_1.types.SERVICE:q(G.input);break;case algebra_1.types.SLICE:q(G.input);break;case algebra_1.types.UNION:G.input.map(q);break;case algebra_1.types.VALUES:break;case algebra_1.types.ZERO_OR_MORE_PATH:q(G.path);break;case algebra_1.types.ZERO_OR_ONE_PATH:q(G.path);break;case algebra_1.types.COMPOSITE_UPDATE:G.updates.forEach(W=>q(W));break;case algebra_1.types.DELETE_INSERT:G.delete&&G.delete.forEach(W=>q(W)),G.insert&&G.insert.forEach(W=>q(W)),G.where&&q(G.where);break;case algebra_1.types.LOAD:break;case algebra_1.types.CLEAR:break;case algebra_1.types.CREATE:break;case algebra_1.types.DROP:break;case algebra_1.types.ADD:break;case algebra_1.types.MOVE:break;case algebra_1.types.COPY:break;default:throw new Error(`Unknown Operation type ${G.type}`)}}static mapOperation(D,F,G){let Q=D,X=!0;G=G||new factory_1$2.default;const q=F[D.type];if(q&&({result:Q,recurse:X}=q(D,G)),!X)return Q;let W=Y=>Util.mapOperation(Y,F,G);switch(Q.type){case algebra_1.types.ALT:return G.createAlt(Q.input.map(W));case algebra_1.types.ASK:return G.createAsk(W(Q.input));case algebra_1.types.BGP:return G.createBgp(Q.patterns.map(W));case algebra_1.types.CONSTRUCT:return G.createConstruct(W(Q.input),Q.template.map(W));case algebra_1.types.DESCRIBE:return G.createDescribe(W(Q.input),Q.terms);case algebra_1.types.DISTINCT:return G.createDistinct(W(Q.input));case algebra_1.types.EXPRESSION:return Util.mapExpression(Q,F,G);case algebra_1.types.EXTEND:return G.createExtend(W(Q.input),Q.variable,W(Q.expression));case algebra_1.types.FILTER:return G.createFilter(W(Q.input),W(Q.expression));case algebra_1.types.FROM:return G.createFrom(W(Q.input),[...Q.default],[...Q.named]);case algebra_1.types.GRAPH:return G.createGraph(W(Q.input),Q.name);case algebra_1.types.GROUP:return G.createGroup(W(Q.input),[].concat(Q.variables),Q.aggregates.map(W));case algebra_1.types.INV:return G.createInv(W(Q.path));case algebra_1.types.JOIN:return G.createJoin(Q.input.map(W));case algebra_1.types.LEFT_JOIN:return G.createLeftJoin(W(Q.input[0]),W(Q.input[1]),Q.expression?W(Q.expression):void 0);case algebra_1.types.LINK:return G.createLink(Q.iri);case algebra_1.types.MINUS:return G.createMinus(W(Q.input[0]),W(Q.input[1]));case algebra_1.types.NOP:return G.createNop();case algebra_1.types.NPS:return G.createNps([].concat(Q.iris));case algebra_1.types.ONE_OR_MORE_PATH:return G.createOneOrMorePath(W(Q.path));case algebra_1.types.ORDER_BY:return G.createOrderBy(W(Q.input),Q.expressions.map(W));case algebra_1.types.PATH:return G.createPath(Q.subject,W(Q.predicate),Q.object,Q.graph);case algebra_1.types.PATTERN:return G.createPattern(Q.subject,Q.predicate,Q.object,Q.graph);case algebra_1.types.PROJECT:return G.createProject(W(Q.input),[...Q.variables]);case algebra_1.types.REDUCED:return G.createReduced(W(Q.input));case algebra_1.types.SEQ:return G.createSeq(Q.input.map(W));case algebra_1.types.SERVICE:return G.createService(W(Q.input),Q.name,Q.silent);case algebra_1.types.SLICE:return G.createSlice(W(Q.input),Q.start,Q.length);case algebra_1.types.UNION:return G.createUnion(Q.input.map(W));case algebra_1.types.VALUES:return G.createValues([].concat(Q.variables),Q.bindings.map(Y=>Object.assign({},Y)));case algebra_1.types.ZERO_OR_MORE_PATH:return G.createZeroOrMorePath(W(Q.path));case algebra_1.types.ZERO_OR_ONE_PATH:return G.createZeroOrOnePath(W(Q.path));case algebra_1.types.COMPOSITE_UPDATE:return G.createCompositeUpdate(Q.updates.map(W));case algebra_1.types.DELETE_INSERT:return G.createDeleteInsert(Q.delete?Q.delete.map(W):void 0,Q.insert?Q.insert.map(W):void 0,Q.where?W(Q.where):void 0);case algebra_1.types.LOAD:return G.createLoad(Q.source,Q.destination,Q.silent);case algebra_1.types.CLEAR:return G.createClear(Q.source,Q.silent);case algebra_1.types.CREATE:return G.createCreate(Q.source,Q.silent);case algebra_1.types.DROP:return G.createDrop(Q.source,Q.silent);case algebra_1.types.ADD:return G.createAdd(Q.source,Q.destination);case algebra_1.types.MOVE:return G.createMove(Q.source,Q.destination);case algebra_1.types.COPY:return G.createCopy(Q.source,Q.destination);default:throw new Error(`Unknown Operation type ${Q.type}`)}}static mapExpression(D,F,G){let Q=X=>Util.mapOperation(X,F,G);switch(D.expressionType){case algebra_1.expressionTypes.AGGREGATE:return D.variable?G.createBoundAggregate(D.variable,D.aggregator,Q(D.expression),D.distinct,D.separator):G.createAggregateExpression(D.aggregator,Q(D.expression),D.distinct,D.separator);case algebra_1.expressionTypes.EXISTENCE:return G.createExistenceExpression(D.not,Q(D.input));case algebra_1.expressionTypes.NAMED:return G.createNamedExpression(D.name,D.args.map(Q));case algebra_1.expressionTypes.OPERATOR:return G.createOperatorExpression(D.operator,D.args.map(Q));case algebra_1.expressionTypes.TERM:return G.createTermExpression(D.term);case algebra_1.expressionTypes.WILDCARD:return G.createWildcardExpression();default:throw new Error(`Unknown Expression type ${D.expressionType}`)}}static createUniqueVariable(D,F,G){let Q=0,X=D;for(;F[X];)X=`${D}${Q++}`;return G.variable(X)}static isSimpleTerm(D){return D.termType!==void 0&&D.termType!=="Quad"&&D.termType!=="Wildcard"}static isQuad(D){return D.termType==="Quad"}static isWildcard(D){return D.termType==="Wildcard"}}util.default=Util;var __createBinding$1=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(U,D,F,G){G===void 0&&(G=F);var Q=Object.getOwnPropertyDescriptor(D,F);(!Q||("get"in Q?!D.__esModule:Q.writable||Q.configurable))&&(Q={enumerable:!0,get:function(){return D[F]}}),Object.defineProperty(U,G,Q)}:function(U,D,F,G){G===void 0&&(G=F),U[G]=D[F]}),__setModuleDefault$1=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(U,D){Object.defineProperty(U,"default",{enumerable:!0,value:D})}:function(U,D){U.default=D}),__importStar$1=commonjsGlobal&&commonjsGlobal.__importStar||function(U){if(U&&U.__esModule)return U;var D={};if(U!=null)for(var F in U)F!=="default"&&Object.prototype.hasOwnProperty.call(U,F)&&__createBinding$1(D,U,F);return __setModuleDefault$1(D,U),D},__importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(U){return U&&U.__esModule?U:{default:U}};Object.defineProperty(sparqlAlgebra,"__esModule",{value:!0});const equal=es6,rdf_string_1$3=rdfString,Algebra$1=__importStar$1(algebra),factory_1$1=__importDefault$1(factory$2),util_1$1=__importDefault$1(util),Parser=sparql$1.Parser,types$1=Algebra$1.types;let variables=new Set,varCount=0,useQuads=!1,factory$1;function translate$1(U,D){D=D||{},factory$1=new factory_1$1.default(D.dataFactory);let F;if(isString(U)){let G=new Parser(D);G._resetBlanks(),F=G.parse(U)}else F=U;return translateQuery(F,D.quads,D.blankToVariable)}sparqlAlgebra.default=translate$1;function translateQuery(U,D,F){if(variables=new Set,varCount=0,useQuads=!!D,!U.type)return factory$1.createNop();if(U.type!=="query"&&U.type!=="update")throw new Error("Translate only works on complete query or update objects.");let G;if(findAllVariables(U),U.type==="query"){const Q={type:"group",patterns:U.where||[]};G=translateGroupGraphPattern(Q),G=translateAggregates(U,G)}else U.type==="update"&&(G=translateUpdate(U));return F&&(G=translateBlankNodesToVariables(G)),G}function isString(U){return typeof U=="string"}function isTerm(U){return!!U?.termType}function isTriple(U){return U.subject&&U.predicate&&U.object}function isVariable(U){return U?.termType==="Variable"}function findAllVariables(U){if(isTerm(U))isVariable(U)&&variables.add(`?${U.value}`);else if(Array.isArray(U))for(const D of U)findAllVariables(D);else if(U&&typeof U=="object")for(let D of Object.keys(U))D.startsWith("?")&&variables.add(D),findAllVariables(U[D])}function inScopeVariables(U){let D={};if(isTriple(U)){const F=[inScopeVariables(U.subject),inScopeVariables(U.predicate),inScopeVariables(U.object),U.graph?inScopeVariables(U.graph):{}];Object.assign(D,...F)}else if(isTerm(U))isVariable(U)&&(D[U.value]=U);else if(U.type==="bgp"){const F=U.triples;Object.assign(D,...F.map(inScopeVariables))}else if(U.type==="path")Object.assign(D,...U.items.map(inScopeVariables));else if(U.type==="group"||U.type==="union"||U.type==="optional")Object.assign(D,...U.patterns.map(inScopeVariables));else if(U.type==="service"||U.type==="graph")Object.assign(D,inScopeVariables(U.name)),Object.assign(D,...U.patterns.map(inScopeVariables));else if(U.type==="bind")Object.assign(D,inScopeVariables(U.variable));else if(U.type==="values"){if(U.values.length>0){const F=Object.keys(U.values[0]).map(G=>factory$1.createTerm(G));Object.assign(D,...F.map(inScopeVariables))}}else if(U.type==="query"&&(U.queryType==="SELECT"||U.queryType==="DESCRIBE")){U.where&&U.variables.some(util_1$1.default.isWildcard)&&Object.assign(D,...U.where.map(inScopeVariables));for(const F of U.variables)isVariable(F)?Object.assign(D,inScopeVariables(F)):F.variable&&Object.assign(D,inScopeVariables(F.variable));if(U.queryType==="SELECT"){if(U.group)for(const F of U.group)F.variable&&Object.assign(D,inScopeVariables(F.variable));if(U.values){const F={type:"values",values:U.values};Object.assign(D,inScopeVariables(F))}}}return D}function translateGroupGraphPattern(U){let D=[],F=[];if("patterns"in U)for(let Q of U.patterns)(Q.type==="filter"?D:F).push(Q);if(U.type==="bgp")return translateBgp$1(U);let G;if(U.type==="union")G=factory$1.createUnion(F.map(Q=>(Q.type!=="group"&&(Q={type:"group",patterns:[Q]}),translateGroupGraphPattern(Q))));else{if(U.type==="graph")return translateGraph$1(U);if(U.type==="group")G=F.reduce(accumulateGroupGraphPattern,factory$1.createBgp([]));else if(U.type==="values")G=translateInlineData(U);else if(U.type==="query")G=translateQuery(U,useQuads,!1);else throw new Error(`Unexpected type: ${U.type}`)}if(D.length>0){let Q=D.map(X=>translateExpression$1(X.expression));Q.length>0&&(G=factory$1.createFilter(G,Q.reduce((X,q)=>factory$1.createOperatorExpression("&&",[X,q]))))}return G}function translateExpression$1(U){if(util_1$1.default.isSimpleTerm(U)||util_1$1.default.isQuad(U))return factory$1.createTermExpression(U);if(util_1$1.default.isWildcard(U))return factory$1.createWildcardExpression();if("aggregation"in U)return factory$1.createAggregateExpression(U.aggregation,translateExpression$1(U.expression),!!U.distinct,U.separator);if("function"in U)return factory$1.createNamedExpression(U.function,U.args.map(translateExpression$1));if("operator"in U)return U.operator==="exists"||U.operator==="notexists"?factory$1.createExistenceExpression(U.operator==="notexists",translateGroupGraphPattern(U.args[0])):((U.operator==="in"||U.operator==="notin")&&(U.args=[U.args[0]].concat(U.args[1])),factory$1.createOperatorExpression(U.operator,U.args.map(translateExpression$1)));throw new Error(`Unknown expression: ${JSON.stringify(U)}`)}function translateBgp$1(U){let D=[],F=[];for(let G of U.triples)if("pathType"in G.predicate){let Q=translatePath$1(G);for(let X of Q)X.type===types$1.PATH?(D.length>0&&F.push(factory$1.createBgp(D)),D=[],F.push(X)):D.push(X)}else D.push(translateQuad(G));return D.length>0&&F.push(factory$1.createBgp(D)),F.length===1?F[0]:factory$1.createJoin(F)}function translatePath$1(U){let D=U.subject,F=translatePathPredicate(U.predicate),G=U.object;return simplifyPath(D,F,G)}function translatePathPredicate(U){if(util_1$1.default.isSimpleTerm(U)){if(U.termType==="NamedNode")return factory$1.createLink(U);throw new Error(`Path predicate should be a NamedNode, got ${JSON.stringify(U)}`)}if(U.pathType==="^")return factory$1.createInv(translatePathPredicate(U.items[0]));if(U.pathType==="!"){let D=[],F=[],G;"pathType"in U.items[0]&&U.items[0].pathType==="|"?G=U.items[0].items:G=U.items;for(let q of G)if(util_1$1.default.isSimpleTerm(q))D.push(q);else if(q.pathType==="^")F.push(q.items[0]);else throw new Error(`Unexpected item: ${JSON.stringify(q)}`);let Q=factory$1.createNps(D),X=factory$1.createInv(factory$1.createNps(F));return F.length===0?Q:D.length===0?X:factory$1.createAlt([Q,X])}if(U.pathType==="/")return factory$1.createSeq(U.items.map(translatePathPredicate));if(U.pathType==="|")return factory$1.createAlt(U.items.map(translatePathPredicate));if(U.pathType==="*")return factory$1.createZeroOrMorePath(translatePathPredicate(U.items[0]));if(U.pathType==="+")return factory$1.createOneOrMorePath(translatePathPredicate(U.items[0]));if(U.pathType==="?")return factory$1.createZeroOrOnePath(translatePathPredicate(U.items[0]));throw new Error(`Unable to translate path expression ${JSON.stringify(U)}`)}function simplifyPath(U,D,F){if(D.type===types$1.LINK)return[factory$1.createPattern(U,D.iri,F)];if(D.type===types$1.INV)return simplifyPath(F,D.path,U);if(D.type===types$1.SEQ){let G=U;return util_1$1.default.flatten(D.input.map((Q,X)=>{const q=X===D.input.length-1?F:generateFreshVar(),W=simplifyPath(G,Q,q);return q.termType==="Variable"&&(G=q),W}))}return[factory$1.createPath(U,D,F)]}function generateFreshVar(){let U=`?var${varCount++}`;return variables.has(U)?generateFreshVar():(variables.add(U),factory$1.createTerm(U))}function translateQuad(U){if("pathType"in U.predicate)throw new Error("Trying to translate property path to quad.");return factory$1.createPattern(U.subject,U.predicate,U.object,U.graph)}function translateGraph$1(U){const D={type:"group",patterns:U.patterns};let F=translateGroupGraphPattern(D);return useQuads?F=recurseGraph(F,U.name):F=factory$1.createGraph(F,U.name),F}let typeVals=Object.values(types$1);function recurseGraph(U,D,F){if(U.type===types$1.GRAPH){if(F)throw new Error("Recursing through nested GRAPH statements with a replacement is impossible.");U=recurseGraph(U.input,U.name)}else if(U.type===types$1.BGP)U.patterns=U.patterns.map(G=>(F&&(G.subject.equals(D)&&(G.subject=F),G.predicate.equals(D)&&(G.predicate=F),G.object.equals(D)&&(G.object=F)),G.graph.termType==="DefaultGraph"&&(G.graph=D),G));else if(U.type===types$1.PATH)F&&(U.subject.equals(D)&&(U.subject=F),U.object.equals(D)&&(U.object=F)),U.graph.termType==="DefaultGraph"&&(U.graph=D);else if(U.type===types$1.PROJECT&&!F)U.variables.some(G=>G.equals(D))||(F=generateFreshVar()),U.input=recurseGraph(U.input,D,F);else if(U.type===types$1.EXTEND&&!F)U.variable.equals(D)&&(F=generateFreshVar()),U.input=recurseGraph(U.input,D,F);else for(let G of Object.keys(U))Array.isArray(U[G])?U[G]=U[G].map(Q=>recurseGraph(Q,D,F)):typeVals.indexOf(U[G].type)>=0?U[G]=recurseGraph(U[G],D,F):F&&isVariable(U[G])&&U[G].equals(D)&&(U[G]=F);return U}function accumulateGroupGraphPattern(U,D){if(D.type==="optional"){const F=translateGroupGraphPattern({type:"group",patterns:D.patterns});F.type===types$1.FILTER?U=factory$1.createLeftJoin(U,F.input,F.expression):U=factory$1.createLeftJoin(U,F)}else if(D.type==="minus"){const F=translateGroupGraphPattern({type:"group",patterns:D.patterns});U=factory$1.createMinus(U,F)}else if(D.type==="bind")U=factory$1.createExtend(U,D.variable,translateExpression$1(D.expression));else if(D.type==="service"){const F={type:"group",patterns:D.patterns},G=factory$1.createService(translateGroupGraphPattern(F),D.name,D.silent);U=simplifiedJoin(U,G)}else{const F=translateGroupGraphPattern(D);U=simplifiedJoin(U,F)}return U}function simplifiedJoin(U,D){return U.type===types$1.BGP&&D.type===types$1.BGP?U=factory$1.createBgp([...U.patterns,...D.patterns]):U.type===types$1.BGP&&U.patterns.length===0?U=D:D.type===types$1.BGP&&D.patterns.length===0||(U=factory$1.createJoin([U,D])),U}function translateInlineData(U){let D=(U.values.length===0?[]:Object.keys(U.values[0])).map(factory$1.createTerm.bind(factory$1)),F=U.values.map(G=>{let Q=Object.keys(G);Q=Q.filter(q=>G[q]!==void 0);let X={};for(let q of Q)X[q]=G[q];return X});return factory$1.createValues(D,F)}function translateAggregates(U,D){const F=U,G=[],Q={};if(F.variables=F.variables&&F.variables.map(q=>mapAggregate(q,Q)),F.having=F.having&&F.having.map(q=>mapAggregate(q,Q)),F.order=F.order&&F.order.map(q=>mapAggregate(q,Q)),F.group||Object.keys(Q).length>0){const q=Object.keys(Q).map(Y=>translateBoundAggregate$1(Q[Y],factory$1.createTerm(Y))),W=[];if(F.group)for(const Y of F.group)if(util_1$1.default.isSimpleTerm(Y.expression))W.push(Y.expression);else{const J="variable"in Y?Y.variable:generateFreshVar();D=factory$1.createExtend(D,J,translateExpression$1(Y.expression)),W.push(J)}D=factory$1.createGroup(D,W,q)}if(F.having)for(let q of F.having)D=factory$1.createFilter(D,translateExpression$1(q));U.values&&(D=factory$1.createJoin([D,translateInlineData(U)]));let X=[];if(U.queryType==="SELECT"||U.queryType==="DESCRIBE")if(U.variables.some(q=>q&&util_1$1.default.isWildcard(q)))X=Object.values(inScopeVariables(U)).sort((q,W)=>q.value.localeCompare(W.value));else for(let q of U.variables)isVariable(q)||!("variable"in q)?X.push(q):q.variable&&(X.push(q.variable),G.push(q));for(let q of G)D=factory$1.createExtend(D,q.variable,translateExpression$1(q.expression));return F.order&&(D=factory$1.createOrderBy(D,F.order.map(q=>{let W=translateExpression$1(q.expression);return q.descending&&(W=factory$1.createOperatorExpression("desc",[W])),W}))),U.queryType==="SELECT"&&(D=factory$1.createProject(D,X)),F.distinct&&(D=factory$1.createDistinct(D)),F.reduced&&(D=factory$1.createReduced(D)),U.queryType==="CONSTRUCT"?D=factory$1.createConstruct(D,(U.template||[]).map(translateQuad)):U.queryType==="ASK"?D=factory$1.createAsk(D):U.queryType==="DESCRIBE"&&(D=factory$1.createDescribe(D,X)),(F.offset||F.limit)&&(D=factory$1.createSlice(D,F.offset||0,F.limit)),F.from&&(D=factory$1.createFrom(D,F.from.default,F.from.named)),D}function mapAggregate(U,D){if("type"in U&&U.type==="aggregate"){let F=!1,G;for(let Q of Object.keys(D))if(equal(D[Q],U)){G=factory$1.createTerm(Q),F=!0;break}return F||(G=generateFreshVar(),D[(0,rdf_string_1$3.termToString)(G)]=U),G}return"expression"in U&&U.expression?{...U,expression:mapAggregate(U.expression,D)}:"args"in U&&U.args?{...U,args:U.args.map(F=>mapAggregate(F,D))}:U}function translateBoundAggregate$1(U,D){if(U.type!=="aggregate"||!U.aggregation)throw new Error(`Unexpected input: ${JSON.stringify(U)}`);const F=translateExpression$1(U);return F.variable=D,F}function translateUpdate(U){return U.updates.length===1?translateSingleUpdate(U.updates[0]):factory$1.createCompositeUpdate(U.updates.map(translateSingleUpdate))}function translateSingleUpdate(U){if("type"in U){if(U.type==="load")return translateUpdateGraphLoad(U);if(U.type==="clear"||U.type==="create"||U.type==="drop")return translateUpdateGraph(U);if(U.type==="add"||U.type==="copy"||U.type==="move")return translateUpdateGraphShortcut$1(U)}else if(U.updateType==="insertdelete"||U.updateType==="deletewhere"||U.updateType==="delete"||U.updateType==="insert")return translateInsertDelete(U);throw new Error(`Unknown update type ${JSON.stringify(U)}`)}function translateInsertDelete(U){if(!useQuads)throw new Error("INSERT/DELETE operations are only supported with quads option enabled");let D=[],F=[],G;if(U.delete&&(D=util_1$1.default.flatten(U.delete.map(Q=>translateUpdateTriplesBlock(Q,U.graph)))),U.insert&&(F=util_1$1.default.flatten(U.insert.map(Q=>translateUpdateTriplesBlock(Q,U.graph)))),U.where&&U.where.length>0){G=translateGroupGraphPattern({type:"group",patterns:U.where});const Q=U.using;Q?G=factory$1.createFrom(G,Q.default,Q.named):U.graph&&(G=recurseGraph(G,U.graph))}else U.updateType==="deletewhere"&&D.length>0&&(G=factory$1.createBgp(D));return factory$1.createDeleteInsert(D.length>0?D:void 0,F.length>0?F:void 0,G)}function translateUpdateTriplesBlock(U,D){let F=D;U.type==="graph"&&(F=U.name);let G=U.triples;return F&&(G=G.map(Q=>Object.assign(Q,{graph:F}))),G.map(translateQuad)}function translateUpdateGraph(U){let D;switch(util_1$1.default.isSimpleTerm(U.graph)?D=U.graph:U.graph.all?D="ALL":U.graph.default?D="DEFAULT":U.graph.named?D="NAMED":D=U.graph.name,U.type){case"clear":return factory$1.createClear(D,U.silent);case"create":return factory$1.createCreate(D,U.silent);case"drop":return factory$1.createDrop(D,U.silent)}}function translateUpdateGraphLoad(U){return factory$1.createLoad(U.source,U.destination,U.silent)}function translateUpdateGraphShortcut$1(U){const D=U.source.default?"DEFAULT":U.source.name,F=U.destination.default?"DEFAULT":U.destination.name;switch(U.type){case"copy":return factory$1.createCopy(D,F,U.silent);case"move":return factory$1.createMove(D,F,U.silent);case"add":return factory$1.createAdd(D,F,U.silent)}}function translateBlankNodesToVariables(U){const D={},F=Array.from(variables).reduce((Q,X)=>(Q[X]=!0,Q),{});return util_1$1.default.mapOperation(U,{[Algebra$1.types.DELETE_INSERT]:Q=>({result:Q,recurse:!1}),[Algebra$1.types.PATH]:(Q,X)=>({result:X.createPath(G(Q.subject),Q.predicate,G(Q.object),G(Q.graph)),recurse:!1}),[Algebra$1.types.PATTERN]:(Q,X)=>({result:X.createPattern(G(Q.subject),G(Q.predicate),G(Q.object),G(Q.graph)),recurse:!1}),[Algebra$1.types.CONSTRUCT]:Q=>({result:factory$1.createConstruct(translateBlankNodesToVariables(Q.input),Q.template),recurse:!1})});function G(Q){if(Q.termType==="BlankNode"){let X=D[Q.value];return X||(X=util_1$1.default.createUniqueVariable(Q.value,F,factory$1.dataFactory),F[X.value]=!0,D[Q.value]=X),X}return Q}}var sparql={},rdfIsomorphic={},RdfIsomorphic={},hash={},utils$9={},minimalisticAssert=assert$5;function assert$5(U,D){if(!U)throw new Error(D||"Assertion failed")}assert$5.equal=function(D,F,G){if(D!=F)throw new Error(G||"Assertion failed: "+D+" != "+F)};var inherits_browserExports={},inherits_browser={get exports(){return inherits_browserExports},set exports(U){inherits_browserExports=U}};typeof Object.create=="function"?inherits_browser.exports=function(D,F){F&&(D.super_=F,D.prototype=Object.create(F.prototype,{constructor:{value:D,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(D,F){if(F){D.super_=F;var G=function(){};G.prototype=F.prototype,D.prototype=new G,D.prototype.constructor=D}};var assert$4=minimalisticAssert,inherits=inherits_browserExports;utils$9.inherits=inherits;function isSurrogatePair(U,D){return(U.charCodeAt(D)&64512)!==55296||D<0||D+1>=U.length?!1:(U.charCodeAt(D+1)&64512)===56320}function toArray(U,D){if(Array.isArray(U))return U.slice();if(!U)return[];var F=[];if(typeof U=="string")if(D){if(D==="hex")for(U=U.replace(/[^a-z0-9]+/ig,""),U.length%2!==0&&(U="0"+U),Q=0;Q<U.length;Q+=2)F.push(parseInt(U[Q]+U[Q+1],16))}else for(var G=0,Q=0;Q<U.length;Q++){var X=U.charCodeAt(Q);X<128?F[G++]=X:X<2048?(F[G++]=X>>6|192,F[G++]=X&63|128):isSurrogatePair(U,Q)?(X=65536+((X&1023)<<10)+(U.charCodeAt(++Q)&1023),F[G++]=X>>18|240,F[G++]=X>>12&63|128,F[G++]=X>>6&63|128,F[G++]=X&63|128):(F[G++]=X>>12|224,F[G++]=X>>6&63|128,F[G++]=X&63|128)}else for(Q=0;Q<U.length;Q++)F[Q]=U[Q]|0;return F}utils$9.toArray=toArray;function toHex(U){for(var D="",F=0;F<U.length;F++)D+=zero2(U[F].toString(16));return D}utils$9.toHex=toHex;function htonl(U){var D=U>>>24|U>>>8&65280|U<<8&16711680|(U&255)<<24;return D>>>0}utils$9.htonl=htonl;function toHex32(U,D){for(var F="",G=0;G<U.length;G++){var Q=U[G];D==="little"&&(Q=htonl(Q)),F+=zero8(Q.toString(16))}return F}utils$9.toHex32=toHex32;function zero2(U){return U.length===1?"0"+U:U}utils$9.zero2=zero2;function zero8(U){return U.length===7?"0"+U:U.length===6?"00"+U:U.length===5?"000"+U:U.length===4?"0000"+U:U.length===3?"00000"+U:U.length===2?"000000"+U:U.length===1?"0000000"+U:U}utils$9.zero8=zero8;function join32(U,D,F,G){var Q=F-D;assert$4(Q%4===0);for(var X=new Array(Q/4),q=0,W=D;q<X.length;q++,W+=4){var Y;G==="big"?Y=U[W]<<24|U[W+1]<<16|U[W+2]<<8|U[W+3]:Y=U[W+3]<<24|U[W+2]<<16|U[W+1]<<8|U[W],X[q]=Y>>>0}return X}utils$9.join32=join32;function split32(U,D){for(var F=new Array(U.length*4),G=0,Q=0;G<U.length;G++,Q+=4){var X=U[G];D==="big"?(F[Q]=X>>>24,F[Q+1]=X>>>16&255,F[Q+2]=X>>>8&255,F[Q+3]=X&255):(F[Q+3]=X>>>24,F[Q+2]=X>>>16&255,F[Q+1]=X>>>8&255,F[Q]=X&255)}return F}utils$9.split32=split32;function rotr32$1(U,D){return U>>>D|U<<32-D}utils$9.rotr32=rotr32$1;function rotl32$2(U,D){return U<<D|U>>>32-D}utils$9.rotl32=rotl32$2;function sum32$3(U,D){return U+D>>>0}utils$9.sum32=sum32$3;function sum32_3$1(U,D,F){return U+D+F>>>0}utils$9.sum32_3=sum32_3$1;function sum32_4$2(U,D,F,G){return U+D+F+G>>>0}utils$9.sum32_4=sum32_4$2;function sum32_5$2(U,D,F,G,Q){return U+D+F+G+Q>>>0}utils$9.sum32_5=sum32_5$2;function sum64$1(U,D,F,G){var Q=U[D],X=U[D+1],q=G+X>>>0,W=(q<G?1:0)+F+Q;U[D]=W>>>0,U[D+1]=q}utils$9.sum64=sum64$1;function sum64_hi$1(U,D,F,G){var Q=D+G>>>0,X=(Q<D?1:0)+U+F;return X>>>0}utils$9.sum64_hi=sum64_hi$1;function sum64_lo$1(U,D,F,G){var Q=D+G;return Q>>>0}utils$9.sum64_lo=sum64_lo$1;function sum64_4_hi$1(U,D,F,G,Q,X,q,W){var Y=0,J=D;J=J+G>>>0,Y+=J<D?1:0,J=J+X>>>0,Y+=J<X?1:0,J=J+W>>>0,Y+=J<W?1:0;var te=U+F+Q+q+Y;return te>>>0}utils$9.sum64_4_hi=sum64_4_hi$1;function sum64_4_lo$1(U,D,F,G,Q,X,q,W){var Y=D+G+X+W;return Y>>>0}utils$9.sum64_4_lo=sum64_4_lo$1;function sum64_5_hi$1(U,D,F,G,Q,X,q,W,Y,J){var te=0,Z=D;Z=Z+G>>>0,te+=Z<D?1:0,Z=Z+X>>>0,te+=Z<X?1:0,Z=Z+W>>>0,te+=Z<W?1:0,Z=Z+J>>>0,te+=Z<J?1:0;var ee=U+F+Q+q+Y+te;return ee>>>0}utils$9.sum64_5_hi=sum64_5_hi$1;function sum64_5_lo$1(U,D,F,G,Q,X,q,W,Y,J){var te=D+G+X+W+J;return te>>>0}utils$9.sum64_5_lo=sum64_5_lo$1;function rotr64_hi$1(U,D,F){var G=D<<32-F|U>>>F;return G>>>0}utils$9.rotr64_hi=rotr64_hi$1;function rotr64_lo$1(U,D,F){var G=U<<32-F|D>>>F;return G>>>0}utils$9.rotr64_lo=rotr64_lo$1;function shr64_hi$1(U,D,F){return U>>>F}utils$9.shr64_hi=shr64_hi$1;function shr64_lo$1(U,D,F){var G=U<<32-F|D>>>F;return G>>>0}utils$9.shr64_lo=shr64_lo$1;var common$5={},utils$8=utils$9,assert$3=minimalisticAssert;function BlockHash$4(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}common$5.BlockHash=BlockHash$4;BlockHash$4.prototype.update=function(D,F){if(D=utils$8.toArray(D,F),this.pending?this.pending=this.pending.concat(D):this.pending=D,this.pendingTotal+=D.length,this.pending.length>=this._delta8){D=this.pending;var G=D.length%this._delta8;this.pending=D.slice(D.length-G,D.length),this.pending.length===0&&(this.pending=null),D=utils$8.join32(D,0,D.length-G,this.endian);for(var Q=0;Q<D.length;Q+=this._delta32)this._update(D,Q,Q+this._delta32)}return this};BlockHash$4.prototype.digest=function(D){return this.update(this._pad()),assert$3(this.pending===null),this._digest(D)};BlockHash$4.prototype._pad=function(){var D=this.pendingTotal,F=this._delta8,G=F-(D+this.padLength)%F,Q=new Array(G+this.padLength);Q[0]=128;for(var X=1;X<G;X++)Q[X]=0;if(D<<=3,this.endian==="big"){for(var q=8;q<this.padLength;q++)Q[X++]=0;Q[X++]=0,Q[X++]=0,Q[X++]=0,Q[X++]=0,Q[X++]=D>>>24&255,Q[X++]=D>>>16&255,Q[X++]=D>>>8&255,Q[X++]=D&255}else for(Q[X++]=D&255,Q[X++]=D>>>8&255,Q[X++]=D>>>16&255,Q[X++]=D>>>24&255,Q[X++]=0,Q[X++]=0,Q[X++]=0,Q[X++]=0,q=8;q<this.padLength;q++)Q[X++]=0;return Q};var sha={},common$4={},utils$7=utils$9,rotr32=utils$7.rotr32;function ft_1$1(U,D,F,G){if(U===0)return ch32$1(D,F,G);if(U===1||U===3)return p32(D,F,G);if(U===2)return maj32$1(D,F,G)}common$4.ft_1=ft_1$1;function ch32$1(U,D,F){return U&D^~U&F}common$4.ch32=ch32$1;function maj32$1(U,D,F){return U&D^U&F^D&F}common$4.maj32=maj32$1;function p32(U,D,F){return U^D^F}common$4.p32=p32;function s0_256$1(U){return rotr32(U,2)^rotr32(U,13)^rotr32(U,22)}common$4.s0_256=s0_256$1;function s1_256$1(U){return rotr32(U,6)^rotr32(U,11)^rotr32(U,25)}common$4.s1_256=s1_256$1;function g0_256$1(U){return rotr32(U,7)^rotr32(U,18)^U>>>3}common$4.g0_256=g0_256$1;function g1_256$1(U){return rotr32(U,17)^rotr32(U,19)^U>>>10}common$4.g1_256=g1_256$1;var utils$6=utils$9,common$3=common$5,shaCommon$1=common$4,rotl32$1=utils$6.rotl32,sum32$2=utils$6.sum32,sum32_5$1=utils$6.sum32_5,ft_1=shaCommon$1.ft_1,BlockHash$3=common$3.BlockHash,sha1_K=[1518500249,1859775393,2400959708,3395469782];function SHA1(){if(!(this instanceof SHA1))return new SHA1;BlockHash$3.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}utils$6.inherits(SHA1,BlockHash$3);var _1=SHA1;SHA1.blockSize=512;SHA1.outSize=160;SHA1.hmacStrength=80;SHA1.padLength=64;SHA1.prototype._update=function(D,F){for(var G=this.W,Q=0;Q<16;Q++)G[Q]=D[F+Q];for(;Q<G.length;Q++)G[Q]=rotl32$1(G[Q-3]^G[Q-8]^G[Q-14]^G[Q-16],1);var X=this.h[0],q=this.h[1],W=this.h[2],Y=this.h[3],J=this.h[4];for(Q=0;Q<G.length;Q++){var te=~~(Q/20),Z=sum32_5$1(rotl32$1(X,5),ft_1(te,q,W,Y),J,G[Q],sha1_K[te]);J=Y,Y=W,W=rotl32$1(q,30),q=X,X=Z}this.h[0]=sum32$2(this.h[0],X),this.h[1]=sum32$2(this.h[1],q),this.h[2]=sum32$2(this.h[2],W),this.h[3]=sum32$2(this.h[3],Y),this.h[4]=sum32$2(this.h[4],J)};SHA1.prototype._digest=function(D){return D==="hex"?utils$6.toHex32(this.h,"big"):utils$6.split32(this.h,"big")};var utils$5=utils$9,common$2=common$5,shaCommon=common$4,assert$2=minimalisticAssert,sum32$1=utils$5.sum32,sum32_4$1=utils$5.sum32_4,sum32_5=utils$5.sum32_5,ch32=shaCommon.ch32,maj32=shaCommon.maj32,s0_256=shaCommon.s0_256,s1_256=shaCommon.s1_256,g0_256=shaCommon.g0_256,g1_256=shaCommon.g1_256,BlockHash$2=common$2.BlockHash,sha256_K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function SHA256$1(){if(!(this instanceof SHA256$1))return new SHA256$1;BlockHash$2.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=sha256_K,this.W=new Array(64)}utils$5.inherits(SHA256$1,BlockHash$2);var _256=SHA256$1;SHA256$1.blockSize=512;SHA256$1.outSize=256;SHA256$1.hmacStrength=192;SHA256$1.padLength=64;SHA256$1.prototype._update=function(D,F){for(var G=this.W,Q=0;Q<16;Q++)G[Q]=D[F+Q];for(;Q<G.length;Q++)G[Q]=sum32_4$1(g1_256(G[Q-2]),G[Q-7],g0_256(G[Q-15]),G[Q-16]);var X=this.h[0],q=this.h[1],W=this.h[2],Y=this.h[3],J=this.h[4],te=this.h[5],Z=this.h[6],ee=this.h[7];for(assert$2(this.k.length===G.length),Q=0;Q<G.length;Q++){var re=sum32_5(ee,s1_256(J),ch32(J,te,Z),this.k[Q],G[Q]),ne=sum32$1(s0_256(X),maj32(X,q,W));ee=Z,Z=te,te=J,J=sum32$1(Y,re),Y=W,W=q,q=X,X=sum32$1(re,ne)}this.h[0]=sum32$1(this.h[0],X),this.h[1]=sum32$1(this.h[1],q),this.h[2]=sum32$1(this.h[2],W),this.h[3]=sum32$1(this.h[3],Y),this.h[4]=sum32$1(this.h[4],J),this.h[5]=sum32$1(this.h[5],te),this.h[6]=sum32$1(this.h[6],Z),this.h[7]=sum32$1(this.h[7],ee)};SHA256$1.prototype._digest=function(D){return D==="hex"?utils$5.toHex32(this.h,"big"):utils$5.split32(this.h,"big")};var utils$4=utils$9,SHA256=_256;function SHA224(){if(!(this instanceof SHA224))return new SHA224;SHA256.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}utils$4.inherits(SHA224,SHA256);var _224=SHA224;SHA224.blockSize=512;SHA224.outSize=224;SHA224.hmacStrength=192;SHA224.padLength=64;SHA224.prototype._digest=function(D){return D==="hex"?utils$4.toHex32(this.h.slice(0,7),"big"):utils$4.split32(this.h.slice(0,7),"big")};var utils$3=utils$9,common$1=common$5,assert$1=minimalisticAssert,rotr64_hi=utils$3.rotr64_hi,rotr64_lo=utils$3.rotr64_lo,shr64_hi=utils$3.shr64_hi,shr64_lo=utils$3.shr64_lo,sum64=utils$3.sum64,sum64_hi=utils$3.sum64_hi,sum64_lo=utils$3.sum64_lo,sum64_4_hi=utils$3.sum64_4_hi,sum64_4_lo=utils$3.sum64_4_lo,sum64_5_hi=utils$3.sum64_5_hi,sum64_5_lo=utils$3.sum64_5_lo,BlockHash$1=common$1.BlockHash,sha512_K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function SHA512$1(){if(!(this instanceof SHA512$1))return new SHA512$1;BlockHash$1.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=sha512_K,this.W=new Array(160)}utils$3.inherits(SHA512$1,BlockHash$1);var _512=SHA512$1;SHA512$1.blockSize=1024;SHA512$1.outSize=512;SHA512$1.hmacStrength=192;SHA512$1.padLength=128;SHA512$1.prototype._prepareBlock=function(D,F){for(var G=this.W,Q=0;Q<32;Q++)G[Q]=D[F+Q];for(;Q<G.length;Q+=2){var X=g1_512_hi(G[Q-4],G[Q-3]),q=g1_512_lo(G[Q-4],G[Q-3]),W=G[Q-14],Y=G[Q-13],J=g0_512_hi(G[Q-30],G[Q-29]),te=g0_512_lo(G[Q-30],G[Q-29]),Z=G[Q-32],ee=G[Q-31];G[Q]=sum64_4_hi(X,q,W,Y,J,te,Z,ee),G[Q+1]=sum64_4_lo(X,q,W,Y,J,te,Z,ee)}};SHA512$1.prototype._update=function(D,F){this._prepareBlock(D,F);var G=this.W,Q=this.h[0],X=this.h[1],q=this.h[2],W=this.h[3],Y=this.h[4],J=this.h[5],te=this.h[6],Z=this.h[7],ee=this.h[8],re=this.h[9],ne=this.h[10],le=this.h[11],se=this.h[12],ie=this.h[13],ge=this.h[14],fe=this.h[15];assert$1(this.k.length===G.length);for(var ae=0;ae<G.length;ae+=2){var ue=ge,pe=fe,_e=s1_512_hi(ee,re),xe=s1_512_lo(ee,re),be=ch64_hi(ee,re,ne,le,se),Te=ch64_lo(ee,re,ne,le,se,ie),ye=this.k[ae],Ee=this.k[ae+1],he=G[ae],oe=G[ae+1],me=sum64_5_hi(ue,pe,_e,xe,be,Te,ye,Ee,he,oe),ve=sum64_5_lo(ue,pe,_e,xe,be,Te,ye,Ee,he,oe);ue=s0_512_hi(Q,X),pe=s0_512_lo(Q,X),_e=maj64_hi(Q,X,q,W,Y),xe=maj64_lo(Q,X,q,W,Y,J);var we=sum64_hi(ue,pe,_e,xe),Pe=sum64_lo(ue,pe,_e,xe);ge=se,fe=ie,se=ne,ie=le,ne=ee,le=re,ee=sum64_hi(te,Z,me,ve),re=sum64_lo(Z,Z,me,ve),te=Y,Z=J,Y=q,J=W,q=Q,W=X,Q=sum64_hi(me,ve,we,Pe),X=sum64_lo(me,ve,we,Pe)}sum64(this.h,0,Q,X),sum64(this.h,2,q,W),sum64(this.h,4,Y,J),sum64(this.h,6,te,Z),sum64(this.h,8,ee,re),sum64(this.h,10,ne,le),sum64(this.h,12,se,ie),sum64(this.h,14,ge,fe)};SHA512$1.prototype._digest=function(D){return D==="hex"?utils$3.toHex32(this.h,"big"):utils$3.split32(this.h,"big")};function ch64_hi(U,D,F,G,Q){var X=U&F^~U&Q;return X<0&&(X+=4294967296),X}function ch64_lo(U,D,F,G,Q,X){var q=D&G^~D&X;return q<0&&(q+=4294967296),q}function maj64_hi(U,D,F,G,Q){var X=U&F^U&Q^F&Q;return X<0&&(X+=4294967296),X}function maj64_lo(U,D,F,G,Q,X){var q=D&G^D&X^G&X;return q<0&&(q+=4294967296),q}function s0_512_hi(U,D){var F=rotr64_hi(U,D,28),G=rotr64_hi(D,U,2),Q=rotr64_hi(D,U,7),X=F^G^Q;return X<0&&(X+=4294967296),X}function s0_512_lo(U,D){var F=rotr64_lo(U,D,28),G=rotr64_lo(D,U,2),Q=rotr64_lo(D,U,7),X=F^G^Q;return X<0&&(X+=4294967296),X}function s1_512_hi(U,D){var F=rotr64_hi(U,D,14),G=rotr64_hi(U,D,18),Q=rotr64_hi(D,U,9),X=F^G^Q;return X<0&&(X+=4294967296),X}function s1_512_lo(U,D){var F=rotr64_lo(U,D,14),G=rotr64_lo(U,D,18),Q=rotr64_lo(D,U,9),X=F^G^Q;return X<0&&(X+=4294967296),X}function g0_512_hi(U,D){var F=rotr64_hi(U,D,1),G=rotr64_hi(U,D,8),Q=shr64_hi(U,D,7),X=F^G^Q;return X<0&&(X+=4294967296),X}function g0_512_lo(U,D){var F=rotr64_lo(U,D,1),G=rotr64_lo(U,D,8),Q=shr64_lo(U,D,7),X=F^G^Q;return X<0&&(X+=4294967296),X}function g1_512_hi(U,D){var F=rotr64_hi(U,D,19),G=rotr64_hi(D,U,29),Q=shr64_hi(U,D,6),X=F^G^Q;return X<0&&(X+=4294967296),X}function g1_512_lo(U,D){var F=rotr64_lo(U,D,19),G=rotr64_lo(D,U,29),Q=shr64_lo(U,D,6),X=F^G^Q;return X<0&&(X+=4294967296),X}var utils$2=utils$9,SHA512=_512;function SHA384(){if(!(this instanceof SHA384))return new SHA384;SHA512.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}utils$2.inherits(SHA384,SHA512);var _384=SHA384;SHA384.blockSize=1024;SHA384.outSize=384;SHA384.hmacStrength=192;SHA384.padLength=128;SHA384.prototype._digest=function(D){return D==="hex"?utils$2.toHex32(this.h.slice(0,12),"big"):utils$2.split32(this.h.slice(0,12),"big")};sha.sha1=_1;sha.sha224=_224;sha.sha256=_256;sha.sha384=_384;sha.sha512=_512;var ripemd={},utils$1=utils$9,common=common$5,rotl32=utils$1.rotl32,sum32=utils$1.sum32,sum32_3=utils$1.sum32_3,sum32_4=utils$1.sum32_4,BlockHash=common.BlockHash;function RIPEMD160(){if(!(this instanceof RIPEMD160))return new RIPEMD160;BlockHash.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}utils$1.inherits(RIPEMD160,BlockHash);ripemd.ripemd160=RIPEMD160;RIPEMD160.blockSize=512;RIPEMD160.outSize=160;RIPEMD160.hmacStrength=192;RIPEMD160.padLength=64;RIPEMD160.prototype._update=function(D,F){for(var G=this.h[0],Q=this.h[1],X=this.h[2],q=this.h[3],W=this.h[4],Y=G,J=Q,te=X,Z=q,ee=W,re=0;re<80;re++){var ne=sum32(rotl32(sum32_4(G,f$2(re,Q,X,q),D[r$2[re]+F],K(re)),s$3[re]),W);G=W,W=q,q=rotl32(X,10),X=Q,Q=ne,ne=sum32(rotl32(sum32_4(Y,f$2(79-re,J,te,Z),D[rh[re]+F],Kh(re)),sh[re]),ee),Y=ee,ee=Z,Z=rotl32(te,10),te=J,J=ne}ne=sum32_3(this.h[1],X,Z),this.h[1]=sum32_3(this.h[2],q,ee),this.h[2]=sum32_3(this.h[3],W,Y),this.h[3]=sum32_3(this.h[4],G,J),this.h[4]=sum32_3(this.h[0],Q,te),this.h[0]=ne};RIPEMD160.prototype._digest=function(D){return D==="hex"?utils$1.toHex32(this.h,"little"):utils$1.split32(this.h,"little")};function f$2(U,D,F,G){return U<=15?D^F^G:U<=31?D&F|~D&G:U<=47?(D|~F)^G:U<=63?D&G|F&~G:D^(F|~G)}function K(U){return U<=15?0:U<=31?1518500249:U<=47?1859775393:U<=63?2400959708:2840853838}function Kh(U){return U<=15?1352829926:U<=31?1548603684:U<=47?1836072691:U<=63?2053994217:0}var r$2=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],rh=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],s$3=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],sh=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],utils=utils$9,assert=minimalisticAssert;function Hmac(U,D,F){if(!(this instanceof Hmac))return new Hmac(U,D,F);this.Hash=U,this.blockSize=U.blockSize/8,this.outSize=U.outSize/8,this.inner=null,this.outer=null,this._init(utils.toArray(D,F))}var hmac=Hmac;Hmac.prototype._init=function(D){D.length>this.blockSize&&(D=new this.Hash().update(D).digest()),assert(D.length<=this.blockSize);for(var F=D.length;F<this.blockSize;F++)D.push(0);for(F=0;F<D.length;F++)D[F]^=54;for(this.inner=new this.Hash().update(D),F=0;F<D.length;F++)D[F]^=106;this.outer=new this.Hash().update(D)};Hmac.prototype.update=function(D,F){return this.inner.update(D,F),this};Hmac.prototype.digest=function(D){return this.outer.update(this.inner.digest()),this.outer.digest(D)};(function(U){var D=U;D.utils=utils$9,D.common=common$5,D.sha=sha,D.ripemd=ripemd,D.hmac=hmac,D.sha1=D.sha.sha1,D.sha256=D.sha.sha256,D.sha224=D.sha.sha224,D.sha384=D.sha.sha384,D.sha512=D.sha.sha512,D.ripemd160=D.ripemd.ripemd160})(hash);var rdfTerms={},QuadTermUtil={};Object.defineProperty(QuadTermUtil,"__esModule",{value:!0});QuadTermUtil.matchPatternMappings=QuadTermUtil.matchPatternComplete=QuadTermUtil.matchPattern=QuadTermUtil.matchTerm=QuadTermUtil.someTerms=QuadTermUtil.everyTerms=QuadTermUtil.reduceTerms=QuadTermUtil.mapTerms=QuadTermUtil.filterQuadTermNames=QuadTermUtil.filterTerms=QuadTermUtil.forEachTerms=QuadTermUtil.collectNamedTerms=QuadTermUtil.getNamedTerms=QuadTermUtil.getTermsNested=QuadTermUtil.getTerms=QuadTermUtil.TRIPLE_TERM_NAMES=QuadTermUtil.QUAD_TERM_NAMES=void 0;const rdf_data_factory_1=rdfDataFactory,DF=new rdf_data_factory_1.DataFactory;QuadTermUtil.QUAD_TERM_NAMES=["subject","predicate","object","graph"];QuadTermUtil.TRIPLE_TERM_NAMES=["subject","predicate","object"];function getTerms(U,D){return D&&U.graph.termType==="DefaultGraph"?[U.subject,U.predicate,U.object]:[U.subject,U.predicate,U.object,U.graph]}QuadTermUtil.getTerms=getTerms;function getTermsNested(U,D){const F=[];for(const G of getTerms(U,D))G.termType==="Quad"?getTermsNested(G,D).forEach(Q=>F.push(Q)):F.push(G);return F}QuadTermUtil.getTermsNested=getTermsNested;function getNamedTerms(U){return[{key:"subject",value:U.subject},{key:"predicate",value:U.predicate},{key:"object",value:U.object},{key:"graph",value:U.graph}]}QuadTermUtil.getNamedTerms=getNamedTerms;function collectNamedTerms(U,D,F){const G={};return U.forEach(Q=>G[Q.key]=Q.value),D&&(G.subject=G.subject||D("subject"),G.predicate=G.predicate||D("predicate"),G.object=G.object||D("object"),G.graph=G.graph||D("graph")),(F||DF).quad(G.subject,G.predicate,G.object,G.graph)}QuadTermUtil.collectNamedTerms=collectNamedTerms;function forEachTerms(U,D){D(U.subject,"subject"),D(U.predicate,"predicate"),D(U.object,"object"),D(U.graph,"graph")}QuadTermUtil.forEachTerms=forEachTerms;function filterTerms(U,D){const F=[];return D(U.subject,"subject")&&F.push(U.subject),D(U.predicate,"predicate")&&F.push(U.predicate),D(U.object,"object")&&F.push(U.object),D(U.graph,"graph")&&F.push(U.graph),F}QuadTermUtil.filterTerms=filterTerms;function filterQuadTermNames(U,D){const F=[];return D(U.subject,"subject")&&F.push("subject"),D(U.predicate,"predicate")&&F.push("predicate"),D(U.object,"object")&&F.push("object"),D(U.graph,"graph")&&F.push("graph"),F}QuadTermUtil.filterQuadTermNames=filterQuadTermNames;function mapTerms(U,D,F){return(F||DF).quad(D(U.subject,"subject"),D(U.predicate,"predicate"),D(U.object,"object"),D(U.graph,"graph"))}QuadTermUtil.mapTerms=mapTerms;function reduceTerms(U,D,F){let G=F;return G=D(G,U.subject,"subject"),G=D(G,U.predicate,"predicate"),G=D(G,U.object,"object"),D(G,U.graph,"graph")}QuadTermUtil.reduceTerms=reduceTerms;function everyTerms(U,D){return D(U.subject,"subject")&&D(U.predicate,"predicate")&&D(U.object,"object")&&D(U.graph,"graph")}QuadTermUtil.everyTerms=everyTerms;function someTerms(U,D){return D(U.subject,"subject")||D(U.predicate,"predicate")||D(U.object,"object")||D(U.graph,"graph")}QuadTermUtil.someTerms=someTerms;function matchTerm(U,D){return!D||D.termType==="Variable"||D.termType==="Quad"&&U.termType==="Quad"&&matchPatternComplete(U,D)||D.equals(U)}QuadTermUtil.matchTerm=matchTerm;function matchPattern(U,D,F,G,Q){return matchTerm(U.subject,D)&&matchTerm(U.predicate,F)&&matchTerm(U.object,G)&&matchTerm(U.graph,Q)}QuadTermUtil.matchPattern=matchPattern;function matchPatternComplete(U,D){return matchPattern(U,D.subject,D.predicate,D.object,D.graph)}QuadTermUtil.matchPatternComplete=matchPatternComplete;function matchPatternMappings(U,D,F={}){const G={};function Q(X,q){return everyTerms(X,(W,Y)=>{var J,te;const Z=q[Y];switch(W.termType){case"Variable":return F.skipVarMapping&&Z.termType==="Variable"||((te=(J=G[W.value])===null||J===void 0?void 0:J.equals(Z))!==null&&te!==void 0?te:(G[W.value]=Z,!0));case"Quad":return Z.termType==="Quad"&&Q(W,Z);default:return W.equals(Z)}})}return Q(D,U)&&(F.returnMappings?G:!0)}QuadTermUtil.matchPatternMappings=matchPatternMappings;var TermUtil={};Object.defineProperty(TermUtil,"__esModule",{value:!0});TermUtil.getQuads=TermUtil.getDefaultGraphs=TermUtil.getVariables=TermUtil.getLiterals=TermUtil.getBlankNodes=TermUtil.getNamedNodes=TermUtil.getTermsOfType=TermUtil.uniqTerms=TermUtil.TERM_TYPES=void 0;const rdf_string_1$2=rdfString;TermUtil.TERM_TYPES=["NamedNode","BlankNode","Literal","Variable","DefaultGraph","Quad"];function uniqTerms(U){const D={};return U.filter(F=>{const G=rdf_string_1$2.termToString(F);return!(G in D)&&(D[G]=!0)})}TermUtil.uniqTerms=uniqTerms;function getTermsOfType(U,D){return U.filter(F=>F.termType===D)}TermUtil.getTermsOfType=getTermsOfType;function getNamedNodes(U){return getTermsOfType(U,"NamedNode")}TermUtil.getNamedNodes=getNamedNodes;function getBlankNodes(U){return getTermsOfType(U,"BlankNode")}TermUtil.getBlankNodes=getBlankNodes;function getLiterals(U){return getTermsOfType(U,"Literal")}TermUtil.getLiterals=getLiterals;function getVariables(U){return getTermsOfType(U,"Variable")}TermUtil.getVariables=getVariables;function getDefaultGraphs(U){return getTermsOfType(U,"DefaultGraph")}TermUtil.getDefaultGraphs=getDefaultGraphs;function getQuads(U){return getTermsOfType(U,"Quad")}TermUtil.getQuads=getQuads;(function(U){var D=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(G,Q,X,q){q===void 0&&(q=X),Object.defineProperty(G,q,{enumerable:!0,get:function(){return Q[X]}})}:function(G,Q,X,q){q===void 0&&(q=X),G[q]=Q[X]}),F=commonjsGlobal&&commonjsGlobal.__exportStar||function(G,Q){for(var X in G)X!=="default"&&!Object.prototype.hasOwnProperty.call(Q,X)&&D(Q,G,X)};Object.defineProperty(U,"__esModule",{value:!0}),F(QuadTermUtil,U),F(TermUtil,U)})(rdfTerms);Object.defineProperty(RdfIsomorphic,"__esModule",{value:!0});RdfIsomorphic.isTermGrounded=RdfIsomorphic.termToSignature=RdfIsomorphic.quadToSignature=RdfIsomorphic.sha1hex=RdfIsomorphic.hashTerm=RdfIsomorphic.hashTerms=RdfIsomorphic.getGraphBlankNodes=RdfIsomorphic.uniqGraph=RdfIsomorphic.deindexGraph=RdfIsomorphic.indexGraph=RdfIsomorphic.getQuadsWithoutBlankNodes=RdfIsomorphic.getQuadsWithBlankNodes=RdfIsomorphic.hasValue=RdfIsomorphic.hashValues=RdfIsomorphic.getBijectionInner=RdfIsomorphic.getBijection=RdfIsomorphic.isomorphic=void 0;const hash_js_1=hash,rdf_string_1$1=rdfString,rdf_terms_1=rdfTerms;function isomorphic(U,D){return!!getBijection(U,D)}RdfIsomorphic.isomorphic=isomorphic;function getBijection(U,D){const F=indexGraph(getQuadsWithoutBlankNodes(U)),G=indexGraph(getQuadsWithoutBlankNodes(D));if(Object.keys(F).length!==Object.keys(G).length)return null;for(const Y in F)if(F[Y]!==G[Y])return null;const Q=uniqGraph(getQuadsWithBlankNodes(U)),X=uniqGraph(getQuadsWithBlankNodes(D)),q=getGraphBlankNodes(U),W=getGraphBlankNodes(D);return getBijectionInner(Q,X,q,W)}RdfIsomorphic.getBijection=getBijection;function getBijectionInner(U,D,F,G,Q,X){Q||(Q={}),X||(X={});const[q,W]=hashTerms(U,F,Q),[Y,J]=hashTerms(D,G,X);if(Object.keys(q).length!==Object.keys(Y).length)return null;for(const Z in q)if(!hasValue(Y,q[Z]))return null;let te={};for(const Z of F){const ee=rdf_string_1$1.termToString(Z),re=W[ee];for(const ne in J)if(J[ne]===re){te[ee]=ne,delete J[ne];break}}if(!arraysEqual(Object.keys(te).sort(),F.map(rdf_string_1$1.termToString).sort())||!arraysEqual(hashValues(te).sort(),G.map(rdf_string_1$1.termToString).sort())){te=null;for(const Z of F){const ee=rdf_string_1$1.termToString(Z);if(!q[ee])for(const re of G){const ne=rdf_string_1$1.termToString(re);if(!Y[ne]&&W[ee]===J[ne]){const le=sha1hex(ee);te=getBijectionInner(U,D,F,G,Object.assign(Object.assign({},q),{[ee]:le}),Object.assign(Object.assign({},Y),{[ne]:le}))}}}}return te}RdfIsomorphic.getBijectionInner=getBijectionInner;function arraysEqual(U,D){if(U.length!==D.length)return!1;for(let F=U.length;F--;)if(U[F]!==D[F])return!1;return!0}function hashValues(U){const D=[];for(const F in U)D.push(U[F]);return D}RdfIsomorphic.hashValues=hashValues;function hasValue(U,D){for(const F in U)if(U[F]===D)return!0;return!1}RdfIsomorphic.hasValue=hasValue;function getQuadsWithBlankNodes(U){return U.filter(D=>rdf_terms_1.someTerms(D,F=>F.termType==="BlankNode"||F.termType==="Quad"&&rdf_terms_1.getTermsNested(F).some(G=>G.termType==="BlankNode")))}RdfIsomorphic.getQuadsWithBlankNodes=getQuadsWithBlankNodes;function getQuadsWithoutBlankNodes(U){return U.filter(D=>rdf_terms_1.everyTerms(D,F=>F.termType!=="BlankNode"&&!(F.termType==="Quad"&&rdf_terms_1.getTermsNested(F).some(G=>G.termType==="BlankNode"))))}RdfIsomorphic.getQuadsWithoutBlankNodes=getQuadsWithoutBlankNodes;function indexGraph(U){const D={};for(const F of U)D[JSON.stringify(rdf_string_1$1.quadToStringQuad(F))]=!0;return D}RdfIsomorphic.indexGraph=indexGraph;function deindexGraph(U){return Object.keys(U).map(D=>rdf_string_1$1.stringQuadToQuad(JSON.parse(D)))}RdfIsomorphic.deindexGraph=deindexGraph;function uniqGraph(U){return deindexGraph(indexGraph(U))}RdfIsomorphic.uniqGraph=uniqGraph;function getGraphBlankNodes(U){return rdf_terms_1.uniqTerms(U.map(D=>rdf_terms_1.getBlankNodes(rdf_terms_1.getTermsNested(D))).reduce((D,F)=>D.concat(F),[]))}RdfIsomorphic.getGraphBlankNodes=getGraphBlankNodes;function hashTerms(U,D,F){const G=Object.assign({},F),Q={};let X=!0;for(;X;){const q=Object.keys(G).length;for(const Y of D){const J=rdf_string_1$1.termToString(Y);if(!G[J]){const[te,Z]=hashTerm(Y,U,G);te&&(G[J]=Z),Q[J]=Z}}const W={};for(const Y in Q){const J=Q[Y];W[J]===void 0?W[J]=Y:W[J]=!1}for(const Y in W){const J=W[Y];J&&(G[J]=Y)}X=q!==Object.keys(G).length}return[G,Q]}RdfIsomorphic.hashTerms=hashTerms;function hashTerm(U,D,F){const G=[];let Q=!0;for(const q of D){const W=rdf_terms_1.getTermsNested(q);if(W.some(Y=>Y.equals(U))){G.push(quadToSignature(q,F,U));for(const Y of W)!isTermGrounded(Y,F)&&!Y.equals(U)&&(Q=!1)}}const X=sha1hex(G.sort().join(""));return[Q,X]}RdfIsomorphic.hashTerm=hashTerm;function sha1hex(U){return hash_js_1.sha1().update(U).digest("hex")}RdfIsomorphic.sha1hex=sha1hex;function quadToSignature(U,D,F){return rdf_terms_1.getTerms(U).map(G=>termToSignature(G,D,F)).join("|")}RdfIsomorphic.quadToSignature=quadToSignature;function termToSignature(U,D,F){return U.equals(F)?"@self":U.termType==="BlankNode"?D[rdf_string_1$1.termToString(U)]||"@blank":U.termType==="Quad"?`<${quadToSignature(U,D,F)}>`:rdf_string_1$1.termToString(U)}RdfIsomorphic.termToSignature=termToSignature;function isTermGrounded(U,D){return U.termType!=="BlankNode"&&!(U.termType==="Quad"&&rdf_terms_1.getTermsNested(U).some(F=>!isTermGrounded(F,D)))||!!D[rdf_string_1$1.termToString(U)]}RdfIsomorphic.isTermGrounded=isTermGrounded;(function(U){var D=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(G,Q,X,q){q===void 0&&(q=X),Object.defineProperty(G,q,{enumerable:!0,get:function(){return Q[X]}})}:function(G,Q,X,q){q===void 0&&(q=X),G[q]=Q[X]}),F=commonjsGlobal&&commonjsGlobal.__exportStar||function(G,Q){for(var X in G)X!=="default"&&!Object.prototype.hasOwnProperty.call(Q,X)&&D(Q,G,X)};Object.defineProperty(U,"__esModule",{value:!0}),F(RdfIsomorphic,U)})(rdfIsomorphic);var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(U,D,F,G){G===void 0&&(G=F);var Q=Object.getOwnPropertyDescriptor(D,F);(!Q||("get"in Q?!D.__esModule:Q.writable||Q.configurable))&&(Q={enumerable:!0,get:function(){return D[F]}}),Object.defineProperty(U,G,Q)}:function(U,D,F,G){G===void 0&&(G=F),U[G]=D[F]}),__setModuleDefault=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(U,D){Object.defineProperty(U,"default",{enumerable:!0,value:D})}:function(U,D){U.default=D}),__importStar=commonjsGlobal&&commonjsGlobal.__importStar||function(U){if(U&&U.__esModule)return U;var D={};if(U!=null)for(var F in U)F!=="default"&&Object.prototype.hasOwnProperty.call(U,F)&&__createBinding(D,U,F);return __setModuleDefault(D,U),D},__importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(U){return U&&U.__esModule?U:{default:U}};Object.defineProperty(sparql,"__esModule",{value:!0});sparql.toSparqlJs=sparql.toSparql=void 0;const rdf_isomorphic_1=rdfIsomorphic,rdf_string_1=rdfString,sparqljs_1=sparql$1,Algebra=__importStar(algebra),factory_1=__importDefault(factory$2),util_1=__importDefault(util),types=Algebra.types,eTypes=Algebra.expressionTypes;let context;const factory=new factory_1.default;function toSparql(U,D={}){return new sparqljs_1.Generator(D).stringify(toSparqlJs(U))}sparql.toSparql=toSparql;function toSparqlJs(U){resetContext(),U=removeQuads(U);let D=translateOperation(U);return D.type==="group"?D.patterns[0]:D}sparql.toSparqlJs=toSparqlJs;function resetContext(){context={project:!1,extend:[],group:[],aggregates:[],order:[]}}function translateOperation(U){switch(U.type!==types.EXTEND&&U.type!==types.ORDER_BY&&U.type!==types.GRAPH&&(context.project=!1),U.type){case types.EXPRESSION:return translateExpression(U);case types.ASK:return translateProject(U,types.ASK);case types.BGP:return translateBgp(U);case types.CONSTRUCT:return translateConstruct(U);case types.DESCRIBE:return translateProject(U,types.DESCRIBE);case types.DISTINCT:return translateDistinct(U);case types.EXTEND:return translateExtend(U);case types.FROM:return translateFrom(U);case types.FILTER:return translateFilter(U);case types.GRAPH:return translateGraph(U);case types.GROUP:return translateGroup(U);case types.JOIN:return translateJoin(U);case types.LEFT_JOIN:return translateLeftJoin(U);case types.MINUS:return translateMinus(U);case types.NOP:return{};case types.ORDER_BY:return translateOrderBy(U);case types.PATH:return translatePath(U);case types.PATTERN:return translatePattern(U);case types.PROJECT:return translateProject(U,types.PROJECT);case types.REDUCED:return translateReduced(U);case types.SERVICE:return translateService(U);case types.SLICE:return translateSlice(U);case types.UNION:return translateUnion(U);case types.VALUES:return translateValues(U);case types.COMPOSITE_UPDATE:return translateCompositeUpdate(U);case types.DELETE_INSERT:return translateDeleteInsert(U);case types.LOAD:return translateLoad(U);case types.CLEAR:return translateClear(U);case types.CREATE:return translateCreate(U);case types.DROP:return translateDrop(U);case types.ADD:return translateAdd(U);case types.MOVE:return translateMove(U);case types.COPY:return translateCopy(U)}throw new Error(`Unknown Operation type ${U.type}`)}function translateExpression(U){switch(U.expressionType){case eTypes.AGGREGATE:return translateAggregateExpression(U);case eTypes.EXISTENCE:return translateExistenceExpression(U);case eTypes.NAMED:return translateNamedExpression(U);case eTypes.OPERATOR:return translateOperatorExpression(U);case eTypes.TERM:return translateTermExpression(U);case eTypes.WILDCARD:return translateWildcardExpression(U)}throw new Error(`Unknown Expression Operation type ${U.expressionType}`)}function translatePathComponent(U){switch(U.type){case types.ALT:return translateAlt(U);case types.INV:return translateInv(U);case types.LINK:return translateLink(U);case types.NPS:return translateNps(U);case types.ONE_OR_MORE_PATH:return translateOneOrMorePath(U);case types.SEQ:return translateSeq(U);case types.ZERO_OR_MORE_PATH:return translateZeroOrMorePath(U);case types.ZERO_OR_ONE_PATH:return translateZeroOrOnePath(U)}throw new Error(`Unknown Path type ${U.type}`)}function translateTerm(U){return(0,rdf_string_1.termToString)(U)}function translateAggregateExpression(U){const D={expression:translateExpression(U.expression),type:"aggregate",aggregation:U.aggregator,distinct:U.distinct};return U.separator&&(D.separator=U.separator),D}function translateExistenceExpression(U){return{type:"operation",operator:U.not?"notexists":"exists",args:util_1.default.flatten([translateOperation(U.input)])}}function translateNamedExpression(U){return{type:"functionCall",function:U.name,args:U.args.map(translateExpression)}}function translateOperatorExpression(U){if(U.operator==="desc"){const F={expression:translateExpression(U.args[0])};return F.descending=!0,F}const D={type:"operation",operator:U.operator,args:U.args.map(translateExpression)};return(D.operator==="in"||D.operator==="notin")&&(D.args=[D.args[0]].concat([D.args.slice(1)])),D}function translateTermExpression(U){return U.term}function translateWildcardExpression(U){return U.wildcard}function translateBoundAggregate(U){return U}function translateBgp(U){let D=U.patterns.map(translatePattern);return D.length===0?null:{type:"bgp",triples:D}}function translateConstruct(U){return{type:"query",prefixes:{},queryType:"CONSTRUCT",template:U.template.map(translatePattern),where:util_1.default.flatten([translateOperation(U.input)])}}function translateDistinct(U){let D=translateOperation(U.input);return D.patterns[0].distinct=!0,D}function translateExtend(U){return context.project?(context.extend.push(U),translateOperation(U.input)):util_1.default.flatten([translateOperation(U.input),{type:"bind",variable:U.variable,expression:translateExpression(U.expression)}])}function translateFrom(U){const D=translateOperation(U.input),F=D.patterns[0];return F.from={default:U.default,named:U.named},D}function translateFilter(U){return{type:"group",patterns:util_1.default.flatten([translateOperation(U.input),{type:"filter",expression:translateExpression(U.expression)}])}}function translateGraph(U){return{type:"graph",patterns:util_1.default.flatten([translateOperation(U.input)]),name:U.name}}function translateGroup(U){const D=translateOperation(U.input),F=U.aggregates.map(translateBoundAggregate);return context.aggregates.push(...F),context.group.push(...U.variables),D}function translateJoin(U){return util_1.default.flatten(U.input.map(translateOperation)).reduce((F,G)=>(G.type!=="bgp"||F.length==0||F[F.length-1].type!=="bgp"?F.push(G):F[F.length-1].triples.push(...G.triples),F),[])}function translateLeftJoin(U){const D={type:"optional",patterns:[translateOperation(U.input[1])]};return U.expression&&D.patterns.push({type:"filter",expression:translateExpression(U.expression)}),D.patterns=util_1.default.flatten(D.patterns),util_1.default.flatten([translateOperation(U.input[0]),D])}function translateMinus(U){let D=translateOperation(U.input[1]);return D.type==="group"&&(D=D.patterns),Array.isArray(D)||(D=[D]),util_1.default.flatten([translateOperation(U.input[0]),{type:"minus",patterns:D}])}function translateOrderBy(U){return context.order.push(...U.expressions),translateOperation(U.input)}function translatePath(U){return{type:"bgp",triples:[{subject:U.subject,predicate:translatePathComponent(U.predicate),object:U.object}]}}function translatePattern(U){return{subject:U.subject,predicate:U.predicate,object:U.object}}function replaceAggregatorVariables(U,D){let F=util_1.default.isSimpleTerm(U)?translateTerm(U):U;if(typeof F=="string"){if(D[F])return D[F]}else if(Array.isArray(U))U=U.map(G=>replaceAggregatorVariables(G,D));else for(let G of Object.keys(U))U[G]=replaceAggregatorVariables(U[G],D);return U}function translateProject(U,D){const F={type:"query",prefixes:{}},G=F;let Q;D===types.PROJECT?(F.queryType="SELECT",Q=U.variables):D===types.ASK?F.queryType="ASK":D===types.DESCRIBE&&(F.queryType="DESCRIBE",Q=U.terms);const X=context.extend,q=context.group,W=context.aggregates,Y=context.order;resetContext(),context.project=!0;let J=util_1.default.flatten([translateOperation(U.input)]);J.length===1&&J[0].type==="group"&&(J=J[0].patterns),F.where=J;let te={};for(let ee of context.aggregates)te[translateTerm(ee.variable)]=translateExpression(ee);let Z={};for(let ee=context.extend.length-1;ee>=0;--ee){let re=context.extend[ee];Z[translateTerm(re.variable)]=replaceAggregatorVariables(translateExpression(re.expression),te)}if(context.group.length>0&&(G.group=context.group.map(ee=>{let re=translateTerm(ee);if(Z[re]){let ne=Z[re];return delete Z[re],{variable:ee,expression:ne}}return{expression:ee}})),context.order.length>0&&(G.order=context.order.map(translateOperation).map(ee=>ee.descending?ee:{expression:ee})),Q&&(G.variables=Q.map(ee=>{let re=translateTerm(ee);return Z[re]?{variable:ee,expression:Z[re]}:ee}),G.variables.length===0&&(G.variables=[new sparqljs_1.Wildcard])),F.where.length>0&&F.where[F.where.length-1].type==="filter"){const ee=F.where[F.where.length-1];objectContainsValues(ee,Object.keys(te))&&(G.having=util_1.default.flatten([replaceAggregatorVariables(ee.expression,te)]),F.where.splice(-1))}return context.extend=X,context.group=q,context.aggregates=W,context.order=Y,{type:"group",patterns:[G]}}function objectContainsValues(U,D){return util_1.default.isSimpleTerm(U)?D.indexOf(translateTerm(U))>=0:Array.isArray(U)?U.some(F=>objectContainsValues(F,D)):U===Object(U)?Object.keys(U).some(F=>objectContainsValues(U[F],D)):D.indexOf(U)>=0}function translateReduced(U){let D=translateOperation(U.input);return D.patterns[0].reduced=!0,D}function translateService(U){let D=translateOperation(U.input);return D.type==="group"&&(D=D.patterns),Array.isArray(D)||(D=[D]),{type:"service",name:U.name,silent:U.silent,patterns:D}}function translateSlice(U){let D=translateOperation(U.input),F=D;return D.type&&D.type==="group"&&(F=D.patterns[0]),U.start!==0&&(F.offset=U.start),U.length!==void 0&&(F.limit=U.length),D}function translateUnion(U){return{type:"union",patterns:util_1.default.flatten(U.input.map(translateOperation))}}function translateValues(U){return{type:"values",values:U.bindings.map(D=>{let F={};for(let G of U.variables){let Q=`?${G.value}`;D[Q]?F[Q]=D[Q]:F[Q]=void 0}return F})}}function translateAlt(U){const D=U.input.map(translatePathComponent);return D.every(F=>"pathType"in F&&F.pathType==="!")?{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:util_1.default.flatten(D.map(F=>F.items))}]}:{type:"path",pathType:"|",items:D}}function translateInv(U){if(U.path.type===types.NPS){const D=U.path.iris.map(F=>({type:"path",pathType:"^",items:[F]}));return D.length<=1?{type:"path",pathType:"!",items:D}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:D}]}}return{type:"path",pathType:"^",items:[translatePathComponent(U.path)]}}function translateLink(U){return U.iri}function translateNps(U){return U.iris.length<=1?{type:"path",pathType:"!",items:U.iris}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:U.iris}]}}function translateOneOrMorePath(U){return{type:"path",pathType:"+",items:[translatePathComponent(U.path)]}}function translateSeq(U){return{type:"path",pathType:"/",items:U.input.map(translatePathComponent)}}function translateZeroOrMorePath(U){return{type:"path",pathType:"*",items:[translatePathComponent(U.path)]}}function translateZeroOrOnePath(U){return{type:"path",pathType:"?",items:[translatePathComponent(U.path)]}}function translateCompositeUpdate(U){const D=U.updates.map(F=>translateOperation(F).updates[0]);return{prefixes:{},type:"update",updates:D}}function translateDeleteInsert(U){var D;let F=U.where,G;if(F&&F.type===types.FROM){let X=F;F=X.input,G={default:X.default,named:X.named}}const Q=[{updateType:"insertdelete",delete:convertUpdatePatterns(U.delete||[]),insert:convertUpdatePatterns(U.insert||[])}];if(G&&(Q[0].using=G),!F||F.type===types.BGP&&F.patterns.length===0)Q[0].where=[];else{const X={};let q=translateOperation(removeQuadsRecursive(F,X));q.type==="group"?Q[0].where=q.patterns:Q[0].where=[q];const W=Object.keys(X);if(W.length>0){if(W.length!==1)throw new Error("This is unexpected and might indicate an error in graph handling for updates.");const Y=(D=X[W[0]])===null||D===void 0?void 0:D.graph;Y&&Y.value!==""&&(Q[0].where=[{type:"graph",patterns:Q[0].where,name:Y}])}}return!U.delete&&!U.where?(Q[0].updateType="insert",delete Q[0].delete,delete Q[0].where):!U.insert&&!U.where?(delete Q[0].insert,delete Q[0].where,U.delete.some(X=>X.subject.termType==="Variable"||X.predicate.termType==="Variable"||X.object.termType==="Variable")?Q[0].updateType="deletewhere":Q[0].updateType="delete"):!U.insert&&U.where&&U.where.type==="bgp"&&(0,rdf_isomorphic_1.isomorphic)(U.delete,U.where.patterns)&&(delete Q[0].where,Q[0].updateType="deletewhere"),{prefixes:{},type:"update",updates:Q}}function translateLoad(U){const D=[{type:"load",silent:!!U.silent,source:U.source}];return U.destination&&(D[0].destination=U.destination),{prefixes:{},type:"update",updates:D}}function translateClear(U){return translateClearCreateDrop(U,"clear")}function translateCreate(U){return translateClearCreateDrop(U,"create")}function translateDrop(U){return translateClearCreateDrop(U,"drop")}function translateClearCreateDrop(U,D){const F=[{type:D,silent:!!U.silent}];return U.source==="DEFAULT"?F[0].graph={default:!0}:U.source==="NAMED"?F[0].graph={named:!0}:U.source==="ALL"?F[0].graph={all:!0}:F[0].graph={type:"graph",name:U.source},{prefixes:{},type:"update",updates:F}}function translateAdd(U){return translateUpdateGraphShortcut(U,"add")}function translateMove(U){return translateUpdateGraphShortcut(U,"move")}function translateCopy(U){return translateUpdateGraphShortcut(U,"copy")}function translateUpdateGraphShortcut(U,D){const F=[{type:D,silent:!!U.silent}];return F[0].source=U.source==="DEFAULT"?{type:"graph",default:!0}:{type:"graph",name:U.source},F[0].destination=U.destination==="DEFAULT"?{type:"graph",default:!0}:{type:"graph",name:U.destination},{prefixes:{},type:"update",updates:F}}function convertUpdatePatterns(U){if(!U)return[];const D={};return U.forEach(F=>{const G=F.graph.value;D[G]||(D[G]=[]),D[G].push(F)}),Object.keys(D).map(F=>F===""?{type:"bgp",triples:D[F].map(translatePattern)}:{type:"graph",triples:D[F].map(translatePattern),name:D[F][0].graph})}function removeQuads(U){return removeQuadsRecursive(U,{})}function removeQuadsRecursive(U,D){if(Array.isArray(U))return U.map(q=>removeQuadsRecursive(q,D));if(!U.type||U.type===types.DELETE_INSERT)return U;if((U.type===types.PATTERN||U.type===types.PATH)&&U.graph)return D[U.graph.value]||(D[U.graph.value]={graph:U.graph,values:[]}),D[U.graph.value].values.push(U),U;const F={},G={},Q={};for(let q of Object.keys(U)){const W={};F[q]=removeQuadsRecursive(U[q],W);const Y=Object.keys(W);if(Y.length>1){let J=potentialGraphFromPatterns(W[Y[0]].values);for(let te=1;te<Y.length;++te){const Z=potentialGraphFromPatterns(W[Y[te]].values);J=factory.createJoin([J,Z])}return Y.map(te=>delete W[te]),J}else if(Y.length===1){const J=W[Y[0]].graph;G[q]=J,Q[J.value]=J}}const X=Object.keys(Q);if(X.length>0)if(X.length===1&&U.type!==types.PROJECT)D[X[0]]={graph:Q[X[0]],values:[F]};else for(let q of Object.keys(G))G[q].value.length>0&&(F[q]=factory.createGraph(F[q],G[q]));return F}function potentialGraphFromPatterns(U){const D=factory.createBgp(U),F=U[0].graph;return F.value.length===0?D:factory.createGraph(D,F)}(function(U){var D=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(te,Z,ee,re){re===void 0&&(re=ee);var ne=Object.getOwnPropertyDescriptor(Z,ee);(!ne||("get"in ne?!Z.__esModule:ne.writable||ne.configurable))&&(ne={enumerable:!0,get:function(){return Z[ee]}}),Object.defineProperty(te,re,ne)}:function(te,Z,ee,re){re===void 0&&(re=ee),te[re]=Z[ee]}),F=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(te,Z){Object.defineProperty(te,"default",{enumerable:!0,value:Z})}:function(te,Z){te.default=Z}),G=commonjsGlobal&&commonjsGlobal.__importStar||function(te){if(te&&te.__esModule)return te;var Z={};if(te!=null)for(var ee in te)ee!=="default"&&Object.prototype.hasOwnProperty.call(te,ee)&&D(Z,te,ee);return F(Z,te),Z},Q=commonjsGlobal&&commonjsGlobal.__importDefault||function(te){return te&&te.__esModule?te:{default:te}};Object.defineProperty(U,"__esModule",{value:!0}),U.Util=U.toSparqlJs=U.toSparql=U.Factory=U.Algebra=U.translate=void 0;const X=Q(sparqlAlgebra);U.translate=X.default;const q=G(algebra);U.Algebra=q;const W=Q(factory$2);U.Factory=W.default;const Y=sparql;Object.defineProperty(U,"toSparql",{enumerable:!0,get:function(){return Y.toSparql}}),Object.defineProperty(U,"toSparqlJs",{enumerable:!0,get:function(){return Y.toSparqlJs}});const J=Q(util);U.Util=J.default})(sparqlalgebrajs);const index$1=getDefaultExportFromCjs(sparqlalgebrajs),__QUADSTORE_COMUNICA_EXTERNAL_MODULE_sparqlalgebrajs__=_mergeNamespaces({__proto__:null,default:index$1},[sparqlalgebrajs]);var __quadstore_comunica_modules__={"../node_modules/@comunica/actor-abstract-path/lib/ActorAbstractPath.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorAbstractPath=void 0;const G=F("../node_modules/@comunica/bindings-factory/lib/index.js"),Q=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),X=F("../node_modules/@comunica/context-entries/lib/index.js"),q=F("asynciterator"),W=F("../node_modules/rdf-data-factory/index.js"),Y=F("../node_modules/rdf-string/index.js"),J=F("sparqlalgebrajs"),te=F("../node_modules/@comunica/actor-abstract-path/lib/PathVariableObjectIterator.js"),Z=new W.DataFactory,ee=new G.BindingsFactory;class re extends Q.ActorQueryOperationTypedMediated{constructor(le,se){super(le,"path"),this.predicateType=se}async testOperation(le,se){if(le.predicate.type!==this.predicateType)throw new Error(`This Actor only supports ${this.predicateType} Path operations.`);return!0}generateVariable(le,se){return se?le&&(le.subject.value===se||le.object.value===se)?this.generateVariable(le,`${se}b`):Z.variable(se):this.generateVariable(le,"b")}async isPathArbitraryLengthDistinct(le,se){return le.get(X.KeysQueryOperation.isPathArbitraryLengthDistinctKey)?(le=le.set(X.KeysQueryOperation.isPathArbitraryLengthDistinctKey,!1),{context:le,operation:void 0}):(le=le.set(X.KeysQueryOperation.isPathArbitraryLengthDistinctKey,!0),{context:le,operation:Q.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:re.FACTORY.createDistinct(se),context:le}))})}async predicateStarGraphVariable(le,se,ie,ge,fe){const ae=this.generateVariable(re.FACTORY.createPath(le,ie,se,ge)),ue=re.FACTORY.createUnion([re.FACTORY.createPattern(le,ae,se,ge),re.FACTORY.createPattern(se,ae,le,ge)]),pe=Q.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({context:fe,operation:ue})),_e=new Set;return{bindingsStream:new q.MultiTransformIterator(pe.bindingsStream,{multiTransform:be=>{const Te=be.get(ge);return _e.has(Te.value)?new q.EmptyIterator:(_e.add(Te.value),new q.TransformIterator(async()=>{const ye=new q.BufferedIterator;return await this.getObjectsPredicateStar(le,ie,Te,fe,{},ye,{count:0}),ye.transform({transform(Ee,he,oe){oe(ee.bindings([[se,Ee],[ge,Te]])),he()}})},{maxBufferSize:128}))},autoStart:!1}),metadata:pe.metadata}}async getObjectsPredicateStarEval(le,se,ie,ge,fe,ae){if(ge.termType==="Variable")return this.predicateStarGraphVariable(le,ie,se,ge,fe);const ue=new te.PathVariableObjectIterator(le,se,ge,fe,this.mediatorQueryOperation,ae);return{bindingsStream:ue.transform({autoStart:!1,transform(_e,xe,be){be(ee.bindings([[ie,_e]])),xe()}}),metadata:()=>new Promise(_e=>ue.getProperty("metadata",xe=>_e(xe())))}}async getObjectsPredicateStar(le,se,ie,ge,fe,ae,ue){const pe=(0,Y.termToString)(le);if(fe[pe])return;ae._push(le),fe[pe]=le,ue.count++;const _e=this.generateVariable(),xe=re.FACTORY.createPath(le,se,_e,ie),be=Q.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:xe,context:ge}));return be.bindingsStream.on("data",async Te=>{const ye=Te.get(_e);await this.getObjectsPredicateStar(ye,se,ie,ge,fe,ae,ue)}),be.bindingsStream.on("end",()=>{--ue.count===0&&ae.close()}),be.metadata}async getSubjectAndObjectBindingsPredicateStar(le,se,ie,ge,fe,ae,ue,pe,_e,xe,be){const Te=(0,Y.termToString)(ge)+(0,Y.termToString)(ae);if(_e[Te])return;if(be.count++,_e[Te]=!0,xe._push(ee.bindings([[le,ie],[se,ge]])),Te in pe){const Ee=await pe[Te];for(const he of Ee)await this.getSubjectAndObjectBindingsPredicateStar(le,se,ie,he,fe,ae,ue,pe,_e,xe,be);--be.count===0&&xe.close();return}const ye=new Promise(async(Ee,he)=>{const oe=[],me=this.generateVariable(),ve=re.FACTORY.createPath(ge,fe,me,ae),we=Q.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:ve,context:ue}));we.bindingsStream.on("data",async Pe=>{const Me=Pe.get(me);oe.push(Me),await this.getSubjectAndObjectBindingsPredicateStar(le,se,ie,Me,fe,ae,ue,pe,_e,xe,be)}),we.bindingsStream.on("error",he),we.bindingsStream.on("end",()=>{--be.count===0&&xe.close(),Ee(oe)})});pe[Te]=ye}}D.ActorAbstractPath=re,re.FACTORY=new J.Factory},"../node_modules/@comunica/actor-abstract-path/lib/PathVariableObjectIterator.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.PathVariableObjectIterator=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("asynciterator"),X=F("../node_modules/rdf-data-factory/index.js"),q=F("../node_modules/rdf-string/index.js"),W=F("sparqlalgebrajs"),Y=new X.DataFactory,J=new W.Factory;class te extends Q.BufferedIterator{constructor(ee,re,ne,le,se,ie,ge=16){super({autoStart:!0}),this.subject=ee,this.predicate=re,this.graph=ne,this.context=le,this.mediatorQueryOperation=se,this.maxRunningOperations=ge,this.termHashes=new Map,this.runningOperations=[],this.pendingOperations=[],this._push(this.subject,ie)}_end(ee){for(const re of this.runningOperations)re.destroy();super._end(ee)}_push(ee,re=!0){let ne;if(re&&(ne=(0,q.termToString)(ee),this.termHashes.has(ne)))return;const le=Y.variable("b");this.pendingOperations.push({variable:le,operation:J.createPath(ee,this.predicate,le,this.graph)}),ne&&(this.termHashes.set(ne,ee),super._push(ee))}_read(ee,re){const ne=this;(async function(){for(;ne.runningOperations.length<ne.maxRunningOperations&&ne.pendingOperations.length!==0;){const ie=ne.pendingOperations.pop(),ge=G.ActorQueryOperation.getSafeBindings(await ne.mediatorQueryOperation.mediate({operation:ie.operation,context:ne.context})),fe=ge.bindingsStream.transform({autoStart:!1,transform(ae,ue,pe){const _e=ae.get(ie.variable);pe(_e),ue()}});fe.done||(ne.runningOperations.push(fe),fe.on("error",ae=>ne.destroy(ae)),fe.on("readable",()=>{ne.readable=!0,ne._fillBufferAsync()}),fe.on("end",()=>{ne.runningOperations.splice(ne.runningOperations.indexOf(fe),1),ne.readable=!0,ne._fillBufferAsync()})),ne.setProperty("metadata",ge.metadata)}let le=0,se;for(;le!==(le=ee);)for(let ie=0;ie<ne.runningOperations.length&&ee>0;ie++)(se=ne.runningOperations[ie].read())!==null&&(ee--,ne._push(se));ne.runningOperations.length===0&&ne.pendingOperations.length===0&&ne.close()})().then(()=>{re()},le=>this.destroy(le))}}D.PathVariableObjectIterator=te},"../node_modules/@comunica/actor-abstract-path/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-abstract-path/lib/ActorAbstractPath.js"),D),Q(F("../node_modules/@comunica/actor-abstract-path/lib/PathVariableObjectIterator.js"),D)},"../node_modules/@comunica/actor-context-preprocess-source-to-destination/lib/ActorContextPreprocessSourceToDestination.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorContextPreprocessSourceToDestination=void 0;const G=F("../node_modules/@comunica/bus-context-preprocess/lib/index.js"),Q=F("../node_modules/@comunica/context-entries/lib/index.js");class X extends G.ActorContextPreprocess{constructor(W){super(W)}async test(W){return!0}async run(W){if(W.context.get(Q.KeysRdfResolveQuadPattern.sources)&&!W.context.get(Q.KeysRdfUpdateQuads.destination)){const Y=W.context.get(Q.KeysRdfResolveQuadPattern.sources);if(Y.length===1)return{context:W.context.set(Q.KeysRdfUpdateQuads.destination,Y[0])}}return W}}D.ActorContextPreprocessSourceToDestination=X},"../node_modules/@comunica/actor-context-preprocess-source-to-destination/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-context-preprocess-source-to-destination/lib/ActorContextPreprocessSourceToDestination.js"),D)},"../node_modules/@comunica/actor-hash-bindings-sha1/lib/ActorHashBindingsSha1.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorHashBindingsSha1=void 0;const G=F("../node_modules/@comunica/bus-hash-bindings/lib/index.js"),Q=F("../node_modules/hash.js/lib/hash.js"),X=F("../node_modules/rdf-string/index.js"),q=F("../node_modules/canonicalize/lib/canonicalize.js");class W extends G.ActorHashBindings{async test(J){if(!J.allowHashCollisions)throw new Error(`Actor ${this.name} can not provide hash functions without hash collisions`);return!0}async run(J){return{hashFunction:te=>(0,Q.sha1)().update(q(Object.fromEntries([...te].map(([Z,ee])=>[(0,X.termToString)(Z),(0,X.termToString)(ee)])))).digest("hex"),hashCollisions:!0}}}D.ActorHashBindingsSha1=W},"../node_modules/@comunica/actor-hash-bindings-sha1/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-hash-bindings-sha1/lib/ActorHashBindingsSha1.js"),D)},"../node_modules/@comunica/actor-init-query/lib/ActorInitQuery-browser.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorInitQuery=void 0;const G=F("../node_modules/@comunica/actor-init-query/lib/ActorInitQueryBase.js");typeof process>"u"&&(globalThis.process=F("./require-empty.js"));class Q extends G.ActorInitQueryBase{}D.ActorInitQuery=Q},"../node_modules/@comunica/actor-init-query/lib/ActorInitQueryBase.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorInitQueryBase=void 0;const G=F("../node_modules/@comunica/bus-init/lib/index.js");class Q extends G.ActorInit{constructor(q){q.contextKeyShortcutsExtensions?.forEach(W=>{if(Object.keys(q.contextKeyShortcuts).some(Y=>Object.keys(W).includes(Y)))throw new Error("Duplicate keys found while adding `contextKeyShortcutsExtensions`.");q.contextKeyShortcuts={...q.contextKeyShortcuts,...W}}),super(q)}async test(q){return!0}async run(q){throw new Error("ActorInitSparql#run is not supported in the browser.")}}D.ActorInitQueryBase=Q},"../node_modules/@comunica/actor-init-query/lib/MemoryPhysicalQueryPlanLogger.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.MemoryPhysicalQueryPlanLogger=void 0;const G=F("../node_modules/rdf-string/index.js");class Q{constructor(){this.children=new Map}logOperation(q,W,Y,J,te,Z){const ee={actor:te,logicalOperator:q,physicalOperator:W,rawNode:Y,children:[],metadata:Z};if(this.children.set(Y,ee.children),this.rootNode){if(!J)throw new Error("Detected more than one parent-less node");const re=this.children.get(J);if(!re)throw new Error("Could not find parent node");re.push(ee)}else{if(J)throw new Error("No root node has been set yet, while a parent is being referenced");this.rootNode=ee}}toJson(){return this.rootNode?this.planNodeToJson(this.rootNode):{}}planNodeToJson(q){return{logical:q.logicalOperator,physical:q.physicalOperator,...this.getLogicalMetadata(q.rawNode),...q.metadata,...q.children.length>0?{children:q.children.map(W=>this.planNodeToJson(W))}:{}}}getLogicalMetadata(q){if("type"in q){const W=q;switch(W.type){case"pattern":return{pattern:this.quadToString(W)};case"project":return{variables:W.variables.map(Y=>Y.value)}}}return{}}quadToString(q){return`${(0,G.termToString)(q.subject)} ${(0,G.termToString)(q.predicate)} ${(0,G.termToString)(q.object)}${q.graph.termType==="DefaultGraph"?"":` ${(0,G.termToString)(q.graph)}`}`}}D.MemoryPhysicalQueryPlanLogger=Q},"../node_modules/@comunica/actor-init-query/lib/QueryEngineBase.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.QueryEngineBase=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/@comunica/context-entries/lib/index.js"),X=F("../node_modules/@comunica/core/lib/index.js"),q=F("../node_modules/@comunica/actor-init-query/lib/MemoryPhysicalQueryPlanLogger.js");class W{constructor(J){this.actorInitQuery=J,this.defaultFunctionArgumentsCache={}}async queryBindings(J,te){return this.queryOfType(J,te,"bindings")}async queryQuads(J,te){return this.queryOfType(J,te,"quads")}async queryBoolean(J,te){return this.queryOfType(J,te,"boolean")}async queryVoid(J,te){return this.queryOfType(J,te,"void")}async queryOfType(J,te,Z){const ee=await this.query(J,te);if(ee.resultType===Z)return ee.execute();throw new Error(`Query result type '${Z}' was expected, while '${ee.resultType}' was found.`)}async query(J,te){const Z=await this.queryOrExplain(J,te);if("explain"in Z)throw new Error("Tried to explain a query when in query-only mode");return Z}async explain(J,te,Z){return te.explain=Z,await this.queryOrExplain(J,te)}async queryOrExplain(J,te){te=te||{};for(const ae in te)this.actorInitQuery.contextKeyShortcuts[ae]&&(te[this.actorInitQuery.contextKeyShortcuts[ae]]=te[ae],delete te[ae]);let Z=new X.ActionContext(te),ee={language:"sparql",version:"1.1"};Z.has(Q.KeysInitQuery.queryFormat)&&(ee=Z.get(Q.KeysInitQuery.queryFormat),Z=Z.delete(Q.KeysInitQuery.queryFormat),ee.language==="graphql"&&(Z=Z.setDefault(Q.KeysInitQuery.graphqlSingularizeVariables,{})));const re=Z.get(Q.KeysInitQuery.baseIRI);Z=Z.setDefault(Q.KeysInitQuery.queryTimestamp,new Date).setDefault(Q.KeysRdfResolveQuadPattern.sourceIds,new Map).setDefault(Q.KeysCore.log,this.actorInitQuery.logger).setDefault(Q.KeysInitQuery.functionArgumentsCache,this.defaultFunctionArgumentsCache).setDefault(Q.KeysRdfResolveQuadPattern.hypermediaSourcesAggregatedStores,new Map),Z=(await this.actorInitQuery.mediatorContextPreprocess.mediate({context:Z})).context;const ne=Z.get(Q.KeysInitQuery.explain);let le;if(typeof J=="string"){Z=Z.set(Q.KeysInitQuery.queryString,J);const ae=await this.actorInitQuery.mediatorQueryParse.mediate({context:Z,query:J,queryFormat:ee,baseIRI:re});le=ae.operation,ae.baseIRI&&(Z=Z.set(Q.KeysInitQuery.baseIRI,ae.baseIRI))}else le=J;if(ne==="parsed")return{explain:!0,type:ne,data:le};Z.has(Q.KeysInitQuery.initialBindings)&&(le=(0,G.materializeOperation)(le,Z.get(Q.KeysInitQuery.initialBindings)),Z=Z.delete(Q.KeysInitQuery.queryString));const se=await this.actorInitQuery.mediatorOptimizeQueryOperation.mediate({context:Z,operation:le});if(le=se.operation,Z=se.context||Z,ne==="logical")return{explain:!0,type:ne,data:le};Z=Z.set(Q.KeysInitQuery.query,le);let ie;ne==="physical"&&(ie=new q.MemoryPhysicalQueryPlanLogger,Z=Z.set(Q.KeysInitQuery.physicalQueryPlanLogger,ie));const ge=await this.actorInitQuery.mediatorQueryOperation.mediate({context:Z,operation:le});ge.context=Z;const fe=W.internalToFinalResult(ge);if(ie){switch(fe.resultType){case"bindings":await (await fe.execute()).toArray();break;case"quads":await (await fe.execute()).toArray();break;case"boolean":await fe.execute();break;case"void":await fe.execute();break}return{explain:!0,type:ne,data:ie.toJson()}}return fe}async getResultMediaTypes(J){return J=X.ActionContext.ensureActionContext(J),(await this.actorInitQuery.mediatorQueryResultSerializeMediaTypeCombiner.mediate({context:J,mediaTypes:!0})).mediaTypes}async getResultMediaTypeFormats(J){return J=X.ActionContext.ensureActionContext(J),(await this.actorInitQuery.mediatorQueryResultSerializeMediaTypeFormatCombiner.mediate({context:J,mediaTypeFormats:!0})).mediaTypeFormats}async resultToString(J,te,Z){if(Z=X.ActionContext.ensureActionContext(Z),!te)switch(J.resultType){case"bindings":te="application/json";break;case"quads":te="application/trig";break;default:te="simple";break}const ee={...await W.finalToInternalResult(J),context:Z};return(await this.actorInitQuery.mediatorQueryResultSerialize.mediate({context:Z,handle:ee,handleMediaType:te})).handle}invalidateHttpCache(J,te){return te=X.ActionContext.ensureActionContext(te),this.actorInitQuery.mediatorHttpInvalidate.mediate({url:J,context:te})}static internalToFinalResult(J){switch(J.type){case"bindings":return{resultType:"bindings",execute:async()=>J.bindingsStream,metadata:async()=>await J.metadata(),context:J.context};case"quads":return{resultType:"quads",execute:async()=>J.quadStream,metadata:async()=>await J.metadata(),context:J.context};case"boolean":return{resultType:"boolean",execute:async()=>J.execute(),context:J.context};case"void":return{resultType:"void",execute:async()=>J.execute(),context:J.context}}}static async finalToInternalResult(J){switch(J.resultType){case"bindings":return{type:"bindings",bindingsStream:await J.execute(),metadata:async()=>await J.metadata()};case"quads":return{type:"quads",quadStream:await J.execute(),metadata:async()=>await J.metadata()};case"boolean":return{type:"boolean",execute:()=>J.execute()};case"void":return{type:"void",execute:()=>J.execute()}}}}D.QueryEngineBase=W},"../node_modules/@comunica/actor-init-query/lib/index-browser.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(q,W,Y,J){J===void 0&&(J=Y);var te=Object.getOwnPropertyDescriptor(W,Y);(!te||("get"in te?!W.__esModule:te.writable||te.configurable))&&(te={enumerable:!0,get:function(){return W[Y]}}),Object.defineProperty(q,J,te)}:function(q,W,Y,J){J===void 0&&(J=Y),q[J]=W[Y]}),Q=this&&this.__exportStar||function(q,W){for(var Y in q)Y!=="default"&&!Object.prototype.hasOwnProperty.call(W,Y)&&G(W,q,Y)};Object.defineProperty(D,"__esModule",{value:!0}),D.QueryEngineBase=void 0,Q(F("../node_modules/@comunica/actor-init-query/lib/ActorInitQueryBase.js"),D),Q(F("../node_modules/@comunica/actor-init-query/lib/ActorInitQuery-browser.js"),D);var X=F("../node_modules/@comunica/actor-init-query/lib/QueryEngineBase.js");Object.defineProperty(D,"QueryEngineBase",{enumerable:!0,get:function(){return X.QueryEngineBase}})},"../node_modules/@comunica/actor-optimize-query-operation-bgp-to-join/lib/ActorOptimizeQueryOperationBgpToJoin.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorOptimizeQueryOperationBgpToJoin=void 0;const G=F("../node_modules/@comunica/bus-optimize-query-operation/lib/index.js"),Q=F("sparqlalgebrajs");class X extends G.ActorOptimizeQueryOperation{async test(W){return!0}async run(W){return{operation:Q.Util.mapOperation(W.operation,{bgp(J,te){return{recurse:!1,result:te.createJoin(J.patterns)}}}),context:W.context}}}D.ActorOptimizeQueryOperationBgpToJoin=X},"../node_modules/@comunica/actor-optimize-query-operation-bgp-to-join/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-optimize-query-operation-bgp-to-join/lib/ActorOptimizeQueryOperationBgpToJoin.js"),D)},"../node_modules/@comunica/actor-optimize-query-operation-join-bgp/lib/ActorOptimizeQueryOperationJoinBgp.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorOptimizeQueryOperationJoinBgp=void 0;const G=F("../node_modules/@comunica/bus-optimize-query-operation/lib/index.js"),Q=F("sparqlalgebrajs");class X extends G.ActorOptimizeQueryOperation{async test(W){return!0}async run(W){return{operation:Q.Util.mapOperation(W.operation,{join(J,te){return J.input.every(Z=>Z.type==="bgp")?{recurse:!1,result:te.createBgp(J.input.flatMap(Z=>Z.patterns))}:{recurse:!1,result:J}}}),context:W.context}}}D.ActorOptimizeQueryOperationJoinBgp=X},"../node_modules/@comunica/actor-optimize-query-operation-join-bgp/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-optimize-query-operation-join-bgp/lib/ActorOptimizeQueryOperationJoinBgp.js"),D)},"../node_modules/@comunica/actor-optimize-query-operation-join-connected/lib/ActorOptimizeQueryOperationJoinConnected.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorOptimizeQueryOperationJoinConnected=void 0;const G=F("../node_modules/@comunica/bus-optimize-query-operation/lib/index.js"),Q=F("sparqlalgebrajs");class X extends G.ActorOptimizeQueryOperation{async test(W){return!0}async run(W){return{operation:Q.Util.mapOperation(W.operation,{join(J,te){return{recurse:!1,result:X.cluster(J,te)}}}),context:W.context}}static cluster(W,Y){const J=W.input.map(re=>({inScopeVariables:Object.fromEntries(Q.Util.inScopeVariables(re).map(ne=>[ne.value,!0])),entries:[re]}));let te,Z=J;do te=Z,Z=X.clusterIteration(te);while(te.length!==Z.length);const ee=Z.map(re=>Y.createJoin(re.entries));return ee.length===1?ee[0]:Y.createJoin(ee,!1)}static clusterIteration(W){const Y=[];for(const J of W){let te=!1;for(const Z of Y)if(X.haveOverlappingVariables(J.inScopeVariables,Z.inScopeVariables)){Z.entries=[...Z.entries,...J.entries],Z.inScopeVariables={...Z.inScopeVariables,...J.inScopeVariables},te=!0;break}te||Y.push({inScopeVariables:J.inScopeVariables,entries:J.entries})}return Y}static haveOverlappingVariables(W,Y){for(const J of Object.keys(W))if(Y[J])return!0;return!1}}D.ActorOptimizeQueryOperationJoinConnected=X},"../node_modules/@comunica/actor-optimize-query-operation-join-connected/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-optimize-query-operation-join-connected/lib/ActorOptimizeQueryOperationJoinConnected.js"),D)},"../node_modules/@comunica/actor-query-operation-ask/lib/ActorQueryOperationAsk.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationAsk=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js");class Q extends G.ActorQueryOperationTypedMediated{constructor(q){super(q,"ask")}async testOperation(q,W){return!0}async runOperation(q,W){const Y=await this.mediatorQueryOperation.mediate({operation:q.input,context:W}),{bindingsStream:J}=G.ActorQueryOperation.getSafeBindings(Y);return{type:"boolean",execute:async()=>(await J.take(1).toArray()).length===1}}}D.ActorQueryOperationAsk=Q},"../node_modules/@comunica/actor-query-operation-ask/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-ask/lib/ActorQueryOperationAsk.js"),D)},"../node_modules/@comunica/actor-query-operation-bgp-join/lib/ActorQueryOperationBgpJoin.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationBgpJoin=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("sparqlalgebrajs");class X extends G.ActorQueryOperationTypedMediated{constructor(W){super(W,"bgp")}async testOperation(W,Y){return!0}async runOperation(W,Y){return this.mediatorQueryOperation.mediate({operation:X.FACTORY.createJoin(W.patterns),context:Y})}}D.ActorQueryOperationBgpJoin=X,X.FACTORY=new Q.Factory},"../node_modules/@comunica/actor-query-operation-bgp-join/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-bgp-join/lib/ActorQueryOperationBgpJoin.js"),D)},"../node_modules/@comunica/actor-query-operation-construct/lib/ActorQueryOperationConstruct.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationConstruct=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/@comunica/context-entries/lib/index.js"),X=F("../node_modules/rdf-terms/index.js"),q=F("sparqlalgebrajs"),W=F("../node_modules/@comunica/actor-query-operation-construct/lib/BindingsToQuadsIterator.js");class Y extends G.ActorQueryOperationTypedMediated{constructor(te){super(te,"construct")}static getVariables(te){return(0,X.uniqTerms)([].concat.apply([],te.map(Z=>(0,X.getVariables)((0,X.getTerms)(Z)))))}async testOperation(te,Z){return!0}async runOperation(te,Z){const ee=Y.getVariables(te.template),re={type:q.Algebra.types.PROJECT,input:te.input,variables:ee},ne=G.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:re,context:Z})),le=Z.get(Q.KeysQueryOperation.localizeBlankNodes),se=le!==void 0?le:!0,ie=new W.BindingsToQuadsIterator(te.template,ne.bindingsStream,se);return{metadata:()=>ne.metadata().then(fe=>({...fe,order:void 0,cardinality:{type:fe.cardinality.type,value:fe.cardinality.value*te.template.length},canContainUndefs:!1,availableOrders:void 0})),quadStream:ie,type:"quads"}}}D.ActorQueryOperationConstruct=Y},"../node_modules/@comunica/actor-query-operation-construct/lib/BindingsToQuadsIterator.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.BindingsToQuadsIterator=void 0;const G=F("asynciterator"),Q=F("../node_modules/rdf-data-factory/index.js"),X=F("../node_modules/rdf-terms/index.js"),q=new Q.DataFactory;class W extends G.MultiTransformIterator{constructor(J,te,Z=!0){super(te,{autoStart:!1}),this.template=J,this.localizeBlankNodes=Z,this.blankNodeCounter=0}static bindTerm(J,te){return te.termType==="Variable"?J.get(te):te}static bindQuad(J,te){try{return(0,X.mapTerms)(te,Z=>{const ee=W.bindTerm(J,Z);if(!ee)throw new Error("Unbound term");return ee})}catch{}}static localizeBlankNode(J,te){return te.termType==="BlankNode"?q.blankNode(`${te.value}${J}`):te}static localizeQuad(J,te){return(0,X.mapTerms)(te,Z=>W.localizeBlankNode(J,Z))}bindTemplate(J,te,Z){let ee=te.map(re=>W.bindQuad.bind(null,J)(re)).filter(Boolean);return this.localizeBlankNodes&&(ee=ee.map(W.localizeQuad.bind(null,Z))),ee}_createTransformer(J){return new G.ArrayIterator(this.bindTemplate(J,this.template,this.blankNodeCounter++))}}D.BindingsToQuadsIterator=W},"../node_modules/@comunica/actor-query-operation-construct/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-construct/lib/ActorQueryOperationConstruct.js"),D),Q(F("../node_modules/@comunica/actor-query-operation-construct/lib/BindingsToQuadsIterator.js"),D)},"../node_modules/@comunica/actor-query-operation-describe-subject/lib/ActorQueryOperationDescribeSubject.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationDescribeSubject=void 0;const G=F("../node_modules/@comunica/actor-query-operation-union/lib/index.js"),Q=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),X=F("../node_modules/@comunica/context-entries/lib/index.js"),q=F("asynciterator"),W=F("../node_modules/rdf-data-factory/index.js"),Y=F("sparqlalgebrajs"),J=new W.DataFactory;class te extends Q.ActorQueryOperationTypedMediated{constructor(ee){super(ee,"describe")}async testOperation(ee,re){return!0}async runOperation(ee,re){const ne=ee.terms.filter(fe=>fe.termType!=="Variable").map(fe=>{const ae=[J.quad(fe,J.variable("__predicate"),J.variable("__object"))];return ae.forEach(pe=>pe.type="pattern"),{input:{type:Y.Algebra.types.BGP,patterns:ae},template:ae,type:"construct"}});if(ne.length!==ee.terms.length){let fe=[];ee.terms.filter(ae=>ae.termType==="Variable").forEach((ae,ue)=>{const pe=[J.quad(ae,J.variable(`__predicate${ue}`),J.variable(`__object${ue}`))];pe.forEach(_e=>_e.type="pattern"),fe=[...fe,...pe]}),ne.push({input:{type:Y.Algebra.types.JOIN,input:[ee.input,{type:Y.Algebra.types.BGP,patterns:fe}]},template:fe,type:Y.Algebra.types.CONSTRUCT})}const le=re.get(X.KeysQueryOperation.localizeBlankNodes);re=re.set(X.KeysQueryOperation.localizeBlankNodes,le!==void 0?le:!1);const se=(await Promise.all(ne.map(fe=>this.mediatorQueryOperation.mediate({operation:fe,context:re})))).map(Q.ActorQueryOperation.getSafeQuads);return{type:"quads",quadStream:new q.UnionIterator(se.map(fe=>fe.quadStream),{autoStart:!1}),metadata:()=>Promise.all(se.map(fe=>fe.metadata())).then(fe=>G.ActorQueryOperationUnion.unionMetadata(fe,!1))}}}D.ActorQueryOperationDescribeSubject=te},"../node_modules/@comunica/actor-query-operation-describe-subject/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-describe-subject/lib/ActorQueryOperationDescribeSubject.js"),D)},"../node_modules/@comunica/actor-query-operation-distinct-hash/lib/ActorQueryOperationDistinctHash.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationDistinctHash=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js");class Q extends G.ActorQueryOperationTypedMediated{constructor(q){super(q,"distinct")}async testOperation(q,W){return!0}async runOperation(q,W){const Y=G.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:q.input,context:W}));return{type:"bindings",bindingsStream:Y.bindingsStream.filter(await this.newHashFilter(W)),metadata:Y.metadata}}async newHashFilter(q){const{hashFunction:W}=await this.mediatorHashBindings.mediate({allowHashCollisions:!0,context:q}),Y={};return J=>{const te=W(J);return!(te in Y)&&(Y[te]=!0)}}}D.ActorQueryOperationDistinctHash=Q},"../node_modules/@comunica/actor-query-operation-distinct-hash/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-distinct-hash/lib/ActorQueryOperationDistinctHash.js"),D)},"../node_modules/@comunica/actor-query-operation-extend/lib/ActorQueryOperationExtend.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationExtend=void 0;const G=F("../node_modules/@comunica/bindings-factory/lib/index.js"),Q=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),X=F("../node_modules/sparqlee/dist/index.js");class q extends Q.ActorQueryOperationTypedMediated{constructor(Y){super(Y,"extend")}async testOperation(Y,J){return new X.AsyncEvaluator(Y.expression,Q.ActorQueryOperation.getAsyncExpressionContext(J,this.mediatorQueryOperation)),!0}async runOperation(Y,J){const{expression:te,input:Z,variable:ee}=Y,re=Q.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:Z,context:J})),ne={...Q.ActorQueryOperation.getAsyncExpressionContext(J,this.mediatorQueryOperation)},le=new X.AsyncEvaluator(te,ne),se=async(ge,fe,ae)=>{try{const ue=await le.evaluate(ge),pe=ge.set(ee,ue);ae(pe)}catch(ue){(0,X.isExpressionError)(ue)?(ae(ge),this.logWarn(J,`Expression error for extend operation with bindings '${(0,G.bindingsToString)(ge)}'`)):ie.emit("error",ue)}fe()},ie=re.bindingsStream.transform({autoStart:!1,transform:se});return{type:"bindings",bindingsStream:ie,async metadata(){const ge=await re.metadata();return{...ge,variables:[...ge.variables,ee]}}}}}D.ActorQueryOperationExtend=q},"../node_modules/@comunica/actor-query-operation-extend/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-extend/lib/ActorQueryOperationExtend.js"),D)},"../node_modules/@comunica/actor-query-operation-filter-sparqlee/lib/ActorQueryOperationFilterSparqlee.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationFilterSparqlee=void 0;const G=F("../node_modules/@comunica/bindings-factory/lib/index.js"),Q=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),X=F("../node_modules/sparqlee/dist/index.js");class q extends Q.ActorQueryOperationTypedMediated{constructor(Y){super(Y,"filter")}async testOperation(Y,J){const te={...Q.ActorQueryOperation.getAsyncExpressionContext(J,this.mediatorQueryOperation)};return new X.AsyncEvaluator(Y.expression,te),!0}async runOperation(Y,J){const te=await this.mediatorQueryOperation.mediate({operation:Y.input,context:J}),Z=Q.ActorQueryOperation.getSafeBindings(te);Q.ActorQueryOperation.validateQueryOutput(Z,"bindings");const ee={...Q.ActorQueryOperation.getAsyncExpressionContext(J,this.mediatorQueryOperation)},re=new X.AsyncEvaluator(Y.expression,ee),ne=async(se,ie,ge)=>{try{await re.evaluateAsEBV(se)&&ge(se)}catch(fe){(0,X.isExpressionError)(fe)?this.logWarn(J,"Error occurred while filtering.",()=>({error:fe,bindings:(0,G.bindingsToString)(se)})):le.emit("error",fe)}ie()},le=Z.bindingsStream.transform({transform:ne});return{type:"bindings",bindingsStream:le,metadata:Z.metadata}}}D.ActorQueryOperationFilterSparqlee=q},"../node_modules/@comunica/actor-query-operation-filter-sparqlee/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-filter-sparqlee/lib/ActorQueryOperationFilterSparqlee.js"),D)},"../node_modules/@comunica/actor-query-operation-from-quad/lib/ActorQueryOperationFromQuad.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationFromQuad=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("sparqlalgebrajs");class X extends G.ActorQueryOperationTypedMediated{constructor(W){super(W,"from")}static copyOperation(W,Y){const J={};for(const te of Object.keys(W))Array.isArray(W[te])&&te!=="template"?te==="variables"?J[te]=W[te]:J[te]=W[te].map(Y):X.ALGEBRA_TYPES.includes(W[te].type)?J[te]=Y(W[te]):J[te]=W[te];return J}static applyOperationDefaultGraph(W,Y){if(W.type==="bgp"&&W.patterns.length>0||W.type==="path"||W.type==="pattern"){if(W.type==="bgp")return X.joinOperations(W.patterns.map(te=>{if(te.graph.termType!=="DefaultGraph")return X.FACTORY.createBgp([te]);const Z=Y.map(ee=>X.FACTORY.createBgp([X.FACTORY.createPattern(te.subject,te.predicate,te.object,ee)]));return X.unionOperations(Z)}));if(W.graph.termType!=="DefaultGraph")return W;const J=Y.map(te=>W.type==="path"?X.FACTORY.createPath(W.subject,W.predicate,W.object,te):X.FACTORY.createPattern(W.subject,W.predicate,W.object,te));return X.unionOperations(J)}return X.copyOperation(W,J=>this.applyOperationDefaultGraph(J,Y))}static applyOperationNamedGraph(W,Y,J){if(W.type==="bgp"&&W.patterns.length>0||W.type==="path"||W.type==="pattern"){const te=W.type==="bgp"?W.patterns[0].graph:W.graph;if(te.termType==="DefaultGraph")return{type:Q.Algebra.types.BGP,patterns:[]};if(te.termType==="Variable"){if(Y.length===1){const ee=Y[0],re={};re[`?${te.value}`]=ee;const ne=X.FACTORY.createValues([te],[re]);let le;return W.type==="bgp"?le=X.FACTORY.createBgp(W.patterns.map(se=>X.FACTORY.createPattern(se.subject,se.predicate,se.object,ee))):W.type==="path"?le=X.FACTORY.createPath(W.subject,W.predicate,W.object,ee):le=X.FACTORY.createPattern(W.subject,W.predicate,W.object,ee),X.FACTORY.createJoin([ne,le])}return X.unionOperations(Y.map(ee=>X.applyOperationNamedGraph(W,[ee],J)))}return[...Y,...J].some(ee=>ee.equals(te))?W:{type:Q.Algebra.types.BGP,patterns:[]}}return X.copyOperation(W,te=>this.applyOperationNamedGraph(te,Y,J))}static joinOperations(W){if(W.length===1)return W[0];if(W.length>1)return X.FACTORY.createJoin(W);throw new Error("A join can only be applied on at least one operation")}static unionOperations(W){if(W.length===1)return W[0];if(W.length>1)return X.FACTORY.createUnion(W);throw new Error("A union can only be applied on at least one operation")}static createOperation(W){let Y=W.input;return W.default.length>0&&(Y=X.applyOperationDefaultGraph(Y,W.default)),(W.named.length>0||W.default.length>0)&&(Y=X.applyOperationNamedGraph(Y,W.named,W.default)),Y}async testOperation(W,Y){return!0}async runOperation(W,Y){const J=X.createOperation(W);return this.mediatorQueryOperation.mediate({operation:J,context:Y})}}D.ActorQueryOperationFromQuad=X,X.FACTORY=new Q.Factory,X.ALGEBRA_TYPES=Object.keys(Q.Algebra.types).map(q=>Q.Algebra.types[q])},"../node_modules/@comunica/actor-query-operation-from-quad/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-from-quad/lib/ActorQueryOperationFromQuad.js"),D)},"../node_modules/@comunica/actor-query-operation-group/lib/ActorQueryOperationGroup.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationGroup=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("asynciterator"),X=F("../node_modules/sparqlee/dist/index.js"),q=F("../node_modules/@comunica/actor-query-operation-group/lib/GroupsState.js");class W extends G.ActorQueryOperationTypedMediated{constructor(J){super(J,"group")}async testOperation(J,te){for(const Z of J.aggregates)new X.AsyncEvaluator(Z.expression,G.ActorQueryOperation.getAsyncExpressionContext(te));return!0}async runOperation(J,te){const{hashFunction:Z}=await this.mediatorHashBindings.mediate({allowHashCollisions:!0,context:te}),{input:ee,aggregates:re}=J,ne=await this.mediatorQueryOperation.mediate({operation:ee,context:te}),le=G.ActorQueryOperation.getSafeBindings(ne),se=[...J.variables,...re.map(fe=>fe.variable)],ie=G.ActorQueryOperation.getAsyncExpressionContext(te);return{type:"bindings",bindingsStream:new Q.TransformIterator(()=>new Promise((fe,ae)=>{const ue=new q.GroupsState(Z,J,ie);le.bindingsStream.on("end",async()=>{try{const pe=new Q.ArrayIterator(await ue.collectResults(),{autoStart:!1});fe(pe)}catch(pe){ae(pe)}}),le.bindingsStream.on("error",ae),le.bindingsStream.on("data",pe=>{ue.consumeBindings(pe).catch(ae)})}),{autoStart:!1}),metadata:async()=>({...await le.metadata(),variables:se})}}}D.ActorQueryOperationGroup=W},"../node_modules/@comunica/actor-query-operation-group/lib/GroupsState.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.GroupsState=void 0;const G=F("../node_modules/@comunica/bindings-factory/lib/index.js"),Q=F("../node_modules/rdf-data-factory/index.js"),X=F("../node_modules/sparqlee/dist/index.js"),q=new Q.DataFactory,W=new G.BindingsFactory;class Y{constructor(te,Z,ee){this.hashFunction=te,this.pattern=Z,this.sparqleeConfig=ee,this.groups=new Map,this.groupsInitializer=new Map,this.groupVariables=new Set(this.pattern.variables.map(re=>re.value)),this.distinctHashes=Z.aggregates.some(({distinct:re})=>re)?new Map:null,this.waitCounter=1,this.resultHasBeenCalled=!1}consumeBindings(te){const Z=this.resultCheck();if(Z)return Z;this.waitCounter++;const ee=te.filter((se,ie)=>this.groupVariables.has(ie.value)),re=this.hashBindings(ee);let ne=this.groupsInitializer.get(re),le;if(!ne)ne=(async()=>{const se={};if(await Promise.all(this.pattern.aggregates.map(async ge=>{const fe=ge.variable.value;se[fe]=new X.AsyncAggregateEvaluator(ge,this.sparqleeConfig),await se[fe].put(te)})),this.distinctHashes){const ge=this.hashBindings(te);this.distinctHashes.set(re,new Set([ge]))}const ie={aggregators:se,bindings:ee};return this.groups.set(re,ie),this.subtractWaitCounterAndCollect(),ie})(),this.groupsInitializer.set(re,ne),le=ne;else{const se=ne;le=(async()=>{const ie=await se;await Promise.all(this.pattern.aggregates.map(async ge=>{if(ge.distinct){const ae=this.hashBindings(te);if(this.distinctHashes.get(re).has(ae))return;this.distinctHashes.get(re).add(ae)}const fe=ge.variable.value;await ie.aggregators[fe].put(te)}))})().then(()=>{this.subtractWaitCounterAndCollect()})}return le}subtractWaitCounterAndCollect(){--this.waitCounter===0&&this.handleResultCollection()}handleResultCollection(){let te=[...this.groups].map(([Z,ee])=>{const{bindings:re,aggregators:ne}=ee;let le=re;for(const se in ne){const ie=ne[se].result();ie&&(le=le.set(q.variable(se),ie))}return le});if(te.length===0&&this.groupVariables.size===0){const Z=[];for(const ee of this.pattern.aggregates){const re=ee.variable,ne=X.AsyncAggregateEvaluator.emptyValue(ee);ne!==void 0&&Z.push([re,ne])}te=[W.bindings(Z)]}this.waitResolver(te)}resultCheck(){if(this.resultHasBeenCalled)return Promise.reject(new Error("Calling any function after calling collectResult is invalid."))}collectResults(){const te=this.resultCheck();if(te)return te;this.resultHasBeenCalled=!0;const Z=new Promise(ee=>{this.waitResolver=ee});return this.subtractWaitCounterAndCollect(),Z}hashBindings(te){return this.hashFunction(te)}}D.GroupsState=Y},"../node_modules/@comunica/actor-query-operation-group/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-group/lib/ActorQueryOperationGroup.js"),D)},"../node_modules/@comunica/actor-query-operation-join/lib/ActorQueryOperationJoin.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationJoin=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js");class Q extends G.ActorQueryOperationTypedMediated{constructor(q){super(q,"join")}async testOperation(q,W){return!0}async runOperation(q,W){const Y=(await Promise.all(q.input.map(async J=>({output:await this.mediatorQueryOperation.mediate({operation:J,context:W}),operation:J})))).map(({output:J,operation:te})=>({output:G.ActorQueryOperation.getSafeBindings(J),operation:te}));return this.mediatorJoin.mediate({type:"inner",entries:Y,context:W})}}D.ActorQueryOperationJoin=Q},"../node_modules/@comunica/actor-query-operation-join/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-join/lib/ActorQueryOperationJoin.js"),D)},"../node_modules/@comunica/actor-query-operation-leftjoin/lib/ActorQueryOperationLeftJoin.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationLeftJoin=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/sparqlee/dist/index.js");class X extends G.ActorQueryOperationTypedMediated{constructor(W){super(W,"leftjoin")}async testOperation(W,Y){return!0}async runOperation(W,Y){const J=(await Promise.all(W.input.map(async Z=>({output:await this.mediatorQueryOperation.mediate({operation:Z,context:Y}),operation:Z})))).map(({output:Z,operation:ee})=>({output:G.ActorQueryOperation.getSafeBindings(Z),operation:ee})),te=await this.mediatorJoin.mediate({type:"optional",entries:J,context:Y});if(W.expression){const ee=(await J[1].output.metadata()).variables,re={...G.ActorQueryOperation.getAsyncExpressionContext(Y)},ne=new Q.AsyncEvaluator(W.expression,re),le=te.bindingsStream.transform({autoStart:!1,transform:async(se,ie,ge)=>{if(!ee.every(fe=>se.has(fe.value)))return ge(se),ie();try{await ne.evaluateAsEBV(se)&&ge(se)}catch(fe){(0,Q.isExpressionError)(fe)?this.logWarn(Y,"Error occurred while filtering.",()=>({error:fe,bindings:se})):le.emit("error",fe)}ie()}});te.bindingsStream=le}return te}}D.ActorQueryOperationLeftJoin=X},"../node_modules/@comunica/actor-query-operation-leftjoin/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-leftjoin/lib/ActorQueryOperationLeftJoin.js"),D)},"../node_modules/@comunica/actor-query-operation-minus/lib/ActorQueryOperationMinus.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationMinus=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js");class Q extends G.ActorQueryOperationTypedMediated{constructor(q){super(q,"minus")}async testOperation(q,W){return!0}async runOperation(q,W){const Y=(await Promise.all(q.input.map(async J=>({output:await this.mediatorQueryOperation.mediate({operation:J,context:W}),operation:J})))).map(({output:J,operation:te})=>({output:G.ActorQueryOperation.getSafeBindings(J),operation:te}));return this.mediatorJoin.mediate({type:"minus",entries:Y,context:W})}}D.ActorQueryOperationMinus=Q},"../node_modules/@comunica/actor-query-operation-minus/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-minus/lib/ActorQueryOperationMinus.js"),D)},"../node_modules/@comunica/actor-query-operation-nop/lib/ActorQueryOperationNop.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationNop=void 0;const G=F("../node_modules/@comunica/bindings-factory/lib/index.js"),Q=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),X=F("asynciterator"),q=new G.BindingsFactory;class W extends Q.ActorQueryOperationTypedMediated{constructor(J){super(J,"nop")}async testOperation(J,te){return!0}async runOperation(J,te){return{bindingsStream:new X.SingletonIterator(q.bindings()),metadata:()=>Promise.resolve({cardinality:{type:"exact",value:1},canContainUndefs:!1,variables:[]}),type:"bindings"}}}D.ActorQueryOperationNop=W},"../node_modules/@comunica/actor-query-operation-nop/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-nop/lib/ActorQueryOperationNop.js"),D)},"../node_modules/@comunica/actor-query-operation-orderby-sparqlee/lib/ActorQueryOperationOrderBySparqlee.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationOrderBySparqlee=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("sparqlalgebrajs"),X=F("../node_modules/sparqlee/dist/index.js"),q=F("../node_modules/@comunica/actor-query-operation-orderby-sparqlee/lib/SortIterator.js");class W extends G.ActorQueryOperationTypedMediated{constructor(J){super(J,"orderby"),this.window=J.window??Number.POSITIVE_INFINITY}async testOperation(J,te){for(let Z of J.expressions)Z=this.extractSortExpression(Z),new X.AsyncEvaluator(Z,G.ActorQueryOperation.getAsyncExpressionContext(te));return!0}async runOperation(J,te){const Z=await this.mediatorQueryOperation.mediate({operation:J.input,context:te}),ee=G.ActorQueryOperation.getSafeBindings(Z),re={window:this.window},ne={...G.ActorQueryOperation.getAsyncExpressionContext(te)};let{bindingsStream:le}=ee;for(let se=J.expressions.length-1;se>=0;se--){let ie=J.expressions[se];const ge=this.isAscending(ie);ie=this.extractSortExpression(ie);const fe=new X.AsyncEvaluator(ie,ne),ae=async(_e,xe,be)=>{try{const Te=await fe.evaluate(_e);be({bindings:_e,result:Te})}catch(Te){(0,X.isExpressionError)(Te)||le.emit("error",Te),be({bindings:_e,result:void 0})}xe()},ue=le.transform({transform:ae});le=new q.SortIterator(ue,(_e,xe)=>(0,X.orderTypes)(_e.result,xe.result,ge),re).map(({bindings:_e,result:xe})=>_e)}return{type:"bindings",bindingsStream:le,metadata:ee.metadata}}extractSortExpression(J){const{expressionType:te,operator:Z}=J;return te!==Q.Algebra.expressionTypes.OPERATOR?J:Z==="desc"?J.args[0]:J}isAscending(J){const{expressionType:te,operator:Z}=J;return te!==Q.Algebra.expressionTypes.OPERATOR?!0:Z!=="desc"}}D.ActorQueryOperationOrderBySparqlee=W},"../node_modules/@comunica/actor-query-operation-orderby-sparqlee/lib/SortIterator.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.SortIterator=void 0;const G=F("asynciterator");class Q extends G.TransformIterator{constructor(q,W,Y){super(q,Y);const J=Y&&Y.window;this.windowLength=Number.isFinite(J)&&J>0?J:Number.POSITIVE_INFINITY,this.sort=W,this.sorted=[]}_read(q,W){let Y,{length:J}=this.sorted;for(;J!==this.windowLength&&(Y=this.source.read(),Y!==null);){let te=0,Z=J-1,ee,re;for(;te<=Z;)ee=Math.trunc((te+Z)/2),re=this.sort(Y,this.sorted[ee]),re<0?te=ee+1:re>0?Z=ee-1:(te=ee,Z=-1);this.sorted.splice(te,0,Y),J++}J===this.windowLength&&this._push(this.sorted.pop()),W()}_flush(q){let{length:W}=this.sorted;for(;W--;)this._push(this.sorted.pop());q()}}D.SortIterator=Q},"../node_modules/@comunica/actor-query-operation-orderby-sparqlee/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-orderby-sparqlee/lib/ActorQueryOperationOrderBySparqlee.js"),D)},"../node_modules/@comunica/actor-query-operation-path-alt/lib/ActorQueryOperationPathAlt.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationPathAlt=void 0;const G=F("../node_modules/@comunica/actor-abstract-path/lib/index.js"),Q=F("../node_modules/@comunica/actor-query-operation-union/lib/index.js"),X=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),q=F("asynciterator"),W=F("sparqlalgebrajs");class Y extends G.ActorAbstractPath{constructor(te){super(te,W.Algebra.types.ALT)}async runOperation(te,Z){const ee=te.predicate,re=(await Promise.all(ee.input.map(se=>this.mediatorQueryOperation.mediate({context:Z,operation:G.ActorAbstractPath.FACTORY.createPath(te.subject,se,te.object,te.graph)})))).map(X.ActorQueryOperation.getSafeBindings);return{type:"bindings",bindingsStream:new q.UnionIterator(re.map(se=>se.bindingsStream),{autoStart:!1}),metadata:()=>Promise.all(re.map(se=>se.metadata())).then(se=>Q.ActorQueryOperationUnion.unionMetadata(se,!0))}}}D.ActorQueryOperationPathAlt=Y},"../node_modules/@comunica/actor-query-operation-path-alt/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-path-alt/lib/ActorQueryOperationPathAlt.js"),D)},"../node_modules/@comunica/actor-query-operation-path-inv/lib/ActorQueryOperationPathInv.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationPathInv=void 0;const G=F("../node_modules/@comunica/actor-abstract-path/lib/index.js"),Q=F("sparqlalgebrajs");class X extends G.ActorAbstractPath{constructor(W){super(W,Q.Algebra.types.INV)}async runOperation(W,Y){const J=W.predicate,te=G.ActorAbstractPath.FACTORY.createPath(W.object,J.path,W.subject,W.graph);return this.mediatorQueryOperation.mediate({operation:te,context:Y})}}D.ActorQueryOperationPathInv=X},"../node_modules/@comunica/actor-query-operation-path-inv/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-path-inv/lib/ActorQueryOperationPathInv.js"),D)},"../node_modules/@comunica/actor-query-operation-path-link/lib/ActorQueryOperationPathLink.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationPathLink=void 0;const G=F("../node_modules/@comunica/actor-abstract-path/lib/index.js"),Q=F("sparqlalgebrajs");class X extends G.ActorAbstractPath{constructor(W){super(W,Q.Algebra.types.LINK)}async runOperation(W,Y){const J=W.predicate,te=G.ActorAbstractPath.FACTORY.createPattern(W.subject,J.iri,W.object,W.graph);return this.mediatorQueryOperation.mediate({operation:te,context:Y})}}D.ActorQueryOperationPathLink=X},"../node_modules/@comunica/actor-query-operation-path-link/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-path-link/lib/ActorQueryOperationPathLink.js"),D)},"../node_modules/@comunica/actor-query-operation-path-nps/lib/ActorQueryOperationPathNps.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationPathNps=void 0;const G=F("../node_modules/@comunica/actor-abstract-path/lib/index.js"),Q=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),X=F("sparqlalgebrajs");class q extends G.ActorAbstractPath{constructor(Y){super(Y,X.Algebra.types.NPS)}async runOperation(Y,J){const te=Y.predicate,Z=this.generateVariable(Y),ee=G.ActorAbstractPath.FACTORY.createPattern(Y.subject,Z,Y.object,Y.graph),re=Q.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:ee,context:J}));return{type:"bindings",bindingsStream:re.bindingsStream.transform({filter(le){return!te.iris.some(se=>se.equals(le.get(Z)))},transform(le,se,ie){ie(le.delete(Z)),se()}}),metadata:re.metadata}}}D.ActorQueryOperationPathNps=q},"../node_modules/@comunica/actor-query-operation-path-nps/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-path-nps/lib/ActorQueryOperationPathNps.js"),D)},"../node_modules/@comunica/actor-query-operation-path-one-or-more/lib/ActorQueryOperationPathOneOrMore.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationPathOneOrMore=void 0;const G=F("../node_modules/@comunica/actor-abstract-path/lib/index.js"),Q=F("../node_modules/@comunica/bindings-factory/lib/index.js"),X=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),q=F("asynciterator"),W=F("sparqlalgebrajs"),Y=new Q.BindingsFactory;class J extends G.ActorAbstractPath{constructor(Z){super(Z,W.Algebra.types.ONE_OR_MORE_PATH)}async runOperation(Z,ee){const re=await this.isPathArbitraryLengthDistinct(ee,Z);if(re.operation)return re.operation;ee=re.context;const ne=Z.predicate;if(Z.subject.termType!=="Variable"&&Z.object.termType==="Variable"){const ge=Z.object,fe=await this.getObjectsPredicateStarEval(Z.subject,ne.path,ge,Z.graph,ee,!1),ae=Z.graph.termType==="Variable"?[ge,Z.graph]:[ge];return{type:"bindings",bindingsStream:fe.bindingsStream,metadata:async()=>({...await fe.metadata(),variables:ae})}}if(Z.subject.termType==="Variable"&&Z.object.termType==="Variable"){const ge=G.ActorAbstractPath.FACTORY.createDistinct(G.ActorAbstractPath.FACTORY.createPath(Z.subject,Z.predicate.path,Z.object,Z.graph)),fe=X.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({context:ee,operation:ge})),ae=Z.subject,ue=Z.object,pe={},_e=new q.MultiTransformIterator(fe.bindingsStream,{multiTransform:be=>{const Te=be.get(ae),ye=be.get(ue),Ee=Z.graph.termType==="Variable"?be.get(Z.graph):Z.graph;return new q.TransformIterator(async()=>{const he=new q.BufferedIterator;return await this.getSubjectAndObjectBindingsPredicateStar(ae,ue,Te,ye,ne.path,Ee,ee,pe,{},he,{count:0}),he.transform({transform(oe,me,ve){Z.graph.termType==="Variable"&&(oe=oe.set(Z.graph,Ee)),ve(oe),me()}})},{maxBufferSize:128})},autoStart:!1}),xe=Z.graph.termType==="Variable"?[ae,ue,Z.graph]:[ae,ue];return{type:"bindings",bindingsStream:_e,metadata:async()=>({...await fe.metadata(),variables:xe})}}if(Z.subject.termType==="Variable"&&Z.object.termType!=="Variable")return this.mediatorQueryOperation.mediate({context:ee,operation:G.ActorAbstractPath.FACTORY.createPath(Z.object,G.ActorAbstractPath.FACTORY.createOneOrMorePath(G.ActorAbstractPath.FACTORY.createInv(ne.path)),Z.subject,Z.graph)});const le=this.generateVariable(),se=X.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({context:ee,operation:G.ActorAbstractPath.FACTORY.createPath(Z.subject,ne,le,Z.graph)}));return{type:"bindings",bindingsStream:se.bindingsStream.transform({filter:ge=>Z.object.equals(ge.get(le)),transform(ge,fe,ae){const ue=Z.graph.termType==="Variable"?Y.bindings([[Z.graph,ge.get(Z.graph)]]):Y.bindings();ae(ue),fe()}}),metadata:async()=>({...await se.metadata(),variables:Z.graph.termType==="Variable"?[Z.graph]:[]})}}}D.ActorQueryOperationPathOneOrMore=J},"../node_modules/@comunica/actor-query-operation-path-one-or-more/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-path-one-or-more/lib/ActorQueryOperationPathOneOrMore.js"),D)},"../node_modules/@comunica/actor-query-operation-path-seq/lib/ActorQueryOperationPathSeq.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationPathSeq=void 0;const G=F("../node_modules/@comunica/actor-abstract-path/lib/index.js"),Q=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),X=F("sparqlalgebrajs");class q extends G.ActorAbstractPath{constructor(Y){super(Y,X.Algebra.types.SEQ)}async runOperation(Y,J){const te=Y.predicate;let Z=Y.subject;const ee=[],re=await Promise.all(te.input.map((se,ie)=>{const ge=ie===te.input.length-1?Y.object:this.generateVariable(Y,`b${ie}`),fe=G.ActorAbstractPath.FACTORY.createPath(Z,se,ge,Y.graph),ae=this.mediatorQueryOperation.mediate({context:J,operation:fe});return Z=ge,ie<te.input.length-1&&ee.push(ge),{output:ae,operation:fe}}).map(async({output:se,operation:ie})=>({output:Q.ActorQueryOperation.getSafeBindings(await se),operation:ie}))),ne=Q.ActorQueryOperation.getSafeBindings(await this.mediatorJoin.mediate({type:"inner",entries:re,context:J}));return{type:"bindings",bindingsStream:ne.bindingsStream.transform({transform(se,ie,ge){for(const fe of ee)se=se.delete(fe);ge(se),ie()}}),async metadata(){const se=await ne.metadata(),ie=se.variables.filter(ge=>!ee.some(fe=>fe.value===ge.value));return{...se,variables:ie}}}}}D.ActorQueryOperationPathSeq=q},"../node_modules/@comunica/actor-query-operation-path-seq/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-path-seq/lib/ActorQueryOperationPathSeq.js"),D)},"../node_modules/@comunica/actor-query-operation-path-zero-or-more/lib/ActorQueryOperationPathZeroOrMore.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationPathZeroOrMore=void 0;const G=F("../node_modules/@comunica/actor-abstract-path/lib/index.js"),Q=F("../node_modules/@comunica/bindings-factory/lib/index.js"),X=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),q=F("asynciterator"),W=F("../node_modules/rdf-string/index.js"),Y=F("sparqlalgebrajs"),J=new Q.BindingsFactory;class te extends G.ActorAbstractPath{constructor(ee){super(ee,Y.Algebra.types.ZERO_OR_MORE_PATH)}async runOperation(ee,re){const ne=await this.isPathArbitraryLengthDistinct(re,ee);if(ne.operation)return ne.operation;re=ne.context;const le=ee.predicate,se=ee.subject.termType==="Variable",ie=ee.object.termType==="Variable";if(ee.subject.termType==="Variable"&&ee.object.termType==="Variable"){const _e=this.generateVariable(ee),xe=G.ActorAbstractPath.FACTORY.createPattern(ee.subject,_e,ee.object,ee.graph),be=X.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({context:re,operation:xe})),Te=ee.subject,ye=ee.object,Ee=new Set,he={},oe=new q.MultiTransformIterator(be.bindingsStream,{multiTransform:ve=>{const we=ve.get(Te),Pe=ve.get(ye),Me=ee.graph.termType==="Variable"?ve.get(ee.graph):ee.graph,De=(0,W.termToString)(we)+(0,W.termToString)(Me),Oe=(0,W.termToString)(Pe)+(0,W.termToString)(Me);return new q.TransformIterator(async()=>{if(Ee.has(De)&&Ee.has(Oe))return new q.EmptyIterator;const Ie=new q.BufferedIterator,Be={count:0};return Ee.has(De)||(Ee.add(De),await this.getSubjectAndObjectBindingsPredicateStar(Te,ye,we,we,le.path,Me,re,he,{},Ie,Be)),Ee.has(Oe)||(Ee.add(Oe),await this.getSubjectAndObjectBindingsPredicateStar(Te,ye,Pe,Pe,le.path,Me,re,he,{},Ie,Be)),Ie.transform({transform(ze,et,qe){ee.graph.termType==="Variable"&&(ze=ze.set(ee.graph,Me)),qe(ze),et()}})})}}),me=ee.graph.termType==="Variable"?[Te,ee.object,ee.graph]:[Te,ee.object];return{type:"bindings",bindingsStream:oe,metadata:async()=>({...await be.metadata(),variables:me})}}if(!se&&!ie){const _e=this.generateVariable(),xe=await this.getObjectsPredicateStarEval(ee.subject,le.path,_e,ee.graph,re,!0);return{type:"bindings",bindingsStream:xe.bindingsStream.transform({filter:Te=>ee.object.equals(Te.get(_e)),transform(Te,ye,Ee){const he=ee.graph.termType==="Variable"?J.bindings([[ee.graph,Te.get(ee.graph)]]):J.bindings();Ee(he),ye()}}),metadata:async()=>({...await xe.metadata(),variables:ee.graph.termType==="Variable"?[ee.graph]:[]})}}const ge=se?ee.object:ee.subject,fe=se?ee.subject:ee.object,ae=se?G.ActorAbstractPath.FACTORY.createInv(le.path):le.path,ue=await this.getObjectsPredicateStarEval(ge,ae,fe,ee.graph,re,!0),pe=ee.graph.termType==="Variable"?[fe,ee.graph]:[fe];return{type:"bindings",bindingsStream:ue.bindingsStream,metadata:async()=>({...await ue.metadata(),variables:pe})}}}D.ActorQueryOperationPathZeroOrMore=te},"../node_modules/@comunica/actor-query-operation-path-zero-or-more/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-path-zero-or-more/lib/ActorQueryOperationPathZeroOrMore.js"),D)},"../node_modules/@comunica/actor-query-operation-path-zero-or-one/lib/ActorQueryOperationPathZeroOrOne.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationPathZeroOrOne=void 0;const G=F("../node_modules/@comunica/actor-abstract-path/lib/index.js"),Q=F("../node_modules/@comunica/bindings-factory/lib/index.js"),X=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),q=F("asynciterator"),W=F("sparqlalgebrajs"),Y=new Q.BindingsFactory;class J extends G.ActorAbstractPath{constructor(Z){super(Z,W.Algebra.types.ZERO_OR_ONE_PATH)}async runOperation(Z,ee){const re=Z.predicate,ne=Z.subject.termType==="Variable",le=Z.object.termType==="Variable",se=[];if(!ne&&!le&&Z.subject.equals(Z.object))return{type:"bindings",bindingsStream:new q.SingletonIterator(Y.bindings()),metadata:()=>Promise.resolve({cardinality:{type:"exact",value:1},canContainUndefs:!1,variables:[]})};if(ne&&le)throw new Error("ZeroOrOne path expressions with 2 variables not supported yet");const ie=await this.isPathArbitraryLengthDistinct(ee,Z);if(ie.operation)return ie.operation;ee=ie.context,Z.subject.termType==="Variable"&&se.push(Y.bindings([[Z.subject,Z.object]])),Z.object.termType==="Variable"&&se.push(Y.bindings([[Z.object,Z.subject]]));const ge=X.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({context:ee,operation:G.ActorAbstractPath.FACTORY.createPath(Z.subject,re.path,Z.object,Z.graph)}));return{type:"bindings",bindingsStream:ge.bindingsStream.prepend(se),metadata:ge.metadata}}}D.ActorQueryOperationPathZeroOrOne=J},"../node_modules/@comunica/actor-query-operation-path-zero-or-one/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-path-zero-or-one/lib/ActorQueryOperationPathZeroOrOne.js"),D)},"../node_modules/@comunica/actor-query-operation-project/lib/ActorQueryOperationProject.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationProject=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/@comunica/data-factory/lib/index.js"),X=F("../node_modules/rdf-data-factory/index.js"),q=new X.DataFactory;class W extends G.ActorQueryOperationTypedMediated{constructor(J){super(J,"project")}async testOperation(J,te){return!0}async runOperation(J,te){const Z=G.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:J.input,context:te})),ee=await Z.metadata(),re=J.variables,ne=ee.variables.filter(ge=>!re.some(fe=>ge.value===fe.value)),le=re.filter(ge=>!ee.variables.some(fe=>ge.value===fe.value));if(le.length>0)throw new Error(`Variables '${le.map(ge=>`?${ge.value}`)}' are used in the projection result, but are not assigned.`);let se=ne.length===0?Z.bindingsStream:Z.bindingsStream.transform({map(ge){for(const fe of ne)ge=ge.delete(fe);return ge},autoStart:!1}),ie=0;return se=se.transform({map(ge){ie++;const fe=new Map;return ge.map(ae=>{if(ae instanceof Q.BlankNodeBindingsScoped){let ue=fe.get(ae.value);return ue||(ue=q.blankNode(`${ae.value}${ie}`),fe.set(ae.value,ue)),ue}return ae})},autoStart:!1}),{type:"bindings",bindingsStream:se,metadata:async()=>({...ee,variables:re})}}}D.ActorQueryOperationProject=W},"../node_modules/@comunica/actor-query-operation-project/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-project/lib/ActorQueryOperationProject.js"),D)},"../node_modules/@comunica/actor-query-operation-quadpattern/lib/ActorQueryOperationQuadpattern.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationQuadpattern=void 0;const G=F("../node_modules/@comunica/bindings-factory/lib/index.js"),Q=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),X=F("../node_modules/@comunica/context-entries/lib/index.js"),q=F("../node_modules/rdf-data-factory/index.js"),W=F("../node_modules/rdf-terms/index.js"),Y=F("sparqlalgebrajs"),J=new G.BindingsFactory,te=new q.DataFactory,Z=new Y.Factory;class ee extends Q.ActorQueryOperationTyped{constructor(ne){super(ne,"pattern")}static isTermVariable(ne){return ne.termType==="Variable"}static getVariables(ne){return(0,W.uniqTerms)((0,W.getTerms)(ne).filter(ee.isTermVariable))}static getDuplicateElementLinks(ne){const le={};let se=!1;for(const ge of W.QUAD_TERM_NAMES)if(ne[ge].termType==="Variable"){const fe=ne[ge].value,ae=(le[fe]||(le[fe]=[])).push(ge);se=se||ae>1}if(!se)return;const ie={};for(const ge in le){const fe=le[ge],ae=fe.slice(1);ae.length>0&&(ie[fe[0]]=ae)}return ie}static validateMetadata(ne){for(const le of["cardinality","canContainUndefs"])if(!(le in ne))throw new Error(`Invalid metadata: missing ${le} in ${JSON.stringify(ne)}`);return ne}static getMetadata(ne,le,se){return()=>new Promise((ie,ge)=>{ne.getProperty("metadata",fe=>ie(fe)),ne.on("error",ge)}).then(ie=>("canContainUndefs"in ie||(ie.canContainUndefs=!1),ee.quadsMetadataToBindingsMetadata(ee.validateMetadata(ie),le,se)))}static quadsMetadataToBindingsMetadata(ne,le,se){return{...ne,order:ne.order?ee.quadsOrderToBindingsOrder(ne.order,le):void 0,availableOrders:ne.availableOrders?ne.availableOrders.map(ie=>({cost:ie.cost,terms:ee.quadsOrderToBindingsOrder(ie.terms,le)})):void 0,variables:se}}static quadsOrderToBindingsOrder(ne,le){const se={};return ne.map(ie=>{const ge=le[ie.term];if(ge&&!se[ge])return se[ge]=!0,{term:te.variable(ge),direction:ie.direction}}).filter(ie=>!!ie)}async testOperation(ne,le){return!0}async runOperation(ne,le){ne.context&&(le=le.merge(ne.context));let se=ne;const ie=this.unionDefaultGraph||le.get(X.KeysQueryOperation.unionDefaultGraph);ne.graph.termType==="DefaultGraph"&&ie&&(se=Z.createPattern(ne.subject,ne.predicate,ne.object,te.variable("__comunica:defaultGraph")));const ge=await this.mediatorResolveQuadPattern.mediate({pattern:se,context:le}),fe=ee.getVariables(ne),ae=(0,W.reduceTerms)(ne,(xe,be,Te)=>(be.termType==="Variable"&&(xe[Te]=be.value),xe),{}),ue=(xe,be,Te)=>{const ye=ae[Te];return ye&&xe.push([te.variable(ye),be]),xe},pe=ee.getMetadata(ge.data,ae,fe);return{type:"bindings",bindingsStream:new Q.ClosableTransformIterator(async()=>{let xe=ge.data;const be=ee.getDuplicateElementLinks(ne);return ne.graph.termType==="Variable"&&!ie&&(xe=xe.filter(Te=>Te.graph.termType!=="DefaultGraph")),be&&(xe=xe.filter(Te=>{for(const ye of W.TRIPLE_TERM_NAMES)for(const Ee of be[ye]||[])if(!Te[ye].equals(Te[Ee]))return!1;return!0})),xe.map(Te=>J.bindings((0,W.reduceTerms)(Te,ue,[])))},{autoStart:!1,onClose:()=>ge.data.destroy()}),metadata:pe}}}D.ActorQueryOperationQuadpattern=ee},"../node_modules/@comunica/actor-query-operation-quadpattern/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-quadpattern/lib/ActorQueryOperationQuadpattern.js"),D)},"../node_modules/@comunica/actor-query-operation-reduced-hash/lib/ActorQueryOperationReducedHash.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationReducedHash=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/@comunica/actor-query-operation-reduced-hash/node_modules/lru-cache/index.js");class X extends G.ActorQueryOperationTypedMediated{constructor(W){super(W,"reduced")}async testOperation(W,Y){return!0}async runOperation(W,Y){const J=G.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:W.input,context:Y}));return{type:"bindings",bindingsStream:J.bindingsStream.filter(await this.newHashFilter(Y)),metadata:J.metadata}}async newHashFilter(W){const{hashFunction:Y}=await this.mediatorHashBindings.mediate({allowHashCollisions:!0,context:W}),J=new Q({max:this.cacheSize});return te=>{const Z=Y(te);return J.has(Z)?!1:(J.set(Z,!0),!0)}}}D.ActorQueryOperationReducedHash=X},"../node_modules/@comunica/actor-query-operation-reduced-hash/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-reduced-hash/lib/ActorQueryOperationReducedHash.js"),D)},"../node_modules/@comunica/actor-query-operation-service/lib/ActorQueryOperationService.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationService=void 0;const G=F("../node_modules/@comunica/bindings-factory/lib/index.js"),Q=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),X=F("../node_modules/@comunica/context-entries/lib/index.js"),q=F("asynciterator"),W=new G.BindingsFactory;class Y extends Q.ActorQueryOperationTypedMediated{constructor(te){super(te,"service")}async testOperation(te,Z){if(te.name.termType!=="NamedNode")throw new Error(`${this.name} can only query services by IRI, while a ${te.name.termType} was given.`);return!0}async runOperation(te,Z){const ee=te.name.value;let re=Z.delete(X.KeysRdfResolveQuadPattern.source).delete(X.KeysRdfResolveQuadPattern.sources).delete(X.KeysInitQuery.queryString);const ne=this.forceSparqlEndpoint?"sparql":void 0;re=re.set(X.KeysRdfResolveQuadPattern.sources,[{type:ne,value:ee}]);let le;try{le=Q.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:te.input,context:re}))}catch(se){if(te.silent)le={bindingsStream:new q.SingletonIterator(W.bindings()),type:"bindings",metadata:async()=>({cardinality:{type:"exact",value:1},canContainUndefs:!1,variables:[]})};else throw se}return le}}D.ActorQueryOperationService=Y},"../node_modules/@comunica/actor-query-operation-service/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-service/lib/ActorQueryOperationService.js"),D)},"../node_modules/@comunica/actor-query-operation-slice/lib/ActorQueryOperationSlice.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationSlice=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/@comunica/context-entries/lib/index.js");class X extends G.ActorQueryOperationTypedMediated{constructor(W){super(W,"slice")}async testOperation(W,Y){return!0}async runOperation(W,Y){W.length&&(Y=Y.set(Q.KeysQueryOperation.limitIndicator,W.length));const J=await this.mediatorQueryOperation.mediate({operation:W.input,context:Y});if(J.type==="bindings")return{type:"bindings",bindingsStream:this.sliceStream(J.bindingsStream,W),metadata:this.sliceMetadata(J,W)};if(J.type==="quads")return{type:"quads",quadStream:this.sliceStream(J.quadStream,W),metadata:this.sliceMetadata(J,W)};throw new Error(`Invalid query output type: Expected 'bindings' or 'quads' but got '${J.type}'`)}sliceStream(W,Y){const J=!!Y.length||Y.length===0,{start:te}=Y,Z=J?Y.start+Y.length-1:Number.POSITIVE_INFINITY;return W.transform({offset:te,limit:Math.max(Z-te+1,0),autoStart:!1})}sliceMetadata(W,Y){const J=!!Y.length||Y.length===0;return()=>W.metadata().then(te=>{const Z={...te.cardinality};return Number.isFinite(Z.value)&&(Z.value=Math.max(0,Z.value-Y.start),J&&(Z.value=Math.min(Z.value,Y.length))),{...te,cardinality:Z}})}}D.ActorQueryOperationSlice=X},"../node_modules/@comunica/actor-query-operation-slice/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-slice/lib/ActorQueryOperationSlice.js"),D)},"../node_modules/@comunica/actor-query-operation-union/lib/ActorQueryOperationUnion.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationUnion=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("asynciterator"),X=F("../node_modules/rdf-terms/index.js");class q extends G.ActorQueryOperationTypedMediated{constructor(Y){super(Y,"union")}static unionVariables(Y){return(0,X.uniqTerms)(Y.flat())}static unionMetadata(Y,J){const te={type:"exact",value:0};for(const ee of Y)if(ee.cardinality.value&&Number.isFinite(ee.cardinality.value)||ee.cardinality.value===0)ee.cardinality.type==="estimate"&&(te.type="estimate"),te.value+=ee.cardinality.value;else{te.type="estimate",te.value=Number.POSITIVE_INFINITY;break}const Z={cardinality:te,canContainUndefs:Y.some(ee=>ee.canContainUndefs)};return J&&(Z.variables=q.unionVariables(Y.map(ee=>ee.variables))),Z}async testOperation(Y,J){return!0}async runOperation(Y,J){const te=(await Promise.all(Y.input.map(re=>this.mediatorQueryOperation.mediate({operation:re,context:J})))).map(G.ActorQueryOperation.getSafeBindings);return{type:"bindings",bindingsStream:new Q.UnionIterator(te.map(re=>re.bindingsStream),{autoStart:!1}),metadata:()=>Promise.all(te.map(re=>re.metadata())).then(re=>q.unionMetadata(re,!0))}}}D.ActorQueryOperationUnion=q},"../node_modules/@comunica/actor-query-operation-union/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-union/lib/ActorQueryOperationUnion.js"),D)},"../node_modules/@comunica/actor-query-operation-update-add-rewrite/lib/ActorQueryOperationAddRewrite.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationAddRewrite=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/rdf-data-factory/index.js"),X=F("sparqlalgebrajs"),q=new Q.DataFactory;class W extends G.ActorQueryOperationTypedMediated{constructor(J){super(J,"add"),this.factory=new X.Factory}async testOperation(J,te){return G.ActorQueryOperation.throwOnReadOnly(te),!0}runOperation(J,te){const Z=J.destination==="DEFAULT"?q.defaultGraph():J.destination,ee=J.source==="DEFAULT"?q.defaultGraph():J.source,re=this.factory.createDeleteInsert(void 0,[this.factory.createPattern(q.variable("s"),q.variable("p"),q.variable("o"),Z)],this.factory.createPattern(q.variable("s"),q.variable("p"),q.variable("o"),ee));return this.mediatorQueryOperation.mediate({operation:re,context:te})}}D.ActorQueryOperationAddRewrite=W},"../node_modules/@comunica/actor-query-operation-update-add-rewrite/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-update-add-rewrite/lib/ActorQueryOperationAddRewrite.js"),D)},"../node_modules/@comunica/actor-query-operation-update-clear/lib/ActorQueryOperationClear.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationClear=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/rdf-data-factory/index.js"),X=new Q.DataFactory;class q extends G.ActorQueryOperationTypedMediated{constructor(Y){super(Y,"clear")}async testOperation(Y,J){return G.ActorQueryOperation.throwOnReadOnly(J),!0}async runOperation(Y,J){let te;Y.source==="DEFAULT"?te=X.defaultGraph():typeof Y.source=="string"?te=Y.source:te=[Y.source];const{execute:Z}=await this.mediatorUpdateQuads.mediate({deleteGraphs:{graphs:te,requireExistence:!Y.silent,dropGraphs:!1},context:J});return{type:"void",execute:Z}}}D.ActorQueryOperationClear=q},"../node_modules/@comunica/actor-query-operation-update-clear/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-update-clear/lib/ActorQueryOperationClear.js"),D)},"../node_modules/@comunica/actor-query-operation-update-compositeupdate/lib/ActorQueryOperationUpdateCompositeUpdate.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationUpdateCompositeUpdate=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js");class Q extends G.ActorQueryOperationTypedMediated{constructor(q){super(q,"compositeupdate")}async testOperation(q,W){return G.ActorQueryOperation.throwOnReadOnly(W),!0}async runOperation(q,W){return{type:"void",execute:()=>(async()=>{for(const J of q.updates)await G.ActorQueryOperation.getSafeVoid(await this.mediatorQueryOperation.mediate({operation:J,context:W})).execute()})()}}}D.ActorQueryOperationUpdateCompositeUpdate=Q},"../node_modules/@comunica/actor-query-operation-update-compositeupdate/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-update-compositeupdate/lib/ActorQueryOperationUpdateCompositeUpdate.js"),D)},"../node_modules/@comunica/actor-query-operation-update-copy-rewrite/lib/ActorQueryOperationCopyRewrite.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationCopyRewrite=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("sparqlalgebrajs");class X extends G.ActorQueryOperationTypedMediated{constructor(W){super(W,"copy"),this.factory=new Q.Factory}async testOperation(W,Y){return G.ActorQueryOperation.throwOnReadOnly(Y),!0}runOperation(W,Y){if(typeof W.destination=="string"&&typeof W.source=="string"&&W.destination===W.source||typeof W.destination!="string"&&typeof W.source!="string"&&W.destination.equals(W.source))return Promise.resolve({type:"void",execute:()=>Promise.resolve()});const J=this.factory.createCompositeUpdate([this.factory.createDrop(W.destination,!0),this.factory.createAdd(W.source,W.destination,W.silent)]);return this.mediatorQueryOperation.mediate({operation:J,context:Y})}}D.ActorQueryOperationCopyRewrite=X},"../node_modules/@comunica/actor-query-operation-update-copy-rewrite/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-update-copy-rewrite/lib/ActorQueryOperationCopyRewrite.js"),D)},"../node_modules/@comunica/actor-query-operation-update-create/lib/ActorQueryOperationCreate.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationCreate=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js");class Q extends G.ActorQueryOperationTypedMediated{constructor(q){super(q,"create")}async testOperation(q,W){return G.ActorQueryOperation.throwOnReadOnly(W),!0}async runOperation(q,W){const{execute:Y}=await this.mediatorUpdateQuads.mediate({createGraphs:{graphs:[q.source],requireNonExistence:!q.silent},context:W});return{type:"void",execute:Y}}}D.ActorQueryOperationCreate=Q},"../node_modules/@comunica/actor-query-operation-update-create/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-update-create/lib/ActorQueryOperationCreate.js"),D)},"../node_modules/@comunica/actor-query-operation-update-deleteinsert/lib/ActorQueryOperationUpdateDeleteInsert.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationUpdateDeleteInsert=void 0;const G=F("../node_modules/@comunica/actor-query-operation-construct/lib/index.js"),Q=F("../node_modules/@comunica/bindings-factory/lib/index.js"),X=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),q=F("asynciterator"),W=new Q.BindingsFactory;class Y extends X.ActorQueryOperationTypedMediated{constructor(te){super(te,"deleteinsert"),this.blankNodeCounter=0}async testOperation(te,Z){return X.ActorQueryOperation.throwOnReadOnly(Z),!0}async runOperation(te,Z){const ee=te.where?X.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:te.where,context:Z})).bindingsStream:new q.ArrayIterator([W.bindings()],{autoStart:!1});let re,ne;te.insert&&(re=new G.BindingsToQuadsIterator(te.insert.map(G.BindingsToQuadsIterator.localizeQuad.bind(null,this.blankNodeCounter)),ee.clone(),!1),this.blankNodeCounter++),te.delete&&(ne=new G.BindingsToQuadsIterator(te.delete.map(G.BindingsToQuadsIterator.localizeQuad.bind(null,this.blankNodeCounter)),ee.clone(),!1),this.blankNodeCounter++);const{execute:le}=await this.mediatorUpdateQuads.mediate({quadStreamInsert:re,quadStreamDelete:ne,context:Z});return{type:"void",execute:le}}}D.ActorQueryOperationUpdateDeleteInsert=Y},"../node_modules/@comunica/actor-query-operation-update-deleteinsert/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-update-deleteinsert/lib/ActorQueryOperationUpdateDeleteInsert.js"),D)},"../node_modules/@comunica/actor-query-operation-update-drop/lib/ActorQueryOperationDrop.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationDrop=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/rdf-data-factory/index.js"),X=new Q.DataFactory;class q extends G.ActorQueryOperationTypedMediated{constructor(Y){super(Y,"drop")}async testOperation(Y,J){return G.ActorQueryOperation.throwOnReadOnly(J),!0}async runOperation(Y,J){let te;Y.source==="DEFAULT"?te=X.defaultGraph():typeof Y.source=="string"?te=Y.source:te=[Y.source];const{execute:Z}=await this.mediatorUpdateQuads.mediate({deleteGraphs:{graphs:te,requireExistence:!Y.silent,dropGraphs:!0},context:J});return{type:"void",execute:Z}}}D.ActorQueryOperationDrop=q},"../node_modules/@comunica/actor-query-operation-update-drop/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-update-drop/lib/ActorQueryOperationDrop.js"),D)},"../node_modules/@comunica/actor-query-operation-update-load/lib/ActorQueryOperationLoad.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationLoad=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/@comunica/context-entries/lib/index.js"),X=F("../node_modules/rdf-data-factory/index.js"),q=F("sparqlalgebrajs"),W=new X.DataFactory;class Y extends G.ActorQueryOperationTypedMediated{constructor(te){super(te,"load"),this.factory=new q.Factory,this.constructOperation=this.factory.createConstruct(this.factory.createPattern(W.variable("s"),W.variable("p"),W.variable("o")),[this.factory.createPattern(W.variable("s"),W.variable("p"),W.variable("o"))])}async testOperation(te,Z){return G.ActorQueryOperation.throwOnReadOnly(Z),!0}async runOperation(te,Z){let ee=Z.set(Q.KeysRdfResolveQuadPattern.sources,[te.source.value]);te.silent&&(ee=ee.set(Q.KeysInitQuery.lenient,!0));let ne=Y.getSafeQuads(await this.mediatorQueryOperation.mediate({operation:this.constructOperation,context:ee})).quadStream;te.destination&&(ne=ne.map(se=>W.quad(se.subject,se.predicate,se.object,te.destination)));const{execute:le}=await this.mediatorUpdateQuads.mediate({quadStreamInsert:ne,context:Z});return{type:"void",execute:le}}}D.ActorQueryOperationLoad=Y},"../node_modules/@comunica/actor-query-operation-update-load/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-update-load/lib/ActorQueryOperationLoad.js"),D)},"../node_modules/@comunica/actor-query-operation-update-move-rewrite/lib/ActorQueryOperationMoveRewrite.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationMoveRewrite=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("sparqlalgebrajs");class X extends G.ActorQueryOperationTypedMediated{constructor(W){super(W,"move"),this.factory=new Q.Factory}async testOperation(W,Y){return G.ActorQueryOperation.throwOnReadOnly(Y),!0}runOperation(W,Y){if(typeof W.destination=="string"&&typeof W.source=="string"&&W.destination===W.source||typeof W.destination!="string"&&typeof W.source!="string"&&W.destination.equals(W.source))return Promise.resolve({type:"void",execute:()=>Promise.resolve()});const J=[this.factory.createDrop(W.destination,!0),this.factory.createAdd(W.source,W.destination,W.silent),this.factory.createDrop(W.source)],te=this.factory.createCompositeUpdate(J);return this.mediatorQueryOperation.mediate({operation:te,context:Y})}}D.ActorQueryOperationMoveRewrite=X},"../node_modules/@comunica/actor-query-operation-update-move-rewrite/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-update-move-rewrite/lib/ActorQueryOperationMoveRewrite.js"),D)},"../node_modules/@comunica/actor-query-operation-values/lib/ActorQueryOperationValues.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationValues=void 0;const G=F("../node_modules/@comunica/bindings-factory/lib/index.js"),Q=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),X=F("asynciterator"),q=F("../node_modules/rdf-data-factory/index.js"),W=new G.BindingsFactory,Y=new q.DataFactory;class J extends Q.ActorQueryOperationTyped{constructor(Z){super(Z,"values")}async testOperation(Z,ee){return!0}async runOperation(Z,ee){const re=new X.ArrayIterator(Z.bindings.map(se=>W.bindings(Object.entries(se).map(([ie,ge])=>[Y.variable(ie.slice(1)),ge])))),ne=Z.variables;return{type:"bindings",bindingsStream:re,metadata:()=>Promise.resolve({cardinality:{type:"exact",value:Z.bindings.length},canContainUndefs:Z.bindings.some(se=>ne.some(ie=>!(`?${ie.value}` in se))),variables:ne})}}}D.ActorQueryOperationValues=J},"../node_modules/@comunica/actor-query-operation-values/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-operation-values/lib/ActorQueryOperationValues.js"),D)},"../node_modules/@comunica/actor-query-parse-sparql/lib/ActorQueryParseSparql.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryParseSparql=void 0;const G=F("../node_modules/@comunica/bus-query-parse/lib/index.js"),Q=F("sparqlalgebrajs"),X=F("sparqljs");class q extends G.ActorQueryParse{constructor(Y){super(Y),this.prefixes=Object.freeze(this.prefixes)}async test(Y){if(Y.queryFormat&&Y.queryFormat.language!=="sparql")throw new Error("This actor can only parse SPARQL queries");return!0}async run(Y){const te=new X.Parser({prefixes:this.prefixes,baseIRI:Y.baseIRI}).parse(Y.query);return{baseIRI:te.type==="query"?te.base:void 0,operation:(0,Q.translate)(te,{quads:!0,prefixes:this.prefixes,blankToVariable:!0,baseIRI:Y.baseIRI})}}}D.ActorQueryParseSparql=q},"../node_modules/@comunica/actor-query-parse-sparql/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-query-parse-sparql/lib/ActorQueryParseSparql.js"),D)},"../node_modules/@comunica/actor-rdf-join-entries-sort-cardinality/lib/ActorRdfJoinEntriesSortCardinality.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoinEntriesSortCardinality=void 0;const G=F("../node_modules/@comunica/bus-rdf-join-entries-sort/lib/index.js");class Q extends G.ActorRdfJoinEntriesSort{constructor(q){super(q)}async test(q){return!0}async run(q){return{entries:[...q.entries].sort((Y,J)=>Y.metadata.cardinality.value-J.metadata.cardinality.value)}}}D.ActorRdfJoinEntriesSortCardinality=Q},"../node_modules/@comunica/actor-rdf-join-entries-sort-cardinality/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-join-entries-sort-cardinality/lib/ActorRdfJoinEntriesSortCardinality.js"),D)},"../node_modules/@comunica/actor-rdf-join-inner-hash/lib/ActorRdfJoinHash.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoinHash=void 0;const G=F("../node_modules/@comunica/bus-rdf-join/lib/index.js"),Q=F("../node_modules/asyncjoin/index.js");class X extends G.ActorRdfJoin{constructor(W){super(W,{logicalType:"inner",physicalName:"hash",limitEntries:2})}async getOutput(W){const Y=await G.ActorRdfJoin.getMetadatas(W.entries),J=G.ActorRdfJoin.overlappingVariables(Y);return{result:{type:"bindings",bindingsStream:new Q.HashJoin(W.entries[0].output.bindingsStream,W.entries[1].output.bindingsStream,Z=>G.ActorRdfJoin.hash(Z,J),G.ActorRdfJoin.joinBindings),metadata:async()=>await this.constructResultMetadata(W.entries,Y,W.context)}}}async getJoinCoefficients(W,Y){const J=G.ActorRdfJoin.getRequestInitialTimes(Y),te=G.ActorRdfJoin.getRequestItemTimes(Y);return{iterations:Y[0].cardinality.value+Y[1].cardinality.value,persistedItems:Y[0].cardinality.value,blockingItems:Y[0].cardinality.value,requestTime:J[0]+Y[0].cardinality.value*te[0]+J[1]+Y[1].cardinality.value*te[1]}}}D.ActorRdfJoinHash=X},"../node_modules/@comunica/actor-rdf-join-inner-hash/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-join-inner-hash/lib/ActorRdfJoinHash.js"),D)},"../node_modules/@comunica/actor-rdf-join-inner-multi-bind/lib/ActorRdfJoinMultiBind.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoinMultiBind=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/@comunica/bus-rdf-join/lib/index.js"),X=F("../node_modules/@comunica/context-entries/lib/index.js"),q=F("asynciterator"),W=F("sparqlalgebrajs");class Y extends Q.ActorRdfJoin{constructor(te){super(te,{logicalType:"inner",physicalName:"bind",canHandleUndefs:!0})}static createBindStream(te,Z,ee,re,ne){const le=se=>{const ie=ee.map(fe=>(0,G.materializeOperation)(fe,se,{bindFilter:!1})),ge=fe=>fe.merge(se);return new q.TransformIterator(async()=>(await re(ie,se)).transform({map:ge}),{maxBufferSize:128,autoStart:!1})};switch(te){case"depth-first":return new q.MultiTransformIterator(Z,{autoStart:!1,multiTransform:le,optional:ne});case"breadth-first":return new q.UnionIterator(Z.transform({map:le,optional:ne}),{autoStart:!1});default:throw new Error(`Received request for unknown bind order: ${te}`)}}async sortJoinEntries(te,Z){if(te.some(se=>se.metadata.canContainUndefs))return te;const re={};for(const se of te)for(const ie of se.metadata.variables){let ge=re[ie.value];ge||(ge=0),re[ie.value]=++ge}const ne=[];for(const[se,ie]of Object.entries(re))ie>=2&&ne.push(se);if(ne.length===0)throw new Error("Bind join can only join entries with at least one common variable");const le=[];for(const se of te){let ie=!1;for(const ge of se.metadata.variables)if(ne.includes(ge.value)){ie=!0;break}ie||le.push(se)}return(await this.mediatorJoinEntriesSort.mediate({entries:te,context:Z})).entries.sort((se,ie)=>{const ge=le.includes(se),fe=le.includes(ie);return ge===fe?0:ge?1:-1})}async getOutput(te){const Z=await Q.ActorRdfJoin.getEntriesWithMetadatas(te.entries),ee=await this.sortJoinEntries(Z,te.context);this.logDebug(te.context,"First entry for Bind Join: ",()=>({entry:ee[0].operation,metadata:ee[0].metadata}));for(const[ie,ge]of ee.entries())ie!==0&&ge.output.bindingsStream.close();const re=ee[0].output,ne=[...ee];ne.splice(0,1);const le=te.context.set(X.KeysQueryOperation.joinLeftMetadata,ee[0].metadata).set(X.KeysQueryOperation.joinRightMetadatas,ne.map(ie=>ie.metadata));return{result:{type:"bindings",bindingsStream:Y.createBindStream(this.bindOrder,re.bindingsStream,ne.map(ie=>ie.operation),async(ie,ge)=>{const fe=ie.length===1?ie[0]:Y.FACTORY.createJoin(ie);return G.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:fe,context:le?.set(X.KeysQueryOperation.joinBindings,ge)})).bindingsStream},!1),metadata:()=>this.constructResultMetadata(ee,ee.map(ie=>ie.metadata),te.context)},physicalPlanMetadata:{bindIndex:Z.indexOf(ee[0]),bindOrder:this.bindOrder}}}async getJoinCoefficients(te,Z){const ee=await this.sortJoinEntries(te.entries.map((pe,_e)=>({...pe,metadata:Z[_e]})),te.context);Z=ee.map(pe=>pe.metadata);const re=Q.ActorRdfJoin.getRequestInitialTimes(Z),ne=Q.ActorRdfJoin.getRequestItemTimes(Z),le=[...ee],se=[...re],ie=[...ne];if(le.splice(0,1),se.splice(0,1),ie.splice(0,1),le.some(pe=>pe.operation.type===W.Algebra.types.EXTEND||pe.operation.type===W.Algebra.types.GROUP))throw new Error(`Actor ${this.name} can not bind on Extend and Group operations`);const ge=await Promise.all(le.map(async pe=>(await this.mediatorJoinSelectivity.mediate({entries:[ee[0],pe],context:te.context})).selectivity*this.selectivityModifier)),fe=le.map((pe,_e)=>pe.metadata.cardinality.value*ge[_e]).reduce((pe,_e)=>pe+_e,0),ae=se.reduce((pe,_e,xe)=>pe+_e*ge[xe],0),ue=ie.reduce((pe,_e,xe)=>pe+_e*ge[xe],0);return{iterations:Z[0].cardinality.value*fe,persistedItems:0,blockingItems:0,requestTime:re[0]+Z[0].cardinality.value*(ne[0]+ae+fe*ue)}}}D.ActorRdfJoinMultiBind=Y,Y.FACTORY=new W.Factory},"../node_modules/@comunica/actor-rdf-join-inner-multi-bind/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-join-inner-multi-bind/lib/ActorRdfJoinMultiBind.js"),D)},"../node_modules/@comunica/actor-rdf-join-inner-multi-empty/lib/ActorRdfJoinMultiEmpty.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoinMultiEmpty=void 0;const G=F("../node_modules/@comunica/bus-rdf-join/lib/index.js"),Q=F("asynciterator");class X extends G.ActorRdfJoin{constructor(W){super(W,{logicalType:"inner",physicalName:"multi-empty"})}async test(W){if((await G.ActorRdfJoin.getMetadatas(W.entries)).every(Y=>G.ActorRdfJoin.getCardinality(Y).value>0))throw new Error(`Actor ${this.name} can only join entries where at least one is empty`);return super.test(W)}async getOutput(W){for(const Y of W.entries)Y.output.bindingsStream.close();return{result:{bindingsStream:new Q.ArrayIterator([],{autoStart:!1}),metadata:async()=>({cardinality:{type:"exact",value:0},canContainUndefs:!1,variables:G.ActorRdfJoin.joinVariables(await G.ActorRdfJoin.getMetadatas(W.entries))}),type:"bindings"}}}async getJoinCoefficients(W,Y){return{iterations:0,persistedItems:0,blockingItems:0,requestTime:0}}}D.ActorRdfJoinMultiEmpty=X},"../node_modules/@comunica/actor-rdf-join-inner-multi-empty/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-join-inner-multi-empty/lib/ActorRdfJoinMultiEmpty.js"),D)},"../node_modules/@comunica/actor-rdf-join-inner-multi-smallest/lib/ActorRdfJoinMultiSmallest.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoinMultiSmallest=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/@comunica/bus-rdf-join/lib/index.js"),X=F("sparqlalgebrajs");class q extends Q.ActorRdfJoin{constructor(Y){super(Y,{logicalType:"inner",physicalName:"multi-smallest",limitEntries:3,limitEntriesMin:!0})}async sortJoinEntries(Y,J){return(await this.mediatorJoinEntriesSort.mediate({entries:Y,context:J})).entries}async getOutput(Y){const J=await this.sortJoinEntries(await Q.ActorRdfJoin.getEntriesWithMetadatas([...Y.entries]),Y.context),te=J[0],Z=J[1];J.splice(0,2);const ee={output:G.ActorQueryOperation.getSafeBindings(await this.mediatorJoin.mediate({type:Y.type,entries:[te,Z],context:Y.context})),operation:q.FACTORY.createJoin([te.operation,Z.operation],!1)};return J.push(ee),{result:await this.mediatorJoin.mediate({type:Y.type,entries:J,context:Y.context})}}async getJoinCoefficients(Y,J){J=[...J],J=(await this.sortJoinEntries(Y.entries.map((re,ne)=>({...re,metadata:J[ne]})),Y.context)).map(re=>re.metadata);const Z=Q.ActorRdfJoin.getRequestInitialTimes(J),ee=Q.ActorRdfJoin.getRequestItemTimes(J);return{iterations:J[0].cardinality.value*J[1].cardinality.value*J.slice(2).reduce((re,ne)=>re*ne.cardinality.value,1),persistedItems:0,blockingItems:0,requestTime:Z[0]+J[0].cardinality.value*ee[0]+Z[1]+J[1].cardinality.value*ee[1]+J.slice(2).reduce((re,ne,le)=>re+Z.slice(2)[le]+ne.cardinality.value*ee.slice(2)[le],0)}}}D.ActorRdfJoinMultiSmallest=q,q.FACTORY=new X.Factory},"../node_modules/@comunica/actor-rdf-join-inner-multi-smallest/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-join-inner-multi-smallest/lib/ActorRdfJoinMultiSmallest.js"),D)},"../node_modules/@comunica/actor-rdf-join-inner-nestedloop/lib/ActorRdfJoinNestedLoop.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoinNestedLoop=void 0;const G=F("../node_modules/@comunica/bus-rdf-join/lib/index.js"),Q=F("../node_modules/asyncjoin/index.js");class X extends G.ActorRdfJoin{constructor(W){super(W,{logicalType:"inner",physicalName:"nested-loop",limitEntries:2,canHandleUndefs:!0})}async getOutput(W){return{result:{type:"bindings",bindingsStream:new Q.NestedLoopJoin(W.entries[0].output.bindingsStream,W.entries[1].output.bindingsStream,G.ActorRdfJoin.joinBindings,{autoStart:!1}),metadata:async()=>await this.constructResultMetadata(W.entries,await G.ActorRdfJoin.getMetadatas(W.entries),W.context)}}}async getJoinCoefficients(W,Y){const J=G.ActorRdfJoin.getRequestInitialTimes(Y),te=G.ActorRdfJoin.getRequestItemTimes(Y);return{iterations:Y[0].cardinality.value*Y[1].cardinality.value,persistedItems:0,blockingItems:0,requestTime:J[0]+Y[0].cardinality.value*te[0]+J[1]+Y[1].cardinality.value*te[1]}}}D.ActorRdfJoinNestedLoop=X},"../node_modules/@comunica/actor-rdf-join-inner-nestedloop/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-join-inner-nestedloop/lib/ActorRdfJoinNestedLoop.js"),D)},"../node_modules/@comunica/actor-rdf-join-inner-none/lib/ActorRdfJoinNone.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoinNone=void 0;const G=F("../node_modules/@comunica/bindings-factory/lib/index.js"),Q=F("../node_modules/@comunica/bus-rdf-join/lib/index.js"),X=F("asynciterator"),q=new G.BindingsFactory;class W extends Q.ActorRdfJoin{constructor(J){super(J,{logicalType:"inner",physicalName:"none",limitEntries:0})}async test(J){if(J.entries.length>0)throw new Error(`Actor ${this.name} can only join zero entries`);return await this.getJoinCoefficients()}async getOutput(J){return{result:{bindingsStream:new X.ArrayIterator([q.bindings()],{autoStart:!1}),metadata:()=>Promise.resolve({cardinality:{type:"exact",value:1},canContainUndefs:!1,variables:[]}),type:"bindings"}}}async getJoinCoefficients(){return{iterations:0,persistedItems:0,blockingItems:0,requestTime:0}}}D.ActorRdfJoinNone=W},"../node_modules/@comunica/actor-rdf-join-inner-none/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-join-inner-none/lib/ActorRdfJoinNone.js"),D)},"../node_modules/@comunica/actor-rdf-join-inner-single/lib/ActorRdfJoinSingle.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoinSingle=void 0;const G=F("../node_modules/@comunica/bus-rdf-join/lib/index.js");class Q extends G.ActorRdfJoin{constructor(q){super(q,{logicalType:"inner",physicalName:"single",limitEntries:1}),this.includeInLogs=!1}async test(q){if(q.entries.length!==1)throw new Error(`Actor ${this.name} can only join a single entry`);return await this.getJoinCoefficients()}async getOutput(q){return{result:q.entries[0].output}}async getJoinCoefficients(){return{iterations:0,persistedItems:0,blockingItems:0,requestTime:0}}}D.ActorRdfJoinSingle=Q},"../node_modules/@comunica/actor-rdf-join-inner-single/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-join-inner-single/lib/ActorRdfJoinSingle.js"),D)},"../node_modules/@comunica/actor-rdf-join-inner-symmetrichash/lib/ActorRdfJoinSymmetricHash.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoinSymmetricHash=void 0;const G=F("../node_modules/@comunica/bus-rdf-join/lib/index.js"),Q=F("../node_modules/asyncjoin/index.js");class X extends G.ActorRdfJoin{constructor(W){super(W,{logicalType:"inner",physicalName:"symmetric-hash",limitEntries:2})}async getOutput(W){const Y=await G.ActorRdfJoin.getMetadatas(W.entries),J=G.ActorRdfJoin.overlappingVariables(Y);return{result:{type:"bindings",bindingsStream:new Q.SymmetricHashJoin(W.entries[0].output.bindingsStream,W.entries[1].output.bindingsStream,Z=>X.hash(Z,J),G.ActorRdfJoin.joinBindings),metadata:async()=>await this.constructResultMetadata(W.entries,Y,W.context)}}}async getJoinCoefficients(W,Y){const J=G.ActorRdfJoin.getRequestInitialTimes(Y),te=G.ActorRdfJoin.getRequestItemTimes(Y);return{iterations:Y[0].cardinality.value+Y[1].cardinality.value,persistedItems:Y[0].cardinality.value+Y[1].cardinality.value,blockingItems:0,requestTime:J[0]+Y[0].cardinality.value*te[0]+J[1]+Y[1].cardinality.value*te[1]}}}D.ActorRdfJoinSymmetricHash=X},"../node_modules/@comunica/actor-rdf-join-inner-symmetrichash/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-join-inner-symmetrichash/lib/ActorRdfJoinSymmetricHash.js"),D)},"../node_modules/@comunica/actor-rdf-join-minus-hash-undef/lib/ActorRdfJoinMinusHashUndef.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoinMinusHashUndef=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/@comunica/bus-rdf-join/lib/index.js"),X=F("../node_modules/@comunica/actor-rdf-join-minus-hash-undef/lib/BindingsIndex.js");class q extends Q.ActorRdfJoin{constructor(Y){super(Y,{logicalType:"minus",physicalName:"hash-undef",limitEntries:2,canHandleUndefs:!0})}async getOutput(Y){const J=Y.entries[1].output,te=Y.entries[0].output,Z=await Q.ActorRdfJoin.getMetadatas(Y.entries),ee=Q.ActorRdfJoin.overlappingVariables(Z);if(ee.length>0){const re=new X.BindingsIndex(ee);return{result:{type:"bindings",bindingsStream:new G.ClosableTransformIterator(async()=>(await new Promise(le=>{J.bindingsStream.on("data",se=>re.add(se)),J.bindingsStream.on("end",le)}),te.bindingsStream.filter(le=>!re.contains(le))),{autoStart:!1,onClose(){J.bindingsStream.destroy(),te.bindingsStream.destroy()}}),async metadata(){const le=await te.metadata(),se=await te.metadata();return{...se,canContainUndefs:le.canContainUndefs||se.canContainUndefs}}}}}return{result:te}}async getJoinCoefficients(Y,J){const te=Q.ActorRdfJoin.getRequestInitialTimes(J),Z=Q.ActorRdfJoin.getRequestItemTimes(J);return{iterations:(J[0].cardinality.value+J[1].cardinality.value)*1.01,persistedItems:J[0].cardinality.value,blockingItems:J[0].cardinality.value,requestTime:te[0]+J[0].cardinality.value*Z[0]+te[1]+J[1].cardinality.value*Z[1]}}}D.ActorRdfJoinMinusHashUndef=q},"../node_modules/@comunica/actor-rdf-join-minus-hash-undef/lib/BindingsIndex.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.BindingsIndex=void 0;const G=F("../node_modules/rdf-string/index.js");class Q{constructor(q){this.data={},this.keys=q}static hashTerm(q){return q&&q.termType!=="Variable"?(0,G.termToString)(q):""}add(q){if(this.isBindingsValid(q)){let W=this.data;for(const Y of this.keys){const J=Q.hashTerm(q.get(Y));let te=W[J];te||(te=W[J]={}),W=te}}}contains(q){return this.isBindingsValid(q)?this.containsRecursive(q,this.keys,[this.data]):!1}isBindingsValid(q){let W=!1;for(const Y of this.keys)if(q.get(Y)){W=!0;break}return W}containsRecursive(q,W,Y){if(W.length===0)return!0;let J;[J,...W]=W;for(const te of Y){const Z=Q.hashTerm(q.get(J));if(Z){const ee=[te[Z],te[""]].filter(Boolean);if(ee.length===0)continue;if(this.containsRecursive(q,W,ee))return!0}else{let ee=Object.keys(te).map(re=>te[re]);if(ee.length===0&&(ee=[{}]),this.containsRecursive(q,W,ee))return!0}}return!1}}D.BindingsIndex=Q},"../node_modules/@comunica/actor-rdf-join-minus-hash-undef/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-join-minus-hash-undef/lib/ActorRdfJoinMinusHashUndef.js"),D)},"../node_modules/@comunica/actor-rdf-join-minus-hash/lib/ActorRdfJoinMinusHash.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoinMinusHash=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/@comunica/bus-rdf-join/lib/index.js");class X extends Q.ActorRdfJoin{constructor(W){super(W,{logicalType:"minus",physicalName:"hash",limitEntries:2})}async getOutput(W){const Y=W.entries[1].output,J=W.entries[0].output,te=await Q.ActorRdfJoin.getMetadatas(W.entries),Z=Q.ActorRdfJoin.overlappingVariables(te);if(Z.length>0){const ee={};return{result:{type:"bindings",bindingsStream:new G.ClosableTransformIterator(async()=>(await new Promise(ne=>{Y.bindingsStream.on("data",le=>{ee[Q.ActorRdfJoin.hash(le,Z)]=!0}),Y.bindingsStream.on("end",ne)}),J.bindingsStream.filter(ne=>!ee[Q.ActorRdfJoin.hash(ne,Z)])),{autoStart:!1,onClose(){Y.bindingsStream.destroy(),J.bindingsStream.destroy()}}),metadata:J.metadata}}}return{result:J}}async getJoinCoefficients(W,Y){const J=Q.ActorRdfJoin.getRequestInitialTimes(Y),te=Q.ActorRdfJoin.getRequestItemTimes(Y);return{iterations:Y[0].cardinality.value+Y[1].cardinality.value,persistedItems:Y[0].cardinality.value,blockingItems:Y[0].cardinality.value,requestTime:J[0]+Y[0].cardinality.value*te[0]+J[1]+Y[1].cardinality.value*te[1]}}}D.ActorRdfJoinMinusHash=X},"../node_modules/@comunica/actor-rdf-join-minus-hash/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-join-minus-hash/lib/ActorRdfJoinMinusHash.js"),D)},"../node_modules/@comunica/actor-rdf-join-optional-bind/lib/ActorRdfJoinOptionalBind.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoinOptionalBind=void 0;const G=F("../node_modules/@comunica/actor-rdf-join-inner-multi-bind/lib/index.js"),Q=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),X=F("../node_modules/@comunica/bus-rdf-join/lib/index.js"),q=F("../node_modules/@comunica/context-entries/lib/index.js"),W=F("sparqlalgebrajs");class Y extends X.ActorRdfJoin{constructor(te){super(te,{logicalType:"optional",physicalName:"bind",limitEntries:2,canHandleUndefs:!0})}async getOutput(te){te.entries[1].output.bindingsStream.close();const Z=te.context.set(q.KeysQueryOperation.joinLeftMetadata,await te.entries[0].output.metadata()).set(q.KeysQueryOperation.joinRightMetadatas,[await te.entries[1].output.metadata()]);return{result:{type:"bindings",bindingsStream:G.ActorRdfJoinMultiBind.createBindStream(this.bindOrder,te.entries[0].output.bindingsStream,[te.entries[1].operation],async(re,ne)=>{const le=re[0];return Q.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:le,context:Z?.set(q.KeysQueryOperation.joinBindings,ne)})).bindingsStream},!0),metadata:async()=>await this.constructResultMetadata(te.entries,await X.ActorRdfJoin.getMetadatas(te.entries),te.context,{canContainUndefs:!0})}}}async getJoinCoefficients(te,Z){const ee=X.ActorRdfJoin.getRequestInitialTimes(Z),re=X.ActorRdfJoin.getRequestItemTimes(Z);if(te.entries[1].operation.type===W.Algebra.types.EXTEND||te.entries[1].operation.type===W.Algebra.types.GROUP)throw new Error(`Actor ${this.name} can not bind on Extend and Group operations`);const ne=(await this.mediatorJoinSelectivity.mediate({entries:te.entries,context:te.context})).selectivity*this.selectivityModifier;return{iterations:Z[0].cardinality.value*Z[1].cardinality.value*ne,persistedItems:0,blockingItems:0,requestTime:ee[0]+Z[0].cardinality.value*ne*(re[0]+ee[1]+Z[1].cardinality.value*re[1])}}}D.ActorRdfJoinOptionalBind=Y},"../node_modules/@comunica/actor-rdf-join-optional-bind/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-join-optional-bind/lib/ActorRdfJoinOptionalBind.js"),D)},"../node_modules/@comunica/actor-rdf-join-optional-nestedloop/lib/ActorRdfJoinOptionalNestedLoop.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoinOptionalNestedLoop=void 0;const G=F("../node_modules/@comunica/bus-rdf-join/lib/index.js"),Q=F("../node_modules/asyncjoin/index.js");class X extends G.ActorRdfJoin{constructor(W){super(W,{logicalType:"optional",physicalName:"nested-loop",limitEntries:2,canHandleUndefs:!0})}async getOutput(W){return{result:{type:"bindings",bindingsStream:new Q.NestedLoopJoin(W.entries[0].output.bindingsStream,W.entries[1].output.bindingsStream,G.ActorRdfJoin.joinBindings,{optional:!0,autoStart:!1}),metadata:async()=>await this.constructResultMetadata(W.entries,await G.ActorRdfJoin.getMetadatas(W.entries),W.context,{canContainUndefs:!0})}}}async getJoinCoefficients(W,Y){const J=G.ActorRdfJoin.getRequestInitialTimes(Y),te=G.ActorRdfJoin.getRequestItemTimes(Y);return{iterations:Y[0].cardinality.value*Y[1].cardinality.value,persistedItems:0,blockingItems:0,requestTime:J[0]+Y[0].cardinality.value*te[0]+J[1]+Y[1].cardinality.value*te[1]}}}D.ActorRdfJoinOptionalNestedLoop=X},"../node_modules/@comunica/actor-rdf-join-optional-nestedloop/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-join-optional-nestedloop/lib/ActorRdfJoinOptionalNestedLoop.js"),D)},"../node_modules/@comunica/actor-rdf-join-selectivity-variable-counting/lib/ActorRdfJoinSelectivityVariableCounting.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.JoinTypes=D.ActorRdfJoinSelectivityVariableCounting=void 0;const G=F("../node_modules/@comunica/bus-rdf-join-selectivity/lib/index.js"),Q=F("sparqlalgebrajs");class X extends G.ActorRdfJoinSelectivity{constructor(Y){super(Y)}async test(Y){return{accuracy:.5}}static getPatternCost(Y){let J=1;return Y.subject.termType==="Variable"&&(J+=4),(Y.predicate.termType==="Variable"||Y.type===Q.Algebra.types.PATH)&&(J+=1),Y.object.termType==="Variable"&&(J+=2),Y.graph.termType==="Variable"&&(J+=1),J/9}static getJoinTypes(Y,J){const te=[];return Y.subject.termType==="Variable"?(Y.subject.equals(J.subject)&&te.push(q.unboundSS),J.type==="pattern"&&Y.subject.equals(J.predicate)&&te.push(q.unboundSP),Y.subject.equals(J.object)&&te.push(q.unboundSO),Y.subject.equals(J.graph)&&te.push(q.unboundSG)):(Y.subject.equals(J.subject)&&te.push(q.boundSS),J.type==="pattern"&&Y.subject.equals(J.predicate)&&te.push(q.boundSP),Y.subject.equals(J.object)&&te.push(q.boundSO),Y.subject.equals(J.graph)&&te.push(q.boundSG)),Y.type==="pattern"&&(Y.predicate.termType==="Variable"?(Y.predicate.equals(J.subject)&&te.push(q.unboundPS),J.type==="pattern"&&Y.predicate.equals(J.predicate)&&te.push(q.unboundPP),Y.predicate.equals(J.object)&&te.push(q.unboundPO),Y.predicate.equals(J.graph)&&te.push(q.unboundPG)):(Y.predicate.equals(J.subject)&&te.push(q.boundPS),J.type==="pattern"&&Y.predicate.equals(J.predicate)&&te.push(q.boundPP),Y.predicate.equals(J.object)&&te.push(q.boundPO),Y.predicate.equals(J.graph)&&te.push(q.boundPG))),Y.object.termType==="Variable"?(Y.object.equals(J.subject)&&te.push(q.unboundOS),J.type==="pattern"&&Y.object.equals(J.predicate)&&te.push(q.unboundOP),Y.object.equals(J.object)&&te.push(q.unboundOO),Y.object.equals(J.graph)&&te.push(q.unboundOG)):(Y.object.equals(J.subject)&&te.push(q.boundOS),J.type==="pattern"&&Y.object.equals(J.predicate)&&te.push(q.boundOP),Y.object.equals(J.object)&&te.push(q.boundOO),Y.object.equals(J.graph)&&te.push(q.boundOG)),Y.graph.termType==="Variable"?(Y.graph.equals(J.subject)&&te.push(q.unboundGS),J.type==="pattern"&&Y.graph.equals(J.predicate)&&te.push(q.unboundGP),Y.graph.equals(J.object)&&te.push(q.unboundGO),Y.graph.equals(J.graph)&&te.push(q.unboundGG)):(Y.graph.equals(J.subject)&&te.push(q.boundGS),J.type==="pattern"&&Y.graph.equals(J.predicate)&&te.push(q.boundGP),Y.graph.equals(J.object)&&te.push(q.boundGO),Y.graph.equals(J.graph)&&te.push(q.boundGG)),te}static getOperationsPairwiseJoinCost(Y,J){let te=X.MAX_PAIRWISE_COST;for(const Z of X.getJoinTypes(Y,J))switch(Z){case q.boundSS:te-=2*2;break;case q.boundSP:te-=3*2;break;case q.boundSO:te-=1*2;break;case q.boundSG:te-=3*2;break;case q.boundPS:te-=3*2;break;case q.boundPP:return 1;case q.boundPO:te-=3*2;break;case q.boundPG:te-=3*2;break;case q.boundOS:te-=1*2;break;case q.boundOP:te-=3*2;break;case q.boundOO:te-=1*2;break;case q.boundOG:te-=3*2;break;case q.boundGS:te-=3*2;break;case q.boundGP:te-=3*2;break;case q.boundGO:te-=3*2;break;case q.boundGG:te-=3*2;break;case q.unboundSS:te-=2;break;case q.unboundSP:te-=3;break;case q.unboundSO:te-=1;break;case q.unboundSG:te-=3;break;case q.unboundPS:te-=3;break;case q.unboundPP:te-=3;break;case q.unboundPO:te-=3;break;case q.unboundPG:te-=3;break;case q.unboundOS:te-=1;break;case q.unboundOP:te-=3;break;case q.unboundOO:te-=1;break;case q.unboundOG:te-=3;break;case q.unboundGS:te-=3;break;case q.unboundGP:te-=3;break;case q.unboundGO:te-=3;break;case q.unboundGG:te-=3;break}return te/X.MAX_PAIRWISE_COST}static getOperationsJoinCost(Y){const J=[];for(const ee of Y)Q.Util.recurseOperation(ee,{[Q.Algebra.types.PATTERN](re){return J.push(re),!1},[Q.Algebra.types.PATH](re){return J.push(re),!1}});let te=0,Z=0;for(const ee of J)for(const re of J)ee!==re&&(te+=X.getOperationsPairwiseJoinCost(ee,re),Z++);return te/Z*J.reduce((ee,re)=>ee*X.getPatternCost(re),1)}async run(Y){return Y.entries.length<=1?{selectivity:1}:{selectivity:X.getOperationsJoinCost(Y.entries.map(J=>J.operation))}}}D.ActorRdfJoinSelectivityVariableCounting=X,X.MAX_PAIRWISE_COST=41*2;var q;(function(W){W[W.boundSS=0]="boundSS",W[W.boundSP=1]="boundSP",W[W.boundSO=2]="boundSO",W[W.boundSG=3]="boundSG",W[W.boundPS=4]="boundPS",W[W.boundPP=5]="boundPP",W[W.boundPO=6]="boundPO",W[W.boundPG=7]="boundPG",W[W.boundOS=8]="boundOS",W[W.boundOP=9]="boundOP",W[W.boundOO=10]="boundOO",W[W.boundOG=11]="boundOG",W[W.boundGS=12]="boundGS",W[W.boundGP=13]="boundGP",W[W.boundGO=14]="boundGO",W[W.boundGG=15]="boundGG",W[W.unboundSS=16]="unboundSS",W[W.unboundSP=17]="unboundSP",W[W.unboundSO=18]="unboundSO",W[W.unboundSG=19]="unboundSG",W[W.unboundPS=20]="unboundPS",W[W.unboundPP=21]="unboundPP",W[W.unboundPO=22]="unboundPO",W[W.unboundPG=23]="unboundPG",W[W.unboundOS=24]="unboundOS",W[W.unboundOP=25]="unboundOP",W[W.unboundOO=26]="unboundOO",W[W.unboundOG=27]="unboundOG",W[W.unboundGS=28]="unboundGS",W[W.unboundGP=29]="unboundGP",W[W.unboundGO=30]="unboundGO",W[W.unboundGG=31]="unboundGG"})(q=D.JoinTypes||(D.JoinTypes={}))},"../node_modules/@comunica/actor-rdf-join-selectivity-variable-counting/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-join-selectivity-variable-counting/lib/ActorRdfJoinSelectivityVariableCounting.js"),D)},"../node_modules/@comunica/actor-rdf-resolve-quad-pattern-federated/lib/ActorRdfResolveQuadPatternFederated.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfResolveQuadPatternFederated=void 0;const G=F("../node_modules/@comunica/bus-rdf-resolve-quad-pattern/lib/index.js"),Q=F("../node_modules/@comunica/actor-rdf-resolve-quad-pattern-federated/lib/FederatedQuadSource.js");class X extends G.ActorRdfResolveQuadPatternSource{constructor(W){super(W),this.emptyPatterns=new Map}async test(W){if(!(0,G.getContextSources)(W.context))throw new Error(`Actor ${this.name} can only resolve quad pattern queries against a sources array.`);return!0}async getSource(W){return new Q.FederatedQuadSource(this.mediatorResolveQuadPattern,W,this.emptyPatterns,this.skipEmptyPatterns)}}D.ActorRdfResolveQuadPatternFederated=X},"../node_modules/@comunica/actor-rdf-resolve-quad-pattern-federated/lib/FederatedQuadSource.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.FederatedQuadSource=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/@comunica/bus-rdf-resolve-quad-pattern/lib/index.js"),X=F("../node_modules/@comunica/context-entries/lib/index.js"),q=F("../node_modules/@comunica/data-factory/lib/index.js"),W=F("asynciterator"),Y=F("../node_modules/rdf-data-factory/index.js"),J=F("../node_modules/rdf-terms/index.js"),te=F("sparqlalgebrajs"),Z=new Y.DataFactory;class ee{constructor(ne,le,se,ie){if(this.mediatorResolveQuadPattern=ne,this.sources=le.get(X.KeysRdfResolveQuadPattern.sources),this.contextDefault=le.delete(X.KeysRdfResolveQuadPattern.sources),this.emptyPatterns=se,this.sourceIds=le.get(X.KeysRdfResolveQuadPattern.sourceIds)??new Map,this.skipEmptyPatterns=ie,this.algebraFactory=new te.Factory,this.skipEmptyPatterns)for(const ge of this.sources)this.emptyPatterns.has(ge)||this.emptyPatterns.set(ge,[])}static isTermBound(ne){return ne.termType!=="Variable"}static isSubPatternOf(ne,le){return(!ee.isTermBound(le.subject)||le.subject.equals(ne.subject))&&(!ee.isTermBound(le.predicate)||le.predicate.equals(ne.predicate))&&(!ee.isTermBound(le.object)||le.object.equals(ne.object))&&(!ee.isTermBound(le.graph)||le.graph.equals(ne.graph))}static skolemizeTerm(ne,le){return ne.termType==="BlankNode"?new q.BlankNodeScoped(`bc_${le}_${ne.value}`,Z.namedNode(`${ee.SKOLEM_PREFIX}${le}:${ne.value}`)):ne}static skolemizeQuad(ne,le){return(0,J.mapTerms)(ne,se=>ee.skolemizeTerm(se,le))}static deskolemizeTerm(ne,le){if(ne.termType==="BlankNode"&&"skolemized"in ne&&(ne=ne.skolemized),ne.termType==="NamedNode"&&ne.value.startsWith(ee.SKOLEM_PREFIX)){const se=ne.value.indexOf(":",ee.SKOLEM_PREFIX.length);if(ne.value.slice(ee.SKOLEM_PREFIX.length,se)===le){const ge=ne.value.slice(se+1,ne.value.length);return Z.blankNode(ge)}return null}return ne}static deskolemizeQuad(ne,le){return(0,J.mapTerms)(ne,se=>{const ie=ee.deskolemizeTerm(se,le);return ie||se})}isSourceEmpty(ne,le){if(!this.skipEmptyPatterns)return!1;const se=this.emptyPatterns.get(ne);if(se){for(const ie of se)if(ee.isSubPatternOf(le,ie))return!0}return!1}getSourceId(ne){let le=this.sourceIds.get(ne);return le===void 0&&(le=`${this.sourceIds.size}`,this.sourceIds.set(ne,le)),le}match(ne,le,se,ie){const ge={cardinality:{type:"exact",value:0},canContainUndefs:!1};let fe=this.sources.length;const ae=(_e,xe,be,Te)=>{this.skipEmptyPatterns&&!_e&&be&&!this.isSourceEmpty(xe,be)&&this.emptyPatterns.get(xe).push(be),fe||(Te&&this.sources.length===1?pe.setProperty("metadata",Te):pe.setProperty("metadata",ge))},ue=Promise.all(this.sources.map(async _e=>{const xe=this.getSourceId(_e),be=ee.deskolemizeTerm(ne,xe),Te=ee.deskolemizeTerm(le,xe),ye=ee.deskolemizeTerm(se,xe),Ee=ee.deskolemizeTerm(ie,xe);let he,oe=(0,Q.getDataSourceContext)(_e,this.contextDefault);oe=oe.set(X.KeysRdfResolveQuadPattern.source,_e);let me;!be||!Te||!ye||!Ee||this.isSourceEmpty(_e,he=this.algebraFactory.createPattern(be,Te,ye,Ee))?(me={data:new W.ArrayIterator([],{autoStart:!1})},me.data.setProperty("metadata",{cardinality:0,canContainUndefs:!1})):me=await this.mediatorResolveQuadPattern.mediate({pattern:he,context:oe}),me.data.getProperty("metadata",we=>{!we.cardinality||!Number.isFinite(we.cardinality.value)?(ge.cardinality.type="estimate",ge.cardinality.value=Number.POSITIVE_INFINITY,fe=0):(we.cardinality.type==="estimate"&&(ge.cardinality.type="estimate"),ge.cardinality.value+=we.cardinality.value,fe--),(ge.requestTime||we.requestTime)&&(ge.requestTime=ge.requestTime||0,we.requestTime=we.requestTime||0,ge.requestTime+=we.requestTime),(ge.pageSize||we.pageSize)&&(ge.pageSize=ge.pageSize||0,we.pageSize=we.pageSize||0,ge.pageSize+=we.pageSize),we.canContainUndefs&&(ge.canContainUndefs=!0),ae(ge.cardinality.value,_e,he,we)});const ve=me.data.map(we=>ee.skolemizeQuad(we,xe));return ve.on("error",we=>pe.emit("error",we)),ve})),pe=new G.ClosableTransformIterator(async()=>new W.UnionIterator(await ue),{autoStart:!1,onClose(){ue.then(_e=>{for(const xe of _e)xe.destroy()},()=>{})}});return this.sources.length===0&&pe.setProperty("metadata",ge),pe}}D.FederatedQuadSource=ee,ee.SKOLEM_PREFIX="urn:comunica_skolem:source_"},"../node_modules/@comunica/actor-rdf-resolve-quad-pattern-federated/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-resolve-quad-pattern-federated/lib/ActorRdfResolveQuadPatternFederated.js"),D),Q(F("../node_modules/@comunica/actor-rdf-resolve-quad-pattern-federated/lib/FederatedQuadSource.js"),D)},"../node_modules/@comunica/actor-rdf-resolve-quad-pattern-rdfjs-source/lib/ActorRdfResolveQuadPatternRdfJsSource.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfResolveQuadPatternRdfJsSource=void 0;const G=F("../node_modules/@comunica/bus-rdf-resolve-quad-pattern/lib/index.js"),Q=F("../node_modules/@comunica/actor-rdf-resolve-quad-pattern-rdfjs-source/lib/RdfJsQuadSource.js");class X extends G.ActorRdfResolveQuadPatternSource{constructor(W){super(W)}async test(W){if(!(0,G.hasContextSingleSourceOfType)("rdfjsSource",W.context))throw new Error(`${this.name} requires a single source with an rdfjsSource to be present in the context.`);const Y=(0,G.getContextSource)(W.context);if(!Y||typeof Y=="string"||!("match"in Y)&&!Y.value.match)throw new Error(`${this.name} received an invalid rdfjsSource.`);return!0}async getSource(W){const Y=(0,G.getContextSource)(W);return new Q.RdfJsQuadSource("match"in Y?Y:Y.value)}}D.ActorRdfResolveQuadPatternRdfJsSource=X},"../node_modules/@comunica/actor-rdf-resolve-quad-pattern-rdfjs-source/lib/IRdfJsSourceExtended.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0})},"../node_modules/@comunica/actor-rdf-resolve-quad-pattern-rdfjs-source/lib/RdfJsQuadSource.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.RdfJsQuadSource=void 0;const G=F("asynciterator");class Q{constructor(q){this.source=q}static nullifyVariables(q){return!q||q.termType==="Variable"?void 0:q}match(q,W,Y,J){const te=this.source.match(Q.nullifyVariables(q),Q.nullifyVariables(W),Q.nullifyVariables(Y),Q.nullifyVariables(J)),Z=(0,G.wrap)(te,{autoStart:!1});return this.setMetadata(Z,q,W,Y,J).catch(ee=>Z.destroy(ee)),Z}async setMetadata(q,W,Y,J,te){let Z;if(this.source.countQuads)Z=await this.source.countQuads(Q.nullifyVariables(W),Q.nullifyVariables(Y),Q.nullifyVariables(J),Q.nullifyVariables(te));else{let ee=0;Z=await new Promise((re,ne)=>{const le=this.source.match(Q.nullifyVariables(W),Q.nullifyVariables(Y),Q.nullifyVariables(J),Q.nullifyVariables(te));le.on("error",ne),le.on("end",()=>re(ee)),le.on("data",()=>ee++)})}q.setProperty("metadata",{cardinality:{type:"exact",value:Z},canContainUndefs:!1})}}D.RdfJsQuadSource=Q},"../node_modules/@comunica/actor-rdf-resolve-quad-pattern-rdfjs-source/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-resolve-quad-pattern-rdfjs-source/lib/ActorRdfResolveQuadPatternRdfJsSource.js"),D),Q(F("../node_modules/@comunica/actor-rdf-resolve-quad-pattern-rdfjs-source/lib/IRdfJsSourceExtended.js"),D),Q(F("../node_modules/@comunica/actor-rdf-resolve-quad-pattern-rdfjs-source/lib/RdfJsQuadSource.js"),D)},"../node_modules/@comunica/actor-rdf-update-quads-rdfjs-store/lib/ActorRdfUpdateQuadsRdfJsStore.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfUpdateQuadsRdfJsStore=void 0;const G=F("../node_modules/@comunica/bus-rdf-update-quads/lib/index.js"),Q=F("../node_modules/@comunica/actor-rdf-update-quads-rdfjs-store/lib/RdfJsQuadDestination.js");class X extends G.ActorRdfUpdateQuadsDestination{constructor(W){super(W)}async test(W){const Y=(0,G.getContextDestination)(W.context);if(!Y||typeof Y=="string"||!("remove"in Y)&&"value"in Y&&!Y.value.remove)throw new Error(`${this.name} received an invalid rdfjsStore.`);return!0}async getDestination(W){const Y=(0,G.getContextDestination)(W);return new Q.RdfJsQuadDestination("remove"in Y?Y:Y.value)}}D.ActorRdfUpdateQuadsRdfJsStore=X},"../node_modules/@comunica/actor-rdf-update-quads-rdfjs-store/lib/RdfJsQuadDestination.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.RdfJsQuadDestination=void 0;const G=F("../node_modules/rdf-data-factory/index.js"),Q=F("../node_modules/rdf-string/index.js"),X=new G.DataFactory;class q{constructor(Y){this.store=Y}promisifyEventEmitter(Y){return new Promise((J,te)=>{Y.on("end",J),Y.on("error",te)})}delete(Y){return this.promisifyEventEmitter(this.store.remove(Y))}insert(Y){return this.promisifyEventEmitter(this.store.import(Y))}async deleteGraphs(Y,J,te){switch(Y){case"ALL":await this.promisifyEventEmitter(this.store.deleteGraph(X.defaultGraph()));case"NAMED":const Z=this.store.match(),ee={};Z.on("data",re=>{re.graph.termType!=="DefaultGraph"&&(ee[(0,Q.termToString)(re.graph)]=!0)}),await this.promisifyEventEmitter(Z),await Promise.all(Object.keys(ee).map(re=>this.promisifyEventEmitter(this.store.deleteGraph((0,Q.stringToTerm)(re)))));break;default:for(const re of Array.isArray(Y)?Y:[Y])await this.promisifyEventEmitter(this.store.deleteGraph(re))}}async createGraphs(Y,J){if(J)for(const te of Y){const Z=this.store.match(void 0,void 0,void 0,te);await new Promise((ee,re)=>{Z.once("data",()=>{re(new Error(`Unable to create graph ${te.value} as it already exists`))}),Z.on("end",ee),Z.on("error",re)})}}}D.RdfJsQuadDestination=q},"../node_modules/@comunica/actor-rdf-update-quads-rdfjs-store/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/actor-rdf-update-quads-rdfjs-store/lib/ActorRdfUpdateQuadsRdfJsStore.js"),D)},"../node_modules/@comunica/bindings-factory/lib/Bindings.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Bindings=void 0;const G=F("../packages/immutable/dist/index.js"),Q=F("../node_modules/@comunica/bindings-factory/lib/bindingsToString.js");class X{constructor(W,Y){this.type="bindings",this.dataFactory=W,this.entries=Y}has(W){return this.entries.has(typeof W=="string"?W:W.value)}get(W){return this.entries.get(typeof W=="string"?W:W.value)}set(W,Y){return new X(this.dataFactory,this.entries.set(typeof W=="string"?W:W.value,Y))}delete(W){return new X(this.dataFactory,this.entries.delete(typeof W=="string"?W:W.value))}keys(){return this.mapIterable(this.iteratorToIterable(this.entries.keys()),W=>this.dataFactory.variable(W))}values(){return this.iteratorToIterable(this.entries.values())}forEach(W){this.entries.forEach((Y,J)=>W(Y,this.dataFactory.variable(J)))}get size(){return this.entries.size}[Symbol.iterator](){return this.mapIterable(this.iteratorToIterable(this.entries.entries()),([W,Y])=>[this.dataFactory.variable(W),Y])[Symbol.iterator]()}equals(W){if(!W)return!1;if(this===W)return!0;if(this.size!==W.size)return!1;for(const Y of this.keys())if(!this.get(Y)?.equals(W.get(Y)))return!1;return!0}filter(W){return new X(this.dataFactory,(0,G.Map)(this.entries.filter((Y,J)=>W(Y,this.dataFactory.variable(J)))))}map(W){return new X(this.dataFactory,(0,G.Map)(this.entries.map((Y,J)=>W(Y,this.dataFactory.variable(J)))))}merge(W){const Y=new Set([...this.iteratorToIterable(this.entries.keys()),...[...W.keys()].map(te=>te.value)]),J=[];for(const te of Y){const Z=this.entries.get(te),ee=W.get(this.dataFactory.variable(te));if(Z&&ee&&!Z.equals(ee))return;const re=Z||ee;J.push([te,re])}return new X(this.dataFactory,(0,G.Map)(J))}mergeWith(W,Y){const J=new Set([...this.iteratorToIterable(this.entries.keys()),...[...Y.keys()].map(Z=>Z.value)]),te=[];for(const Z of J){const ee=this.dataFactory.variable(Z),re=this.entries.get(Z),ne=Y.get(ee);let le;re&&ne&&!re.equals(ne)?le=W(re,ne,ee):le=re||ne,te.push([Z,le])}return new X(this.dataFactory,(0,G.Map)(te))}toString(){return(0,Q.bindingsToString)(this)}*mapIterable(W,Y){for(const J of W)yield Y(J)}iteratorToIterable(W){return{[Symbol.iterator]:()=>W}}}D.Bindings=X},"../node_modules/@comunica/bindings-factory/lib/BindingsFactory.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.BindingsFactory=void 0;const G=F("../packages/immutable/dist/index.js"),Q=F("../node_modules/rdf-data-factory/index.js"),X=F("../node_modules/@comunica/bindings-factory/lib/Bindings.js");class q{constructor(Y=new Q.DataFactory){this.dataFactory=Y}bindings(Y=[]){return new X.Bindings(this.dataFactory,(0,G.Map)(Y.map(([J,te])=>[J.value,te])))}fromBindings(Y){return this.bindings([...Y])}fromRecord(Y){return this.bindings(Object.entries(Y).map(([J,te])=>[this.dataFactory.variable(J),te]))}}D.BindingsFactory=q},"../node_modules/@comunica/bindings-factory/lib/bindingsToString.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.bindingsToString=void 0;const G=F("../node_modules/rdf-string/index.js");function Q(X){const q={};for(const W of X.keys())q[W.value]=(0,G.termToString)(X.get(W));return JSON.stringify(q,null,"  ")}D.bindingsToString=Q},"../node_modules/@comunica/bindings-factory/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/bindings-factory/lib/Bindings.js"),D),Q(F("../node_modules/@comunica/bindings-factory/lib/BindingsFactory.js"),D),Q(F("../node_modules/@comunica/bindings-factory/lib/bindingsToString.js"),D)},"../node_modules/@comunica/bus-context-preprocess/lib/ActorContextPreprocess.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorContextPreprocess=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");class Q extends G.Actor{constructor(q){super(q)}}D.ActorContextPreprocess=Q},"../node_modules/@comunica/bus-context-preprocess/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/bus-context-preprocess/lib/ActorContextPreprocess.js"),D)},"../node_modules/@comunica/bus-hash-bindings/lib/ActorHashBindings.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorHashBindings=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");class Q extends G.Actor{constructor(q){super(q)}}D.ActorHashBindings=Q},"../node_modules/@comunica/bus-hash-bindings/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/bus-hash-bindings/lib/ActorHashBindings.js"),D)},"../node_modules/@comunica/bus-init/lib/ActorInit.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorInit=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");class Q extends G.Actor{constructor(q){super(q)}}D.ActorInit=Q},"../node_modules/@comunica/bus-init/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/bus-init/lib/ActorInit.js"),D)},"../node_modules/@comunica/bus-optimize-query-operation/lib/ActorOptimizeQueryOperation.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorOptimizeQueryOperation=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");class Q extends G.Actor{constructor(q){super(q)}}D.ActorOptimizeQueryOperation=Q},"../node_modules/@comunica/bus-optimize-query-operation/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/bus-optimize-query-operation/lib/ActorOptimizeQueryOperation.js"),D)},"../node_modules/@comunica/bus-query-operation/lib/ActorQueryOperation.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperation=void 0;const G=F("../node_modules/@comunica/context-entries/lib/index.js"),Q=F("../node_modules/@comunica/core/lib/index.js"),X=F("../node_modules/@comunica/data-factory/lib/index.js"),q=F("../node_modules/@comunica/bus-query-operation/lib/Bindings.js");let W=0;class Y extends Q.Actor{constructor(te){super(te)}static getSafeBindings(te){return Y.validateQueryOutput(te,"bindings"),te}static getSafeQuads(te){return Y.validateQueryOutput(te,"quads"),te}static getSafeBoolean(te){return Y.validateQueryOutput(te,"boolean"),te}static getSafeVoid(te){return Y.validateQueryOutput(te,"void"),te}static cachifyMetadata(te){let Z;return()=>Z||(Z=te())}static validateQueryOutput(te,Z){if(te.type!==Z)throw new Error(`Invalid query output type: Expected '${Z}' but got '${te.type}'`)}static getBaseExpressionContext(te){const Z=te.get(G.KeysInitQuery.queryTimestamp),ee=te.get(G.KeysInitQuery.baseIRI),re=te.get(G.KeysInitQuery.functionArgumentsCache)||{};if(te.has(G.KeysInitQuery.extensionFunctionCreator)&&te.has(G.KeysInitQuery.extensionFunctions))throw new Error("Illegal simultaneous usage of extensionFunctionCreator and extensionFunctions in context");let ne=te.get(G.KeysInitQuery.extensionFunctionCreator);const le=te.get(G.KeysInitQuery.extensionFunctions);return le&&(ne=se=>le[se.value]),{now:Z,baseIRI:ee,extensionFunctionCreator:ne,functionArgumentsCache:re}}static getExpressionContext(te,Z){return{...this.getBaseExpressionContext(te),bnode:ee=>new X.BlankNodeBindingsScoped(ee||`BNODE_${W++}`)}}static getAsyncExpressionContext(te,Z){const ee={...this.getBaseExpressionContext(te),bnode:re=>Promise.resolve(new X.BlankNodeBindingsScoped(re||`BNODE_${W++}`))};return Z&&(ee.exists=Y.createExistenceResolver(te,Z)),ee}static createExistenceResolver(te,Z){return async(ee,re)=>{const ne=(0,q.materializeOperation)(ee.input,re),le=await Z.mediate({operation:ne,context:te}),se=Y.getSafeBindings(le);return new Promise((ie,ge)=>{se.bindingsStream.on("end",()=>{ie(!1)}),se.bindingsStream.on("error",ge),se.bindingsStream.on("data",()=>{se.bindingsStream.close(),ie(!0)})}).then(ie=>ee.not?!ie:ie)}}static throwOnReadOnly(te){if(te.get(G.KeysQueryOperation.readOnly))throw new Error("Attempted a write operation in read-only mode")}}D.ActorQueryOperation=Y},"../node_modules/@comunica/bus-query-operation/lib/ActorQueryOperationTyped.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationTyped=void 0;const G=F("../node_modules/@comunica/context-entries/lib/index.js"),Q=F("../node_modules/@comunica/bus-query-operation/lib/ActorQueryOperation.js");class X extends Q.ActorQueryOperation{constructor(W,Y){if(super({...W,operationName:Y}),!this.operationName)throw new Error('A valid "operationName" argument must be provided.')}async test(W){if(!W.operation)throw new Error("Missing field 'operation' in a query operation action.");if(W.operation.type!==this.operationName)throw new Error(`Actor ${this.name} only supports ${this.operationName} operations, but got ${W.operation.type}`);const Y=W.operation;return this.testOperation(Y,W.context)}async run(W){const Y=W.context.get(G.KeysInitQuery.physicalQueryPlanLogger);Y&&(Y.logOperation(W.operation.type,void 0,W.operation,W.context.get(G.KeysInitQuery.physicalQueryPlanNode),this.name,{}),W.context=W.context.set(G.KeysInitQuery.physicalQueryPlanNode,W.operation));const J=W.operation,te=W.context.set(G.KeysQueryOperation.operation,J),Z=await this.runOperation(J,te);return"metadata"in Z&&(Z.metadata=Q.ActorQueryOperation.cachifyMetadata(Z.metadata)),Z}}D.ActorQueryOperationTyped=X},"../node_modules/@comunica/bus-query-operation/lib/ActorQueryOperationTypedMediated.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryOperationTypedMediated=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/ActorQueryOperationTyped.js");class Q extends G.ActorQueryOperationTyped{constructor(q,W){super(q,W)}}D.ActorQueryOperationTypedMediated=Q},"../node_modules/@comunica/bus-query-operation/lib/Bindings.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.materializeOperation=D.materializeTerm=void 0;const G=F("../node_modules/@comunica/bindings-factory/lib/index.js"),Q=F("../node_modules/rdf-string/index.js"),X=F("sparqlalgebrajs"),q=new G.BindingsFactory;function W(J,te){if(J.termType==="Variable"){const Z=te.get(J);if(Z)return Z}return J}D.materializeTerm=W;function Y(J,te,Z={}){return Z={strictTargetVariables:"strictTargetVariables"in Z?Z.strictTargetVariables:!1,bindFilter:"bindFilter"in Z?Z.bindFilter:!0},X.Util.mapOperation(J,{path(ee,re){return{recurse:!1,result:re.createPath(W(ee.subject,te),ee.predicate,W(ee.object,te),W(ee.graph,te))}},pattern(ee,re){return{recurse:!1,result:re.createPattern(W(ee.subject,te),W(ee.predicate,te),W(ee.object,te),W(ee.graph,te))}},extend(ee){if(te.has(ee.variable)){if(Z.strictTargetVariables)throw new Error(`Tried to bind variable ${(0,Q.termToString)(ee.variable)} in a BIND operator.`);return{recurse:!0,result:Y(ee.input,te,Z)}}return{recurse:!0,result:ee}},group(ee,re){if(Z.strictTargetVariables){for(const le of ee.variables)if(te.has(le))throw new Error(`Tried to bind variable ${(0,Q.termToString)(le)} in a GROUP BY operator.`);return{recurse:!0,result:ee}}const ne=ee.variables.filter(le=>!te.has(le));return{recurse:!0,result:re.createGroup(ee.input,ne,ee.aggregates)}},project(ee,re){if(Z.strictTargetVariables){for(const se of ee.variables)if(te.has(se))throw new Error(`Tried to bind variable ${(0,Q.termToString)(se)} in a SELECT operator.`);return{recurse:!0,result:ee}}const ne=ee.variables.filter(se=>!te.has(se)),le=q.bindings(ee.variables.map(se=>{const ie=te.get(se);if(ie)return[se,ie]}).filter(se=>!!se));return{recurse:!1,result:re.createProject(Y(ee.input,le,Z),ne)}},values(ee,re){if(Z.strictTargetVariables){for(const ne of ee.variables)if(te.has(ne))throw new Error(`Tried to bind variable ${(0,Q.termToString)(ne)} in a VALUES operator.`)}else{const ne=ee.variables.filter(se=>!te.has(se)),le=ee.bindings.map(se=>{const ie={...se};let ge=!0;return te.forEach((fe,ae)=>{const ue=(0,Q.termToString)(ae);ue in ie&&(fe.equals(ie[ue])||(ge=!1),delete ie[ue])}),ge?ie:void 0}).filter(Boolean);return{recurse:!0,result:re.createValues(ne,le)}}return{recurse:!1,result:ee}},expression(ee,re){if(!Z.bindFilter)return{recurse:!1,result:ee};if(ee.expressionType==="term")return{recurse:!1,result:re.createTermExpression(W(ee.term,te))};if(ee.expressionType==="aggregate"&&"variable"in ee&&te.has(ee.variable)){if(Z.strictTargetVariables)throw new Error(`Tried to bind ${(0,Q.termToString)(ee.variable)} in a ${ee.aggregator} aggregate.`);return{recurse:!0,result:ee}}return{recurse:!0,result:ee}}})}D.materializeOperation=Y},"../node_modules/@comunica/bus-query-operation/lib/BusQueryOperation.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.BusQueryOperation=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");class Q extends G.BusIndexed{constructor(q){super({...q,actorIdentifierFields:["operationName"],actionIdentifierFields:["operation","type"]})}}D.BusQueryOperation=Q},"../node_modules/@comunica/bus-query-operation/lib/ClosableTransformIterator.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ClosableTransformIterator=void 0;const G=F("asynciterator");class Q extends G.TransformIterator{constructor(q,W){super(q,W),this.onClose=W.onClose}_end(q){this.onClose(),super._end(q)}}D.ClosableTransformIterator=Q},"../node_modules/@comunica/bus-query-operation/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/bus-query-operation/lib/ActorQueryOperation.js"),D),Q(F("../node_modules/@comunica/bus-query-operation/lib/ActorQueryOperationTyped.js"),D),Q(F("../node_modules/@comunica/bus-query-operation/lib/ActorQueryOperationTypedMediated.js"),D),Q(F("../node_modules/@comunica/bus-query-operation/lib/Bindings.js"),D),Q(F("../node_modules/@comunica/bus-query-operation/lib/BusQueryOperation.js"),D),Q(F("../node_modules/@comunica/bus-query-operation/lib/ClosableTransformIterator.js"),D)},"../node_modules/@comunica/bus-query-parse/lib/ActorQueryParse.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorQueryParse=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");class Q extends G.Actor{constructor(q){super(q)}}D.ActorQueryParse=Q},"../node_modules/@comunica/bus-query-parse/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/bus-query-parse/lib/ActorQueryParse.js"),D)},"../node_modules/@comunica/bus-rdf-join-entries-sort/lib/ActorRdfJoinEntriesSort.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoinEntriesSort=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");class Q extends G.Actor{constructor(q){super(q)}}D.ActorRdfJoinEntriesSort=Q},"../node_modules/@comunica/bus-rdf-join-entries-sort/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/bus-rdf-join-entries-sort/lib/ActorRdfJoinEntriesSort.js"),D)},"../node_modules/@comunica/bus-rdf-join-selectivity/lib/ActorRdfJoinSelectivity.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoinSelectivity=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");class Q extends G.Actor{constructor(q){super(q)}}D.ActorRdfJoinSelectivity=Q},"../node_modules/@comunica/bus-rdf-join-selectivity/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/bus-rdf-join-selectivity/lib/ActorRdfJoinSelectivity.js"),D)},"../node_modules/@comunica/bus-rdf-join/lib/ActorRdfJoin.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfJoin=void 0;const G=F("../node_modules/@comunica/bus-query-operation/lib/index.js"),Q=F("../node_modules/@comunica/context-entries/lib/index.js"),X=F("../node_modules/@comunica/core/lib/index.js"),q=F("../node_modules/rdf-data-factory/index.js"),W=F("../node_modules/rdf-string/index.js"),Y=new q.DataFactory;class J extends X.Actor{constructor(Z,ee){super(Z),this.includeInLogs=!0,this.logicalType=ee.logicalType,this.physicalName=ee.physicalName,this.limitEntries=ee.limitEntries??Number.POSITIVE_INFINITY,this.limitEntriesMin=ee.limitEntriesMin??!1,this.canHandleUndefs=ee.canHandleUndefs??!1}static hash(Z,ee){return ee.filter(re=>Z.has(re)).map(re=>(0,W.termToString)(Z.get(re))).join("")}static overlappingVariables(Z){const ee=Z.map(ne=>ne.variables);let re=ee[0];for(const ne of ee.slice(1))re=re.filter(le=>ne.some(se=>se.value===le.value));return re}static joinVariables(Z){return[...new Set(Z.flatMap(ee=>ee.variables.map(re=>re.value)))].map(ee=>Y.variable(ee))}static joinBindings(...Z){if(Z.length===0)return null;if(Z.length===1)return Z[0];let ee=Z[0];for(const re of Z.slice(1)){const ne=ee.merge(re);if(!ne)return null;ee=ne}return ee}static getCardinality(Z){return Z.cardinality}static async getMetadatas(Z){return await Promise.all(Z.map(ee=>ee.output.metadata()))}static async getEntriesWithMetadatas(Z){const ee=await J.getMetadatas(Z);return Z.map((re,ne)=>({...re,metadata:ee[ne]}))}static getRequestInitialTimes(Z){return Z.map(ee=>ee.pageSize?0:ee.requestTime||0)}static getRequestItemTimes(Z){return Z.map(ee=>ee.pageSize?(ee.requestTime||0)/ee.pageSize:0)}async constructResultMetadata(Z,ee,re,ne={}){let le;return ne.cardinality?le=ne.cardinality:(le=ee.reduce((se,ie)=>{const ge=J.getCardinality(ie);return{type:ge.type==="estimate"?"estimate":se.type,value:se.value*ge.value}},{type:"exact",value:1}),le.value*=(await this.mediatorJoinSelectivity.mediate({entries:Z,context:re})).selectivity),{...ne,cardinality:{type:le.type,value:le.value},canContainUndefs:ne.canContainUndefs??ee.some(se=>se.canContainUndefs),variables:J.joinVariables(ee)}}async test(Z){if(Z.type!==this.logicalType)throw new Error(`${this.name} can only handle logical joins of type '${this.logicalType}', while '${Z.type}' was given.`);if(Z.entries.length<=1)throw new Error(`${this.name} requires at least two join entries.`);if(this.limitEntriesMin?Z.entries.length<this.limitEntries:Z.entries.length>this.limitEntries)throw new Error(`${this.name} requires ${this.limitEntries} join entries at ${this.limitEntriesMin?"least":"most"}. The input contained ${Z.entries.length}.`);for(const re of Z.entries)if(re.output.type!=="bindings")throw new Error(`Invalid type of a join entry: Expected 'bindings' but got '${re.output.type}'`);const ee=await J.getMetadatas(Z.entries);if(!this.canHandleUndefs){for(const re of ee)if(re.canContainUndefs)throw new Error(`Actor ${this.name} can not join streams containing undefs`)}return await this.getJoinCoefficients(Z,ee)}async run(Z){let ee;Z.context.has(Q.KeysInitQuery.physicalQueryPlanLogger)&&(ee=Z.context.get(Q.KeysInitQuery.physicalQueryPlanNode),Z.context=Z.context.set(Q.KeysInitQuery.physicalQueryPlanNode,Z));const re=Z.context.get(Q.KeysInitQuery.physicalQueryPlanLogger);let ne;this.includeInLogs&&re&&(ne={},re.logOperation(`join-${this.logicalType}`,this.physicalName,Z,ee,this.name,ne));const{result:le,physicalPlanMetadata:se}=await this.getOutput(Z),ie=await J.getMetadatas(Z.entries);return ne&&(Object.assign(ne,se),ne.cardinalities=ie.map(J.getCardinality),ne.joinCoefficients=await this.getJoinCoefficients(Z,ie)),le.metadata=G.ActorQueryOperation.cachifyMetadata(le.metadata),le}}D.ActorRdfJoin=J},"../node_modules/@comunica/bus-rdf-join/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/bus-rdf-join/lib/ActorRdfJoin.js"),D)},"../node_modules/@comunica/bus-rdf-resolve-quad-pattern/lib/ActorRdfResolveQuadPattern.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfResolveQuadPattern=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");class Q extends G.Actor{constructor(q){super(q)}}D.ActorRdfResolveQuadPattern=Q},"../node_modules/@comunica/bus-rdf-resolve-quad-pattern/lib/ActorRdfResolveQuadPatternSource.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfResolveQuadPatternSource=void 0;const G=F("../node_modules/@comunica/bus-rdf-resolve-quad-pattern/lib/ActorRdfResolveQuadPattern.js");class Q extends G.ActorRdfResolveQuadPattern{constructor(q){super(q)}async test(q){return!0}async run(q){const W=await this.getSource(q.context,q.pattern);return await this.getOutput(W,q.pattern,q.context)}async getOutput(q,W,Y){return{data:q.match(W.subject,W.predicate,W.object,W.graph,Y)}}}D.ActorRdfResolveQuadPatternSource=Q},"../node_modules/@comunica/bus-rdf-resolve-quad-pattern/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/bus-rdf-resolve-quad-pattern/lib/ActorRdfResolveQuadPattern.js"),D),Q(F("../node_modules/@comunica/bus-rdf-resolve-quad-pattern/lib/ActorRdfResolveQuadPatternSource.js"),D),Q(F("../node_modules/@comunica/bus-rdf-resolve-quad-pattern/lib/utils.js"),D)},"../node_modules/@comunica/bus-rdf-resolve-quad-pattern/lib/utils.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.hasContextSingleSourceOfType=D.hasContextSingleSource=D.getContextSourceUrl=D.getContextSourceFirst=D.getContextSource=D.getContextSources=D.getDataSourceContext=D.getDataSourceValue=D.getDataSourceType=D.isDataSourceRawType=void 0;const G=F("../node_modules/@comunica/context-entries/lib/index.js");function Q(ne){return typeof ne=="string"||"match"in ne}D.isDataSourceRawType=Q;function X(ne){return typeof ne=="string"?"":"match"in ne?"rdfjsSource":ne.type}D.getDataSourceType=X;function q(ne){return Q(ne)?ne:ne.value}D.getDataSourceValue=q;function W(ne,le){return typeof ne=="string"||"match"in ne||!ne.context?le:le.merge(ne.context)}D.getDataSourceContext=W;function Y(ne){return ne.get(G.KeysRdfResolveQuadPattern.sources)}D.getContextSources=Y;function J(ne){return ne.get(G.KeysRdfResolveQuadPattern.source)}D.getContextSource=J;function te(ne){if(ne.has(G.KeysRdfResolveQuadPattern.source))return ne.get(G.KeysRdfResolveQuadPattern.source);const le=ne.get(G.KeysRdfResolveQuadPattern.sources);if(le?.length===1)return le[0]}D.getContextSourceFirst=te;function Z(ne){if(ne){let le=q(ne);if(typeof le=="string"){const se=le.indexOf("#");return se>=0&&(le=le.slice(0,se)),le}}}D.getContextSourceUrl=Z;function ee(ne){const le=J(ne);return!!(le&&(Q(le)||le.value))}D.hasContextSingleSource=ee;function re(ne,le){const se=J(le);return!!(se&&X(se)===ne&&q(se))}D.hasContextSingleSourceOfType=re},"../node_modules/@comunica/bus-rdf-update-quads/lib/ActorRdfUpdateQuads.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfUpdateQuads=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");class Q extends G.Actor{constructor(q){super(q)}}D.ActorRdfUpdateQuads=Q},"../node_modules/@comunica/bus-rdf-update-quads/lib/ActorRdfUpdateQuadsDestination.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActorRdfUpdateQuadsDestination=D.deskolemize=D.deskolemizeStream=void 0;const G=F("../node_modules/@comunica/actor-rdf-resolve-quad-pattern-federated/lib/index.js"),Q=F("../node_modules/@comunica/context-entries/lib/index.js"),X=F("../node_modules/@comunica/bus-rdf-update-quads/lib/ActorRdfUpdateQuads.js");function q(J,te){return J?.map(Z=>G.FederatedQuadSource.deskolemizeQuad(Z,te))}D.deskolemizeStream=q;function W(J){const te=J.context.get(Q.KeysRdfUpdateQuads.destination),Z=J.context.get(Q.KeysRdfResolveQuadPattern.sourceIds)?.get(te);return Z?{...J,quadStreamInsert:q(J.quadStreamInsert,Z),quadStreamDelete:q(J.quadStreamDelete,Z)}:J}D.deskolemize=W;class Y extends X.ActorRdfUpdateQuads{async test(te){return!0}async run(te){const Z=await this.getDestination(te.context);return await this.getOutput(Z,W(te),te.context)}async getOutput(te,Z,ee){return{execute:()=>Promise.all([Z.quadStreamInsert?te.insert(Z.quadStreamInsert):Promise.resolve(),Z.quadStreamDelete?te.delete(Z.quadStreamDelete):Promise.resolve(),Z.deleteGraphs?te.deleteGraphs(Z.deleteGraphs.graphs,Z.deleteGraphs.requireExistence,Z.deleteGraphs.dropGraphs):Promise.resolve(),Z.createGraphs?te.createGraphs(Z.createGraphs.graphs,Z.createGraphs.requireNonExistence):Promise.resolve()]).then(()=>{})}}}D.ActorRdfUpdateQuadsDestination=Y},"../node_modules/@comunica/bus-rdf-update-quads/lib/IQuadDestination.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.validateHttpResponse=void 0;const G=F("./require-empty.js"),Q=F("../node_modules/stream-to-string/index.js");async function X(q,W){if(W.status>=400){let Y="empty response";if(W.body){const J=G.ActorHttp.toNodeReadable(W.body);Y=await Q(J)}throw new Error(`Could not update ${q} (HTTP status ${W.status}):
${Y}`)}await W.body?.cancel()}D.validateHttpResponse=X},"../node_modules/@comunica/bus-rdf-update-quads/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/bus-rdf-update-quads/lib/ActorRdfUpdateQuads.js"),D),Q(F("../node_modules/@comunica/bus-rdf-update-quads/lib/ActorRdfUpdateQuadsDestination.js"),D),Q(F("../node_modules/@comunica/bus-rdf-update-quads/lib/IQuadDestination.js"),D),Q(F("../node_modules/@comunica/bus-rdf-update-quads/lib/utils.js"),D)},"../node_modules/@comunica/bus-rdf-update-quads/lib/utils.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.getContextDestinationUrl=D.getContextDestinationFirst=D.getContextDestination=D.getDataDestinationContext=D.getDataDestinationValue=D.getDataDestinationType=D.isDataDestinationRawType=void 0;const G=F("../node_modules/@comunica/context-entries/lib/index.js");function Q(Z){return typeof Z=="string"||"remove"in Z}D.isDataDestinationRawType=Q;function X(Z){return typeof Z=="string"?"":"remove"in Z?"rdfjsStore":Z.type}D.getDataDestinationType=X;function q(Z){return Q(Z)?Z:Z.value}D.getDataDestinationValue=q;function W(Z,ee){return typeof Z=="string"||"remove"in Z||!Z.context?ee:ee.merge(Z.context)}D.getDataDestinationContext=W;function Y(Z){return Z.get(G.KeysRdfUpdateQuads.destination)}D.getContextDestination=Y;function J(Z){if(Z.has(G.KeysRdfUpdateQuads.destination))return Z.get(G.KeysRdfUpdateQuads.destination)}D.getContextDestinationFirst=J;function te(Z){if(Z){let ee=q(Z);if(typeof ee=="string"){const re=ee.indexOf("#");return re>=0&&(ee=ee.slice(0,re)),ee}}}D.getContextDestinationUrl=te},"../node_modules/@comunica/context-entries/lib/Keys.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.KeysRdfUpdateQuads=D.KeysRdfResolveQuadPattern=D.KeysRdfParseHtmlScript=D.KeysRdfParseJsonLd=D.KeysQueryOperation=D.KeysInitQuery=D.KeysHttpProxy=D.KeysHttpMemento=D.KeysHttpWayback=D.KeysHttp=D.KeysCore=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");D.KeysCore={log:G.CONTEXT_KEY_LOGGER},D.KeysHttp={includeCredentials:new G.ActionContextKey("@comunica/bus-http:include-credentials"),auth:new G.ActionContextKey("@comunica/bus-http:auth"),fetch:new G.ActionContextKey("@comunica/bus-http:fetch"),httpTimeout:new G.ActionContextKey("@comunica/bus-http:http-timeout"),httpBodyTimeout:new G.ActionContextKey("@comunica/bus-http:http-body-timeout"),httpRetryCount:new G.ActionContextKey("@comunica/bus-http:http-retry-count"),httpRetryDelay:new G.ActionContextKey("@comunica/bus-http:http-retry-delay"),httpRetryOnServerError:new G.ActionContextKey("@comunica/bus-http:http-retry-on-server-error")},D.KeysHttpWayback={recoverBrokenLinks:new G.ActionContextKey("@comunica/bus-http:recover-broken-links")},D.KeysHttpMemento={datetime:new G.ActionContextKey("@comunica/actor-http-memento:datetime")},D.KeysHttpProxy={httpProxyHandler:new G.ActionContextKey("@comunica/actor-http-proxy:httpProxyHandler")},D.KeysInitQuery={initialBindings:new G.ActionContextKey("@comunica/actor-init-query:initialBindings"),queryFormat:new G.ActionContextKey("@comunica/actor-init-query:queryFormat"),graphqlSingularizeVariables:new G.ActionContextKey("@comunica/actor-init-query:singularizeVariables"),lenient:new G.ActionContextKey("@comunica/actor-init-query:lenient"),queryString:new G.ActionContextKey("@comunica/actor-init-query:queryString"),query:new G.ActionContextKey("@comunica/actor-init-query:query"),baseIRI:new G.ActionContextKey("@comunica/actor-init-query:baseIRI"),functionArgumentsCache:new G.ActionContextKey("@comunica/actor-init-query:functionArgumentsCache"),queryTimestamp:new G.ActionContextKey("@comunica/actor-init-query:queryTimestamp"),extensionFunctionCreator:new G.ActionContextKey("@comunica/actor-init-query:extensionFunctionCreator"),extensionFunctions:new G.ActionContextKey("@comunica/actor-init-query:extensionFunctions"),cliArgsHandlers:new G.ActionContextKey("@comunica/actor-init-query:cliArgsHandlers"),explain:new G.ActionContextKey("@comunica/actor-init-query:explain"),physicalQueryPlanLogger:new G.ActionContextKey("@comunica/actor-init-query:physicalQueryPlanLogger"),physicalQueryPlanNode:new G.ActionContextKey("@comunica/actor-init-query:physicalQueryPlanNode"),jsonLdContext:new G.ActionContextKey("@context")},D.KeysQueryOperation={operation:new G.ActionContextKey("@comunica/bus-query-operation:operation"),joinLeftMetadata:new G.ActionContextKey("@comunica/bus-query-operation:joinLeftMetadata"),joinRightMetadatas:new G.ActionContextKey("@comunica/bus-query-operation:joinRightMetadatas"),joinBindings:new G.ActionContextKey("@comunica/bus-query-operation:joinBindings"),readOnly:new G.ActionContextKey("@comunica/bus-query-operation:readOnly"),isPathArbitraryLengthDistinctKey:new G.ActionContextKey("@comunica/bus-query-operation:isPathArbitraryLengthDistinct"),limitIndicator:new G.ActionContextKey("@comunica/bus-query-operation:limitIndicator"),unionDefaultGraph:new G.ActionContextKey("@comunica/bus-query-operation:unionDefaultGraph"),localizeBlankNodes:new G.ActionContextKey("@comunica/actor-query-operation:localizeBlankNodes")},D.KeysRdfParseJsonLd={documentLoader:new G.ActionContextKey("@comunica/actor-rdf-parse-jsonld:documentLoader"),strictValues:new G.ActionContextKey("@comunica/actor-rdf-parse-jsonld:strictValues"),parserOptions:new G.ActionContextKey("@comunica/actor-rdf-parse-jsonld:parserOptions")},D.KeysRdfParseHtmlScript={processingHtmlScript:new G.ActionContextKey("@comunica/actor-rdf-parse-html-script:processingHtmlScript"),extractAllScripts:new G.ActionContextKey("extractAllScripts")},D.KeysRdfResolveQuadPattern={sources:new G.ActionContextKey("@comunica/bus-rdf-resolve-quad-pattern:sources"),source:new G.ActionContextKey("@comunica/bus-rdf-resolve-quad-pattern:source"),sourceIds:new G.ActionContextKey("@comunica/bus-rdf-resolve-quad-pattern:sourceIds"),hypermediaSourcesAggregatedStores:new G.ActionContextKey("@comunica/bus-rdf-resolve-quad-pattern:hypermediaSourcesAggregatedStores")},D.KeysRdfUpdateQuads={destination:new G.ActionContextKey("@comunica/bus-rdf-update-quads:destination")}},"../node_modules/@comunica/context-entries/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/context-entries/lib/Keys.js"),D)},"../node_modules/@comunica/core/lib/ActionContext.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActionContextKey=D.ActionContext=void 0;const G=F("../packages/immutable/dist/index.js");class Q{constructor(W={}){this.map=(0,G.Map)(W)}setDefault(W,Y){return this.has(W)?this:this.set(W,Y)}set(W,Y){return this.setRaw(W.name,Y)}setRaw(W,Y){return new Q(this.map.set(W,Y))}delete(W){return new Q(this.map.delete(W.name))}get(W){return this.getRaw(W.name)}getRaw(W){return this.map.get(W)}getSafe(W){if(!this.has(W))throw new Error(`Context entry ${W.name} is required but not available`);return this.get(W)}has(W){return this.hasRaw(W.name)}hasRaw(W){return this.map.has(W)}merge(...W){let Y=this;for(const J of W)for(const te of J.keys())Y=Y.set(te,J.get(te));return Y}keys(){return[...this.map.keys()].map(W=>new X(W))}toJS(){return this.map.toJS()}toString(){return`ActionContext(${JSON.stringify(this.map.toJS())})`}[Symbol.for("nodejs.util.inspect.custom")](){return`ActionContext(${JSON.stringify(this.map.toJS(),null,"  ")})`}static ensureActionContext(W){return W instanceof Q?W:new Q((0,G.Map)(W||{}))}}D.ActionContext=Q;class X{constructor(W){this.name=W}}D.ActionContextKey=X},"../node_modules/@comunica/core/lib/ActionObserver.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ActionObserver=void 0;class F{constructor(Q){Object.assign(this,Q)}}D.ActionObserver=F},"../node_modules/@comunica/core/lib/Actor.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Actor=void 0;const G=F("../node_modules/@comunica/core/lib/ContextEntries.js");class Q{constructor(q){this.beforeActors=[],Object.assign(this,q),this.bus.subscribe(this),this.beforeActors.length>0&&this.bus.addDependencies(this,this.beforeActors)}static getContextLogger(q){return q.get(G.CONTEXT_KEY_LOGGER)}runObservable(q){const W=this.run(q);return this.bus.onRun(this,q,W),W}async initialize(){return!0}async deinitialize(){return!0}getDefaultLogData(q,W){const Y=W?W():{};return Y.actor=this.name,Y}logTrace(q,W,Y){const J=Q.getContextLogger(q);J&&J.trace(W,this.getDefaultLogData(q,Y))}logDebug(q,W,Y){const J=Q.getContextLogger(q);J&&J.debug(W,this.getDefaultLogData(q,Y))}logInfo(q,W,Y){const J=Q.getContextLogger(q);J&&J.info(W,this.getDefaultLogData(q,Y))}logWarn(q,W,Y){const J=Q.getContextLogger(q);J&&J.warn(W,this.getDefaultLogData(q,Y))}logError(q,W,Y){const J=Q.getContextLogger(q);J&&J.error(W,this.getDefaultLogData(q,Y))}logFatal(q,W,Y){const J=Q.getContextLogger(q);J&&J.fatal(W,this.getDefaultLogData(q,Y))}}D.Actor=Q},"../node_modules/@comunica/core/lib/Bus.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Bus=void 0;class F{constructor(Q){this.actors=[],this.observers=[],this.dependencyLinks=new Map,Object.assign(this,Q)}subscribe(Q){this.actors.push(Q),this.reorderForDependencies()}subscribeObserver(Q){this.observers.push(Q)}unsubscribe(Q){const X=this.actors.indexOf(Q);return X>=0?(this.actors.splice(X,1),!0):!1}unsubscribeObserver(Q){const X=this.observers.indexOf(Q);return X>=0?(this.observers.splice(X,1),!0):!1}publish(Q){return this.actors.map(X=>({actor:X,reply:X.test(Q)}))}onRun(Q,X,q){for(const W of this.observers)W.onRun(Q,X,q)}addDependencies(Q,X){for(const q of X){let W=this.dependencyLinks.get(q);W||(W=[],this.dependencyLinks.set(q,W)),W.push(Q)}this.reorderForDependencies()}reorderForDependencies(){if(this.dependencyLinks.size>0){const Q=[];for(const X of this.dependencyLinks.keys()){const q=this.actors.indexOf(X);q>=0&&(this.actors.splice(q,1),Q.push(X))}for(;Q.length>0;){let X=-1;for(let W=0;W<Q.length;W++){let Y=!0;for(const J of this.dependencyLinks.get(Q[W]))if(!this.actors.includes(J)&&Q.includes(J)){Y=!1;break}if(Y){X=W;break}}if(X<0)throw new Error(`Cyclic dependency links detected in bus ${this.name}`);const q=Q.splice(X,1)[0];this.actors.push(q)}}}}D.Bus=F},"../node_modules/@comunica/core/lib/BusIndexed.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.BusIndexed=void 0;const G=F("../node_modules/@comunica/core/lib/Bus.js");class Q extends G.Bus{constructor(q){super(q),this.actorsIndex={}}subscribe(q){const W=this.getActorIdentifier(q)||"_undefined_";let Y=this.actorsIndex[W];Y||(Y=this.actorsIndex[W]=[]),Y.push(q),super.subscribe(q)}unsubscribe(q){const W=this.getActorIdentifier(q)||"_undefined_",Y=this.actorsIndex[W];if(Y){const J=Y.indexOf(q);J>=0&&Y.splice(J,1),Y.length===0&&delete this.actorsIndex[W]}return super.unsubscribe(q)}publish(q){const W=this.getActionIdentifier(q);return W?[...this.actorsIndex[W]||[],...this.actorsIndex._undefined_||[]].map(J=>({actor:J,reply:J.test(q)})):super.publish(q)}getActorIdentifier(q){return this.actorIdentifierFields.reduce((W,Y)=>W[Y],q)}getActionIdentifier(q){return this.actionIdentifierFields.reduce((W,Y)=>W[Y],q)}}D.BusIndexed=Q},"../node_modules/@comunica/core/lib/ContextEntries.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.CONTEXT_KEY_LOGGER=void 0;const G=F("../node_modules/@comunica/core/lib/ActionContext.js");D.CONTEXT_KEY_LOGGER=new G.ActionContextKey("@comunica/core:log")},"../node_modules/@comunica/core/lib/Mediator.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Mediator=void 0;class F{constructor(Q){Object.assign(this,Q)}publish(Q){const X=this.bus.publish(Q);if(X.length===0)throw new Error(`No actors are able to reply to a message in the bus ${this.bus.name}`);return X}async mediateActor(Q){return await this.mediateWith(Q,this.publish(Q))}async mediate(Q){return(await this.mediateActor(Q)).runObservable(Q)}}D.Mediator=F},"../node_modules/@comunica/core/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(W,Y,J,te){te===void 0&&(te=J);var Z=Object.getOwnPropertyDescriptor(Y,J);(!Z||("get"in Z?!Y.__esModule:Z.writable||Z.configurable))&&(Z={enumerable:!0,get:function(){return Y[J]}}),Object.defineProperty(W,te,Z)}:function(W,Y,J,te){te===void 0&&(te=J),W[te]=Y[J]}),Q=this&&this.__exportStar||function(W,Y){for(var J in W)J!=="default"&&!Object.prototype.hasOwnProperty.call(Y,J)&&G(Y,W,J)};Object.defineProperty(D,"__esModule",{value:!0}),D.Logger=void 0;const q=F("../node_modules/@comunica/types/lib/index.js").Logger;D.Logger=q,Q(F("../node_modules/@comunica/core/lib/ActionContext.js"),D),Q(F("../node_modules/@comunica/core/lib/Bus.js"),D),Q(F("../node_modules/@comunica/core/lib/BusIndexed.js"),D),Q(F("../node_modules/@comunica/core/lib/ContextEntries.js"),D),Q(F("../node_modules/@comunica/core/lib/ActionObserver.js"),D),Q(F("../node_modules/@comunica/core/lib/Actor.js"),D),Q(F("../node_modules/@comunica/core/lib/Mediator.js"),D)},"../node_modules/@comunica/data-factory/lib/BlankNodeBindingsScoped.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.BlankNodeBindingsScoped=void 0;class F{constructor(Q){this.termType="BlankNode",this.singleBindingsScope=!0,this.value=Q}equals(Q){return!!Q&&Q.termType==="BlankNode"&&Q.value===this.value}}D.BlankNodeBindingsScoped=F},"../node_modules/@comunica/data-factory/lib/BlankNodeScoped.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.BlankNodeScoped=void 0;class F{constructor(Q,X){this.termType="BlankNode",this.value=Q,this.skolemized=X}equals(Q){return!!Q&&Q.termType==="BlankNode"&&Q.value===this.value}}D.BlankNodeScoped=F},"../node_modules/@comunica/data-factory/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/data-factory/lib/BlankNodeScoped.js"),D),Q(F("../node_modules/@comunica/data-factory/lib/BlankNodeBindingsScoped.js"),D)},"../node_modules/@comunica/logger-void/lib/LoggerVoid.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.LoggerVoid=void 0;const G=F("../node_modules/@comunica/types/lib/index.js");class Q extends G.Logger{debug(){}error(){}fatal(){}info(){}trace(){}warn(){}}D.LoggerVoid=Q},"../node_modules/@comunica/logger-void/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/logger-void/lib/LoggerVoid.js"),D)},"../node_modules/@comunica/mediator-all/lib/MediatorAll.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.MediatorAll=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");class Q extends G.Mediator{constructor(q){super(q)}async mediate(q){const W=[];let Y;try{Y=this.publish(q)}catch{Y=[]}for(const te of Y)try{await te.reply,W.push(te.actor)}catch{}return(await Promise.all(W.map(te=>te.runObservable(q))))[0]}async mediateWith(){throw new Error("Unsupported operation: MediatorAll#mediateWith")}}D.MediatorAll=Q},"../node_modules/@comunica/mediator-all/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/mediator-all/lib/MediatorAll.js"),D)},"../node_modules/@comunica/mediator-combine-pipeline/lib/MediatorCombinePipeline.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.MediatorCombinePipeline=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");class Q extends G.Mediator{constructor(q){super(q)}async mediate(q){let W;try{W=this.publish(q)}catch{return q}if(this.filterErrors){const J=[];for(const te of W)try{await te.reply,J.push(te)}catch{}W=J}if(W=await Promise.all(W.map(async({actor:J,reply:te})=>({actor:J,reply:await te}))),this.order){const J=te=>{const Z=this.field?te[this.field]:te;if(typeof Z!="number")throw new Error("Cannot order elements that are not numbers.");return Z};W=W.sort((te,Z)=>(this.order==="increasing"?1:-1)*(J(te.reply)-J(Z.reply)))}let Y=q;for(const{actor:J}of W)Y={...Y,...await J.runObservable(Y)};return Y}mediateWith(){throw new Error("Method not supported.")}}D.MediatorCombinePipeline=Q},"../node_modules/@comunica/mediator-combine-pipeline/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/mediator-combine-pipeline/lib/MediatorCombinePipeline.js"),D)},"../node_modules/@comunica/mediator-combine-union/lib/MediatorCombineUnion.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.MediatorCombineUnion=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");class Q extends G.Mediator{constructor(q){super(q),this.combiner=this.createCombiner()}async mediate(q){let W;try{W=this.publish(q)}catch{W=[]}await Promise.all(W.map(({reply:J})=>J));const Y=await Promise.all(W.map(J=>J.actor.runObservable(q)));return this.combiner(Y)}mediateWith(){throw new Error("Method not supported.")}createCombiner(){return q=>{const W={};return W[this.field]={},[{}].concat(q.map(Y=>Y[this.field])).forEach((Y,J,te)=>{W[this.field]={...Y,...W[this.field]}}),W}}}D.MediatorCombineUnion=Q},"../node_modules/@comunica/mediator-combine-union/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/mediator-combine-union/lib/MediatorCombineUnion.js"),D)},"../node_modules/@comunica/mediator-join-coefficients-fixed/lib/MediatorJoinCoefficientsFixed.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.MediatorJoinCoefficientsFixed=void 0;const G=F("../node_modules/@comunica/context-entries/lib/index.js"),Q=F("../node_modules/@comunica/core/lib/index.js");class X extends Q.Mediator{constructor(W){super(W)}async mediateWith(W,Y){const J=[],te=Y.map(({reply:ge})=>ge).map(ge=>ge.catch(fe=>{J.push(fe)})),Z=await Promise.all(te);let ee=Z.map((ge,fe)=>{if(ge)return ge.iterations*this.cpuWeight+ge.persistedItems*this.memoryWeight+ge.blockingItems*this.timeWeight+ge.requestTime*this.ioWeight});const re=Math.max(...ee.filter(ge=>ge!==void 0)),ne=W.context.get(G.KeysQueryOperation.limitIndicator);ne&&(ee=ee.map((ge,fe)=>ge!==void 0&&Z[fe].persistedItems>0&&Z[fe].iterations>ne?ge+re:ge));let le=-1,se=Number.POSITIVE_INFINITY;for(const[ge,fe]of ee.entries())fe!==void 0&&(le===-1||fe<se)&&(le=ge,se=fe);if(le<0)throw new Error(`All actors rejected their test in ${this.name}
${J.map(ge=>ge.message).join(`
`)}`);const ie=Y[le].actor;return ie.includeInLogs&&Q.Actor.getContextLogger(W.context)?.debug(`Determined physical join operator '${ie.logicalType}-${ie.physicalName}'`,{entries:W.entries.length,variables:await Promise.all(W.entries.map(async ge=>(await ge.output.metadata()).variables.map(fe=>fe.value))),costs:Object.fromEntries(ee.map((ge,fe)=>[`${Y[fe].actor.logicalType}-${Y[fe].actor.physicalName}`,ge])),coefficients:Object.fromEntries(Z.map((ge,fe)=>[`${Y[fe].actor.logicalType}-${Y[fe].actor.physicalName}`,ge]))}),ie}}D.MediatorJoinCoefficientsFixed=X},"../node_modules/@comunica/mediator-join-coefficients-fixed/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/mediator-join-coefficients-fixed/lib/MediatorJoinCoefficientsFixed.js"),D)},"../node_modules/@comunica/mediator-number/lib/MediatorNumber.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.MediatorNumber=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");class Q extends G.Mediator{constructor(q){super(q),this.indexPicker=this.createIndexPicker()}createIndexPicker(){switch(this.type){case"min":return q=>q.reduce((W,Y,J)=>{const te=this.getOrDefault(Y[this.field],Number.POSITIVE_INFINITY);return te!==null&&(Number.isNaN(W[0])||W[0]>te)?[te,J]:W},[Number.NaN,-1])[1];case"max":return q=>q.reduce((W,Y,J)=>{const te=this.getOrDefault(Y[this.field],Number.NEGATIVE_INFINITY);return te!==null&&(Number.isNaN(W[0])||W[0]<te)?[te,J]:W},[Number.NaN,-1])[1];default:throw new Error(`No valid "type" value was given, must be either 'min' or 'max', but got: ${this.type}`)}}getOrDefault(q,W){return q===void 0?W:q}async mediateWith(q,W){let Y=W.map(({reply:ee})=>ee);const J=[];if(this.ignoreErrors){const ee={};ee[this.field]=null,Y=Y.map(re=>re.catch(ne=>(J.push(ne),ee)))}const te=await Promise.all(Y),Z=this.indexPicker(te);if(Z<0)throw new Error(`All actors rejected their test in ${this.name}
${J.map(ee=>ee.message).join(`
`)}`);return W[Z].actor}}D.MediatorNumber=Q},"../node_modules/@comunica/mediator-number/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/mediator-number/lib/MediatorNumber.js"),D)},"../node_modules/@comunica/mediator-race/lib/MediatorRace.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.MediatorRace=void 0;const G=F("../node_modules/@comunica/core/lib/index.js");class Q extends G.Mediator{constructor(q){super(q)}mediateWith(q,W){return new Promise((Y,J)=>{const te=[];for(const Z of W)Z.reply.then(()=>{Y(Z.actor)}).catch(ee=>{te.push(ee),te.length===W.length&&J(new Error(`${this.name} mediated over all rejecting actors:
${te.map(re=>re.message).join(`
`)}`))})})}}D.MediatorRace=Q},"../node_modules/@comunica/mediator-race/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/mediator-race/lib/MediatorRace.js"),D)},"../node_modules/@comunica/types/lib/Bindings.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0})},"../node_modules/@comunica/types/lib/IActionContext.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0})},"../node_modules/@comunica/types/lib/IAggregatedStore.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0})},"../node_modules/@comunica/types/lib/ICliArgsHandler.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0})},"../node_modules/@comunica/types/lib/IDataDestination.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0})},"../node_modules/@comunica/types/lib/IDataSource.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0})},"../node_modules/@comunica/types/lib/IJoinEntry.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0})},"../node_modules/@comunica/types/lib/IMetadata.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0})},"../node_modules/@comunica/types/lib/IPhysicalQueryPlanLogger.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0})},"../node_modules/@comunica/types/lib/IProxyHandler.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0})},"../node_modules/@comunica/types/lib/IQueryContext.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0})},"../node_modules/@comunica/types/lib/IQueryEngine.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0})},"../node_modules/@comunica/types/lib/IQueryOperationResult.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0})},"../node_modules/@comunica/types/lib/Logger.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Logger=void 0;class F{static getLevelOrdinal(Q){return F.LEVELS[Q]}}D.Logger=F,F.LEVELS={trace:0,debug:1,info:2,warn:3,error:4,fatal:5}},"../node_modules/@comunica/types/lib/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/@comunica/types/lib/Bindings.js"),D),Q(F("../node_modules/@comunica/types/lib/IActionContext.js"),D),Q(F("../node_modules/@comunica/types/lib/IAggregatedStore.js"),D),Q(F("../node_modules/@comunica/types/lib/ICliArgsHandler.js"),D),Q(F("../node_modules/@comunica/types/lib/IDataDestination.js"),D),Q(F("../node_modules/@comunica/types/lib/IDataSource.js"),D),Q(F("../node_modules/@comunica/types/lib/IJoinEntry.js"),D),Q(F("../node_modules/@comunica/types/lib/IMetadata.js"),D),Q(F("../node_modules/@comunica/types/lib/IPhysicalQueryPlanLogger.js"),D),Q(F("../node_modules/@comunica/types/lib/IProxyHandler.js"),D),Q(F("../node_modules/@comunica/types/lib/IQueryContext.js"),D),Q(F("../node_modules/@comunica/types/lib/IQueryEngine.js"),D),Q(F("../node_modules/@comunica/types/lib/IQueryOperationResult.js"),D),Q(F("../node_modules/@comunica/types/lib/Logger.js"),D)},"../node_modules/asyncjoin/index.js":(U,D,F)=>{const G=F("../node_modules/asyncjoin/join/DynamicNestedLoopJoin.js"),Q=F("../node_modules/asyncjoin/join/HashJoin.js"),X=F("../node_modules/asyncjoin/join/NestedLoopJoin.js"),q=F("../node_modules/asyncjoin/join/SymmetricHashJoin.js"),W=F("../node_modules/asyncjoin/util/MergeIterator.js");U.exports={DynamicNestedLoopJoin:G,HashJoin:Q,NestedLoopJoin:X,SymmetricHashJoin:q,MergeStream:W}},"../node_modules/asyncjoin/join/DynamicNestedLoopJoin.js":(U,D,F)=>{let G=F("asynciterator"),Q=G.MultiTransformIterator,X=G.SimpleTransformIterator;class q extends Q{constructor(Y,J,te,Z){super(Y,Z),this.funRight=J,this.funJoin=te}_createTransformer(Y){return new X(this.funRight(Y),{transform:(J,te,Z)=>{let ee=this.funJoin(Y,J);ee!==null&&Z(ee),te()}})}}U.exports=q},"../node_modules/asyncjoin/join/HashJoin.js":(U,D,F)=>{let G=F("asynciterator").AsyncIterator;class Q extends G{constructor(q,W,Y,J){super(),this.addedDataListener=!1,this.left=q,this.right=W,this.funHash=Y,this.funJoin=J,this.leftMap=new Map,this.match=null,this.matches=[],this.matchIdx=0,this.left.on("error",Z=>this.destroy(Z)),this.right.on("error",Z=>this.destroy(Z)),this.readable=!1,this.left.on("end",te.bind(this));function te(){if(this.leftMap.size<=0)return this.close();this.readable=!0,this.right.on("readable",()=>this.readable=!0),this.right.on("end",()=>{this.hasResults()||this._end()})}this.on("newListener",Z=>{Z==="data"&&!this.addedDataListener&&(this.addedDataListener=!0,this._addDataListener())})}hasResults(){return!this.right.ended||this.matchIdx<this.matches.length}_end(){super._end(),this.left.destroy(),this.right.destroy()}read(){for(this.addedDataListener||(this.addedDataListener=!0,this._addDataListener());;){if(this.ended||!this.readable)return null;for(;this.matchIdx<this.matches.length;){let W=this.matches[this.matchIdx++],Y=this.funJoin(W,this.match);if(Y!==null)return Y}if(this.hasResults()||this._end(),this.match=this.right.read(),this.match===null)return this.readable=!1,null;let q=this.funHash(this.match);this.matches=this.leftMap.get(q)||[],this.matchIdx=0}}_addDataListener(){this.left.on("data",q.bind(this));function q(W){let Y=this.funHash(W);this.leftMap.has(Y)||this.leftMap.set(Y,[]),this.leftMap.get(Y).push(W)}}}U.exports=Q},"../node_modules/asyncjoin/join/NestedLoopJoin.js":(U,D,F)=>{const{MultiTransformIterator:G,SimpleTransformIterator:Q,scheduleTask:X}=F("asynciterator");class q extends G{constructor(Y,J,te,Z){super(Y,Z),this.right=J,this.funJoin=te,this.on("end",()=>this.right.close())}_end(){super._end(),X(()=>this.right.destroy())}_createTransformer(Y){return new Q(this.right.clone(),{transform:(J,te,Z)=>{let ee=this.funJoin(Y,J);ee!==null&&Z(ee),te()}})}}U.exports=q},"../node_modules/asyncjoin/join/SymmetricHashJoin.js":(U,D,F)=>{let G=F("asynciterator").AsyncIterator;class Q extends G{constructor(q,W,Y,J){super(),this.left=q,this.right=W,this.funHash=Y,this.funJoin=J,this.usedLeft=!1,this.leftMap=new Map,this.rightMap=new Map,this.on("end",()=>this._cleanup()),this.match=null,this.matches=[],this.matchIdx=0,(this.left.readable||this.right.readable)&&(this.readable=!0),this.left.on("error",te=>this.destroy(te)),this.right.on("error",te=>this.destroy(te)),this.left.on("readable",()=>this.readable=!0),this.right.on("readable",()=>this.readable=!0),this.left.on("end",()=>{this.hasResults()||this._end()}),this.right.on("end",()=>{this.hasResults()||this._end()})}hasResults(){return!this.left.ended||!this.right.ended||!!this.matches&&this.matchIdx<this.matches.length}_cleanup(){this.leftMap=null,this.rightMap=null,this.matches=null}_end(){super._end(),this.left.destroy(),this.right.destroy()}read(){if(this.ended)return null;for(;this.matchIdx<this.matches.length;){let te=this.matches[this.matchIdx++],Z=this.usedLeft?this.funJoin(this.match,te):this.funJoin(te,this.match);if(Z!==null)return Z}this.hasResults()||this._end();let q=null;for(let te=0;te<2&&(q=this.usedLeft?this.right.read():this.left.read(),this.usedLeft=!this.usedLeft,q===null);++te);if(this.done||q===null)return this.readable=!1,null;let W=this.funHash(q),Y=this.usedLeft?this.leftMap:this.rightMap;return Y.has(W)||Y.set(W,[]),Y.get(W).push(q),this.match=q,this.matches=(this.usedLeft?this.rightMap:this.leftMap).get(W)||[],this.matchIdx=0,this.read()}}U.exports=Q},"../node_modules/asyncjoin/util/MergeIterator.js":(U,D,F)=>{let G=F("asynciterator").AsyncIterator;class Q extends G{constructor(q){super(),Array.isArray(q)||(q=Array.prototype.slice.call(arguments)),this.streams=q;for(let W of q)W.on("readable",()=>this.emit("readable")),W.on("end",()=>this._removeStream(W));this.streams.length===0&&this.close(),this.idx=this.streams.length-1}_removeStream(q){let W=this.streams.indexOf(q);W<0||(this.streams.splice(W,1),this.idx>=this.streams.length&&--this.idx,this.streams.length===0&&this._end())}close(){super.close();for(let q of this.streams)q.close()}read(){for(let q=0;q<this.streams.length;++q){this.idx=(this.idx+1)%this.streams.length;let W=this.streams[this.idx].read();if(W!==null)return W}return null}}U.exports=Q},"../node_modules/bignumber.js/bignumber.js":function(U,D,F){var G;(function(Q){var X,q=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,W=Math.ceil,Y=Math.floor,J="[BigNumber Error] ",te=J+"Number primitive has more than 15 significant digits: ",Z=1e14,ee=14,re=9007199254740991,ne=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],le=1e7,se=1e9;function ie(be){var Te,ye,Ee,he=je.prototype={constructor:je,toString:null,valueOf:null},oe=new je(1),me=20,ve=4,we=-7,Pe=21,Me=-1e7,De=1e7,Oe=!1,Ie=1,Be=0,ze={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},et="0123456789abcdefghijklmnopqrstuvwxyz",qe=!0;function je(Re,Ue){var Le,Ge,ke,He,Ke,$e,Qe,Ne,Ce=this;if(!(Ce instanceof je))return new je(Re,Ue);if(Ue==null){if(Re&&Re._isBigNumber===!0){Ce.s=Re.s,!Re.c||Re.e>De?Ce.c=Ce.e=null:Re.e<Me?Ce.c=[Ce.e=0]:(Ce.e=Re.e,Ce.c=Re.c.slice());return}if(($e=typeof Re=="number")&&Re*0==0){if(Ce.s=1/Re<0?(Re=-Re,-1):1,Re===~~Re){for(He=0,Ke=Re;Ke>=10;Ke/=10,He++);He>De?Ce.c=Ce.e=null:(Ce.e=He,Ce.c=[Re]);return}Ne=String(Re)}else{if(!q.test(Ne=String(Re)))return Ee(Ce,Ne,$e);Ce.s=Ne.charCodeAt(0)==45?(Ne=Ne.slice(1),-1):1}(He=Ne.indexOf("."))>-1&&(Ne=Ne.replace(".","")),(Ke=Ne.search(/e/i))>0?(He<0&&(He=Ke),He+=+Ne.slice(Ke+1),Ne=Ne.substring(0,Ke)):He<0&&(He=Ne.length)}else{if(ue(Ue,2,et.length,"Base"),Ue==10&&qe)return Ce=new je(Re),ut(Ce,me+Ce.e+1,ve);if(Ne=String(Re),$e=typeof Re=="number"){if(Re*0!=0)return Ee(Ce,Ne,$e,Ue);if(Ce.s=1/Re<0?(Ne=Ne.slice(1),-1):1,je.DEBUG&&Ne.replace(/^0\.0*|\./,"").length>15)throw Error(te+Re)}else Ce.s=Ne.charCodeAt(0)===45?(Ne=Ne.slice(1),-1):1;for(Le=et.slice(0,Ue),He=Ke=0,Qe=Ne.length;Ke<Qe;Ke++)if(Le.indexOf(Ge=Ne.charAt(Ke))<0){if(Ge=="."){if(Ke>He){He=Qe;continue}}else if(!ke&&(Ne==Ne.toUpperCase()&&(Ne=Ne.toLowerCase())||Ne==Ne.toLowerCase()&&(Ne=Ne.toUpperCase()))){ke=!0,Ke=-1,He=0;continue}return Ee(Ce,String(Re),$e,Ue)}$e=!1,Ne=ye(Ne,Ue,10,Ce.s),(He=Ne.indexOf("."))>-1?Ne=Ne.replace(".",""):He=Ne.length}for(Ke=0;Ne.charCodeAt(Ke)===48;Ke++);for(Qe=Ne.length;Ne.charCodeAt(--Qe)===48;);if(Ne=Ne.slice(Ke,++Qe)){if(Qe-=Ke,$e&&je.DEBUG&&Qe>15&&(Re>re||Re!==Y(Re)))throw Error(te+Ce.s*Re);if((He=He-Ke-1)>De)Ce.c=Ce.e=null;else if(He<Me)Ce.c=[Ce.e=0];else{if(Ce.e=He,Ce.c=[],Ke=(He+1)%ee,He<0&&(Ke+=ee),Ke<Qe){for(Ke&&Ce.c.push(+Ne.slice(0,Ke)),Qe-=ee;Ke<Qe;)Ce.c.push(+Ne.slice(Ke,Ke+=ee));Ke=ee-(Ne=Ne.slice(Ke)).length}else Ke-=Qe;for(;Ke--;Ne+="0");Ce.c.push(+Ne)}}else Ce.c=[Ce.e=0]}je.clone=ie,je.ROUND_UP=0,je.ROUND_DOWN=1,je.ROUND_CEIL=2,je.ROUND_FLOOR=3,je.ROUND_HALF_UP=4,je.ROUND_HALF_DOWN=5,je.ROUND_HALF_EVEN=6,je.ROUND_HALF_CEIL=7,je.ROUND_HALF_FLOOR=8,je.EUCLID=9,je.config=je.set=function(Re){var Ue,Le;if(Re!=null)if(typeof Re=="object"){if(Re.hasOwnProperty(Ue="DECIMAL_PLACES")&&(Le=Re[Ue],ue(Le,0,se,Ue),me=Le),Re.hasOwnProperty(Ue="ROUNDING_MODE")&&(Le=Re[Ue],ue(Le,0,8,Ue),ve=Le),Re.hasOwnProperty(Ue="EXPONENTIAL_AT")&&(Le=Re[Ue],Le&&Le.pop?(ue(Le[0],-se,0,Ue),ue(Le[1],0,se,Ue),we=Le[0],Pe=Le[1]):(ue(Le,-se,se,Ue),we=-(Pe=Le<0?-Le:Le))),Re.hasOwnProperty(Ue="RANGE"))if(Le=Re[Ue],Le&&Le.pop)ue(Le[0],-se,-1,Ue),ue(Le[1],1,se,Ue),Me=Le[0],De=Le[1];else if(ue(Le,-se,se,Ue),Le)Me=-(De=Le<0?-Le:Le);else throw Error(J+Ue+" cannot be zero: "+Le);if(Re.hasOwnProperty(Ue="CRYPTO"))if(Le=Re[Ue],Le===!!Le)if(Le)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Oe=Le;else throw Oe=!Le,Error(J+"crypto unavailable");else Oe=Le;else throw Error(J+Ue+" not true or false: "+Le);if(Re.hasOwnProperty(Ue="MODULO_MODE")&&(Le=Re[Ue],ue(Le,0,9,Ue),Ie=Le),Re.hasOwnProperty(Ue="POW_PRECISION")&&(Le=Re[Ue],ue(Le,0,se,Ue),Be=Le),Re.hasOwnProperty(Ue="FORMAT"))if(Le=Re[Ue],typeof Le=="object")ze=Le;else throw Error(J+Ue+" not an object: "+Le);if(Re.hasOwnProperty(Ue="ALPHABET"))if(Le=Re[Ue],typeof Le=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(Le))qe=Le.slice(0,10)=="0123456789",et=Le;else throw Error(J+Ue+" invalid: "+Le)}else throw Error(J+"Object expected: "+Re);return{DECIMAL_PLACES:me,ROUNDING_MODE:ve,EXPONENTIAL_AT:[we,Pe],RANGE:[Me,De],CRYPTO:Oe,MODULO_MODE:Ie,POW_PRECISION:Be,FORMAT:ze,ALPHABET:et}},je.isBigNumber=function(Re){if(!Re||Re._isBigNumber!==!0)return!1;if(!je.DEBUG)return!0;var Ue,Le,Ge=Re.c,ke=Re.e,He=Re.s;e:if({}.toString.call(Ge)=="[object Array]"){if((He===1||He===-1)&&ke>=-se&&ke<=se&&ke===Y(ke)){if(Ge[0]===0){if(ke===0&&Ge.length===1)return!0;break e}if(Ue=(ke+1)%ee,Ue<1&&(Ue+=ee),String(Ge[0]).length==Ue){for(Ue=0;Ue<Ge.length;Ue++)if(Le=Ge[Ue],Le<0||Le>=Z||Le!==Y(Le))break e;if(Le!==0)return!0}}}else if(Ge===null&&ke===null&&(He===null||He===1||He===-1))return!0;throw Error(J+"Invalid BigNumber: "+Re)},je.maximum=je.max=function(){return ct(arguments,he.lt)},je.minimum=je.min=function(){return ct(arguments,he.gt)},je.random=function(){var Re=9007199254740992,Ue=Math.random()*Re&2097151?function(){return Y(Math.random()*Re)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(Le){var Ge,ke,He,Ke,$e,Qe=0,Ne=[],Ce=new je(oe);if(Le==null?Le=me:ue(Le,0,se),Ke=W(Le/ee),Oe)if(crypto.getRandomValues){for(Ge=crypto.getRandomValues(new Uint32Array(Ke*=2));Qe<Ke;)$e=Ge[Qe]*131072+(Ge[Qe+1]>>>11),$e>=9e15?(ke=crypto.getRandomValues(new Uint32Array(2)),Ge[Qe]=ke[0],Ge[Qe+1]=ke[1]):(Ne.push($e%1e14),Qe+=2);Qe=Ke/2}else if(crypto.randomBytes){for(Ge=crypto.randomBytes(Ke*=7);Qe<Ke;)$e=(Ge[Qe]&31)*281474976710656+Ge[Qe+1]*1099511627776+Ge[Qe+2]*4294967296+Ge[Qe+3]*16777216+(Ge[Qe+4]<<16)+(Ge[Qe+5]<<8)+Ge[Qe+6],$e>=9e15?crypto.randomBytes(7).copy(Ge,Qe):(Ne.push($e%1e14),Qe+=7);Qe=Ke/7}else throw Oe=!1,Error(J+"crypto unavailable");if(!Oe)for(;Qe<Ke;)$e=Ue(),$e<9e15&&(Ne[Qe++]=$e%1e14);for(Ke=Ne[--Qe],Le%=ee,Ke&&Le&&($e=ne[ee-Le],Ne[Qe]=Y(Ke/$e)*$e);Ne[Qe]===0;Ne.pop(),Qe--);if(Qe<0)Ne=[He=0];else{for(He=-1;Ne[0]===0;Ne.splice(0,1),He-=ee);for(Qe=1,$e=Ne[0];$e>=10;$e/=10,Qe++);Qe<ee&&(He-=ee-Qe)}return Ce.e=He,Ce.c=Ne,Ce}}(),je.sum=function(){for(var Re=1,Ue=arguments,Le=new je(Ue[0]);Re<Ue.length;)Le=Le.plus(Ue[Re++]);return Le},ye=function(){var Re="0123456789";function Ue(Le,Ge,ke,He){for(var Ke,$e=[0],Qe,Ne=0,Ce=Le.length;Ne<Ce;){for(Qe=$e.length;Qe--;$e[Qe]*=Ge);for($e[0]+=He.indexOf(Le.charAt(Ne++)),Ke=0;Ke<$e.length;Ke++)$e[Ke]>ke-1&&($e[Ke+1]==null&&($e[Ke+1]=0),$e[Ke+1]+=$e[Ke]/ke|0,$e[Ke]%=ke)}return $e.reverse()}return function(Le,Ge,ke,He,Ke){var $e,Qe,Ne,Ce,Ze,at,st,Se,ce=Le.indexOf("."),de=me,Ae=ve;for(ce>=0&&(Ce=Be,Be=0,Le=Le.replace(".",""),Se=new je(Ge),at=Se.pow(Le.length-ce),Be=Ce,Se.c=Ue(xe(fe(at.c),at.e,"0"),10,ke,Re),Se.e=Se.c.length),st=Ue(Le,Ge,ke,Ke?($e=et,Re):($e=Re,et)),Ne=Ce=st.length;st[--Ce]==0;st.pop());if(!st[0])return $e.charAt(0);if(ce<0?--Ne:(at.c=st,at.e=Ne,at.s=He,at=Te(at,Se,de,Ae,ke),st=at.c,Ze=at.r,Ne=at.e),Qe=Ne+de+1,ce=st[Qe],Ce=ke/2,Ze=Ze||Qe<0||st[Qe+1]!=null,Ze=Ae<4?(ce!=null||Ze)&&(Ae==0||Ae==(at.s<0?3:2)):ce>Ce||ce==Ce&&(Ae==4||Ze||Ae==6&&st[Qe-1]&1||Ae==(at.s<0?8:7)),Qe<1||!st[0])Le=Ze?xe($e.charAt(1),-de,$e.charAt(0)):$e.charAt(0);else{if(st.length=Qe,Ze)for(--ke;++st[--Qe]>ke;)st[Qe]=0,Qe||(++Ne,st=[1].concat(st));for(Ce=st.length;!st[--Ce];);for(ce=0,Le="";ce<=Ce;Le+=$e.charAt(st[ce++]));Le=xe(Le,Ne,$e.charAt(0))}return Le}}(),Te=function(){function Re(Ge,ke,He){var Ke,$e,Qe,Ne,Ce=0,Ze=Ge.length,at=ke%le,st=ke/le|0;for(Ge=Ge.slice();Ze--;)Qe=Ge[Ze]%le,Ne=Ge[Ze]/le|0,Ke=st*Qe+Ne*at,$e=at*Qe+Ke%le*le+Ce,Ce=($e/He|0)+(Ke/le|0)+st*Ne,Ge[Ze]=$e%He;return Ce&&(Ge=[Ce].concat(Ge)),Ge}function Ue(Ge,ke,He,Ke){var $e,Qe;if(He!=Ke)Qe=He>Ke?1:-1;else for($e=Qe=0;$e<He;$e++)if(Ge[$e]!=ke[$e]){Qe=Ge[$e]>ke[$e]?1:-1;break}return Qe}function Le(Ge,ke,He,Ke){for(var $e=0;He--;)Ge[He]-=$e,$e=Ge[He]<ke[He]?1:0,Ge[He]=$e*Ke+Ge[He]-ke[He];for(;!Ge[0]&&Ge.length>1;Ge.splice(0,1));}return function(Ge,ke,He,Ke,$e){var Qe,Ne,Ce,Ze,at,st,Se,ce,de,Ae,Fe,Ve,Je,dt,St,Tt,At,wt=Ge.s==ke.s?1:-1,ot=Ge.c,pt=ke.c;if(!ot||!ot[0]||!pt||!pt[0])return new je(!Ge.s||!ke.s||(ot?pt&&ot[0]==pt[0]:!pt)?NaN:ot&&ot[0]==0||!pt?wt*0:wt/0);for(ce=new je(wt),de=ce.c=[],Ne=Ge.e-ke.e,wt=He+Ne+1,$e||($e=Z,Ne=ge(Ge.e/ee)-ge(ke.e/ee),wt=wt/ee|0),Ce=0;pt[Ce]==(ot[Ce]||0);Ce++);if(pt[Ce]>(ot[Ce]||0)&&Ne--,wt<0)de.push(1),Ze=!0;else{for(dt=ot.length,Tt=pt.length,Ce=0,wt+=2,at=Y($e/(pt[0]+1)),at>1&&(pt=Re(pt,at,$e),ot=Re(ot,at,$e),Tt=pt.length,dt=ot.length),Je=Tt,Ae=ot.slice(0,Tt),Fe=Ae.length;Fe<Tt;Ae[Fe++]=0);At=pt.slice(),At=[0].concat(At),St=pt[0],pt[1]>=$e/2&&St++;do{if(at=0,Qe=Ue(pt,Ae,Tt,Fe),Qe<0){if(Ve=Ae[0],Tt!=Fe&&(Ve=Ve*$e+(Ae[1]||0)),at=Y(Ve/St),at>1)for(at>=$e&&(at=$e-1),st=Re(pt,at,$e),Se=st.length,Fe=Ae.length;Ue(st,Ae,Se,Fe)==1;)at--,Le(st,Tt<Se?At:pt,Se,$e),Se=st.length,Qe=1;else at==0&&(Qe=at=1),st=pt.slice(),Se=st.length;if(Se<Fe&&(st=[0].concat(st)),Le(Ae,st,Fe,$e),Fe=Ae.length,Qe==-1)for(;Ue(pt,Ae,Tt,Fe)<1;)at++,Le(Ae,Tt<Fe?At:pt,Fe,$e),Fe=Ae.length}else Qe===0&&(at++,Ae=[0]);de[Ce++]=at,Ae[0]?Ae[Fe++]=ot[Je]||0:(Ae=[ot[Je]],Fe=1)}while((Je++<dt||Ae[0]!=null)&&wt--);Ze=Ae[0]!=null,de[0]||de.splice(0,1)}if($e==Z){for(Ce=1,wt=de[0];wt>=10;wt/=10,Ce++);ut(ce,He+(ce.e=Ce+Ne*ee-1)+1,Ke,Ze)}else ce.e=Ne,ce.r=+Ze;return ce}}();function it(Re,Ue,Le,Ge){var ke,He,Ke,$e,Qe;if(Le==null?Le=ve:ue(Le,0,8),!Re.c)return Re.toString();if(ke=Re.c[0],Ke=Re.e,Ue==null)Qe=fe(Re.c),Qe=Ge==1||Ge==2&&(Ke<=we||Ke>=Pe)?_e(Qe,Ke):xe(Qe,Ke,"0");else if(Re=ut(new je(Re),Ue,Le),He=Re.e,Qe=fe(Re.c),$e=Qe.length,Ge==1||Ge==2&&(Ue<=He||He<=we)){for(;$e<Ue;Qe+="0",$e++);Qe=_e(Qe,He)}else if(Ue-=Ke,Qe=xe(Qe,He,"0"),He+1>$e){if(--Ue>0)for(Qe+=".";Ue--;Qe+="0");}else if(Ue+=He-$e,Ue>0)for(He+1==$e&&(Qe+=".");Ue--;Qe+="0");return Re.s<0&&ke?"-"+Qe:Qe}function ct(Re,Ue){for(var Le,Ge=1,ke=new je(Re[0]);Ge<Re.length;Ge++)if(Le=new je(Re[Ge]),Le.s)Ue.call(ke,Le)&&(ke=Le);else{ke=Le;break}return ke}function rt(Re,Ue,Le){for(var Ge=1,ke=Ue.length;!Ue[--ke];Ue.pop());for(ke=Ue[0];ke>=10;ke/=10,Ge++);return(Le=Ge+Le*ee-1)>De?Re.c=Re.e=null:Le<Me?Re.c=[Re.e=0]:(Re.e=Le,Re.c=Ue),Re}Ee=function(){var Re=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ue=/^([^.]+)\.$/,Le=/^\.([^.]+)$/,Ge=/^-?(Infinity|NaN)$/,ke=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(He,Ke,$e,Qe){var Ne,Ce=$e?Ke:Ke.replace(ke,"");if(Ge.test(Ce))He.s=isNaN(Ce)?null:Ce<0?-1:1;else{if(!$e&&(Ce=Ce.replace(Re,function(Ze,at,st){return Ne=(st=st.toLowerCase())=="x"?16:st=="b"?2:8,!Qe||Qe==Ne?at:Ze}),Qe&&(Ne=Qe,Ce=Ce.replace(Ue,"$1").replace(Le,"0.$1")),Ke!=Ce))return new je(Ce,Ne);if(je.DEBUG)throw Error(J+"Not a"+(Qe?" base "+Qe:"")+" number: "+Ke);He.s=null}He.c=He.e=null}}();function ut(Re,Ue,Le,Ge){var ke,He,Ke,$e,Qe,Ne,Ce,Ze=Re.c,at=ne;if(Ze){e:{for(ke=1,$e=Ze[0];$e>=10;$e/=10,ke++);if(He=Ue-ke,He<0)He+=ee,Ke=Ue,Qe=Ze[Ne=0],Ce=Qe/at[ke-Ke-1]%10|0;else if(Ne=W((He+1)/ee),Ne>=Ze.length)if(Ge){for(;Ze.length<=Ne;Ze.push(0));Qe=Ce=0,ke=1,He%=ee,Ke=He-ee+1}else break e;else{for(Qe=$e=Ze[Ne],ke=1;$e>=10;$e/=10,ke++);He%=ee,Ke=He-ee+ke,Ce=Ke<0?0:Qe/at[ke-Ke-1]%10|0}if(Ge=Ge||Ue<0||Ze[Ne+1]!=null||(Ke<0?Qe:Qe%at[ke-Ke-1]),Ge=Le<4?(Ce||Ge)&&(Le==0||Le==(Re.s<0?3:2)):Ce>5||Ce==5&&(Le==4||Ge||Le==6&&(He>0?Ke>0?Qe/at[ke-Ke]:0:Ze[Ne-1])%10&1||Le==(Re.s<0?8:7)),Ue<1||!Ze[0])return Ze.length=0,Ge?(Ue-=Re.e+1,Ze[0]=at[(ee-Ue%ee)%ee],Re.e=-Ue||0):Ze[0]=Re.e=0,Re;if(He==0?(Ze.length=Ne,$e=1,Ne--):(Ze.length=Ne+1,$e=at[ee-He],Ze[Ne]=Ke>0?Y(Qe/at[ke-Ke]%at[Ke])*$e:0),Ge)for(;;)if(Ne==0){for(He=1,Ke=Ze[0];Ke>=10;Ke/=10,He++);for(Ke=Ze[0]+=$e,$e=1;Ke>=10;Ke/=10,$e++);He!=$e&&(Re.e++,Ze[0]==Z&&(Ze[0]=1));break}else{if(Ze[Ne]+=$e,Ze[Ne]!=Z)break;Ze[Ne--]=0,$e=1}for(He=Ze.length;Ze[--He]===0;Ze.pop());}Re.e>De?Re.c=Re.e=null:Re.e<Me&&(Re.c=[Re.e=0])}return Re}function We(Re){var Ue,Le=Re.e;return Le===null?Re.toString():(Ue=fe(Re.c),Ue=Le<=we||Le>=Pe?_e(Ue,Le):xe(Ue,Le,"0"),Re.s<0?"-"+Ue:Ue)}return he.absoluteValue=he.abs=function(){var Re=new je(this);return Re.s<0&&(Re.s=1),Re},he.comparedTo=function(Re,Ue){return ae(this,new je(Re,Ue))},he.decimalPlaces=he.dp=function(Re,Ue){var Le,Ge,ke,He=this;if(Re!=null)return ue(Re,0,se),Ue==null?Ue=ve:ue(Ue,0,8),ut(new je(He),Re+He.e+1,Ue);if(!(Le=He.c))return null;if(Ge=((ke=Le.length-1)-ge(this.e/ee))*ee,ke=Le[ke])for(;ke%10==0;ke/=10,Ge--);return Ge<0&&(Ge=0),Ge},he.dividedBy=he.div=function(Re,Ue){return Te(this,new je(Re,Ue),me,ve)},he.dividedToIntegerBy=he.idiv=function(Re,Ue){return Te(this,new je(Re,Ue),0,1)},he.exponentiatedBy=he.pow=function(Re,Ue){var Le,Ge,ke,He,Ke,$e,Qe,Ne,Ce,Ze=this;if(Re=new je(Re),Re.c&&!Re.isInteger())throw Error(J+"Exponent not an integer: "+We(Re));if(Ue!=null&&(Ue=new je(Ue)),$e=Re.e>14,!Ze.c||!Ze.c[0]||Ze.c[0]==1&&!Ze.e&&Ze.c.length==1||!Re.c||!Re.c[0])return Ce=new je(Math.pow(+We(Ze),$e?Re.s*(2-pe(Re)):+We(Re))),Ue?Ce.mod(Ue):Ce;if(Qe=Re.s<0,Ue){if(Ue.c?!Ue.c[0]:!Ue.s)return new je(NaN);Ge=!Qe&&Ze.isInteger()&&Ue.isInteger(),Ge&&(Ze=Ze.mod(Ue))}else{if(Re.e>9&&(Ze.e>0||Ze.e<-1||(Ze.e==0?Ze.c[0]>1||$e&&Ze.c[1]>=24e7:Ze.c[0]<8e13||$e&&Ze.c[0]<=9999975e7)))return He=Ze.s<0&&pe(Re)?-0:0,Ze.e>-1&&(He=1/He),new je(Qe?1/He:He);Be&&(He=W(Be/ee+2))}for($e?(Le=new je(.5),Qe&&(Re.s=1),Ne=pe(Re)):(ke=Math.abs(+We(Re)),Ne=ke%2),Ce=new je(oe);;){if(Ne){if(Ce=Ce.times(Ze),!Ce.c)break;He?Ce.c.length>He&&(Ce.c.length=He):Ge&&(Ce=Ce.mod(Ue))}if(ke){if(ke=Y(ke/2),ke===0)break;Ne=ke%2}else if(Re=Re.times(Le),ut(Re,Re.e+1,1),Re.e>14)Ne=pe(Re);else{if(ke=+We(Re),ke===0)break;Ne=ke%2}Ze=Ze.times(Ze),He?Ze.c&&Ze.c.length>He&&(Ze.c.length=He):Ge&&(Ze=Ze.mod(Ue))}return Ge?Ce:(Qe&&(Ce=oe.div(Ce)),Ue?Ce.mod(Ue):He?ut(Ce,Be,ve,Ke):Ce)},he.integerValue=function(Re){var Ue=new je(this);return Re==null?Re=ve:ue(Re,0,8),ut(Ue,Ue.e+1,Re)},he.isEqualTo=he.eq=function(Re,Ue){return ae(this,new je(Re,Ue))===0},he.isFinite=function(){return!!this.c},he.isGreaterThan=he.gt=function(Re,Ue){return ae(this,new je(Re,Ue))>0},he.isGreaterThanOrEqualTo=he.gte=function(Re,Ue){return(Ue=ae(this,new je(Re,Ue)))===1||Ue===0},he.isInteger=function(){return!!this.c&&ge(this.e/ee)>this.c.length-2},he.isLessThan=he.lt=function(Re,Ue){return ae(this,new je(Re,Ue))<0},he.isLessThanOrEqualTo=he.lte=function(Re,Ue){return(Ue=ae(this,new je(Re,Ue)))===-1||Ue===0},he.isNaN=function(){return!this.s},he.isNegative=function(){return this.s<0},he.isPositive=function(){return this.s>0},he.isZero=function(){return!!this.c&&this.c[0]==0},he.minus=function(Re,Ue){var Le,Ge,ke,He,Ke=this,$e=Ke.s;if(Re=new je(Re,Ue),Ue=Re.s,!$e||!Ue)return new je(NaN);if($e!=Ue)return Re.s=-Ue,Ke.plus(Re);var Qe=Ke.e/ee,Ne=Re.e/ee,Ce=Ke.c,Ze=Re.c;if(!Qe||!Ne){if(!Ce||!Ze)return Ce?(Re.s=-Ue,Re):new je(Ze?Ke:NaN);if(!Ce[0]||!Ze[0])return Ze[0]?(Re.s=-Ue,Re):new je(Ce[0]?Ke:ve==3?-0:0)}if(Qe=ge(Qe),Ne=ge(Ne),Ce=Ce.slice(),$e=Qe-Ne){for((He=$e<0)?($e=-$e,ke=Ce):(Ne=Qe,ke=Ze),ke.reverse(),Ue=$e;Ue--;ke.push(0));ke.reverse()}else for(Ge=(He=($e=Ce.length)<(Ue=Ze.length))?$e:Ue,$e=Ue=0;Ue<Ge;Ue++)if(Ce[Ue]!=Ze[Ue]){He=Ce[Ue]<Ze[Ue];break}if(He&&(ke=Ce,Ce=Ze,Ze=ke,Re.s=-Re.s),Ue=(Ge=Ze.length)-(Le=Ce.length),Ue>0)for(;Ue--;Ce[Le++]=0);for(Ue=Z-1;Ge>$e;){if(Ce[--Ge]<Ze[Ge]){for(Le=Ge;Le&&!Ce[--Le];Ce[Le]=Ue);--Ce[Le],Ce[Ge]+=Z}Ce[Ge]-=Ze[Ge]}for(;Ce[0]==0;Ce.splice(0,1),--Ne);return Ce[0]?rt(Re,Ce,Ne):(Re.s=ve==3?-1:1,Re.c=[Re.e=0],Re)},he.modulo=he.mod=function(Re,Ue){var Le,Ge,ke=this;return Re=new je(Re,Ue),!ke.c||!Re.s||Re.c&&!Re.c[0]?new je(NaN):!Re.c||ke.c&&!ke.c[0]?new je(ke):(Ie==9?(Ge=Re.s,Re.s=1,Le=Te(ke,Re,0,3),Re.s=Ge,Le.s*=Ge):Le=Te(ke,Re,0,Ie),Re=ke.minus(Le.times(Re)),!Re.c[0]&&Ie==1&&(Re.s=ke.s),Re)},he.multipliedBy=he.times=function(Re,Ue){var Le,Ge,ke,He,Ke,$e,Qe,Ne,Ce,Ze,at,st,Se,ce,de,Ae=this,Fe=Ae.c,Ve=(Re=new je(Re,Ue)).c;if(!Fe||!Ve||!Fe[0]||!Ve[0])return!Ae.s||!Re.s||Fe&&!Fe[0]&&!Ve||Ve&&!Ve[0]&&!Fe?Re.c=Re.e=Re.s=null:(Re.s*=Ae.s,!Fe||!Ve?Re.c=Re.e=null:(Re.c=[0],Re.e=0)),Re;for(Ge=ge(Ae.e/ee)+ge(Re.e/ee),Re.s*=Ae.s,Qe=Fe.length,Ze=Ve.length,Qe<Ze&&(Se=Fe,Fe=Ve,Ve=Se,ke=Qe,Qe=Ze,Ze=ke),ke=Qe+Ze,Se=[];ke--;Se.push(0));for(ce=Z,de=le,ke=Ze;--ke>=0;){for(Le=0,at=Ve[ke]%de,st=Ve[ke]/de|0,Ke=Qe,He=ke+Ke;He>ke;)Ne=Fe[--Ke]%de,Ce=Fe[Ke]/de|0,$e=st*Ne+Ce*at,Ne=at*Ne+$e%de*de+Se[He]+Le,Le=(Ne/ce|0)+($e/de|0)+st*Ce,Se[He--]=Ne%ce;Se[He]=Le}return Le?++Ge:Se.splice(0,1),rt(Re,Se,Ge)},he.negated=function(){var Re=new je(this);return Re.s=-Re.s||null,Re},he.plus=function(Re,Ue){var Le,Ge=this,ke=Ge.s;if(Re=new je(Re,Ue),Ue=Re.s,!ke||!Ue)return new je(NaN);if(ke!=Ue)return Re.s=-Ue,Ge.minus(Re);var He=Ge.e/ee,Ke=Re.e/ee,$e=Ge.c,Qe=Re.c;if(!He||!Ke){if(!$e||!Qe)return new je(ke/0);if(!$e[0]||!Qe[0])return Qe[0]?Re:new je($e[0]?Ge:ke*0)}if(He=ge(He),Ke=ge(Ke),$e=$e.slice(),ke=He-Ke){for(ke>0?(Ke=He,Le=Qe):(ke=-ke,Le=$e),Le.reverse();ke--;Le.push(0));Le.reverse()}for(ke=$e.length,Ue=Qe.length,ke-Ue<0&&(Le=Qe,Qe=$e,$e=Le,Ue=ke),ke=0;Ue;)ke=($e[--Ue]=$e[Ue]+Qe[Ue]+ke)/Z|0,$e[Ue]=Z===$e[Ue]?0:$e[Ue]%Z;return ke&&($e=[ke].concat($e),++Ke),rt(Re,$e,Ke)},he.precision=he.sd=function(Re,Ue){var Le,Ge,ke,He=this;if(Re!=null&&Re!==!!Re)return ue(Re,1,se),Ue==null?Ue=ve:ue(Ue,0,8),ut(new je(He),Re,Ue);if(!(Le=He.c))return null;if(ke=Le.length-1,Ge=ke*ee+1,ke=Le[ke]){for(;ke%10==0;ke/=10,Ge--);for(ke=Le[0];ke>=10;ke/=10,Ge++);}return Re&&He.e+1>Ge&&(Ge=He.e+1),Ge},he.shiftedBy=function(Re){return ue(Re,-re,re),this.times("1e"+Re)},he.squareRoot=he.sqrt=function(){var Re,Ue,Le,Ge,ke,He=this,Ke=He.c,$e=He.s,Qe=He.e,Ne=me+4,Ce=new je("0.5");if($e!==1||!Ke||!Ke[0])return new je(!$e||$e<0&&(!Ke||Ke[0])?NaN:Ke?He:1/0);if($e=Math.sqrt(+We(He)),$e==0||$e==1/0?(Ue=fe(Ke),(Ue.length+Qe)%2==0&&(Ue+="0"),$e=Math.sqrt(+Ue),Qe=ge((Qe+1)/2)-(Qe<0||Qe%2),$e==1/0?Ue="5e"+Qe:(Ue=$e.toExponential(),Ue=Ue.slice(0,Ue.indexOf("e")+1)+Qe),Le=new je(Ue)):Le=new je($e+""),Le.c[0]){for(Qe=Le.e,$e=Qe+Ne,$e<3&&($e=0);;)if(ke=Le,Le=Ce.times(ke.plus(Te(He,ke,Ne,1))),fe(ke.c).slice(0,$e)===(Ue=fe(Le.c)).slice(0,$e))if(Le.e<Qe&&--$e,Ue=Ue.slice($e-3,$e+1),Ue=="9999"||!Ge&&Ue=="4999"){if(!Ge&&(ut(ke,ke.e+me+2,0),ke.times(ke).eq(He))){Le=ke;break}Ne+=4,$e+=4,Ge=1}else{(!+Ue||!+Ue.slice(1)&&Ue.charAt(0)=="5")&&(ut(Le,Le.e+me+2,1),Re=!Le.times(Le).eq(He));break}}return ut(Le,Le.e+me+1,ve,Re)},he.toExponential=function(Re,Ue){return Re!=null&&(ue(Re,0,se),Re++),it(this,Re,Ue,1)},he.toFixed=function(Re,Ue){return Re!=null&&(ue(Re,0,se),Re=Re+this.e+1),it(this,Re,Ue)},he.toFormat=function(Re,Ue,Le){var Ge,ke=this;if(Le==null)Re!=null&&Ue&&typeof Ue=="object"?(Le=Ue,Ue=null):Re&&typeof Re=="object"?(Le=Re,Re=Ue=null):Le=ze;else if(typeof Le!="object")throw Error(J+"Argument not an object: "+Le);if(Ge=ke.toFixed(Re,Ue),ke.c){var He,Ke=Ge.split("."),$e=+Le.groupSize,Qe=+Le.secondaryGroupSize,Ne=Le.groupSeparator||"",Ce=Ke[0],Ze=Ke[1],at=ke.s<0,st=at?Ce.slice(1):Ce,Se=st.length;if(Qe&&(He=$e,$e=Qe,Qe=He,Se-=He),$e>0&&Se>0){for(He=Se%$e||$e,Ce=st.substr(0,He);He<Se;He+=$e)Ce+=Ne+st.substr(He,$e);Qe>0&&(Ce+=Ne+st.slice(He)),at&&(Ce="-"+Ce)}Ge=Ze?Ce+(Le.decimalSeparator||"")+((Qe=+Le.fractionGroupSize)?Ze.replace(new RegExp("\\d{"+Qe+"}\\B","g"),"$&"+(Le.fractionGroupSeparator||"")):Ze):Ce}return(Le.prefix||"")+Ge+(Le.suffix||"")},he.toFraction=function(Re){var Ue,Le,Ge,ke,He,Ke,$e,Qe,Ne,Ce,Ze,at,st=this,Se=st.c;if(Re!=null&&($e=new je(Re),!$e.isInteger()&&($e.c||$e.s!==1)||$e.lt(oe)))throw Error(J+"Argument "+($e.isInteger()?"out of range: ":"not an integer: ")+We($e));if(!Se)return new je(st);for(Ue=new je(oe),Ne=Le=new je(oe),Ge=Qe=new je(oe),at=fe(Se),He=Ue.e=at.length-st.e-1,Ue.c[0]=ne[(Ke=He%ee)<0?ee+Ke:Ke],Re=!Re||$e.comparedTo(Ue)>0?He>0?Ue:Ne:$e,Ke=De,De=1/0,$e=new je(at),Qe.c[0]=0;Ce=Te($e,Ue,0,1),ke=Le.plus(Ce.times(Ge)),ke.comparedTo(Re)!=1;)Le=Ge,Ge=ke,Ne=Qe.plus(Ce.times(ke=Ne)),Qe=ke,Ue=$e.minus(Ce.times(ke=Ue)),$e=ke;return ke=Te(Re.minus(Le),Ge,0,1),Qe=Qe.plus(ke.times(Ne)),Le=Le.plus(ke.times(Ge)),Qe.s=Ne.s=st.s,He=He*2,Ze=Te(Ne,Ge,He,ve).minus(st).abs().comparedTo(Te(Qe,Le,He,ve).minus(st).abs())<1?[Ne,Ge]:[Qe,Le],De=Ke,Ze},he.toNumber=function(){return+We(this)},he.toPrecision=function(Re,Ue){return Re!=null&&ue(Re,1,se),it(this,Re,Ue,2)},he.toString=function(Re){var Ue,Le=this,Ge=Le.s,ke=Le.e;return ke===null?Ge?(Ue="Infinity",Ge<0&&(Ue="-"+Ue)):Ue="NaN":(Re==null?Ue=ke<=we||ke>=Pe?_e(fe(Le.c),ke):xe(fe(Le.c),ke,"0"):Re===10&&qe?(Le=ut(new je(Le),me+ke+1,ve),Ue=xe(fe(Le.c),Le.e,"0")):(ue(Re,2,et.length,"Base"),Ue=ye(xe(fe(Le.c),ke,"0"),10,Re,Ge,!0)),Ge<0&&Le.c[0]&&(Ue="-"+Ue)),Ue},he.valueOf=he.toJSON=function(){return We(this)},he._isBigNumber=!0,be!=null&&je.set(be),je}function ge(be){var Te=be|0;return be>0||be===Te?Te:Te-1}function fe(be){for(var Te,ye,Ee=1,he=be.length,oe=be[0]+"";Ee<he;){for(Te=be[Ee++]+"",ye=ee-Te.length;ye--;Te="0"+Te);oe+=Te}for(he=oe.length;oe.charCodeAt(--he)===48;);return oe.slice(0,he+1||1)}function ae(be,Te){var ye,Ee,he=be.c,oe=Te.c,me=be.s,ve=Te.s,we=be.e,Pe=Te.e;if(!me||!ve)return null;if(ye=he&&!he[0],Ee=oe&&!oe[0],ye||Ee)return ye?Ee?0:-ve:me;if(me!=ve)return me;if(ye=me<0,Ee=we==Pe,!he||!oe)return Ee?0:!he^ye?1:-1;if(!Ee)return we>Pe^ye?1:-1;for(ve=(we=he.length)<(Pe=oe.length)?we:Pe,me=0;me<ve;me++)if(he[me]!=oe[me])return he[me]>oe[me]^ye?1:-1;return we==Pe?0:we>Pe^ye?1:-1}function ue(be,Te,ye,Ee){if(be<Te||be>ye||be!==Y(be))throw Error(J+(Ee||"Argument")+(typeof be=="number"?be<Te||be>ye?" out of range: ":" not an integer: ":" not a primitive number: ")+String(be))}function pe(be){var Te=be.c.length-1;return ge(be.e/ee)==Te&&be.c[Te]%2!=0}function _e(be,Te){return(be.length>1?be.charAt(0)+"."+be.slice(1):be)+(Te<0?"e":"e+")+Te}function xe(be,Te,ye){var Ee,he;if(Te<0){for(he=ye+".";++Te;he+=ye);be=he+be}else if(Ee=be.length,++Te>Ee){for(he=ye,Te-=Ee;--Te;he+=ye);be+=he}else Te<Ee&&(be=be.slice(0,Te)+"."+be.slice(Te));return be}X=ie(),X.default=X.BigNumber=X,G=function(){return X}.call(D,F,D,U),G!==void 0&&(U.exports=G)})()},"../node_modules/canonicalize/lib/canonicalize.js":U=>{U.exports=function D(F){return F===null||typeof F!="object"||F.toJSON!=null?JSON.stringify(F):Array.isArray(F)?"["+F.reduce((G,Q,X)=>{const q=X===0?"":",",W=Q===void 0||typeof Q=="symbol"?null:Q;return G+q+D(W)},"")+"]":"{"+Object.keys(F).sort().reduce((G,Q,X)=>{if(F[Q]===void 0||typeof F[Q]=="symbol")return G;const q=G.length===0?"":",";return G+q+D(Q)+":"+D(F[Q])},"")+"}"}},"../node_modules/hash.js/lib/hash.js":(U,D,F)=>{var G=D;G.utils=F("../node_modules/hash.js/lib/hash/utils.js"),G.common=F("../node_modules/hash.js/lib/hash/common.js"),G.sha=F("../node_modules/hash.js/lib/hash/sha.js"),G.ripemd=F("../node_modules/hash.js/lib/hash/ripemd.js"),G.hmac=F("../node_modules/hash.js/lib/hash/hmac.js"),G.sha1=G.sha.sha1,G.sha256=G.sha.sha256,G.sha224=G.sha.sha224,G.sha384=G.sha.sha384,G.sha512=G.sha.sha512,G.ripemd160=G.ripemd.ripemd160},"../node_modules/hash.js/lib/hash/common.js":(U,D,F)=>{var G=F("../node_modules/hash.js/lib/hash/utils.js"),Q=F("../node_modules/minimalistic-assert/index.js");function X(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}D.BlockHash=X,X.prototype.update=function(W,Y){if(W=G.toArray(W,Y),this.pending?this.pending=this.pending.concat(W):this.pending=W,this.pendingTotal+=W.length,this.pending.length>=this._delta8){W=this.pending;var J=W.length%this._delta8;this.pending=W.slice(W.length-J,W.length),this.pending.length===0&&(this.pending=null),W=G.join32(W,0,W.length-J,this.endian);for(var te=0;te<W.length;te+=this._delta32)this._update(W,te,te+this._delta32)}return this},X.prototype.digest=function(W){return this.update(this._pad()),Q(this.pending===null),this._digest(W)},X.prototype._pad=function(){var W=this.pendingTotal,Y=this._delta8,J=Y-(W+this.padLength)%Y,te=new Array(J+this.padLength);te[0]=128;for(var Z=1;Z<J;Z++)te[Z]=0;if(W<<=3,this.endian==="big"){for(var ee=8;ee<this.padLength;ee++)te[Z++]=0;te[Z++]=0,te[Z++]=0,te[Z++]=0,te[Z++]=0,te[Z++]=W>>>24&255,te[Z++]=W>>>16&255,te[Z++]=W>>>8&255,te[Z++]=W&255}else for(te[Z++]=W&255,te[Z++]=W>>>8&255,te[Z++]=W>>>16&255,te[Z++]=W>>>24&255,te[Z++]=0,te[Z++]=0,te[Z++]=0,te[Z++]=0,ee=8;ee<this.padLength;ee++)te[Z++]=0;return te}},"../node_modules/hash.js/lib/hash/hmac.js":(U,D,F)=>{var G=F("../node_modules/hash.js/lib/hash/utils.js"),Q=F("../node_modules/minimalistic-assert/index.js");function X(q,W,Y){if(!(this instanceof X))return new X(q,W,Y);this.Hash=q,this.blockSize=q.blockSize/8,this.outSize=q.outSize/8,this.inner=null,this.outer=null,this._init(G.toArray(W,Y))}U.exports=X,X.prototype._init=function(W){W.length>this.blockSize&&(W=new this.Hash().update(W).digest()),Q(W.length<=this.blockSize);for(var Y=W.length;Y<this.blockSize;Y++)W.push(0);for(Y=0;Y<W.length;Y++)W[Y]^=54;for(this.inner=new this.Hash().update(W),Y=0;Y<W.length;Y++)W[Y]^=106;this.outer=new this.Hash().update(W)},X.prototype.update=function(W,Y){return this.inner.update(W,Y),this},X.prototype.digest=function(W){return this.outer.update(this.inner.digest()),this.outer.digest(W)}},"../node_modules/hash.js/lib/hash/ripemd.js":(U,D,F)=>{var G=F("../node_modules/hash.js/lib/hash/utils.js"),Q=F("../node_modules/hash.js/lib/hash/common.js"),X=G.rotl32,q=G.sum32,W=G.sum32_3,Y=G.sum32_4,J=Q.BlockHash;function te(){if(!(this instanceof te))return new te;J.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}G.inherits(te,J),D.ripemd160=te,te.blockSize=512,te.outSize=160,te.hmacStrength=192,te.padLength=64,te.prototype._update=function(fe,ae){for(var ue=this.h[0],pe=this.h[1],_e=this.h[2],xe=this.h[3],be=this.h[4],Te=ue,ye=pe,Ee=_e,he=xe,oe=be,me=0;me<80;me++){var ve=q(X(Y(ue,Z(me,pe,_e,xe),fe[ne[me]+ae],ee(me)),se[me]),be);ue=be,be=xe,xe=X(_e,10),_e=pe,pe=ve,ve=q(X(Y(Te,Z(79-me,ye,Ee,he),fe[le[me]+ae],re(me)),ie[me]),oe),Te=oe,oe=he,he=X(Ee,10),Ee=ye,ye=ve}ve=W(this.h[1],_e,he),this.h[1]=W(this.h[2],xe,oe),this.h[2]=W(this.h[3],be,Te),this.h[3]=W(this.h[4],ue,ye),this.h[4]=W(this.h[0],pe,Ee),this.h[0]=ve},te.prototype._digest=function(fe){return fe==="hex"?G.toHex32(this.h,"little"):G.split32(this.h,"little")};function Z(ge,fe,ae,ue){return ge<=15?fe^ae^ue:ge<=31?fe&ae|~fe&ue:ge<=47?(fe|~ae)^ue:ge<=63?fe&ue|ae&~ue:fe^(ae|~ue)}function ee(ge){return ge<=15?0:ge<=31?1518500249:ge<=47?1859775393:ge<=63?2400959708:2840853838}function re(ge){return ge<=15?1352829926:ge<=31?1548603684:ge<=47?1836072691:ge<=63?2053994217:0}var ne=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],le=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],se=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],ie=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},"../node_modules/hash.js/lib/hash/sha.js":(U,D,F)=>{D.sha1=F("../node_modules/hash.js/lib/hash/sha/1.js"),D.sha224=F("../node_modules/hash.js/lib/hash/sha/224.js"),D.sha256=F("../node_modules/hash.js/lib/hash/sha/256.js"),D.sha384=F("../node_modules/hash.js/lib/hash/sha/384.js"),D.sha512=F("../node_modules/hash.js/lib/hash/sha/512.js")},"../node_modules/hash.js/lib/hash/sha/1.js":(U,D,F)=>{var G=F("../node_modules/hash.js/lib/hash/utils.js"),Q=F("../node_modules/hash.js/lib/hash/common.js"),X=F("../node_modules/hash.js/lib/hash/sha/common.js"),q=G.rotl32,W=G.sum32,Y=G.sum32_5,J=X.ft_1,te=Q.BlockHash,Z=[1518500249,1859775393,2400959708,3395469782];function ee(){if(!(this instanceof ee))return new ee;te.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}G.inherits(ee,te),U.exports=ee,ee.blockSize=512,ee.outSize=160,ee.hmacStrength=80,ee.padLength=64,ee.prototype._update=function(ne,le){for(var se=this.W,ie=0;ie<16;ie++)se[ie]=ne[le+ie];for(;ie<se.length;ie++)se[ie]=q(se[ie-3]^se[ie-8]^se[ie-14]^se[ie-16],1);var ge=this.h[0],fe=this.h[1],ae=this.h[2],ue=this.h[3],pe=this.h[4];for(ie=0;ie<se.length;ie++){var _e=~~(ie/20),xe=Y(q(ge,5),J(_e,fe,ae,ue),pe,se[ie],Z[_e]);pe=ue,ue=ae,ae=q(fe,30),fe=ge,ge=xe}this.h[0]=W(this.h[0],ge),this.h[1]=W(this.h[1],fe),this.h[2]=W(this.h[2],ae),this.h[3]=W(this.h[3],ue),this.h[4]=W(this.h[4],pe)},ee.prototype._digest=function(ne){return ne==="hex"?G.toHex32(this.h,"big"):G.split32(this.h,"big")}},"../node_modules/hash.js/lib/hash/sha/224.js":(U,D,F)=>{var G=F("../node_modules/hash.js/lib/hash/utils.js"),Q=F("../node_modules/hash.js/lib/hash/sha/256.js");function X(){if(!(this instanceof X))return new X;Q.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}G.inherits(X,Q),U.exports=X,X.blockSize=512,X.outSize=224,X.hmacStrength=192,X.padLength=64,X.prototype._digest=function(W){return W==="hex"?G.toHex32(this.h.slice(0,7),"big"):G.split32(this.h.slice(0,7),"big")}},"../node_modules/hash.js/lib/hash/sha/256.js":(U,D,F)=>{var G=F("../node_modules/hash.js/lib/hash/utils.js"),Q=F("../node_modules/hash.js/lib/hash/common.js"),X=F("../node_modules/hash.js/lib/hash/sha/common.js"),q=F("../node_modules/minimalistic-assert/index.js"),W=G.sum32,Y=G.sum32_4,J=G.sum32_5,te=X.ch32,Z=X.maj32,ee=X.s0_256,re=X.s1_256,ne=X.g0_256,le=X.g1_256,se=Q.BlockHash,ie=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function ge(){if(!(this instanceof ge))return new ge;se.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=ie,this.W=new Array(64)}G.inherits(ge,se),U.exports=ge,ge.blockSize=512,ge.outSize=256,ge.hmacStrength=192,ge.padLength=64,ge.prototype._update=function(ae,ue){for(var pe=this.W,_e=0;_e<16;_e++)pe[_e]=ae[ue+_e];for(;_e<pe.length;_e++)pe[_e]=Y(le(pe[_e-2]),pe[_e-7],ne(pe[_e-15]),pe[_e-16]);var xe=this.h[0],be=this.h[1],Te=this.h[2],ye=this.h[3],Ee=this.h[4],he=this.h[5],oe=this.h[6],me=this.h[7];for(q(this.k.length===pe.length),_e=0;_e<pe.length;_e++){var ve=J(me,re(Ee),te(Ee,he,oe),this.k[_e],pe[_e]),we=W(ee(xe),Z(xe,be,Te));me=oe,oe=he,he=Ee,Ee=W(ye,ve),ye=Te,Te=be,be=xe,xe=W(ve,we)}this.h[0]=W(this.h[0],xe),this.h[1]=W(this.h[1],be),this.h[2]=W(this.h[2],Te),this.h[3]=W(this.h[3],ye),this.h[4]=W(this.h[4],Ee),this.h[5]=W(this.h[5],he),this.h[6]=W(this.h[6],oe),this.h[7]=W(this.h[7],me)},ge.prototype._digest=function(ae){return ae==="hex"?G.toHex32(this.h,"big"):G.split32(this.h,"big")}},"../node_modules/hash.js/lib/hash/sha/384.js":(U,D,F)=>{var G=F("../node_modules/hash.js/lib/hash/utils.js"),Q=F("../node_modules/hash.js/lib/hash/sha/512.js");function X(){if(!(this instanceof X))return new X;Q.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}G.inherits(X,Q),U.exports=X,X.blockSize=1024,X.outSize=384,X.hmacStrength=192,X.padLength=128,X.prototype._digest=function(W){return W==="hex"?G.toHex32(this.h.slice(0,12),"big"):G.split32(this.h.slice(0,12),"big")}},"../node_modules/hash.js/lib/hash/sha/512.js":(U,D,F)=>{var G=F("../node_modules/hash.js/lib/hash/utils.js"),Q=F("../node_modules/hash.js/lib/hash/common.js"),X=F("../node_modules/minimalistic-assert/index.js"),q=G.rotr64_hi,W=G.rotr64_lo,Y=G.shr64_hi,J=G.shr64_lo,te=G.sum64,Z=G.sum64_hi,ee=G.sum64_lo,re=G.sum64_4_hi,ne=G.sum64_4_lo,le=G.sum64_5_hi,se=G.sum64_5_lo,ie=Q.BlockHash,ge=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function fe(){if(!(this instanceof fe))return new fe;ie.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=ge,this.W=new Array(160)}G.inherits(fe,ie),U.exports=fe,fe.blockSize=1024,fe.outSize=512,fe.hmacStrength=192,fe.padLength=128,fe.prototype._prepareBlock=function(we,Pe){for(var Me=this.W,De=0;De<32;De++)Me[De]=we[Pe+De];for(;De<Me.length;De+=2){var Oe=oe(Me[De-4],Me[De-3]),Ie=me(Me[De-4],Me[De-3]),Be=Me[De-14],ze=Me[De-13],et=Ee(Me[De-30],Me[De-29]),qe=he(Me[De-30],Me[De-29]),je=Me[De-32],it=Me[De-31];Me[De]=re(Oe,Ie,Be,ze,et,qe,je,it),Me[De+1]=ne(Oe,Ie,Be,ze,et,qe,je,it)}},fe.prototype._update=function(we,Pe){this._prepareBlock(we,Pe);var Me=this.W,De=this.h[0],Oe=this.h[1],Ie=this.h[2],Be=this.h[3],ze=this.h[4],et=this.h[5],qe=this.h[6],je=this.h[7],it=this.h[8],ct=this.h[9],rt=this.h[10],ut=this.h[11],We=this.h[12],Re=this.h[13],Ue=this.h[14],Le=this.h[15];X(this.k.length===Me.length);for(var Ge=0;Ge<Me.length;Ge+=2){var ke=Ue,He=Le,Ke=Te(it,ct),$e=ye(it,ct),Qe=ae(it,ct,rt,ut,We),Ne=ue(it,ct,rt,ut,We,Re),Ce=this.k[Ge],Ze=this.k[Ge+1],at=Me[Ge],st=Me[Ge+1],Se=le(ke,He,Ke,$e,Qe,Ne,Ce,Ze,at,st),ce=se(ke,He,Ke,$e,Qe,Ne,Ce,Ze,at,st);ke=xe(De,Oe),He=be(De,Oe),Ke=pe(De,Oe,Ie,Be,ze),$e=_e(De,Oe,Ie,Be,ze,et);var de=Z(ke,He,Ke,$e),Ae=ee(ke,He,Ke,$e);Ue=We,Le=Re,We=rt,Re=ut,rt=it,ut=ct,it=Z(qe,je,Se,ce),ct=ee(je,je,Se,ce),qe=ze,je=et,ze=Ie,et=Be,Ie=De,Be=Oe,De=Z(Se,ce,de,Ae),Oe=ee(Se,ce,de,Ae)}te(this.h,0,De,Oe),te(this.h,2,Ie,Be),te(this.h,4,ze,et),te(this.h,6,qe,je),te(this.h,8,it,ct),te(this.h,10,rt,ut),te(this.h,12,We,Re),te(this.h,14,Ue,Le)},fe.prototype._digest=function(we){return we==="hex"?G.toHex32(this.h,"big"):G.split32(this.h,"big")};function ae(ve,we,Pe,Me,De){var Oe=ve&Pe^~ve&De;return Oe<0&&(Oe+=4294967296),Oe}function ue(ve,we,Pe,Me,De,Oe){var Ie=we&Me^~we&Oe;return Ie<0&&(Ie+=4294967296),Ie}function pe(ve,we,Pe,Me,De){var Oe=ve&Pe^ve&De^Pe&De;return Oe<0&&(Oe+=4294967296),Oe}function _e(ve,we,Pe,Me,De,Oe){var Ie=we&Me^we&Oe^Me&Oe;return Ie<0&&(Ie+=4294967296),Ie}function xe(ve,we){var Pe=q(ve,we,28),Me=q(we,ve,2),De=q(we,ve,7),Oe=Pe^Me^De;return Oe<0&&(Oe+=4294967296),Oe}function be(ve,we){var Pe=W(ve,we,28),Me=W(we,ve,2),De=W(we,ve,7),Oe=Pe^Me^De;return Oe<0&&(Oe+=4294967296),Oe}function Te(ve,we){var Pe=q(ve,we,14),Me=q(ve,we,18),De=q(we,ve,9),Oe=Pe^Me^De;return Oe<0&&(Oe+=4294967296),Oe}function ye(ve,we){var Pe=W(ve,we,14),Me=W(ve,we,18),De=W(we,ve,9),Oe=Pe^Me^De;return Oe<0&&(Oe+=4294967296),Oe}function Ee(ve,we){var Pe=q(ve,we,1),Me=q(ve,we,8),De=Y(ve,we,7),Oe=Pe^Me^De;return Oe<0&&(Oe+=4294967296),Oe}function he(ve,we){var Pe=W(ve,we,1),Me=W(ve,we,8),De=J(ve,we,7),Oe=Pe^Me^De;return Oe<0&&(Oe+=4294967296),Oe}function oe(ve,we){var Pe=q(ve,we,19),Me=q(we,ve,29),De=Y(ve,we,6),Oe=Pe^Me^De;return Oe<0&&(Oe+=4294967296),Oe}function me(ve,we){var Pe=W(ve,we,19),Me=W(we,ve,29),De=J(ve,we,6),Oe=Pe^Me^De;return Oe<0&&(Oe+=4294967296),Oe}},"../node_modules/hash.js/lib/hash/sha/common.js":(U,D,F)=>{var G=F("../node_modules/hash.js/lib/hash/utils.js"),Q=G.rotr32;function X(re,ne,le,se){if(re===0)return q(ne,le,se);if(re===1||re===3)return Y(ne,le,se);if(re===2)return W(ne,le,se)}D.ft_1=X;function q(re,ne,le){return re&ne^~re&le}D.ch32=q;function W(re,ne,le){return re&ne^re&le^ne&le}D.maj32=W;function Y(re,ne,le){return re^ne^le}D.p32=Y;function J(re){return Q(re,2)^Q(re,13)^Q(re,22)}D.s0_256=J;function te(re){return Q(re,6)^Q(re,11)^Q(re,25)}D.s1_256=te;function Z(re){return Q(re,7)^Q(re,18)^re>>>3}D.g0_256=Z;function ee(re){return Q(re,17)^Q(re,19)^re>>>10}D.g1_256=ee},"../node_modules/hash.js/lib/hash/utils.js":(U,D,F)=>{var G=F("../node_modules/minimalistic-assert/index.js"),Q=F("../node_modules/inherits/inherits_browser.js");D.inherits=Q;function X(me,ve){return(me.charCodeAt(ve)&64512)!==55296||ve<0||ve+1>=me.length?!1:(me.charCodeAt(ve+1)&64512)===56320}function q(me,ve){if(Array.isArray(me))return me.slice();if(!me)return[];var we=[];if(typeof me=="string")if(ve){if(ve==="hex")for(me=me.replace(/[^a-z0-9]+/ig,""),me.length%2!==0&&(me="0"+me),Me=0;Me<me.length;Me+=2)we.push(parseInt(me[Me]+me[Me+1],16))}else for(var Pe=0,Me=0;Me<me.length;Me++){var De=me.charCodeAt(Me);De<128?we[Pe++]=De:De<2048?(we[Pe++]=De>>6|192,we[Pe++]=De&63|128):X(me,Me)?(De=65536+((De&1023)<<10)+(me.charCodeAt(++Me)&1023),we[Pe++]=De>>18|240,we[Pe++]=De>>12&63|128,we[Pe++]=De>>6&63|128,we[Pe++]=De&63|128):(we[Pe++]=De>>12|224,we[Pe++]=De>>6&63|128,we[Pe++]=De&63|128)}else for(Me=0;Me<me.length;Me++)we[Me]=me[Me]|0;return we}D.toArray=q;function W(me){for(var ve="",we=0;we<me.length;we++)ve+=te(me[we].toString(16));return ve}D.toHex=W;function Y(me){var ve=me>>>24|me>>>8&65280|me<<8&16711680|(me&255)<<24;return ve>>>0}D.htonl=Y;function J(me,ve){for(var we="",Pe=0;Pe<me.length;Pe++){var Me=me[Pe];ve==="little"&&(Me=Y(Me)),we+=Z(Me.toString(16))}return we}D.toHex32=J;function te(me){return me.length===1?"0"+me:me}D.zero2=te;function Z(me){return me.length===7?"0"+me:me.length===6?"00"+me:me.length===5?"000"+me:me.length===4?"0000"+me:me.length===3?"00000"+me:me.length===2?"000000"+me:me.length===1?"0000000"+me:me}D.zero8=Z;function ee(me,ve,we,Pe){var Me=we-ve;G(Me%4===0);for(var De=new Array(Me/4),Oe=0,Ie=ve;Oe<De.length;Oe++,Ie+=4){var Be;Pe==="big"?Be=me[Ie]<<24|me[Ie+1]<<16|me[Ie+2]<<8|me[Ie+3]:Be=me[Ie+3]<<24|me[Ie+2]<<16|me[Ie+1]<<8|me[Ie],De[Oe]=Be>>>0}return De}D.join32=ee;function re(me,ve){for(var we=new Array(me.length*4),Pe=0,Me=0;Pe<me.length;Pe++,Me+=4){var De=me[Pe];ve==="big"?(we[Me]=De>>>24,we[Me+1]=De>>>16&255,we[Me+2]=De>>>8&255,we[Me+3]=De&255):(we[Me+3]=De>>>24,we[Me+2]=De>>>16&255,we[Me+1]=De>>>8&255,we[Me]=De&255)}return we}D.split32=re;function ne(me,ve){return me>>>ve|me<<32-ve}D.rotr32=ne;function le(me,ve){return me<<ve|me>>>32-ve}D.rotl32=le;function se(me,ve){return me+ve>>>0}D.sum32=se;function ie(me,ve,we){return me+ve+we>>>0}D.sum32_3=ie;function ge(me,ve,we,Pe){return me+ve+we+Pe>>>0}D.sum32_4=ge;function fe(me,ve,we,Pe,Me){return me+ve+we+Pe+Me>>>0}D.sum32_5=fe;function ae(me,ve,we,Pe){var Me=me[ve],De=me[ve+1],Oe=Pe+De>>>0,Ie=(Oe<Pe?1:0)+we+Me;me[ve]=Ie>>>0,me[ve+1]=Oe}D.sum64=ae;function ue(me,ve,we,Pe){var Me=ve+Pe>>>0,De=(Me<ve?1:0)+me+we;return De>>>0}D.sum64_hi=ue;function pe(me,ve,we,Pe){var Me=ve+Pe;return Me>>>0}D.sum64_lo=pe;function _e(me,ve,we,Pe,Me,De,Oe,Ie){var Be=0,ze=ve;ze=ze+Pe>>>0,Be+=ze<ve?1:0,ze=ze+De>>>0,Be+=ze<De?1:0,ze=ze+Ie>>>0,Be+=ze<Ie?1:0;var et=me+we+Me+Oe+Be;return et>>>0}D.sum64_4_hi=_e;function xe(me,ve,we,Pe,Me,De,Oe,Ie){var Be=ve+Pe+De+Ie;return Be>>>0}D.sum64_4_lo=xe;function be(me,ve,we,Pe,Me,De,Oe,Ie,Be,ze){var et=0,qe=ve;qe=qe+Pe>>>0,et+=qe<ve?1:0,qe=qe+De>>>0,et+=qe<De?1:0,qe=qe+Ie>>>0,et+=qe<Ie?1:0,qe=qe+ze>>>0,et+=qe<ze?1:0;var je=me+we+Me+Oe+Be+et;return je>>>0}D.sum64_5_hi=be;function Te(me,ve,we,Pe,Me,De,Oe,Ie,Be,ze){var et=ve+Pe+De+Ie+ze;return et>>>0}D.sum64_5_lo=Te;function ye(me,ve,we){var Pe=ve<<32-we|me>>>we;return Pe>>>0}D.rotr64_hi=ye;function Ee(me,ve,we){var Pe=me<<32-we|ve>>>we;return Pe>>>0}D.rotr64_lo=Ee;function he(me,ve,we){return me>>>we}D.shr64_hi=he;function oe(me,ve,we){var Pe=me<<32-we|ve>>>we;return Pe>>>0}D.shr64_lo=oe},"../node_modules/inherits/inherits_browser.js":U=>{typeof Object.create=="function"?U.exports=function(F,G){G&&(F.super_=G,F.prototype=Object.create(G.prototype,{constructor:{value:F,enumerable:!1,writable:!0,configurable:!0}}))}:U.exports=function(F,G){if(G){F.super_=G;var Q=function(){};Q.prototype=G.prototype,F.prototype=new Q,F.prototype.constructor=F}}},"../node_modules/lru-cache/index.js":(U,D,F)=>{const G=F("../node_modules/yallist/yallist.js"),Q=Symbol("max"),X=Symbol("length"),q=Symbol("lengthCalculator"),W=Symbol("allowStale"),Y=Symbol("maxAge"),J=Symbol("dispose"),te=Symbol("noDisposeOnSet"),Z=Symbol("lruList"),ee=Symbol("cache"),re=Symbol("updateAgeOnGet"),ne=()=>1;class le{constructor(_e){if(typeof _e=="number"&&(_e={max:_e}),_e||(_e={}),_e.max&&(typeof _e.max!="number"||_e.max<0))throw new TypeError("max must be a non-negative number");this[Q]=_e.max||1/0;const xe=_e.length||ne;if(this[q]=typeof xe!="function"?ne:xe,this[W]=_e.stale||!1,_e.maxAge&&typeof _e.maxAge!="number")throw new TypeError("maxAge must be a number");this[Y]=_e.maxAge||0,this[J]=_e.dispose,this[te]=_e.noDisposeOnSet||!1,this[re]=_e.updateAgeOnGet||!1,this.reset()}set max(_e){if(typeof _e!="number"||_e<0)throw new TypeError("max must be a non-negative number");this[Q]=_e||1/0,ge(this)}get max(){return this[Q]}set allowStale(_e){this[W]=!!_e}get allowStale(){return this[W]}set maxAge(_e){if(typeof _e!="number")throw new TypeError("maxAge must be a non-negative number");this[Y]=_e,ge(this)}get maxAge(){return this[Y]}set lengthCalculator(_e){typeof _e!="function"&&(_e=ne),_e!==this[q]&&(this[q]=_e,this[X]=0,this[Z].forEach(xe=>{xe.length=this[q](xe.value,xe.key),this[X]+=xe.length})),ge(this)}get lengthCalculator(){return this[q]}get length(){return this[X]}get itemCount(){return this[Z].length}rforEach(_e,xe){xe=xe||this;for(let be=this[Z].tail;be!==null;){const Te=be.prev;ue(this,_e,be,xe),be=Te}}forEach(_e,xe){xe=xe||this;for(let be=this[Z].head;be!==null;){const Te=be.next;ue(this,_e,be,xe),be=Te}}keys(){return this[Z].toArray().map(_e=>_e.key)}values(){return this[Z].toArray().map(_e=>_e.value)}reset(){this[J]&&this[Z]&&this[Z].length&&this[Z].forEach(_e=>this[J](_e.key,_e.value)),this[ee]=new Map,this[Z]=new G,this[X]=0}dump(){return this[Z].map(_e=>ie(this,_e)?!1:{k:_e.key,v:_e.value,e:_e.now+(_e.maxAge||0)}).toArray().filter(_e=>_e)}dumpLru(){return this[Z]}set(_e,xe,be){if(be=be||this[Y],be&&typeof be!="number")throw new TypeError("maxAge must be a number");const Te=be?Date.now():0,ye=this[q](xe,_e);if(this[ee].has(_e)){if(ye>this[Q])return fe(this,this[ee].get(_e)),!1;const oe=this[ee].get(_e).value;return this[J]&&(this[te]||this[J](_e,oe.value)),oe.now=Te,oe.maxAge=be,oe.value=xe,this[X]+=ye-oe.length,oe.length=ye,this.get(_e),ge(this),!0}const Ee=new ae(_e,xe,ye,Te,be);return Ee.length>this[Q]?(this[J]&&this[J](_e,xe),!1):(this[X]+=Ee.length,this[Z].unshift(Ee),this[ee].set(_e,this[Z].head),ge(this),!0)}has(_e){if(!this[ee].has(_e))return!1;const xe=this[ee].get(_e).value;return!ie(this,xe)}get(_e){return se(this,_e,!0)}peek(_e){return se(this,_e,!1)}pop(){const _e=this[Z].tail;return _e?(fe(this,_e),_e.value):null}del(_e){fe(this,this[ee].get(_e))}load(_e){this.reset();const xe=Date.now();for(let be=_e.length-1;be>=0;be--){const Te=_e[be],ye=Te.e||0;if(ye===0)this.set(Te.k,Te.v);else{const Ee=ye-xe;Ee>0&&this.set(Te.k,Te.v,Ee)}}}prune(){this[ee].forEach((_e,xe)=>se(this,xe,!1))}}const se=(pe,_e,xe)=>{const be=pe[ee].get(_e);if(be){const Te=be.value;if(ie(pe,Te)){if(fe(pe,be),!pe[W])return}else xe&&(pe[re]&&(be.value.now=Date.now()),pe[Z].unshiftNode(be));return Te.value}},ie=(pe,_e)=>{if(!_e||!_e.maxAge&&!pe[Y])return!1;const xe=Date.now()-_e.now;return _e.maxAge?xe>_e.maxAge:pe[Y]&&xe>pe[Y]},ge=pe=>{if(pe[X]>pe[Q])for(let _e=pe[Z].tail;pe[X]>pe[Q]&&_e!==null;){const xe=_e.prev;fe(pe,_e),_e=xe}},fe=(pe,_e)=>{if(_e){const xe=_e.value;pe[J]&&pe[J](xe.key,xe.value),pe[X]-=xe.length,pe[ee].delete(xe.key),pe[Z].removeNode(_e)}};class ae{constructor(_e,xe,be,Te,ye){this.key=_e,this.value=xe,this.length=be,this.now=Te,this.maxAge=ye||0}}const ue=(pe,_e,xe,be)=>{let Te=xe.value;ie(pe,Te)&&(fe(pe,xe),pe[W]||(Te=void 0)),Te&&_e.call(be,Te.value,Te.key,pe)};U.exports=le},"../node_modules/minimalistic-assert/index.js":U=>{U.exports=D;function D(F,G){if(!F)throw new Error(G||"Assertion failed")}D.equal=function(G,Q,X){if(G!=Q)throw new Error(X||"Assertion failed: "+G+" != "+Q)}},"../node_modules/rdf-data-factory/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W),Object.defineProperty(X,Y,{enumerable:!0,get:function(){return q[W]}})}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/rdf-data-factory/lib/BlankNode.js"),D),Q(F("../node_modules/rdf-data-factory/lib/DataFactory.js"),D),Q(F("../node_modules/rdf-data-factory/lib/DefaultGraph.js"),D),Q(F("../node_modules/rdf-data-factory/lib/Literal.js"),D),Q(F("../node_modules/rdf-data-factory/lib/NamedNode.js"),D),Q(F("../node_modules/rdf-data-factory/lib/Quad.js"),D),Q(F("../node_modules/rdf-data-factory/lib/Variable.js"),D)},"../node_modules/rdf-data-factory/lib/BlankNode.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.BlankNode=void 0;class F{constructor(Q){this.termType="BlankNode",this.value=Q}equals(Q){return!!Q&&Q.termType==="BlankNode"&&Q.value===this.value}}D.BlankNode=F},"../node_modules/rdf-data-factory/lib/DataFactory.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.DataFactory=void 0;const G=F("../node_modules/rdf-data-factory/lib/BlankNode.js"),Q=F("../node_modules/rdf-data-factory/lib/DefaultGraph.js"),X=F("../node_modules/rdf-data-factory/lib/Literal.js"),q=F("../node_modules/rdf-data-factory/lib/NamedNode.js"),W=F("../node_modules/rdf-data-factory/lib/Quad.js"),Y=F("../node_modules/rdf-data-factory/lib/Variable.js");let J=0;class te{constructor(ee){this.blankNodeCounter=0,ee=ee||{},this.blankNodePrefix=ee.blankNodePrefix||`df_${J++}_`}namedNode(ee){return new q.NamedNode(ee)}blankNode(ee){return new G.BlankNode(ee||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(ee,re){return new X.Literal(ee,re)}variable(ee){return new Y.Variable(ee)}defaultGraph(){return Q.DefaultGraph.INSTANCE}quad(ee,re,ne,le){return new W.Quad(ee,re,ne,le||this.defaultGraph())}fromTerm(ee){switch(ee.termType){case"NamedNode":return this.namedNode(ee.value);case"BlankNode":return this.blankNode(ee.value);case"Literal":return ee.language?this.literal(ee.value,ee.language):ee.datatype.equals(X.Literal.XSD_STRING)?this.literal(ee.value):this.literal(ee.value,this.fromTerm(ee.datatype));case"Variable":return this.variable(ee.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(ee.subject),this.fromTerm(ee.predicate),this.fromTerm(ee.object),this.fromTerm(ee.graph))}}fromQuad(ee){return this.fromTerm(ee)}resetBlankNodeCounter(){this.blankNodeCounter=0}}D.DataFactory=te},"../node_modules/rdf-data-factory/lib/DefaultGraph.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.DefaultGraph=void 0;class F{constructor(){this.termType="DefaultGraph",this.value=""}equals(Q){return!!Q&&Q.termType==="DefaultGraph"}}D.DefaultGraph=F,F.INSTANCE=new F},"../node_modules/rdf-data-factory/lib/Literal.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Literal=void 0;const G=F("../node_modules/rdf-data-factory/lib/NamedNode.js");class Q{constructor(q,W){this.termType="Literal",this.value=q,typeof W=="string"?(this.language=W,this.datatype=Q.RDF_LANGUAGE_STRING):W?(this.language="",this.datatype=W):(this.language="",this.datatype=Q.XSD_STRING)}equals(q){return!!q&&q.termType==="Literal"&&q.value===this.value&&q.language===this.language&&q.datatype.equals(this.datatype)}}D.Literal=Q,Q.RDF_LANGUAGE_STRING=new G.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),Q.XSD_STRING=new G.NamedNode("http://www.w3.org/2001/XMLSchema#string")},"../node_modules/rdf-data-factory/lib/NamedNode.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.NamedNode=void 0;class F{constructor(Q){this.termType="NamedNode",this.value=Q}equals(Q){return!!Q&&Q.termType==="NamedNode"&&Q.value===this.value}}D.NamedNode=F},"../node_modules/rdf-data-factory/lib/Quad.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Quad=void 0;class F{constructor(Q,X,q,W){this.termType="Quad",this.value="",this.subject=Q,this.predicate=X,this.object=q,this.graph=W}equals(Q){return!!Q&&(Q.termType==="Quad"||!Q.termType)&&this.subject.equals(Q.subject)&&this.predicate.equals(Q.predicate)&&this.object.equals(Q.object)&&this.graph.equals(Q.graph)}}D.Quad=F},"../node_modules/rdf-data-factory/lib/Variable.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Variable=void 0;class F{constructor(Q){this.termType="Variable",this.value=Q}equals(Q){return!!Q&&Q.termType==="Variable"&&Q.value===this.value}}D.Variable=F},"../node_modules/rdf-string/index.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.termToString=D.stringToTerm=D.stringQuadToQuad=D.quadToStringQuad=D.getLiteralValue=D.getLiteralType=D.getLiteralLanguage=void 0;const G=F("../node_modules/rdf-string/lib/TermUtil.js");Object.defineProperty(D,"getLiteralLanguage",{enumerable:!0,get:function(){return G.getLiteralLanguage}}),Object.defineProperty(D,"getLiteralType",{enumerable:!0,get:function(){return G.getLiteralType}}),Object.defineProperty(D,"getLiteralValue",{enumerable:!0,get:function(){return G.getLiteralValue}}),Object.defineProperty(D,"quadToStringQuad",{enumerable:!0,get:function(){return G.quadToStringQuad}}),Object.defineProperty(D,"stringQuadToQuad",{enumerable:!0,get:function(){return G.stringQuadToQuad}}),Object.defineProperty(D,"stringToTerm",{enumerable:!0,get:function(){return G.stringToTerm}}),Object.defineProperty(D,"termToString",{enumerable:!0,get:function(){return G.termToString}})},"../node_modules/rdf-string/lib/TermUtil.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.stringQuadToQuad=D.quadToStringQuad=D.stringToTerm=D.getLiteralLanguage=D.getLiteralType=D.getLiteralValue=D.termToString=void 0;const G=F("../node_modules/rdf-data-factory/index.js"),Q=new G.DataFactory;function X(ee){if(ee)switch(ee.termType){case"NamedNode":return ee.value;case"BlankNode":return"_:"+ee.value;case"Literal":const re=ee;return'"'+re.value+'"'+(re.datatype&&re.datatype.value!=="http://www.w3.org/2001/XMLSchema#string"&&re.datatype.value!=="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"?"^^"+re.datatype.value:"")+(re.language?"@"+re.language:"");case"Quad":return`<<${X(ee.subject)} ${X(ee.predicate)} ${X(ee.object)}${ee.graph.termType==="DefaultGraph"?"":" "+X(ee.graph)}>>`;case"Variable":return"?"+ee.value;case"DefaultGraph":return ee.value}}D.termToString=X;function q(ee){const re=/^"([^]*)"/.exec(ee);if(!re)throw new Error(ee+" is not a literal");return re[1]}D.getLiteralValue=q;function W(ee){const re=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(ee);if(!re)throw new Error(ee+" is not a literal");return re[1]||(re[2]?"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":"http://www.w3.org/2001/XMLSchema#string")}D.getLiteralType=W;function Y(ee){const re=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(ee);if(!re)throw new Error(ee+" is not a literal");return re[1]?re[1].toLowerCase():""}D.getLiteralLanguage=Y;function J(ee,re){if(re=re||Q,!ee||!ee.length)return re.defaultGraph();switch(ee[0]){case"_":return re.blankNode(ee.substr(2));case"?":if(!re.variable)throw new Error("Missing 'variable()' method on the given DataFactory");return re.variable(ee.substr(1));case'"':const ne=Y(ee),le=re.namedNode(W(ee));return re.literal(q(ee),ne||le);case"<":default:if(ee.startsWith("<<")&&ee.endsWith(">>")){const se=ee.slice(2,-2).trim();let ie=[],ge=0,fe=0,ae=!1;for(let ue=0;ue<se.length;ue++){const pe=se[ue];if(pe==="<"&&ge++,pe===">"){if(ge===0)throw new Error("Found closing tag without opening tag in "+ee);ge--}if(pe==='"'){let _e=!1,xe=ue;for(;xe-- >0&&se[xe]==="\\";)_e=!_e;_e||(ae=!ae)}if(pe===" "&&!ae&&ge===0){for(ie.push(se.slice(fe,ue));se[ue+1]===" ";)ue+=1;fe=ue+1}}if(ge!==0)throw new Error("Found opening tag without closing tag in "+ee);if(ie.push(se.slice(fe,se.length)),ie.length!==3&&ie.length!==4)throw new Error("Nested quad syntax error "+ee);return ie=ie.map(ue=>ue.startsWith("<")&&!ue.includes(" ")?ue.slice(1,-1):ue),re.quad(J(ie[0]),J(ie[1]),J(ie[2]),ie[3]?J(ie[3]):void 0)}return re.namedNode(ee)}}D.stringToTerm=J;function te(ee){return{subject:X(ee.subject),predicate:X(ee.predicate),object:X(ee.object),graph:X(ee.graph)}}D.quadToStringQuad=te;function Z(ee,re){return re=re||Q,re.quad(J(ee.subject,re),J(ee.predicate,re),J(ee.object,re),J(ee.graph,re))}D.stringQuadToQuad=Z},"../node_modules/rdf-terms/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W),Object.defineProperty(X,Y,{enumerable:!0,get:function(){return q[W]}})}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/rdf-terms/lib/QuadTermUtil.js"),D),Q(F("../node_modules/rdf-terms/lib/TermUtil.js"),D)},"../node_modules/rdf-terms/lib/QuadTermUtil.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.matchPatternMappings=D.matchPatternComplete=D.matchPattern=D.matchTerm=D.someTerms=D.everyTerms=D.reduceTerms=D.mapTerms=D.filterQuadTermNames=D.filterTerms=D.forEachTerms=D.collectNamedTerms=D.getNamedTerms=D.getTermsNested=D.getTerms=D.TRIPLE_TERM_NAMES=D.QUAD_TERM_NAMES=void 0;const G=F("../node_modules/rdf-data-factory/index.js"),Q=new G.DataFactory;D.QUAD_TERM_NAMES=["subject","predicate","object","graph"],D.TRIPLE_TERM_NAMES=["subject","predicate","object"];function X(ae,ue){return ue&&ae.graph.termType==="DefaultGraph"?[ae.subject,ae.predicate,ae.object]:[ae.subject,ae.predicate,ae.object,ae.graph]}D.getTerms=X;function q(ae,ue){const pe=[];for(const _e of X(ae,ue))_e.termType==="Quad"?q(_e,ue).forEach(xe=>pe.push(xe)):pe.push(_e);return pe}D.getTermsNested=q;function W(ae){return[{key:"subject",value:ae.subject},{key:"predicate",value:ae.predicate},{key:"object",value:ae.object},{key:"graph",value:ae.graph}]}D.getNamedTerms=W;function Y(ae,ue,pe){const _e={};return ae.forEach(xe=>_e[xe.key]=xe.value),ue&&(_e.subject=_e.subject||ue("subject"),_e.predicate=_e.predicate||ue("predicate"),_e.object=_e.object||ue("object"),_e.graph=_e.graph||ue("graph")),(pe||Q).quad(_e.subject,_e.predicate,_e.object,_e.graph)}D.collectNamedTerms=Y;function J(ae,ue){ue(ae.subject,"subject"),ue(ae.predicate,"predicate"),ue(ae.object,"object"),ue(ae.graph,"graph")}D.forEachTerms=J;function te(ae,ue){const pe=[];return ue(ae.subject,"subject")&&pe.push(ae.subject),ue(ae.predicate,"predicate")&&pe.push(ae.predicate),ue(ae.object,"object")&&pe.push(ae.object),ue(ae.graph,"graph")&&pe.push(ae.graph),pe}D.filterTerms=te;function Z(ae,ue){const pe=[];return ue(ae.subject,"subject")&&pe.push("subject"),ue(ae.predicate,"predicate")&&pe.push("predicate"),ue(ae.object,"object")&&pe.push("object"),ue(ae.graph,"graph")&&pe.push("graph"),pe}D.filterQuadTermNames=Z;function ee(ae,ue,pe){return(pe||Q).quad(ue(ae.subject,"subject"),ue(ae.predicate,"predicate"),ue(ae.object,"object"),ue(ae.graph,"graph"))}D.mapTerms=ee;function re(ae,ue,pe){let _e=pe;return _e=ue(_e,ae.subject,"subject"),_e=ue(_e,ae.predicate,"predicate"),_e=ue(_e,ae.object,"object"),ue(_e,ae.graph,"graph")}D.reduceTerms=re;function ne(ae,ue){return ue(ae.subject,"subject")&&ue(ae.predicate,"predicate")&&ue(ae.object,"object")&&ue(ae.graph,"graph")}D.everyTerms=ne;function le(ae,ue){return ue(ae.subject,"subject")||ue(ae.predicate,"predicate")||ue(ae.object,"object")||ue(ae.graph,"graph")}D.someTerms=le;function se(ae,ue){return!ue||ue.termType==="Variable"||ue.termType==="Quad"&&ae.termType==="Quad"&&ge(ae,ue)||ue.equals(ae)}D.matchTerm=se;function ie(ae,ue,pe,_e,xe){return se(ae.subject,ue)&&se(ae.predicate,pe)&&se(ae.object,_e)&&se(ae.graph,xe)}D.matchPattern=ie;function ge(ae,ue){return ie(ae,ue.subject,ue.predicate,ue.object,ue.graph)}D.matchPatternComplete=ge;function fe(ae,ue,pe={}){const _e={};function xe(be,Te){return ne(be,(ye,Ee)=>{var he,oe;const me=Te[Ee];switch(ye.termType){case"Variable":return pe.skipVarMapping&&me.termType==="Variable"||((oe=(he=_e[ye.value])===null||he===void 0?void 0:he.equals(me))!==null&&oe!==void 0?oe:(_e[ye.value]=me,!0));case"Quad":return me.termType==="Quad"&&xe(ye,me);default:return ye.equals(me)}})}return xe(ue,ae)&&(pe.returnMappings?_e:!0)}D.matchPatternMappings=fe},"../node_modules/rdf-terms/lib/TermUtil.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.getQuads=D.getDefaultGraphs=D.getVariables=D.getLiterals=D.getBlankNodes=D.getNamedNodes=D.getTermsOfType=D.uniqTerms=D.TERM_TYPES=void 0;const G=F("../node_modules/rdf-string/index.js");D.TERM_TYPES=["NamedNode","BlankNode","Literal","Variable","DefaultGraph","Quad"];function Q(ee){const re={};return ee.filter(ne=>{const le=G.termToString(ne);return!(le in re)&&(re[le]=!0)})}D.uniqTerms=Q;function X(ee,re){return ee.filter(ne=>ne.termType===re)}D.getTermsOfType=X;function q(ee){return X(ee,"NamedNode")}D.getNamedNodes=q;function W(ee){return X(ee,"BlankNode")}D.getBlankNodes=W;function Y(ee){return X(ee,"Literal")}D.getLiterals=Y;function J(ee){return X(ee,"Variable")}D.getVariables=J;function te(ee){return X(ee,"DefaultGraph")}D.getDefaultGraphs=te;function Z(ee){return X(ee,"Quad")}D.getQuads=Z},"../node_modules/relative-to-absolute-iri/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W),Object.defineProperty(X,Y,{enumerable:!0,get:function(){return q[W]}})}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/relative-to-absolute-iri/lib/Resolve.js"),D)},"../node_modules/relative-to-absolute-iri/lib/Resolve.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.removeDotSegmentsOfPath=D.removeDotSegments=D.resolve=void 0;function F(q,W){W=W||"";const Y=W.indexOf("#");if(Y>0&&(W=W.substr(0,Y)),!q.length){if(W.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${W}' for value '${q}'`);return W}if(q.startsWith("?")){const le=W.indexOf("?");return le>0&&(W=W.substr(0,le)),W+q}if(q.startsWith("#"))return W+q;if(!W.length){const le=q.indexOf(":");if(le<0)throw new Error(`Found invalid relative IRI '${q}' for a missing baseIRI`);return Q(q,le)}const J=q.indexOf(":");if(J>=0)return Q(q,J);const te=W.indexOf(":");if(te<0)throw new Error(`Found invalid baseIRI '${W}' for value '${q}'`);const Z=W.substr(0,te+1);if(q.indexOf("//")===0)return Z+Q(q,J);let ee;if(W.indexOf("//",te)===te+1){if(ee=W.indexOf("/",te+3),ee<0)return W.length>te+3?W+"/"+Q(q,J):Z+Q(q,J)}else if(ee=W.indexOf("/",te+1),ee<0)return Z+Q(q,J);if(q.indexOf("/")===0)return W.substr(0,ee)+G(q);let re=W.substr(ee);const ne=re.lastIndexOf("/");return ne>=0&&ne<re.length-1&&(re=re.substr(0,ne+1),q[0]==="."&&q[1]!=="."&&q[1]!=="/"&&q[2]&&(q=q.substr(1))),q=re+q,q=G(q),W.substr(0,ee)+q}D.resolve=F;function G(q){const W=[];let Y=0;for(;Y<q.length;)switch(q[Y]){case"/":if(q[Y+1]===".")if(q[Y+2]==="."){if(!X(q[Y+3])){W.push([]),Y++;break}W.pop(),q[Y+3]||W.push([]),Y+=3}else{if(!X(q[Y+2])){W.push([]),Y++;break}q[Y+2]||W.push([]),Y+=2}else W.push([]),Y++;break;case"#":case"?":W.length||W.push([]),W[W.length-1].push(q.substr(Y)),Y=q.length;break;default:W.length||W.push([]),W[W.length-1].push(q[Y]),Y++;break}return"/"+W.map(J=>J.join("")).join("/")}D.removeDotSegments=G;function Q(q,W){let Y=W+1;W>=0?q[W+1]==="/"&&q[W+2]==="/"&&(Y=W+3):q[0]==="/"&&q[1]==="/"&&(Y=2);const J=q.indexOf("/",Y);if(J<0)return q;const te=q.substr(0,J),Z=q.substr(J);return te+G(Z)}D.removeDotSegmentsOfPath=Q;function X(q){return!q||q==="#"||q==="?"||q==="/"}},"../node_modules/spark-md5/spark-md5.js":U=>{(function(D){U.exports=D()})(function(D){var F=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function G(se,ie){var ge=se[0],fe=se[1],ae=se[2],ue=se[3];ge+=(fe&ae|~fe&ue)+ie[0]-680876936|0,ge=(ge<<7|ge>>>25)+fe|0,ue+=(ge&fe|~ge&ae)+ie[1]-389564586|0,ue=(ue<<12|ue>>>20)+ge|0,ae+=(ue&ge|~ue&fe)+ie[2]+606105819|0,ae=(ae<<17|ae>>>15)+ue|0,fe+=(ae&ue|~ae&ge)+ie[3]-1044525330|0,fe=(fe<<22|fe>>>10)+ae|0,ge+=(fe&ae|~fe&ue)+ie[4]-176418897|0,ge=(ge<<7|ge>>>25)+fe|0,ue+=(ge&fe|~ge&ae)+ie[5]+1200080426|0,ue=(ue<<12|ue>>>20)+ge|0,ae+=(ue&ge|~ue&fe)+ie[6]-1473231341|0,ae=(ae<<17|ae>>>15)+ue|0,fe+=(ae&ue|~ae&ge)+ie[7]-45705983|0,fe=(fe<<22|fe>>>10)+ae|0,ge+=(fe&ae|~fe&ue)+ie[8]+1770035416|0,ge=(ge<<7|ge>>>25)+fe|0,ue+=(ge&fe|~ge&ae)+ie[9]-1958414417|0,ue=(ue<<12|ue>>>20)+ge|0,ae+=(ue&ge|~ue&fe)+ie[10]-42063|0,ae=(ae<<17|ae>>>15)+ue|0,fe+=(ae&ue|~ae&ge)+ie[11]-1990404162|0,fe=(fe<<22|fe>>>10)+ae|0,ge+=(fe&ae|~fe&ue)+ie[12]+1804603682|0,ge=(ge<<7|ge>>>25)+fe|0,ue+=(ge&fe|~ge&ae)+ie[13]-40341101|0,ue=(ue<<12|ue>>>20)+ge|0,ae+=(ue&ge|~ue&fe)+ie[14]-1502002290|0,ae=(ae<<17|ae>>>15)+ue|0,fe+=(ae&ue|~ae&ge)+ie[15]+1236535329|0,fe=(fe<<22|fe>>>10)+ae|0,ge+=(fe&ue|ae&~ue)+ie[1]-165796510|0,ge=(ge<<5|ge>>>27)+fe|0,ue+=(ge&ae|fe&~ae)+ie[6]-1069501632|0,ue=(ue<<9|ue>>>23)+ge|0,ae+=(ue&fe|ge&~fe)+ie[11]+643717713|0,ae=(ae<<14|ae>>>18)+ue|0,fe+=(ae&ge|ue&~ge)+ie[0]-373897302|0,fe=(fe<<20|fe>>>12)+ae|0,ge+=(fe&ue|ae&~ue)+ie[5]-701558691|0,ge=(ge<<5|ge>>>27)+fe|0,ue+=(ge&ae|fe&~ae)+ie[10]+38016083|0,ue=(ue<<9|ue>>>23)+ge|0,ae+=(ue&fe|ge&~fe)+ie[15]-660478335|0,ae=(ae<<14|ae>>>18)+ue|0,fe+=(ae&ge|ue&~ge)+ie[4]-405537848|0,fe=(fe<<20|fe>>>12)+ae|0,ge+=(fe&ue|ae&~ue)+ie[9]+568446438|0,ge=(ge<<5|ge>>>27)+fe|0,ue+=(ge&ae|fe&~ae)+ie[14]-1019803690|0,ue=(ue<<9|ue>>>23)+ge|0,ae+=(ue&fe|ge&~fe)+ie[3]-187363961|0,ae=(ae<<14|ae>>>18)+ue|0,fe+=(ae&ge|ue&~ge)+ie[8]+1163531501|0,fe=(fe<<20|fe>>>12)+ae|0,ge+=(fe&ue|ae&~ue)+ie[13]-1444681467|0,ge=(ge<<5|ge>>>27)+fe|0,ue+=(ge&ae|fe&~ae)+ie[2]-51403784|0,ue=(ue<<9|ue>>>23)+ge|0,ae+=(ue&fe|ge&~fe)+ie[7]+1735328473|0,ae=(ae<<14|ae>>>18)+ue|0,fe+=(ae&ge|ue&~ge)+ie[12]-1926607734|0,fe=(fe<<20|fe>>>12)+ae|0,ge+=(fe^ae^ue)+ie[5]-378558|0,ge=(ge<<4|ge>>>28)+fe|0,ue+=(ge^fe^ae)+ie[8]-2022574463|0,ue=(ue<<11|ue>>>21)+ge|0,ae+=(ue^ge^fe)+ie[11]+1839030562|0,ae=(ae<<16|ae>>>16)+ue|0,fe+=(ae^ue^ge)+ie[14]-35309556|0,fe=(fe<<23|fe>>>9)+ae|0,ge+=(fe^ae^ue)+ie[1]-1530992060|0,ge=(ge<<4|ge>>>28)+fe|0,ue+=(ge^fe^ae)+ie[4]+1272893353|0,ue=(ue<<11|ue>>>21)+ge|0,ae+=(ue^ge^fe)+ie[7]-155497632|0,ae=(ae<<16|ae>>>16)+ue|0,fe+=(ae^ue^ge)+ie[10]-1094730640|0,fe=(fe<<23|fe>>>9)+ae|0,ge+=(fe^ae^ue)+ie[13]+681279174|0,ge=(ge<<4|ge>>>28)+fe|0,ue+=(ge^fe^ae)+ie[0]-358537222|0,ue=(ue<<11|ue>>>21)+ge|0,ae+=(ue^ge^fe)+ie[3]-722521979|0,ae=(ae<<16|ae>>>16)+ue|0,fe+=(ae^ue^ge)+ie[6]+76029189|0,fe=(fe<<23|fe>>>9)+ae|0,ge+=(fe^ae^ue)+ie[9]-640364487|0,ge=(ge<<4|ge>>>28)+fe|0,ue+=(ge^fe^ae)+ie[12]-421815835|0,ue=(ue<<11|ue>>>21)+ge|0,ae+=(ue^ge^fe)+ie[15]+530742520|0,ae=(ae<<16|ae>>>16)+ue|0,fe+=(ae^ue^ge)+ie[2]-995338651|0,fe=(fe<<23|fe>>>9)+ae|0,ge+=(ae^(fe|~ue))+ie[0]-198630844|0,ge=(ge<<6|ge>>>26)+fe|0,ue+=(fe^(ge|~ae))+ie[7]+1126891415|0,ue=(ue<<10|ue>>>22)+ge|0,ae+=(ge^(ue|~fe))+ie[14]-1416354905|0,ae=(ae<<15|ae>>>17)+ue|0,fe+=(ue^(ae|~ge))+ie[5]-57434055|0,fe=(fe<<21|fe>>>11)+ae|0,ge+=(ae^(fe|~ue))+ie[12]+1700485571|0,ge=(ge<<6|ge>>>26)+fe|0,ue+=(fe^(ge|~ae))+ie[3]-1894986606|0,ue=(ue<<10|ue>>>22)+ge|0,ae+=(ge^(ue|~fe))+ie[10]-1051523|0,ae=(ae<<15|ae>>>17)+ue|0,fe+=(ue^(ae|~ge))+ie[1]-2054922799|0,fe=(fe<<21|fe>>>11)+ae|0,ge+=(ae^(fe|~ue))+ie[8]+1873313359|0,ge=(ge<<6|ge>>>26)+fe|0,ue+=(fe^(ge|~ae))+ie[15]-30611744|0,ue=(ue<<10|ue>>>22)+ge|0,ae+=(ge^(ue|~fe))+ie[6]-1560198380|0,ae=(ae<<15|ae>>>17)+ue|0,fe+=(ue^(ae|~ge))+ie[13]+1309151649|0,fe=(fe<<21|fe>>>11)+ae|0,ge+=(ae^(fe|~ue))+ie[4]-145523070|0,ge=(ge<<6|ge>>>26)+fe|0,ue+=(fe^(ge|~ae))+ie[11]-1120210379|0,ue=(ue<<10|ue>>>22)+ge|0,ae+=(ge^(ue|~fe))+ie[2]+718787259|0,ae=(ae<<15|ae>>>17)+ue|0,fe+=(ue^(ae|~ge))+ie[9]-343485551|0,fe=(fe<<21|fe>>>11)+ae|0,se[0]=ge+se[0]|0,se[1]=fe+se[1]|0,se[2]=ae+se[2]|0,se[3]=ue+se[3]|0}function Q(se){var ie=[],ge;for(ge=0;ge<64;ge+=4)ie[ge>>2]=se.charCodeAt(ge)+(se.charCodeAt(ge+1)<<8)+(se.charCodeAt(ge+2)<<16)+(se.charCodeAt(ge+3)<<24);return ie}function X(se){var ie=[],ge;for(ge=0;ge<64;ge+=4)ie[ge>>2]=se[ge]+(se[ge+1]<<8)+(se[ge+2]<<16)+(se[ge+3]<<24);return ie}function q(se){var ie=se.length,ge=[1732584193,-271733879,-1732584194,271733878],fe,ae,ue,pe,_e,xe;for(fe=64;fe<=ie;fe+=64)G(ge,Q(se.substring(fe-64,fe)));for(se=se.substring(fe-64),ae=se.length,ue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=0;fe<ae;fe+=1)ue[fe>>2]|=se.charCodeAt(fe)<<(fe%4<<3);if(ue[fe>>2]|=128<<(fe%4<<3),fe>55)for(G(ge,ue),fe=0;fe<16;fe+=1)ue[fe]=0;return pe=ie*8,pe=pe.toString(16).match(/(.*?)(.{0,8})$/),_e=parseInt(pe[2],16),xe=parseInt(pe[1],16)||0,ue[14]=_e,ue[15]=xe,G(ge,ue),ge}function W(se){var ie=se.length,ge=[1732584193,-271733879,-1732584194,271733878],fe,ae,ue,pe,_e,xe;for(fe=64;fe<=ie;fe+=64)G(ge,X(se.subarray(fe-64,fe)));for(se=fe-64<ie?se.subarray(fe-64):new Uint8Array(0),ae=se.length,ue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=0;fe<ae;fe+=1)ue[fe>>2]|=se[fe]<<(fe%4<<3);if(ue[fe>>2]|=128<<(fe%4<<3),fe>55)for(G(ge,ue),fe=0;fe<16;fe+=1)ue[fe]=0;return pe=ie*8,pe=pe.toString(16).match(/(.*?)(.{0,8})$/),_e=parseInt(pe[2],16),xe=parseInt(pe[1],16)||0,ue[14]=_e,ue[15]=xe,G(ge,ue),ge}function Y(se){var ie="",ge;for(ge=0;ge<4;ge+=1)ie+=F[se>>ge*8+4&15]+F[se>>ge*8&15];return ie}function J(se){var ie;for(ie=0;ie<se.length;ie+=1)se[ie]=Y(se[ie]);return se.join("")}J(q("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function se(ie,ge){return ie=ie|0||0,ie<0?Math.max(ie+ge,0):Math.min(ie,ge)}ArrayBuffer.prototype.slice=function(ie,ge){var fe=this.byteLength,ae=se(ie,fe),ue=fe,pe,_e,xe,be;return ge!==D&&(ue=se(ge,fe)),ae>ue?new ArrayBuffer(0):(pe=ue-ae,_e=new ArrayBuffer(pe),xe=new Uint8Array(_e),be=new Uint8Array(this,ae,pe),xe.set(be),_e)}}();function te(se){return/[\u0080-\uFFFF]/.test(se)&&(se=unescape(encodeURIComponent(se))),se}function Z(se,ie){var ge=se.length,fe=new ArrayBuffer(ge),ae=new Uint8Array(fe),ue;for(ue=0;ue<ge;ue+=1)ae[ue]=se.charCodeAt(ue);return ie?ae:fe}function ee(se){return String.fromCharCode.apply(null,new Uint8Array(se))}function re(se,ie,ge){var fe=new Uint8Array(se.byteLength+ie.byteLength);return fe.set(new Uint8Array(se)),fe.set(new Uint8Array(ie),se.byteLength),ge?fe:fe.buffer}function ne(se){var ie=[],ge=se.length,fe;for(fe=0;fe<ge-1;fe+=2)ie.push(parseInt(se.substr(fe,2),16));return String.fromCharCode.apply(String,ie)}function le(){this.reset()}return le.prototype.append=function(se){return this.appendBinary(te(se)),this},le.prototype.appendBinary=function(se){this._buff+=se,this._length+=se.length;var ie=this._buff.length,ge;for(ge=64;ge<=ie;ge+=64)G(this._hash,Q(this._buff.substring(ge-64,ge)));return this._buff=this._buff.substring(ge-64),this},le.prototype.end=function(se){var ie=this._buff,ge=ie.length,fe,ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ue;for(fe=0;fe<ge;fe+=1)ae[fe>>2]|=ie.charCodeAt(fe)<<(fe%4<<3);return this._finish(ae,ge),ue=J(this._hash),se&&(ue=ne(ue)),this.reset(),ue},le.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},le.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},le.prototype.setState=function(se){return this._buff=se.buff,this._length=se.length,this._hash=se.hash,this},le.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},le.prototype._finish=function(se,ie){var ge=ie,fe,ae,ue;if(se[ge>>2]|=128<<(ge%4<<3),ge>55)for(G(this._hash,se),ge=0;ge<16;ge+=1)se[ge]=0;fe=this._length*8,fe=fe.toString(16).match(/(.*?)(.{0,8})$/),ae=parseInt(fe[2],16),ue=parseInt(fe[1],16)||0,se[14]=ae,se[15]=ue,G(this._hash,se)},le.hash=function(se,ie){return le.hashBinary(te(se),ie)},le.hashBinary=function(se,ie){var ge=q(se),fe=J(ge);return ie?ne(fe):fe},le.ArrayBuffer=function(){this.reset()},le.ArrayBuffer.prototype.append=function(se){var ie=re(this._buff.buffer,se,!0),ge=ie.length,fe;for(this._length+=se.byteLength,fe=64;fe<=ge;fe+=64)G(this._hash,X(ie.subarray(fe-64,fe)));return this._buff=fe-64<ge?new Uint8Array(ie.buffer.slice(fe-64)):new Uint8Array(0),this},le.ArrayBuffer.prototype.end=function(se){var ie=this._buff,ge=ie.length,fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ae,ue;for(ae=0;ae<ge;ae+=1)fe[ae>>2]|=ie[ae]<<(ae%4<<3);return this._finish(fe,ge),ue=J(this._hash),se&&(ue=ne(ue)),this.reset(),ue},le.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},le.ArrayBuffer.prototype.getState=function(){var se=le.prototype.getState.call(this);return se.buff=ee(se.buff),se},le.ArrayBuffer.prototype.setState=function(se){return se.buff=Z(se.buff,!0),le.prototype.setState.call(this,se)},le.ArrayBuffer.prototype.destroy=le.prototype.destroy,le.ArrayBuffer.prototype._finish=le.prototype._finish,le.ArrayBuffer.hash=function(se,ie){var ge=W(new Uint8Array(se)),fe=J(ge);return ie?ne(fe):fe},le})},"../node_modules/sparqlee/dist/index.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.AsyncAggregateEvaluator=D.orderTypes=D.isExpressionError=D.ExpressionError=D.AggregateEvaluator=D.SyncEvaluator=D.AsyncEvaluator=void 0;var G=F("../node_modules/sparqlee/dist/lib/evaluators/AsyncEvaluator.js");Object.defineProperty(D,"AsyncEvaluator",{enumerable:!0,get:function(){return G.AsyncEvaluator}});var Q=F("../node_modules/sparqlee/dist/lib/evaluators/SyncEvaluator.js");Object.defineProperty(D,"SyncEvaluator",{enumerable:!0,get:function(){return Q.SyncEvaluator}});var X=F("../node_modules/sparqlee/dist/lib/evaluators/AggregateEvaluator.js");Object.defineProperty(D,"AggregateEvaluator",{enumerable:!0,get:function(){return X.AggregateEvaluator}});var q=F("../node_modules/sparqlee/dist/lib/util/Errors.js");Object.defineProperty(D,"ExpressionError",{enumerable:!0,get:function(){return q.ExpressionError}}),Object.defineProperty(D,"isExpressionError",{enumerable:!0,get:function(){return q.isExpressionError}});var W=F("../node_modules/sparqlee/dist/lib/util/Ordering.js");Object.defineProperty(D,"orderTypes",{enumerable:!0,get:function(){return W.orderTypes}});var Y=F("../node_modules/sparqlee/dist/lib/evaluators/AsyncAggregateEvaluator.js");Object.defineProperty(D,"AsyncAggregateEvaluator",{enumerable:!0,get:function(){return Y.AsyncAggregateEvaluator}})},"../node_modules/sparqlee/dist/lib/aggregators/Average.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Average=void 0;const G=F("../node_modules/sparqlee/dist/lib/expressions/index.js"),Q=F("../node_modules/sparqlee/dist/lib/functions/index.js"),X=F("../node_modules/sparqlee/dist/lib/functions/Helpers.js"),q=F("../node_modules/sparqlee/dist/lib/util/Consts.js"),W=F("../node_modules/sparqlee/dist/lib/aggregators/BaseAggregator.js");class Y extends W.BaseAggregator{constructor(){super(...arguments),this.summer=Q.regularFunctions[q.RegularOperator.ADDITION],this.divider=Q.regularFunctions[q.RegularOperator.DIVISION]}static emptyValue(){return(0,X.integer)(0).toRDF()}init(te){return{sum:this.termToNumericOrError(te),count:1}}put(te,Z){const ee=this.termToNumericOrError(Z);return{sum:this.summer.apply([te.sum,ee],this.sharedContext),count:te.count+1}}result(te){const Z=new G.IntegerLiteral(te.count);return this.divider.apply([te.sum,Z],this.sharedContext).toRDF()}}D.Average=Y},"../node_modules/sparqlee/dist/lib/aggregators/BaseAggregator.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.BaseAggregator=void 0;const G=F("../node_modules/sparqlee/dist/lib/transformers/TermTransformer.js"),Q=F("../node_modules/sparqlee/dist/lib/util/Consts.js"),X=F("../node_modules/sparqlee/dist/lib/util/TypeHandling.js");class q{constructor(Y,J){this.sharedContext=J,this.distinct=Y.distinct,this.separator=Y.separator||" ",this.termTransformer=new G.TermTransformer(J.superTypeProvider)}termToNumericOrError(Y){if(Y.termType!=="Literal")throw new Error(`Term with value ${Y.value} has type ${Y.termType} and is not a numeric literal`);if(!(0,X.isSubTypeOf)(Y.datatype.value,Q.TypeAlias.SPARQL_NUMERIC,this.sharedContext.superTypeProvider))throw new Error(`Term datatype ${Y.datatype.value} with value ${Y.value} has type ${Y.termType} and is not a numeric literal`);return this.termTransformer.transformLiteral(Y)}extractValue(Y){if(Y.termType!=="Literal")throw new Error(`Term with value ${Y.value} has type ${Y.termType} and is not a literal`);const J=this.termTransformer.transformLiteral(Y);return{type:J.dataType,value:J.typedValue}}static emptyValue(){}}D.BaseAggregator=q},"../node_modules/sparqlee/dist/lib/aggregators/Count.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Count=void 0;const G=F("../node_modules/sparqlee/dist/lib/functions/Helpers.js"),Q=F("../node_modules/sparqlee/dist/lib/aggregators/BaseAggregator.js");class X extends Q.BaseAggregator{static emptyValue(){return(0,G.integer)(0).toRDF()}init(W){return 1}put(W,Y){return W+1}result(W){return(0,G.integer)(W).toRDF()}}D.Count=X},"../node_modules/sparqlee/dist/lib/aggregators/GroupConcat.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.GroupConcat=void 0;const G=F("../node_modules/sparqlee/dist/lib/functions/Helpers.js"),Q=F("../node_modules/sparqlee/dist/lib/aggregators/BaseAggregator.js");class X extends Q.BaseAggregator{static emptyValue(){return(0,G.string)("").toRDF()}init(W){return W.value}put(W,Y){return W+this.separator+Y.value}result(W){return(0,G.string)(W).toRDF()}}D.GroupConcat=X},"../node_modules/sparqlee/dist/lib/aggregators/Max.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Max=void 0;const G=F("../node_modules/sparqlee/dist/lib/aggregators/BaseAggregator.js");class Q extends G.BaseAggregator{init(q){const{value:W}=this.extractValue(q);return{extremeValue:W,term:q}}put(q,W){const Y=this.extractValue(W);return Y.value>q.extremeValue?{extremeValue:Y.value,term:W}:q}result(q){return q.term}}D.Max=Q},"../node_modules/sparqlee/dist/lib/aggregators/Min.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Min=void 0;const G=F("../node_modules/sparqlee/dist/lib/aggregators/BaseAggregator.js");class Q extends G.BaseAggregator{init(q){const{value:W}=this.extractValue(q);return{extremeValue:W,term:q}}put(q,W){const Y=this.extractValue(W);return Y.value<q.extremeValue?{extremeValue:Y.value,term:W}:q}result(q){return q.term}}D.Min=Q},"../node_modules/sparqlee/dist/lib/aggregators/Sample.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Sample=void 0;const G=F("../node_modules/sparqlee/dist/lib/aggregators/BaseAggregator.js");class Q extends G.BaseAggregator{init(q){return q}put(q,W){return q}result(q){return q}}D.Sample=Q},"../node_modules/sparqlee/dist/lib/aggregators/Sum.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Sum=void 0;const G=F("../node_modules/sparqlee/dist/lib/functions/index.js"),Q=F("../node_modules/sparqlee/dist/lib/functions/Helpers.js"),X=F("../node_modules/sparqlee/dist/lib/util/Consts.js"),q=F("../node_modules/sparqlee/dist/lib/aggregators/BaseAggregator.js");class W extends q.BaseAggregator{constructor(){super(...arguments),this.summer=G.regularFunctions[X.RegularOperator.ADDITION]}static emptyValue(){return(0,Q.integer)(0).toRDF()}init(J){return this.termToNumericOrError(J)}put(J,te){const Z=this.termToNumericOrError(te);return this.summer.apply([J,Z],this.sharedContext)}result(J){return J.toRDF()}}D.Sum=W},"../node_modules/sparqlee/dist/lib/aggregators/index.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.aggregators=void 0;const G=F("../node_modules/sparqlee/dist/lib/aggregators/Average.js"),Q=F("../node_modules/sparqlee/dist/lib/aggregators/Count.js"),X=F("../node_modules/sparqlee/dist/lib/aggregators/GroupConcat.js"),q=F("../node_modules/sparqlee/dist/lib/aggregators/Max.js"),W=F("../node_modules/sparqlee/dist/lib/aggregators/Min.js"),Y=F("../node_modules/sparqlee/dist/lib/aggregators/Sample.js"),J=F("../node_modules/sparqlee/dist/lib/aggregators/Sum.js");D.aggregators={count:Q.Count,sum:J.Sum,min:W.Min,max:q.Max,avg:G.Average,group_concat:X.GroupConcat,sample:Y.Sample}},"../node_modules/sparqlee/dist/lib/evaluators/AggregateEvaluator.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.AggregateEvaluator=void 0;const G=F("../node_modules/sparqlee/dist/lib/evaluators/evaluatorHelpers/BaseAggregateEvaluator.js"),Q=F("../node_modules/sparqlee/dist/lib/evaluators/SyncEvaluator.js");class X extends G.BaseAggregateEvaluator{constructor(W,Y,J){super(W,Q.SyncEvaluator.completeContext(Y||{}),J),this.evaluator=new Q.SyncEvaluator(W.expression,Y)}put(W){this.init(W)}__put(W){try{const Y=this.evaluator.evaluate(W);this.state=this.aggregator.put(this.state,Y)}catch(Y){this.safeThrow(Y)}}safeThrow(W){if(this.throwError)throw W;this.put=()=>{},this.result=()=>{}}init(W){try{const Y=this.evaluator.evaluate(W);this.state=this.aggregator.init(Y),this.state&&(this.put=this.__put.bind(this),this.result=this.__result.bind(this))}catch(Y){this.safeThrow(Y)}}}D.AggregateEvaluator=X},"../node_modules/sparqlee/dist/lib/evaluators/AsyncAggregateEvaluator.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.AsyncAggregateEvaluator=void 0;const G=F("../node_modules/sparqlee/dist/lib/evaluators/AsyncEvaluator.js"),Q=F("../node_modules/sparqlee/dist/lib/evaluators/evaluatorHelpers/BaseAggregateEvaluator.js");class X extends Q.BaseAggregateEvaluator{constructor(W,Y,J){super(W,G.AsyncEvaluator.completeContext(Y||{}),J),this.evaluator=new G.AsyncEvaluator(W.expression,Y),this.errorOccurred=!1}put(W){return this.init(W)}async __put(W){try{const Y=await this.evaluator.evaluate(W);this.state=this.aggregator.put(this.state,Y)}catch(Y){this.safeThrow(Y)}}safeThrow(W){if(this.throwError)throw W;this.put=async()=>{},this.result=()=>{},this.errorOccurred=!0}async init(W){try{const Y=await this.evaluator.evaluate(W);if(!Y||this.errorOccurred)return;if(this.state){this.state=this.aggregator.put(this.state,Y);return}this.state=this.aggregator.init(Y),this.state&&(this.put=this.__put.bind(this),this.result=this.__result.bind(this))}catch(Y){this.safeThrow(Y)}}}D.AsyncAggregateEvaluator=X},"../node_modules/sparqlee/dist/lib/evaluators/AsyncEvaluator.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.AsyncEvaluator=void 0;const G=F("../node_modules/lru-cache/index.js"),Q=F("../node_modules/sparqlee/dist/lib/transformers/AlgebraTransformer.js"),X=F("../node_modules/sparqlee/dist/lib/evaluators/evaluatorHelpers/AsyncRecursiveEvaluator.js");class q{constructor(Y,J={}){this.algExpr=Y;const te=J.extensionFunctionCreator||(()=>{}),Z=q.completeContext(J),ee=new Q.AlgebraTransformer(Object.assign({type:"async",creator:te},Z));this.expr=ee.transformAlgebra(Y),this.evaluator=new X.AsyncRecursiveEvaluator(Z,ee)}static completeContext(Y){return{now:Y.now||new Date(Date.now()),baseIRI:Y.baseIRI||void 0,functionArgumentsCache:Y.functionArgumentsCache||{},superTypeProvider:{cache:Y.typeCache||new G,discoverer:Y.getSuperType||(()=>"term")},extensionFunctionCreator:Y.extensionFunctionCreator,exists:Y.exists,aggregate:Y.aggregate,bnode:Y.bnode}}async evaluate(Y){return(await this.evaluator.evaluate(this.expr,Y)).toRDF()}async evaluateAsEBV(Y){return(await this.evaluator.evaluate(this.expr,Y)).coerceEBV()}async evaluateAsInternal(Y){return await this.evaluator.evaluate(this.expr,Y)}}D.AsyncEvaluator=q},"../node_modules/sparqlee/dist/lib/evaluators/SyncEvaluator.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.SyncEvaluator=void 0;const G=F("../node_modules/lru-cache/index.js"),Q=F("../node_modules/sparqlee/dist/lib/transformers/AlgebraTransformer.js"),X=F("../node_modules/sparqlee/dist/lib/evaluators/evaluatorHelpers/SyncRecursiveEvaluator.js");class q{constructor(Y,J={}){this.algExpr=Y,this.context=J;const te=J.extensionFunctionCreator||(()=>{}),Z=q.completeContext(J),ee=new Q.AlgebraTransformer(Object.assign({type:"sync",creator:te},Z));this.expr=ee.transformAlgebra(Y),this.evaluator=new X.SyncRecursiveEvaluator(Z,ee)}static completeContext(Y){return{now:Y.now||new Date(Date.now()),baseIRI:Y.baseIRI||void 0,functionArgumentsCache:Y.functionArgumentsCache||{},superTypeProvider:{cache:Y.typeCache||new G,discoverer:Y.getSuperType||(()=>"term")},extensionFunctionCreator:Y.extensionFunctionCreator,exists:Y.exists,aggregate:Y.aggregate,bnode:Y.bnode}}evaluate(Y){return this.evaluator.evaluate(this.expr,Y).toRDF()}evaluateAsEBV(Y){return this.evaluator.evaluate(this.expr,Y).coerceEBV()}evaluateAsInternal(Y){return this.evaluator.evaluate(this.expr,Y)}}D.SyncEvaluator=q},"../node_modules/sparqlee/dist/lib/evaluators/evaluatorHelpers/AsyncRecursiveEvaluator.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.AsyncRecursiveEvaluator=void 0;const G=F("../node_modules/sparqlee/dist/lib/expressions/index.js"),Q=F("../node_modules/sparqlee/dist/lib/transformers/TermTransformer.js"),X=F("../node_modules/sparqlee/dist/lib/util/Errors.js"),q=F("../node_modules/sparqlee/dist/lib/evaluators/evaluatorHelpers/BaseExpressionEvaluator.js");class W extends q.BaseExpressionEvaluator{constructor(J,te){super(te||new Q.TermTransformer(J.superTypeProvider)),this.context=J,this.subEvaluators={[G.ExpressionType.Term]:this.term.bind(this),[G.ExpressionType.Variable]:this.variable.bind(this),[G.ExpressionType.Operator]:this.evalOperator.bind(this),[G.ExpressionType.SpecialOperator]:this.evalSpecialOperator.bind(this),[G.ExpressionType.Named]:this.evalNamed.bind(this),[G.ExpressionType.Existence]:this.evalExistence.bind(this),[G.ExpressionType.Aggregate]:this.evalAggregate.bind(this),[G.ExpressionType.AsyncExtension]:this.evalAsyncExtension.bind(this)}}async evaluate(J,te){const Z=this.subEvaluators[J.expressionType];if(!Z)throw new X.InvalidExpressionType(J);return Z.bind(this)(J,te)}async evalOperator(J,te){const Z=J.args.map(re=>this.evaluate(re,te)),ee=await Promise.all(Z);return J.apply(ee)}async evalSpecialOperator(J,te){const Z=this.evaluate.bind(this),ee={args:J.args,mapping:te,superTypeProvider:this.context.superTypeProvider,now:this.context.now,baseIRI:this.context.baseIRI,functionArgumentsCache:this.context.functionArgumentsCache,evaluate:Z,bnode:this.context.bnode};return J.applyAsync(ee)}async _evalAsyncArgs(J,te){const Z=J.map(ee=>this.evaluate(ee,te));return await Promise.all(Z)}async evalNamed(J,te){return J.apply(await this._evalAsyncArgs(J.args,te))}async evalAsyncExtension(J,te){return await J.apply(await this._evalAsyncArgs(J.args,te))}async evalExistence(J,te){if(!this.context.exists)throw new X.NoExistenceHook;return new G.BooleanLiteral(await this.context.exists(J.expression,te))}async evalAggregate(J,te){if(!this.context.aggregate)throw new X.NoAggregator;return this.termTransformer.transformRDFTermUnsafe(await this.context.aggregate(J.expression))}}D.AsyncRecursiveEvaluator=W},"../node_modules/sparqlee/dist/lib/evaluators/evaluatorHelpers/BaseAggregateEvaluator.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.BaseAggregateEvaluator=void 0;const G=F("../node_modules/sparqlee/dist/lib/aggregators/index.js"),Q=F("../node_modules/sparqlee/dist/lib/util/Errors.js");class X{constructor(W,Y,J){this.throwError=!1,this.expression=W,this.aggregator=new G.aggregators[W.aggregator](W,Y),this.throwError=J||!1}static emptyValue(W,Y=!1){const J=G.aggregators[W.aggregator].emptyValue();if(J===void 0&&Y)throw new Q.EmptyAggregateError;return J}result(){return this.aggregator.constructor.emptyValue()}__result(){return this.aggregator.result(this.state)}}D.BaseAggregateEvaluator=X},"../node_modules/sparqlee/dist/lib/evaluators/evaluatorHelpers/BaseExpressionEvaluator.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.BaseExpressionEvaluator=void 0;const G=F("../node_modules/sparqlee/dist/lib/functions/Helpers.js"),Q=F("../node_modules/sparqlee/dist/lib/util/Errors.js");class X{constructor(W){this.termTransformer=W}term(W,Y){return W}variable(W,Y){const J=Y.get((0,G.expressionToVar)(W));if(!J)throw new Q.UnboundVariableError(W.name,Y);return this.termTransformer.transformRDFTermUnsafe(J)}}D.BaseExpressionEvaluator=X},"../node_modules/sparqlee/dist/lib/evaluators/evaluatorHelpers/SyncRecursiveEvaluator.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.SyncRecursiveEvaluator=void 0;const G=F("../node_modules/sparqlee/dist/lib/expressions/index.js"),Q=F("../node_modules/sparqlee/dist/lib/transformers/TermTransformer.js"),X=F("../node_modules/sparqlee/dist/lib/util/Errors.js"),q=F("../node_modules/sparqlee/dist/lib/evaluators/evaluatorHelpers/BaseExpressionEvaluator.js");class W extends q.BaseExpressionEvaluator{constructor(J,te){super(te||new Q.TermTransformer(J.superTypeProvider)),this.context=J,this.subEvaluators={[G.ExpressionType.Term]:this.term.bind(this),[G.ExpressionType.Variable]:this.variable.bind(this),[G.ExpressionType.Operator]:this.evalOperator.bind(this),[G.ExpressionType.SpecialOperator]:this.evalSpecialOperator.bind(this),[G.ExpressionType.Named]:this.evalNamed.bind(this),[G.ExpressionType.Existence]:this.evalExistence.bind(this),[G.ExpressionType.Aggregate]:this.evalAggregate.bind(this),[G.ExpressionType.SyncExtension]:this.evalSyncExtension.bind(this)}}evaluate(J,te){const Z=this.subEvaluators[J.expressionType];if(!Z)throw new X.InvalidExpressionType(J);return Z.bind(this)(J,te)}evalOperator(J,te){const Z=J.args.map(ee=>this.evaluate(ee,te));return J.apply(Z)}evalSpecialOperator(J,te){const Z=this.evaluate.bind(this),ee={args:J.args,mapping:te,superTypeProvider:this.context.superTypeProvider,now:this.context.now,baseIRI:this.context.baseIRI,functionArgumentsCache:this.context.functionArgumentsCache,evaluate:Z,bnode:this.context.bnode};return J.applySync(ee)}evalNamed(J,te){const Z=J.args.map(ee=>this.evaluate(ee,te));return J.apply(Z)}evalSyncExtension(J,te){const Z=J.args.map(ee=>this.evaluate(ee,te));return J.apply(Z)}evalExistence(J,te){if(!this.context.exists)throw new X.NoExistenceHook;return new G.BooleanLiteral(this.context.exists(J.expression,te))}evalAggregate(J,te){if(!this.context.aggregate)throw new X.NoAggregator;return this.termTransformer.transformRDFTermUnsafe(this.context.aggregate(J.expression))}}D.SyncRecursiveEvaluator=W},"../node_modules/sparqlee/dist/lib/expressions/Aggregate.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Aggregate=void 0;const G=F("../node_modules/sparqlee/dist/lib/expressions/Expressions.js");class Q{constructor(q,W){this.name=q,this.expression=W,this.expressionType=G.ExpressionType.Aggregate}}D.Aggregate=Q},"../node_modules/sparqlee/dist/lib/expressions/AsyncExtension.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.AsyncExtension=void 0;const G=F("../node_modules/sparqlee/dist/lib/expressions/Expressions.js");class Q{constructor(q,W,Y){this.name=q,this.args=W,this.apply=Y,this.expressionType=G.ExpressionType.AsyncExtension}}D.AsyncExtension=Q},"../node_modules/sparqlee/dist/lib/expressions/Existence.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Existence=void 0;const G=F("../node_modules/sparqlee/dist/lib/expressions/Expressions.js");class Q{constructor(q){this.expression=q,this.expressionType=G.ExpressionType.Existence}}D.Existence=Q},"../node_modules/sparqlee/dist/lib/expressions/Expressions.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.asTermType=D.ExpressionType=void 0,function(G){G.Aggregate="aggregate",G.Existence="existence",G.Named="named",G.Operator="operator",G.SpecialOperator="specialOperator",G.Term="term",G.Variable="variable",G.AsyncExtension="asyncExtension",G.SyncExtension="syncExtension"}(D.ExpressionType||(D.ExpressionType={}));function F(G){if(G==="namedNode"||G==="literal"||G==="blankNode")return G}D.asTermType=F},"../node_modules/sparqlee/dist/lib/expressions/Named.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Named=void 0;const G=F("../node_modules/sparqlee/dist/lib/expressions/Expressions.js");class Q{constructor(q,W,Y){this.name=q,this.args=W,this.apply=Y,this.expressionType=G.ExpressionType.Named}}D.Named=Q},"../node_modules/sparqlee/dist/lib/expressions/Operator.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Operator=void 0;const G=F("../node_modules/sparqlee/dist/lib/expressions/Expressions.js");class Q{constructor(q,W){this.args=q,this.apply=W,this.expressionType=G.ExpressionType.Operator}}D.Operator=Q},"../node_modules/sparqlee/dist/lib/expressions/SpecialOperator.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.SpecialOperator=void 0;const G=F("../node_modules/sparqlee/dist/lib/expressions/Expressions.js");class Q{constructor(q,W,Y){this.args=q,this.applyAsync=W,this.applySync=Y,this.expressionType=G.ExpressionType.SpecialOperator}}D.SpecialOperator=Q},"../node_modules/sparqlee/dist/lib/expressions/SyncExtension.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.SyncExtension=void 0;const G=F("../node_modules/sparqlee/dist/lib/expressions/Expressions.js");class Q{constructor(q,W,Y){this.name=q,this.args=W,this.apply=Y,this.expressionType=G.ExpressionType.SyncExtension}}D.SyncExtension=Q},"../node_modules/sparqlee/dist/lib/expressions/Term.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.isNonLexicalLiteral=D.NonLexicalLiteral=D.StringLiteral=D.LangStringLiteral=D.DateTimeLiteral=D.BooleanLiteral=D.DoubleLiteral=D.FloatLiteral=D.DecimalLiteral=D.IntegerLiteral=D.NumericLiteral=D.Literal=D.isLiteralTermExpression=D.BlankNode=D.NamedNode=D.Term=void 0;const G=F("../node_modules/rdf-data-factory/index.js"),Q=F("../node_modules/sparqlee/dist/lib/util/Consts.js"),X=F("../node_modules/sparqlee/dist/lib/util/Consts.js"),q=F("../node_modules/sparqlee/dist/lib/util/Errors.js"),W=F("../node_modules/sparqlee/dist/lib/util/TypeHandling.js"),Y=F("../node_modules/sparqlee/dist/lib/expressions/Expressions.js"),J=new G.DataFactory;class te{constructor(){this.expressionType=Y.ExpressionType.Term}str(){throw new q.InvalidArgumentTypes([this],Q.RegularOperator.STR)}coerceEBV(){throw new q.EBVCoercionError(this)}}D.Term=te;class Z extends te{constructor(ye){super(),this.value=ye,this.termType="namedNode"}toRDF(){return J.namedNode(this.value)}str(){return this.value}}D.NamedNode=Z;class ee extends te{constructor(ye){super(),this.termType="blankNode",this.value=typeof ye=="string"?J.blankNode(ye):ye}toRDF(){return this.value}}D.BlankNode=ee;function re(Te){if(Te.termType==="literal")return Te}D.isLiteralTermExpression=re;class ne extends te{constructor(ye,Ee,he,oe){super(),this.typedValue=ye,this.dataType=Ee,this.strValue=he,this.language=oe,this.termType="literal"}toRDF(){return J.literal(this.strValue||this.str(),this.language||J.namedNode(this.dataType))}str(){return this.strValue||this.typedValue.toString()}}D.Literal=ne;class le extends ne{constructor(ye,Ee,he,oe){super(ye,Ee,he,oe),this.typedValue=ye,this.strValue=he,this.language=oe}coerceEBV(){return!!this.typedValue}toRDF(){const ye=super.toRDF();return Number.isFinite(this.typedValue)||(ye.value=ye.value.replace("Infinity","INF")),ye}str(){return this.strValue||this.specificFormatter(this.typedValue)}}D.NumericLiteral=le;class se extends le{constructor(ye,Ee,he,oe){super(ye,Ee||X.TypeURL.XSD_INTEGER,he,oe),this.typedValue=ye,this.strValue=he,this.language=oe}specificFormatter(ye){return ye.toFixed(0)}}D.IntegerLiteral=se;class ie extends le{constructor(ye,Ee,he,oe){super(ye,Ee||X.TypeURL.XSD_DECIMAL,he,oe),this.typedValue=ye,this.strValue=he,this.language=oe}specificFormatter(ye){return ye.toString()}}D.DecimalLiteral=ie;class ge extends le{constructor(ye,Ee,he,oe){super(ye,Ee||X.TypeURL.XSD_FLOAT,he,oe),this.typedValue=ye,this.strValue=he,this.language=oe}specificFormatter(ye){return ye.toString()}}D.FloatLiteral=ge;class fe extends le{constructor(ye,Ee,he,oe){super(ye,Ee||X.TypeURL.XSD_DOUBLE,he,oe),this.typedValue=ye,this.strValue=he,this.language=oe}specificFormatter(ye){if(!Number.isFinite(ye))return ye>0?"INF":ye<0?"-INF":"NaN";const Ee=ye.toExponential(),[he,oe]=Ee.split("e"),me=oe.replace(/\+/u,"");return`${he.includes(".")?he:`${he}.0`}E${me}`}}D.DoubleLiteral=fe;class ae extends ne{constructor(ye,Ee,he){super(ye,he||X.TypeURL.XSD_BOOLEAN,Ee),this.typedValue=ye,this.strValue=Ee}coerceEBV(){return this.typedValue}}D.BooleanLiteral=ae;class ue extends ne{constructor(ye,Ee,he){super(ye,he||X.TypeURL.XSD_DATE_TIME,Ee),this.typedValue=ye,this.strValue=Ee}}D.DateTimeLiteral=ue;class pe extends ne{constructor(ye,Ee,he){super(ye,he||X.TypeURL.RDF_LANG_STRING,ye,Ee),this.typedValue=ye,this.language=Ee}coerceEBV(){return this.str().length>0}}D.LangStringLiteral=pe;class _e extends ne{constructor(ye,Ee){super(ye,Ee||X.TypeURL.XSD_STRING,ye),this.typedValue=ye}coerceEBV(){return this.str().length>0}}D.StringLiteral=_e;class xe extends ne{constructor(ye,Ee,he,oe,me){super({toString:()=>"undefined"},X.TypeAlias.SPARQL_NON_LEXICAL,oe,me),this.typeURL=Ee,this.openWorldType=he}coerceEBV(){if((0,W.isSubTypeOf)(this.typeURL,X.TypeURL.XSD_BOOLEAN,this.openWorldType)||(0,W.isSubTypeOf)(this.typeURL,X.TypeAlias.SPARQL_NUMERIC,this.openWorldType))return!1;throw new q.EBVCoercionError(this)}toRDF(){return J.literal(this.str(),this.language||J.namedNode(this.typeURL))}str(){return this.strValue||""}}D.NonLexicalLiteral=xe;function be(Te){if(Te.dataType===X.TypeAlias.SPARQL_NON_LEXICAL)return Te}D.isNonLexicalLiteral=be},"../node_modules/sparqlee/dist/lib/expressions/Variable.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Variable=void 0;const G=F("../node_modules/sparqlee/dist/lib/expressions/Expressions.js");class Q{constructor(q){this.expressionType=G.ExpressionType.Variable,this.name=q}}D.Variable=Q},"../node_modules/sparqlee/dist/lib/expressions/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W);var J=Object.getOwnPropertyDescriptor(q,W);(!J||("get"in J?!q.__esModule:J.writable||J.configurable))&&(J={enumerable:!0,get:function(){return q[W]}}),Object.defineProperty(X,Y,J)}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/sparqlee/dist/lib/expressions/Expressions.js"),D),Q(F("../node_modules/sparqlee/dist/lib/expressions/Variable.js"),D),Q(F("../node_modules/sparqlee/dist/lib/expressions/Term.js"),D),Q(F("../node_modules/sparqlee/dist/lib/expressions/Operator.js"),D),Q(F("../node_modules/sparqlee/dist/lib/expressions/SpecialOperator.js"),D),Q(F("../node_modules/sparqlee/dist/lib/expressions/Named.js"),D),Q(F("../node_modules/sparqlee/dist/lib/expressions/Aggregate.js"),D),Q(F("../node_modules/sparqlee/dist/lib/expressions/Existence.js"),D),Q(F("../node_modules/sparqlee/dist/lib/expressions/AsyncExtension.js"),D),Q(F("../node_modules/sparqlee/dist/lib/expressions/SyncExtension.js"),D)},"../node_modules/sparqlee/dist/lib/functions/Core.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.SpecialFunction=D.NamedFunction=D.RegularFunction=D.BaseFunction=void 0;const G=F("../node_modules/sparqlee/dist/lib/util/Errors.js");class Q{constructor(te,Z){this.operator=te,this.apply=(ee,re)=>(this.monomorph(ee,re.superTypeProvider,re.functionArgumentsCache)||this.handleInvalidTypes(ee))(re)(ee),this.arity=Z.arity,this.overloads=Z.overloads}monomorph(te,Z,ee){return this.overloads.search(te,Z,ee)}}D.BaseFunction=Q;class X extends Q{constructor(te,Z){super(te,Z),this.functionClass="regular"}handleInvalidTypes(te){throw new G.InvalidArgumentTypes(te,this.operator)}}D.RegularFunction=X;class q extends Q{constructor(te,Z){super(te,Z),this.functionClass="named"}handleInvalidTypes(te){throw new G.InvalidArgumentTypes(te,this.operator)}}D.NamedFunction=q;class W{constructor(te,Z){this.operator=te,this.functionClass="special",this.arity=Z.arity,this.applySync=Z.applySync,this.applyAsync=Z.applyAsync,this.checkArity=Z.checkArity||Y(this.arity)}}D.SpecialFunction=W;function Y(J){return te=>J===Number.POSITIVE_INFINITY?!0:te.length===J}},"../node_modules/sparqlee/dist/lib/functions/Helpers.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.expressionToVar=D.dateTime=D.langString=D.string=D.double=D.float=D.decimal=D.integer=D.bool=D.Builder=D.declare=void 0;const G=F("../node_modules/rdf-data-factory/index.js"),Q=F("../node_modules/sparqlee/dist/lib/expressions/index.js"),X=F("../node_modules/sparqlee/dist/lib/util/Consts.js"),q=F("../node_modules/sparqlee/dist/lib/util/Consts.js"),W=F("../node_modules/sparqlee/dist/lib/util/Errors.js"),Y=F("../node_modules/sparqlee/dist/lib/functions/OverloadTree.js"),J=new G.DataFactory;function te(ue){return new Z(ue)}D.declare=te;class Z{constructor(pe){this.overloadTree=new Y.OverloadTree(pe),this.collected=!1}collect(){if(this.collected)throw new Error("Builders can only be collected once!");return this.collected=!0,this.overloadTree}set(pe,_e){return this.overloadTree.addOverload(pe,_e),this}copy({from:pe,to:_e}){const xe=this.overloadTree.getImplementationExact(pe);if(!xe)throw new W.UnexpectedError("Tried to copy implementation, but types not found",{from:pe,to:_e});return this.set(_e,xe)}onUnary(pe,_e){return this.set([pe],xe=>([be])=>_e(xe)(be))}onUnaryTyped(pe,_e){return this.set([pe],xe=>([be])=>_e(xe)(be.typedValue))}onBinary(pe,_e){return this.set(pe,xe=>([be,Te])=>_e(xe)(be,Te))}onBinaryTyped(pe,_e){return this.set(pe,xe=>([be,Te])=>_e(xe)(be.typedValue,Te.typedValue))}onTernaryTyped(pe,_e){return this.set(pe,xe=>([be,Te,ye])=>_e(xe)(be.typedValue,Te.typedValue,ye.typedValue))}onTernary(pe,_e){return this.set(pe,xe=>([be,Te,ye])=>_e(xe)(be,Te,ye))}onQuaternaryTyped(pe,_e){return this.set(pe,xe=>([be,Te,ye,Ee])=>_e(xe)(be.typedValue,Te.typedValue,ye.typedValue,Ee.typedValue))}onTerm1(pe){return this.set(["term"],_e=>([xe])=>pe(_e)(xe))}onLiteral1(pe){return this.set(["literal"],_e=>([xe])=>pe(_e)(xe))}onBoolean1(pe){return this.set([X.TypeURL.XSD_BOOLEAN],_e=>([xe])=>pe(_e)(xe))}onBoolean1Typed(pe){return this.set([X.TypeURL.XSD_BOOLEAN],_e=>([xe])=>pe(_e)(xe.typedValue))}onString1(pe){return this.set([X.TypeURL.XSD_STRING],_e=>([xe])=>pe(_e)(xe))}onString1Typed(pe){return this.set([X.TypeURL.XSD_STRING],_e=>([xe])=>pe(_e)(xe.typedValue))}onLangString1(pe){return this.set([X.TypeURL.RDF_LANG_STRING],_e=>([xe])=>pe(_e)(xe))}onStringly1(pe){return this.set([X.TypeAlias.SPARQL_STRINGLY],_e=>([xe])=>pe(_e)(xe))}onStringly1Typed(pe){return this.set([X.TypeAlias.SPARQL_STRINGLY],_e=>([xe])=>pe(_e)(xe.typedValue))}onNumeric1(pe){return this.set([X.TypeAlias.SPARQL_NUMERIC],_e=>([xe])=>pe(_e)(xe)).invalidLexicalForm([X.TypeAlias.SPARQL_NON_LEXICAL],1)}onDateTime1(pe){return this.set([X.TypeURL.XSD_DATE_TIME],_e=>([xe])=>pe(_e)(xe)).invalidLexicalForm([X.TypeAlias.SPARQL_NON_LEXICAL],1)}numericConverter(pe){const _e=xe=>be=>pe(xe)(be.typedValue);return this.onBinary([q.TypeURL.XSD_INTEGER],xe=>be=>re(_e(xe)(be))).onBinary([q.TypeURL.XSD_DECIMAL],xe=>be=>ne(_e(xe)(be))).onBinary([q.TypeURL.XSD_FLOAT],xe=>be=>le(_e(xe)(be))).onBinary([q.TypeURL.XSD_DOUBLE],xe=>be=>se(_e(xe)(be))).invalidLexicalForm([X.TypeAlias.SPARQL_NON_LEXICAL],1)}arithmetic(pe){const _e=xe=>(be,Te)=>pe(xe)(be.typedValue,Te.typedValue);return this.onBinary([q.TypeURL.XSD_INTEGER,q.TypeURL.XSD_INTEGER],xe=>(be,Te)=>re(_e(xe)(be,Te))).onBinary([q.TypeURL.XSD_DECIMAL,q.TypeURL.XSD_DECIMAL],xe=>(be,Te)=>ne(_e(xe)(be,Te))).onBinary([q.TypeURL.XSD_FLOAT,q.TypeURL.XSD_FLOAT],xe=>(be,Te)=>le(_e(xe)(be,Te))).onBinary([q.TypeURL.XSD_DOUBLE,q.TypeURL.XSD_DOUBLE],xe=>(be,Te)=>se(_e(xe)(be,Te)))}numberTest(pe){return this.numeric(_e=>([xe,be])=>{const Te=pe(_e)(xe.typedValue,be.typedValue);return ee(Te)})}stringTest(pe){return this.set([X.TypeURL.XSD_STRING,X.TypeURL.XSD_STRING],_e=>([xe,be])=>{const Te=pe(_e)(xe.typedValue,be.typedValue);return ee(Te)}).invalidLexicalForm([X.TypeAlias.SPARQL_NON_LEXICAL,X.TypeURL.XSD_STRING],1).invalidLexicalForm([X.TypeURL.XSD_STRING,X.TypeAlias.SPARQL_NON_LEXICAL],2)}booleanTest(pe){return this.set([X.TypeURL.XSD_BOOLEAN,X.TypeURL.XSD_BOOLEAN],_e=>([xe,be])=>{const Te=pe(_e)(xe.typedValue,be.typedValue);return ee(Te)}).invalidLexicalForm([X.TypeAlias.SPARQL_NON_LEXICAL,X.TypeURL.XSD_BOOLEAN],1).invalidLexicalForm([X.TypeURL.XSD_BOOLEAN,X.TypeAlias.SPARQL_NON_LEXICAL],2)}dateTimeTest(pe){return this.set([X.TypeURL.XSD_DATE_TIME,X.TypeURL.XSD_DATE_TIME],_e=>([xe,be])=>{const Te=pe(_e)(xe.typedValue,be.typedValue);return ee(Te)}).invalidLexicalForm([X.TypeAlias.SPARQL_NON_LEXICAL,X.TypeURL.XSD_DATE_TIME],1).invalidLexicalForm([X.TypeURL.XSD_DATE_TIME,X.TypeAlias.SPARQL_NON_LEXICAL],2)}numeric(pe){return this.set([X.TypeAlias.SPARQL_NUMERIC,X.TypeAlias.SPARQL_NUMERIC],pe).invalidLexicalForm([X.TypeAlias.SPARQL_NUMERIC,X.TypeAlias.SPARQL_NON_LEXICAL],2).invalidLexicalForm([X.TypeAlias.SPARQL_NON_LEXICAL,X.TypeAlias.SPARQL_NUMERIC],1)}invalidLexicalForm(pe,_e){return this.set(pe,()=>xe=>{throw new W.InvalidLexicalForm(xe[_e-1].toRDF())})}}D.Builder=Z;function ee(ue){return new Q.BooleanLiteral(ue)}D.bool=ee;function re(ue){return new Q.IntegerLiteral(ue)}D.integer=re;function ne(ue){return new Q.DecimalLiteral(ue)}D.decimal=ne;function le(ue){return new Q.FloatLiteral(ue)}D.float=le;function se(ue){return new Q.DoubleLiteral(ue)}D.double=se;function ie(ue){return new Q.StringLiteral(ue)}D.string=ie;function ge(ue,pe){return new Q.LangStringLiteral(ue,pe)}D.langString=ge;function fe(ue,pe){return new Q.DateTimeLiteral(ue,pe)}D.dateTime=fe;function ae(ue){return J.variable(ue.name.slice(1))}D.expressionToVar=ae},"../node_modules/sparqlee/dist/lib/functions/NamedFunctions.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.namedDefinitions=void 0;const G=F("../node_modules/sparqlee/dist/lib/util/Consts.js"),Q=F("../node_modules/sparqlee/dist/lib/util/Errors.js"),X=F("../node_modules/sparqlee/dist/lib/util/Parsing.js"),q=F("../node_modules/sparqlee/dist/lib/functions/Helpers.js"),W={arity:1,overloads:(0,q.declare)(G.TypeURL.XSD_STRING).onNumeric1(()=>ne=>(0,q.string)((0,q.float)(ne.typedValue).str())).onBoolean1Typed(()=>ne=>(0,q.string)((0,q.bool)(ne).str())).onTerm1(()=>ne=>(0,q.string)(ne.str())).collect()},Y={arity:1,overloads:(0,q.declare)(G.TypeURL.XSD_FLOAT).onNumeric1(()=>ne=>(0,q.float)(ne.typedValue)).onBoolean1Typed(()=>ne=>(0,q.float)(ne?1:0)).onUnary(G.TypeURL.XSD_STRING,()=>ne=>{const le=(0,X.parseXSDFloat)(ne.str());if(le===void 0)throw new Q.CastError(ne,G.TypeURL.XSD_FLOAT);return(0,q.float)(le)}).copy({from:[G.TypeURL.XSD_STRING],to:[G.TypeAlias.SPARQL_NON_LEXICAL]}).collect()},J={arity:1,overloads:(0,q.declare)(G.TypeURL.XSD_DOUBLE).onNumeric1(()=>ne=>(0,q.double)(ne.typedValue)).onBoolean1Typed(()=>ne=>(0,q.double)(ne?1:0)).onUnary(G.TypeURL.XSD_STRING,()=>ne=>{const le=(0,X.parseXSDFloat)(ne.str());if(le===void 0)throw new Q.CastError(ne,G.TypeURL.XSD_DOUBLE);return(0,q.double)(le)}).copy({from:[G.TypeURL.XSD_STRING],to:[G.TypeAlias.SPARQL_NON_LEXICAL]}).collect()},te={arity:1,overloads:(0,q.declare)(G.TypeURL.XSD_DECIMAL).onNumeric1(()=>ne=>{const le=(0,X.parseXSDDecimal)(ne.str());if(le===void 0)throw new Q.CastError(ne,G.TypeURL.XSD_DECIMAL);return(0,q.decimal)(le)}).onString1(()=>ne=>{const le=ne.str(),se=/^([+-])?(\d+(\.\d+)?)$/u.test(le)?(0,X.parseXSDDecimal)(le):void 0;if(se===void 0)throw new Q.CastError(ne,G.TypeURL.XSD_DECIMAL);return(0,q.decimal)(se)}).copy({from:[G.TypeURL.XSD_STRING],to:[G.TypeAlias.SPARQL_NON_LEXICAL]}).onBoolean1Typed(()=>ne=>(0,q.decimal)(ne?1:0)).collect()},Z={arity:1,overloads:(0,q.declare)(G.TypeURL.XSD_INTEGER).onBoolean1Typed(()=>ne=>(0,q.integer)(ne?1:0)).onNumeric1(()=>ne=>{const le=(0,X.parseXSDInteger)(ne.str());if(le===void 0)throw new Q.CastError(ne,G.TypeURL.XSD_INTEGER);return(0,q.integer)(le)}).onString1(()=>ne=>{const le=ne.str(),se=/^\d+$/u.test(le)?(0,X.parseXSDInteger)(le):void 0;if(se===void 0)throw new Q.CastError(ne,G.TypeURL.XSD_INTEGER);return(0,q.integer)(se)}).copy({from:[G.TypeAlias.SPARQL_NUMERIC],to:[G.TypeAlias.SPARQL_NON_LEXICAL]}).collect()},ee={arity:1,overloads:(0,q.declare)(G.TypeURL.XSD_DATE_TIME).onUnary(G.TypeURL.XSD_DATE_TIME,()=>ne=>ne).onUnary(G.TypeURL.XSD_STRING,()=>ne=>{const le=new Date(ne.str());if(Number.isNaN(le.getTime()))throw new Q.CastError(ne,G.TypeURL.XSD_DATE_TIME);return(0,q.dateTime)(le,ne.str())}).copy({from:[G.TypeURL.XSD_STRING],to:[G.TypeAlias.SPARQL_NON_LEXICAL]}).collect()},re={arity:1,overloads:(0,q.declare)(G.TypeURL.XSD_BOOLEAN).onNumeric1(()=>ne=>(0,q.bool)(ne.coerceEBV())).onUnary(G.TypeURL.XSD_BOOLEAN,()=>ne=>(0,q.bool)(ne.coerceEBV())).onUnary(G.TypeURL.XSD_STRING,()=>ne=>{switch(ne.str()){case"true":return(0,q.bool)(!0);case"false":return(0,q.bool)(!1);case"1":return(0,q.bool)(!0);case"0":return(0,q.bool)(!1);default:throw new Q.CastError(ne,G.TypeURL.XSD_BOOLEAN)}}).copy({from:[G.TypeURL.XSD_STRING],to:[G.TypeAlias.SPARQL_NON_LEXICAL]}).collect()};D.namedDefinitions={[G.TypeURL.XSD_STRING]:W,[G.TypeURL.XSD_FLOAT]:Y,[G.TypeURL.XSD_DOUBLE]:J,[G.TypeURL.XSD_DECIMAL]:te,[G.TypeURL.XSD_INTEGER]:Z,[G.TypeURL.XSD_DATE_TIME]:ee,[G.TypeURL.XSD_DATE]:ee,[G.TypeURL.XSD_BOOLEAN]:re}},"../node_modules/sparqlee/dist/lib/functions/OverloadTree.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.OverloadTree=void 0;const G=F("../node_modules/sparqlee/dist/lib/expressions/index.js"),Q=F("../node_modules/sparqlee/dist/lib/util/Consts.js"),X=F("../node_modules/sparqlee/dist/lib/util/TypeHandling.js"),q=F("../node_modules/sparqlee/dist/lib/functions/Helpers.js");class W{constructor(J,te){this.identifier=J,this.implementation=void 0,this.generalOverloads=Object.create(null),this.literalOverLoads=[],this.depth=te||0,this.promotionCount=void 0}getSubtree(J){const te=(0,X.asGeneralType)(J);if(te)return this.generalOverloads[te];for(const[Z,ee]of this.literalOverLoads)if(J===Z)return ee}getImplementationExact(J){let te=this;for(const Z of J)if(te=te.getSubtree(Z),!te)return;return te.implementation}search(J,te,Z){let ee=Z[this.identifier],re=0;for(;re<J.length&&ee?.cache;){const se=J[re],ie=(0,G.isLiteralTermExpression)(se);ee=ee.cache[ie?ie.dataType:se.termType],re++}if(re===J.length&&ee?.func)return ee.func;const ne=[],le=0;if(J.length===0)return this.implementation;for(ne.push(...this.getSubTreeWithArg(J[le],te).map(se=>({node:se,index:le+1})));ne.length>0;){const{index:se,node:ie}=ne.pop();if(se===J.length&&ie.implementation)return this.addToCache(Z,J,ie.implementation),ie.implementation;ne.push(...ie.getSubTreeWithArg(J[se],te).map(ge=>({node:ge,index:se+1})))}}addToCache(J,te,Z){function ee(ne,le){return le in ne||(ne[le]={}),ne[le]}let re=ee(J,this.identifier);for(const ne of te){const le=(0,G.isLiteralTermExpression)(ne),se=le?le.dataType:ne.termType;re.cache=re.cache||{},re=ee(re.cache,se)}re.func=Z}addOverload(J,te){this._addOverload([...J],te,0)}_addOverload(J,te,Z){const[ee,...re]=J;if(!ee){(this.promotionCount===void 0||Z<=this.promotionCount)&&(this.promotionCount=Z,this.implementation=te);return}let ne=this.getSubtree(ee);if(!ne){const le=new W(this.identifier,this.depth+1),se=(0,X.asGeneralType)(ee);se&&(this.generalOverloads[se]=le);const ie=(0,X.asOverrideType)(ee);ie&&this.literalOverLoads.push([ie,le]),ne=le}ne._addOverload(re,te,Z),ee===Q.TypeURL.XSD_STRING&&this.addPromotedOverload(Q.TypeURL.XSD_ANY_URI,te,le=>(0,q.string)(le.str()),re,Z),ee===Q.TypeURL.XSD_DOUBLE&&(this.addPromotedOverload(Q.TypeURL.XSD_FLOAT,te,le=>(0,q.double)(le.typedValue),re,Z),this.addPromotedOverload(Q.TypeURL.XSD_DECIMAL,te,le=>(0,q.double)(le.typedValue),re,Z)),ee===Q.TypeURL.XSD_FLOAT&&this.addPromotedOverload(Q.TypeURL.XSD_DECIMAL,te,le=>(0,q.float)(le.typedValue),re,Z)}addPromotedOverload(J,te,Z,ee,re){let ne=this.getSubtree(J);if(!ne){const le=new W(this.identifier,this.depth+1);this.literalOverLoads.push([J,le]),ne=le}ne._addOverload(ee,le=>se=>te(le)([...se.slice(0,this.depth),Z(se[this.depth]),...se.slice(this.depth+1,se.length)]),re+1)}getSubTreeWithArg(J,te){const Z=[],ee=(0,G.isLiteralTermExpression)(J);if(this.generalOverloads.term&&Z.push(this.generalOverloads.term),this.generalOverloads[J.termType]&&Z.push(this.generalOverloads[J.termType]),ee){const re=(0,X.asKnownLiteralType)(ee.dataType);let ne;re?ne=X.superTypeDictTable[re]:ne=(0,X.getSuperTypes)(ee.dataType,te);const le=this.literalOverLoads.filter(([se,ie])=>se in ne).map(([se,ie])=>[ne[se],ie]);le.sort(([se,ie],[ge,fe])=>se-ge),Z.push(...le.map(([se,ie])=>ie))}return Z}}D.OverloadTree=W},"../node_modules/sparqlee/dist/lib/functions/RegularFunctions.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.definitions=void 0;const G=F("../node_modules/bignumber.js/bignumber.js"),Q=F("../node_modules/hash.js/lib/hash.js"),X=F("../node_modules/rdf-data-factory/index.js"),q=F("../node_modules/relative-to-absolute-iri/index.js"),W=F("../node_modules/spark-md5/spark-md5.js"),Y=F("../packages/uuid/dist/index.js"),J=F("../node_modules/sparqlee/dist/lib/expressions/index.js"),te=F("../node_modules/sparqlee/dist/lib/transformers/TermTransformer.js"),Z=F("../node_modules/sparqlee/dist/lib/util/Consts.js"),ee=F("../node_modules/sparqlee/dist/lib/util/Consts.js"),re=F("../node_modules/sparqlee/dist/lib/util/Errors.js"),ne=F("../node_modules/sparqlee/dist/lib/util/Parsing.js"),le=F("../node_modules/sparqlee/dist/lib/functions/Helpers.js"),se=F("../node_modules/sparqlee/dist/lib/functions/XPathFunctions.js"),ie=new X.DataFactory,ge={arity:1,overloads:(0,le.declare)(Z.RegularOperator.NOT).onTerm1(()=>tt=>(0,le.bool)(!tt.coerceEBV())).collect()},fe={arity:1,overloads:(0,le.declare)(Z.RegularOperator.UPLUS).numericConverter(()=>tt=>tt).collect()},ae={arity:1,overloads:(0,le.declare)(Z.RegularOperator.UMINUS).numericConverter(()=>tt=>-tt).collect()},ue={arity:2,overloads:(0,le.declare)(Z.RegularOperator.MULTIPLICATION).arithmetic(()=>(tt,ht)=>new G.BigNumber(tt).times(ht).toNumber()).collect()},pe={arity:2,overloads:(0,le.declare)(Z.RegularOperator.DIVISION).arithmetic(()=>(tt,ht)=>new G.BigNumber(tt).div(ht).toNumber()).onBinaryTyped([ee.TypeURL.XSD_INTEGER,ee.TypeURL.XSD_INTEGER],()=>(tt,ht)=>{if(ht===0)throw new re.ExpressionError("Integer division by 0");return(0,le.decimal)(new G.BigNumber(tt).div(ht).toNumber())}).collect()},_e={arity:2,overloads:(0,le.declare)(Z.RegularOperator.ADDITION).arithmetic(()=>(tt,ht)=>new G.BigNumber(tt).plus(ht).toNumber()).collect()},xe={arity:2,overloads:(0,le.declare)(Z.RegularOperator.SUBTRACTION).arithmetic(()=>(tt,ht)=>new G.BigNumber(tt).minus(ht).toNumber()).collect()},be={arity:2,overloads:(0,le.declare)(Z.RegularOperator.EQUAL).numberTest(()=>(tt,ht)=>tt===ht).stringTest(()=>(tt,ht)=>tt.localeCompare(ht)===0).booleanTest(()=>(tt,ht)=>tt===ht).dateTimeTest(()=>(tt,ht)=>tt.getTime()===ht.getTime()).set(["term","term"],()=>([tt,ht])=>(0,le.bool)(Te(tt,ht))).collect()};function Te(tt,ht){const Pt=tt.toRDF(),Ct=ht.toRDF(),kt=Pt.equals(Ct);if(Pt.termType==="Literal"&&Ct.termType==="Literal")throw new re.RDFEqualTypeError([tt,ht]);return kt}const ye={arity:2,overloads:(0,le.declare)(Z.RegularOperator.NOT_EQUAL).numberTest(()=>(tt,ht)=>tt!==ht).stringTest(()=>(tt,ht)=>tt.localeCompare(ht)!==0).booleanTest(()=>(tt,ht)=>tt!==ht).dateTimeTest(()=>(tt,ht)=>tt.getTime()!==ht.getTime()).set(["term","term"],()=>([tt,ht])=>(0,le.bool)(!Te(tt,ht))).collect()},Ee={arity:2,overloads:(0,le.declare)(Z.RegularOperator.LT).numberTest(()=>(tt,ht)=>tt<ht).stringTest(()=>(tt,ht)=>tt.localeCompare(ht)===-1).booleanTest(()=>(tt,ht)=>tt<ht).dateTimeTest(()=>(tt,ht)=>tt.getTime()<ht.getTime()).collect()},he={arity:2,overloads:(0,le.declare)(Z.RegularOperator.GT).numberTest(()=>(tt,ht)=>tt>ht).stringTest(()=>(tt,ht)=>tt.localeCompare(ht)===1).booleanTest(()=>(tt,ht)=>tt>ht).dateTimeTest(()=>(tt,ht)=>tt.getTime()>ht.getTime()).collect()},oe={arity:2,overloads:(0,le.declare)(Z.RegularOperator.LTE).numberTest(()=>(tt,ht)=>tt<=ht).stringTest(()=>(tt,ht)=>tt.localeCompare(ht)!==1).booleanTest(()=>(tt,ht)=>tt<=ht).dateTimeTest(()=>(tt,ht)=>tt.getTime()<=ht.getTime()).collect()},me={arity:2,overloads:(0,le.declare)(Z.RegularOperator.GTE).numberTest(()=>(tt,ht)=>tt>=ht).stringTest(()=>(tt,ht)=>tt.localeCompare(ht)!==-1).booleanTest(()=>(tt,ht)=>tt>=ht).dateTimeTest(()=>(tt,ht)=>tt.getTime()>=ht.getTime()).collect()},ve={arity:1,overloads:(0,le.declare)(Z.RegularOperator.IS_IRI).onTerm1(()=>tt=>(0,le.bool)(tt.termType==="namedNode")).collect()},we={arity:1,overloads:(0,le.declare)(Z.RegularOperator.IS_BLANK).onTerm1(()=>tt=>(0,le.bool)(tt.termType==="blankNode")).collect()},Pe={arity:1,overloads:(0,le.declare)(Z.RegularOperator.IS_LITERAL).onTerm1(()=>tt=>(0,le.bool)(tt.termType==="literal")).collect()},Me={arity:1,overloads:(0,le.declare)(Z.RegularOperator.IS_NUMERIC).onNumeric1(()=>tt=>(0,le.bool)(!0)).onTerm1(()=>tt=>(0,le.bool)(!1)).collect()},De={arity:1,overloads:(0,le.declare)(Z.RegularOperator.STR).onTerm1(()=>tt=>(0,le.string)(tt.str())).collect()},Oe={arity:1,overloads:(0,le.declare)(Z.RegularOperator.LANG).onLiteral1(()=>tt=>(0,le.string)(tt.language||"")).collect()},Ie={arity:1,overloads:(0,le.declare)(Z.RegularOperator.DATATYPE).onLiteral1(()=>tt=>new J.NamedNode(tt.dataType)).collect()},Be={arity:1,overloads:(0,le.declare)(Z.RegularOperator.IRI).set(["namedNode"],tt=>ht=>{const Pt=ht[0],Ct=(0,q.resolve)(Pt.str(),tt.baseIRI||"");return new J.NamedNode(Ct)}).onString1(tt=>ht=>{const Pt=(0,q.resolve)(ht.str(),tt.baseIRI||"");return new J.NamedNode(Pt)}).collect()},ze={arity:2,overloads:(0,le.declare)(Z.RegularOperator.STRDT).set([ee.TypeURL.XSD_STRING,"namedNode"],({superTypeProvider:tt})=>([ht,Pt])=>{const Ct=ie.literal(ht.typedValue,ie.namedNode(Pt.value));return new te.TermTransformer(tt).transformLiteral(Ct)}).collect()},et={arity:2,overloads:(0,le.declare)(Z.RegularOperator.STRLANG).onBinaryTyped([ee.TypeURL.XSD_STRING,ee.TypeURL.XSD_STRING],()=>(tt,ht)=>new J.LangStringLiteral(tt,ht.toLowerCase())).collect()},qe={arity:0,overloads:(0,le.declare)(Z.RegularOperator.UUID).set([],()=>()=>new J.NamedNode(`urn:uuid:${Y.v4()}`)).collect()},je={arity:0,overloads:(0,le.declare)(Z.RegularOperator.STRUUID).set([],()=>()=>(0,le.string)(Y.v4())).collect()},it={arity:1,overloads:(0,le.declare)(Z.RegularOperator.STRLEN).onStringly1(()=>tt=>(0,le.integer)([...tt.typedValue].length)).collect()},ct={arity:[2,3],overloads:(0,le.declare)(Z.RegularOperator.SUBSTR).onBinaryTyped([ee.TypeURL.XSD_STRING,ee.TypeURL.XSD_INTEGER],()=>(tt,ht)=>(0,le.string)([...tt].slice(ht-1).join(""))).onBinary([ee.TypeURL.RDF_LANG_STRING,ee.TypeURL.XSD_INTEGER],()=>(tt,ht)=>{const Pt=[...tt.typedValue].slice(ht.typedValue-1).join("");return(0,le.langString)(Pt,tt.language)}).onTernaryTyped([ee.TypeURL.XSD_STRING,ee.TypeURL.XSD_INTEGER,ee.TypeURL.XSD_INTEGER],()=>(tt,ht,Pt)=>(0,le.string)([...tt].slice(ht-1,Pt+ht-1).join(""))).onTernary([ee.TypeURL.RDF_LANG_STRING,ee.TypeURL.XSD_INTEGER,ee.TypeURL.XSD_INTEGER],()=>(tt,ht,Pt)=>{const Ct=[...tt.typedValue].slice(ht.typedValue-1,Pt.typedValue+ht.typedValue-1).join("");return(0,le.langString)(Ct,tt.language)}).collect()},rt={arity:1,overloads:(0,le.declare)(Z.RegularOperator.UCASE).onString1Typed(()=>tt=>(0,le.string)(tt.toUpperCase())).onLangString1(()=>tt=>(0,le.langString)(tt.typedValue.toUpperCase(),tt.language)).collect()},ut={arity:1,overloads:(0,le.declare)(Z.RegularOperator.LCASE).onString1Typed(()=>tt=>(0,le.string)(tt.toLowerCase())).onLangString1(()=>tt=>(0,le.langString)(tt.typedValue.toLowerCase(),tt.language)).collect()},We={arity:2,overloads:(0,le.declare)(Z.RegularOperator.STRSTARTS).onBinaryTyped([ee.TypeAlias.SPARQL_STRINGLY,ee.TypeURL.XSD_STRING],()=>(tt,ht)=>(0,le.bool)(tt.startsWith(ht))).onBinary([ee.TypeURL.RDF_LANG_STRING,ee.TypeURL.RDF_LANG_STRING],()=>(tt,ht)=>{if(tt.language!==ht.language)throw new re.IncompatibleLanguageOperation(tt,ht);return(0,le.bool)(tt.typedValue.startsWith(ht.typedValue))}).collect()},Re={arity:2,overloads:(0,le.declare)(Z.RegularOperator.STRENDS).onBinaryTyped([ee.TypeAlias.SPARQL_STRINGLY,ee.TypeURL.XSD_STRING],()=>(tt,ht)=>(0,le.bool)(tt.endsWith(ht))).onBinary([ee.TypeURL.RDF_LANG_STRING,ee.TypeURL.RDF_LANG_STRING],()=>(tt,ht)=>{if(tt.language!==ht.language)throw new re.IncompatibleLanguageOperation(tt,ht);return(0,le.bool)(tt.typedValue.endsWith(ht.typedValue))}).collect()},Ue={arity:2,overloads:(0,le.declare)(Z.RegularOperator.CONTAINS).onBinaryTyped([ee.TypeAlias.SPARQL_STRINGLY,ee.TypeURL.XSD_STRING],()=>(tt,ht)=>(0,le.bool)(tt.includes(ht))).onBinary([ee.TypeURL.RDF_LANG_STRING,ee.TypeURL.RDF_LANG_STRING],()=>(tt,ht)=>{if(tt.language!==ht.language)throw new re.IncompatibleLanguageOperation(tt,ht);return(0,le.bool)(tt.typedValue.includes(ht.typedValue))}).collect()},Le={arity:2,overloads:(0,le.declare)(Z.RegularOperator.STRBEFORE).onBinaryTyped([ee.TypeURL.XSD_STRING,ee.TypeURL.XSD_STRING],()=>(tt,ht)=>(0,le.string)(tt.slice(0,Math.max(0,tt.indexOf(ht))))).onBinary([ee.TypeURL.RDF_LANG_STRING,ee.TypeURL.XSD_STRING],()=>(tt,ht)=>{const[Pt,Ct]=[tt.typedValue,ht.typedValue],kt=tt.typedValue.slice(0,Math.max(0,Pt.indexOf(Ct)));return kt||!Ct?(0,le.langString)(kt,tt.language):(0,le.string)(kt)}).onBinary([ee.TypeURL.RDF_LANG_STRING,ee.TypeURL.RDF_LANG_STRING],()=>(tt,ht)=>{if(tt.language!==ht.language)throw new re.IncompatibleLanguageOperation(tt,ht);const[Pt,Ct]=[tt.typedValue,ht.typedValue],kt=tt.typedValue.slice(0,Math.max(0,Pt.indexOf(Ct)));return kt||!Ct?(0,le.langString)(kt,tt.language):(0,le.string)(kt)}).collect()},Ge={arity:2,overloads:(0,le.declare)(Z.RegularOperator.STRAFTER).onBinaryTyped([ee.TypeURL.XSD_STRING,ee.TypeURL.XSD_STRING],()=>(tt,ht)=>(0,le.string)(tt.slice(tt.indexOf(ht)).slice(ht.length))).onBinary([ee.TypeURL.RDF_LANG_STRING,ee.TypeURL.XSD_STRING],()=>(tt,ht)=>{const[Pt,Ct]=[tt.typedValue,ht.typedValue],kt=Pt.slice(Pt.indexOf(Ct)).slice(Ct.length);return kt||!Ct?(0,le.langString)(kt,tt.language):(0,le.string)(kt)}).onBinary([ee.TypeURL.RDF_LANG_STRING,ee.TypeURL.RDF_LANG_STRING],()=>(tt,ht)=>{if(tt.language!==ht.language)throw new re.IncompatibleLanguageOperation(tt,ht);const[Pt,Ct]=[tt.typedValue,ht.typedValue],kt=Pt.slice(Pt.indexOf(Ct)).slice(Ct.length);return kt||!Ct?(0,le.langString)(kt,tt.language):(0,le.string)(kt)}).collect()},ke={arity:1,overloads:(0,le.declare)(Z.RegularOperator.ENCODE_FOR_URI).onStringly1Typed(()=>tt=>(0,le.string)(encodeURI(tt))).collect()},He={arity:2,overloads:(0,le.declare)(Z.RegularOperator.LANG_MATCHES).onBinaryTyped([ee.TypeURL.XSD_STRING,ee.TypeURL.XSD_STRING],()=>(tt,ht)=>(0,le.bool)(se.langMatches(tt,ht))).collect()},Ke=()=>(tt,ht)=>(0,le.bool)(se.matches(tt,ht)),$e=()=>(tt,ht,Pt)=>(0,le.bool)(se.matches(tt,ht,Pt)),Qe={arity:[2,3],overloads:(0,le.declare)(Z.RegularOperator.REGEX).onBinaryTyped([ee.TypeAlias.SPARQL_STRINGLY,ee.TypeURL.XSD_STRING],Ke).onTernaryTyped([ee.TypeAlias.SPARQL_STRINGLY,ee.TypeURL.XSD_STRING,ee.TypeURL.XSD_STRING],$e).collect()},Ne={arity:[3,4],overloads:(0,le.declare)(Z.RegularOperator.REPLACE).onTernaryTyped([ee.TypeURL.XSD_STRING,ee.TypeURL.XSD_STRING,ee.TypeURL.XSD_STRING],()=>(tt,ht,Pt)=>(0,le.string)(se.replace(tt,ht,Pt))).set([ee.TypeURL.RDF_LANG_STRING,ee.TypeURL.XSD_STRING,ee.TypeURL.XSD_STRING],()=>([tt,ht,Pt])=>{const Ct=se.replace(tt.typedValue,ht.typedValue,Pt.typedValue);return(0,le.langString)(Ct,tt.language)}).onQuaternaryTyped([ee.TypeURL.XSD_STRING,ee.TypeURL.XSD_STRING,ee.TypeURL.XSD_STRING,ee.TypeURL.XSD_STRING],()=>(tt,ht,Pt,Ct)=>(0,le.string)(se.replace(tt,ht,Pt,Ct))).set([ee.TypeURL.RDF_LANG_STRING,ee.TypeURL.XSD_STRING,ee.TypeURL.XSD_STRING,ee.TypeURL.XSD_STRING],()=>([tt,ht,Pt,Ct])=>{const kt=se.replace(tt.typedValue,ht.typedValue,Pt.typedValue,Ct.typedValue);return(0,le.langString)(kt,tt.language)}).collect()},Ce={arity:1,overloads:(0,le.declare)(Z.RegularOperator.ABS).numericConverter(()=>tt=>Math.abs(tt)).collect()},Ze={arity:1,overloads:(0,le.declare)(Z.RegularOperator.ROUND).numericConverter(()=>tt=>Math.round(tt)).collect()},at={arity:1,overloads:(0,le.declare)(Z.RegularOperator.CEIL).numericConverter(()=>tt=>Math.ceil(tt)).collect()},st={arity:1,overloads:(0,le.declare)(Z.RegularOperator.FLOOR).numericConverter(()=>tt=>Math.floor(tt)).collect()},Se={arity:0,overloads:(0,le.declare)(Z.RegularOperator.RAND).set([],()=>()=>(0,le.double)(Math.random())).collect()};function ce(tt){return ne.parseXSDDateTime(tt.str())}const de={arity:0,overloads:(0,le.declare)(Z.RegularOperator.NOW).set([],tt=>()=>new J.DateTimeLiteral(tt.now,tt.now.toISOString())).collect()},Ae={arity:1,overloads:(0,le.declare)(Z.RegularOperator.YEAR).onDateTime1(()=>tt=>(0,le.integer)(Number(ce(tt).year))).collect()},Fe={arity:1,overloads:(0,le.declare)(Z.RegularOperator.MONTH).onDateTime1(()=>tt=>(0,le.integer)(Number(ce(tt).month))).collect()},Ve={arity:1,overloads:(0,le.declare)(Z.RegularOperator.DAY).onDateTime1(()=>tt=>(0,le.integer)(Number(ce(tt).day))).collect()},Je={arity:1,overloads:(0,le.declare)(Z.RegularOperator.HOURS).onDateTime1(()=>tt=>(0,le.integer)(Number(ce(tt).hours))).collect()},dt={arity:1,overloads:(0,le.declare)(Z.RegularOperator.MINUTES).onDateTime1(()=>tt=>(0,le.integer)(Number(ce(tt).minutes))).collect()},St={arity:1,overloads:(0,le.declare)(Z.RegularOperator.SECONDS).onDateTime1(()=>tt=>(0,le.decimal)(Number(ce(tt).seconds))).collect()},Tt={arity:1,overloads:(0,le.declare)(Z.RegularOperator.TIMEZONE).onDateTime1(()=>tt=>{const ht=se.formatDayTimeDuration(ce(tt).timezone);if(!ht)throw new re.InvalidTimezoneCall(tt.strValue);return new J.Literal(ht,ee.TypeURL.XSD_DAYTIME_DURATION,ht)}).collect()},At={arity:1,overloads:(0,le.declare)(Z.RegularOperator.TZ).onDateTime1(()=>tt=>(0,le.string)(ce(tt).timezone)).collect()},wt={arity:1,overloads:(0,le.declare)(Z.RegularOperator.MD5).onString1Typed(()=>tt=>(0,le.string)((0,W.hash)(tt))).collect()},ot={arity:1,overloads:(0,le.declare)(Z.RegularOperator.SHA1).onString1Typed(()=>tt=>(0,le.string)((0,Q.sha1)().update(tt).digest("hex"))).collect()},pt={arity:1,overloads:(0,le.declare)(Z.RegularOperator.SHA256).onString1Typed(()=>tt=>(0,le.string)((0,Q.sha256)().update(tt).digest("hex"))).collect()},xt={arity:1,overloads:(0,le.declare)(Z.RegularOperator.SHA384).onString1Typed(()=>tt=>(0,le.string)((0,Q.sha384)().update(tt).digest("hex"))).collect()},Mt={arity:1,overloads:(0,le.declare)(Z.RegularOperator.SHA512).onString1Typed(()=>tt=>(0,le.string)((0,Q.sha512)().update(tt).digest("hex"))).collect()};D.definitions={"!":ge,uplus:fe,uminus:ae,"*":ue,"/":pe,"+":_e,"-":xe,"=":be,"!=":ye,"<":Ee,">":he,"<=":oe,">=":me,isiri:ve,isuri:ve,isblank:we,isliteral:Pe,isnumeric:Me,str:De,lang:Oe,datatype:Ie,iri:Be,uri:Be,strdt:ze,strlang:et,uuid:qe,struuid:je,strlen:it,substr:ct,ucase:rt,lcase:ut,strstarts:We,strends:Re,contains:Ue,strbefore:Le,strafter:Ge,encode_for_uri:ke,langmatches:He,regex:Qe,replace:Ne,abs:Ce,round:Ze,ceil:at,floor:st,rand:Se,now:de,year:Ae,month:Fe,day:Ve,hours:Je,minutes:dt,seconds:St,timezone:Tt,tz:At,md5:wt,sha1:ot,sha256:pt,sha384:xt,sha512:Mt}},"../node_modules/sparqlee/dist/lib/functions/SpecialFunctions.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.specialDefinitions=void 0;const G=F("../packages/uuid/dist/index.js"),Q=F("../node_modules/sparqlee/dist/lib/expressions/index.js"),X=F("../node_modules/sparqlee/dist/lib/util/Consts.js"),q=F("../node_modules/sparqlee/dist/lib/util/Errors.js"),W=F("../node_modules/sparqlee/dist/lib/functions/Helpers.js"),Y=F("../node_modules/sparqlee/dist/lib/functions/index.js"),J={arity:1,async applyAsync({args:Te,mapping:ye}){return te({args:Te,mapping:ye})},applySync({args:Te,mapping:ye}){return te({args:Te,mapping:ye})}};function te({args:Te,mapping:ye}){const Ee=Te[0];if(Ee.expressionType!==Q.ExpressionType.Variable)throw new q.InvalidArgumentTypes(Te,X.SpecialOperator.BOUND);const he=ye.has((0,W.expressionToVar)(Ee));return(0,W.bool)(he)}const Z={arity:3,async applyAsync({args:Te,mapping:ye,evaluate:Ee}){const oe=(await Ee(Te[0],ye)).coerceEBV();return Ee(oe?Te[1]:Te[2],ye)},applySync({args:Te,mapping:ye,evaluate:Ee}){const oe=Ee(Te[0],ye).coerceEBV();return Ee(oe?Te[1]:Te[2],ye)}},ee={arity:Number.POSITIVE_INFINITY,async applyAsync({args:Te,mapping:ye,evaluate:Ee}){const he=[];for(const oe of Te)try{return await Ee(oe,ye)}catch(me){he.push(me)}throw new q.CoalesceError(he)},applySync({args:Te,mapping:ye,evaluate:Ee}){const he=[];for(const oe of Te)try{return Ee(oe,ye)}catch(me){he.push(me)}throw new q.CoalesceError(he)}},re={arity:2,async applyAsync({args:Te,mapping:ye,evaluate:Ee}){const[he,oe]=Te;try{if((await Ee(he,ye)).coerceEBV())return(0,W.bool)(!0);const Pe=(await Ee(oe,ye)).coerceEBV();return(0,W.bool)(Pe)}catch(me){if(!(await Ee(oe,ye)).coerceEBV())throw me;return(0,W.bool)(!0)}},applySync({args:Te,mapping:ye,evaluate:Ee}){const[he,oe]=Te;try{if(Ee(he,ye).coerceEBV())return(0,W.bool)(!0);const Pe=Ee(oe,ye).coerceEBV();return(0,W.bool)(Pe)}catch(me){if(!Ee(oe,ye).coerceEBV())throw me;return(0,W.bool)(!0)}}},ne={arity:2,async applyAsync({args:Te,mapping:ye,evaluate:Ee}){const[he,oe]=Te;try{if(!(await Ee(he,ye)).coerceEBV())return(0,W.bool)(!1);const Pe=(await Ee(oe,ye)).coerceEBV();return(0,W.bool)(Pe)}catch(me){if((await Ee(oe,ye)).coerceEBV())throw me;return(0,W.bool)(!1)}},applySync({args:Te,mapping:ye,evaluate:Ee}){const[he,oe]=Te;try{if(!Ee(he,ye).coerceEBV())return(0,W.bool)(!1);const Pe=Ee(oe,ye).coerceEBV();return(0,W.bool)(Pe)}catch(me){if(Ee(oe,ye).coerceEBV())throw me;return(0,W.bool)(!1)}}},le={arity:2,async applyAsync({args:Te,mapping:ye,evaluate:Ee}){const[he,oe]=Te.map(we=>Ee(we,ye)),[me,ve]=await Promise.all([he,oe]);return(0,W.bool)(me.toRDF().equals(ve.toRDF()))},applySync({args:Te,mapping:ye,evaluate:Ee}){const[he,oe]=Te.map(me=>Ee(me,ye));return(0,W.bool)(he.toRDF().equals(oe.toRDF()))}},se={arity:Number.POSITIVE_INFINITY,checkArity(Te){return Te.length>0},async applyAsync(Te){const{args:ye,mapping:Ee,evaluate:he}=Te,[oe,...me]=ye,ve=await he(oe,Ee);return ie(ve,Object.assign(Object.assign({},Te),{args:me}),[])},applySync(Te){const{args:ye,mapping:Ee,evaluate:he}=Te,[oe,...me]=ye,ve=he(oe,Ee);return ge(ve,Object.assign(Object.assign({},Te),{args:me}),[])}};async function ie(Te,ye,Ee){const{args:he,mapping:oe,evaluate:me}=ye;if(he.length===0)return Ee.every(we=>!we)?(0,W.bool)(!1):Promise.reject(new q.InError(Ee));try{const ve=he.shift(),we=await me(ve,oe);return Y.regularFunctions[X.RegularOperator.EQUAL].apply([Te,we],ye).typedValue?(0,W.bool)(!0):ie(Te,ye,[...Ee,!1])}catch(ve){return ie(Te,ye,[...Ee,ve])}}function ge(Te,ye,Ee){const{args:he,mapping:oe,evaluate:me}=ye;if(he.length===0){if(Ee.every(we=>!we))return(0,W.bool)(!1);throw new q.InError(Ee)}try{const ve=he.shift(),we=me(ve,oe);return Y.regularFunctions[X.RegularOperator.EQUAL].apply([Te,we],ye).typedValue?(0,W.bool)(!0):ge(Te,ye,[...Ee,!1])}catch(ve){return ge(Te,ye,[...Ee,ve])}}const fe={arity:Number.POSITIVE_INFINITY,checkArity(Te){return Te.length>0},async applyAsync(Te){const Ee=await Y.specialFunctions[X.SpecialOperator.IN].applyAsync(Te);return(0,W.bool)(!Ee.typedValue)},applySync(Te){const Ee=Y.specialFunctions[X.SpecialOperator.IN].applySync(Te);return(0,W.bool)(!Ee.typedValue)}},ae=(0,W.declare)(X.SpecialOperator.CONCAT).onStringly1(()=>Te=>Te).collect(),ue={arity:Number.POSITIVE_INFINITY,async applyAsync(Te){const{args:ye,mapping:Ee,evaluate:he,functionArgumentsCache:oe,superTypeProvider:me}=Te,ve=ye.map(async Oe=>he(Oe,Ee)).map(async Oe=>{const Ie=ae.search([await Oe],me,oe);if(!Ie)throw new q.InvalidArgumentTypes(ye,X.SpecialOperator.CONCAT);return Ie(Te)([await Oe])}),we=await Promise.all(ve),Me=we.map(Oe=>Oe.typedValue).join(""),De=pe(we)?we[0].language:void 0;return De?(0,W.langString)(Me,De):(0,W.string)(Me)},applySync(Te){const{args:ye,mapping:Ee,evaluate:he,superTypeProvider:oe,functionArgumentsCache:me}=Te,ve=ye.map(De=>he(De,Ee)).map(De=>{const Oe=ae.search([De],oe,me);if(!Oe)throw new q.InvalidArgumentTypes(ye,X.SpecialOperator.CONCAT);return Oe(Te)([De])}),Pe=ve.map(De=>De.typedValue).join(""),Me=pe(ve)?ve[0].language:void 0;return Me?(0,W.langString)(Pe,Me):(0,W.string)(Pe)}};function pe(Te){return Te.length>0&&Te.every(ye=>ye.language===Te[0].language)}const _e=(0,W.declare)(X.SpecialOperator.BNODE).onString1(()=>Te=>Te).collect(),xe={arity:Number.POSITIVE_INFINITY,checkArity(Te){return Te.length===0||Te.length===1},async applyAsync(Te){const{args:ye,mapping:Ee,evaluate:he,superTypeProvider:oe,functionArgumentsCache:me}=Te,ve=ye.length===1?await he(ye[0],Ee):void 0;let we;if(ve){const Pe=_e.search([ve],oe,me);if(!Pe)throw new q.InvalidArgumentTypes(ye,X.SpecialOperator.BNODE);we=Pe(Te)([ve]).str()}if(Te.bnode){const Pe=await Te.bnode(we);return new Q.BlankNode(Pe)}return be(we)},applySync(Te){const{args:ye,mapping:Ee,evaluate:he,superTypeProvider:oe,functionArgumentsCache:me}=Te,ve=ye.length===1?he(ye[0],Ee):void 0;let we;if(ve){const Pe=_e.search([ve],oe,me);if(!Pe)throw new q.InvalidArgumentTypes(ye,X.SpecialOperator.BNODE);we=Pe(Te)([ve]).str()}if(Te.bnode){const Pe=Te.bnode(we);return new Q.BlankNode(Pe)}return be(we)}};function be(Te){return new Q.BlankNode(Te||G.v4())}D.specialDefinitions={bound:J,if:Z,coalesce:ee,"&&":ne,"||":re,sameterm:le,in:se,notin:fe,concat:ue,bnode:xe}},"../node_modules/sparqlee/dist/lib/functions/XPathFunctions.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.formatDayTimeDuration=D.langMatches=D.replace=D.matches=void 0;function F(Y,J,te){return new RegExp(J,te).test(Y)}D.matches=F;function G(Y,J,te,Z){let ee=new RegExp(J,Z);if(!ee.global){const re=Z||"";ee=new RegExp(J,`${re}g`)}return Y.replace(ee,te)}D.replace=G;function Q(Y,J){const te=Y.split("-"),Z=J.split("-");if(!q(Z[0],te[0])&&!X(te[0]))return!1;let ee=1,re=1;for(;re<Z.length;){if(X(Z[re])){re++;continue}if(ee===te.length)return!1;if(q(Z[re],te[ee])){ee++,re++;continue}if(te[ee].length===1)return!1;ee++}return!0}D.langMatches=Q;function X(Y){return Y==="*"}function q(Y,J){return new RegExp(`/${Y}/`,"iu").test(`/${J}/`)}function W(Y){if(!Y)return;let J="",te=0,Z=0;if(Y!=="Z"&&(J=Y.startsWith("-")?"-":"",te=Number.parseInt(Y.slice(1,3),10),Z=Number.parseInt(Y.slice(4,6),10)),te===0&&Z===0)return"PT0S";let ee=`${J}PT`;return te>0&&(ee+=`${te}H`),Z>0&&(ee+=`${Z}M`),ee}D.formatDayTimeDuration=W},"../node_modules/sparqlee/dist/lib/functions/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(te,Z,ee,re){re===void 0&&(re=ee);var ne=Object.getOwnPropertyDescriptor(Z,ee);(!ne||("get"in ne?!Z.__esModule:ne.writable||ne.configurable))&&(ne={enumerable:!0,get:function(){return Z[ee]}}),Object.defineProperty(te,re,ne)}:function(te,Z,ee,re){re===void 0&&(re=ee),te[re]=Z[ee]}),Q=this&&this.__exportStar||function(te,Z){for(var ee in te)ee!=="default"&&!Object.prototype.hasOwnProperty.call(Z,ee)&&G(Z,te,ee)};Object.defineProperty(D,"__esModule",{value:!0}),D.OverloadTree=D.namedFunctions=D.specialFunctions=D.regularFunctions=void 0;const X=F("../node_modules/sparqlee/dist/lib/functions/Core.js"),q=F("../node_modules/sparqlee/dist/lib/functions/NamedFunctions.js"),W=F("../node_modules/sparqlee/dist/lib/functions/RegularFunctions.js"),Y=F("../node_modules/sparqlee/dist/lib/functions/SpecialFunctions.js");Q(F("../node_modules/sparqlee/dist/lib/functions/Core.js"),D),D.regularFunctions=Object.fromEntries(Object.entries(W.definitions).map(([te,Z])=>[te,new X.RegularFunction(te,Z)])),D.specialFunctions=Object.fromEntries(Object.entries(Y.specialDefinitions).map(([te,Z])=>[te,new X.SpecialFunction(te,Z)])),D.namedFunctions=Object.fromEntries(Object.entries(q.namedDefinitions).map(([te,Z])=>[te,new X.NamedFunction(te,Z)]));var J=F("../node_modules/sparqlee/dist/lib/functions/OverloadTree.js");Object.defineProperty(D,"OverloadTree",{enumerable:!0,get:function(){return J.OverloadTree}})},"../node_modules/sparqlee/dist/lib/transformers/AlgebraTransformer.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.AlgebraTransformer=void 0;const G=F("sparqlalgebrajs"),Q=F("../node_modules/sparqlee/dist/lib/expressions/index.js"),X=F("../node_modules/sparqlee/dist/lib/functions/index.js"),q=F("../node_modules/sparqlee/dist/lib/util/Consts.js"),W=F("../node_modules/sparqlee/dist/lib/util/Errors.js"),Y=F("../node_modules/sparqlee/dist/lib/util/Errors.js"),J=F("../node_modules/sparqlee/dist/lib/transformers/TermTransformer.js");class te extends J.TermTransformer{constructor(ee){super(ee.superTypeProvider),this.algebraConfig=ee,this.creatorConfig={type:ee.type,creator:ee.creator}}transformAlgebra(ee){const re=G.Algebra.expressionTypes;switch(ee.expressionType){case re.TERM:return this.transformTerm(ee);case re.OPERATOR:return this.transformOperator(ee);case re.NAMED:return this.transformNamed(ee);case re.EXISTENCE:return te.transformExistence(ee);case re.AGGREGATE:return te.transformAggregate(ee);case re.WILDCARD:return te.transformWildcard(ee)}}static transformWildcard(ee){return new Q.NamedNode(ee.wildcard.value)}transformOperator(ee){const re=ee.operator.toLowerCase();if(q.SpecialOperators.has(re)){const ie=re,ge=ee.args.map(ae=>this.transformAlgebra(ae)),fe=X.specialFunctions[ie];if(!fe.checkArity(ge))throw new W.InvalidArity(ge,ie);return new Q.SpecialOperator(ge,fe.applyAsync,fe.applySync)}if(!q.Operators.has(re))throw new W.UnknownOperator(ee.operator);const ne=re,le=ee.args.map(ie=>this.transformAlgebra(ie)),se=X.regularFunctions[ne];if(!te.hasCorrectArity(le,se.arity))throw new W.InvalidArity(le,ne);return new Q.Operator(le,ie=>se.apply(ie,this.algebraConfig))}wrapSyncFunction(ee,re){return ne=>{try{const le=ee(ne.map(se=>se.toRDF()));return this.transformRDFTermUnsafe(le)}catch(le){throw new Y.ExtensionFunctionError(re,le)}}}wrapAsyncFunction(ee,re){return async ne=>{try{const le=await ee(ne.map(se=>se.toRDF()));return this.transformRDFTermUnsafe(le)}catch(le){throw new Y.ExtensionFunctionError(re,le)}}}transformNamed(ee){const re=ee.name.value,ne=ee.args.map(le=>this.transformAlgebra(le));if(q.NamedOperators.has(re)){const le=ee.name.value,se=X.namedFunctions[le];return new Q.Named(ee.name,ne,ie=>se.apply(ie,this.algebraConfig))}if(this.creatorConfig.type==="sync"){const le=this.creatorConfig.creator(ee.name);if(le){const se=this.wrapSyncFunction(le,ee.name.value);return new Q.SyncExtension(ee.name,ne,se)}}else{const le=this.creatorConfig.creator(ee.name);if(le){const se=this.wrapAsyncFunction(le,ee.name.value);return new Q.AsyncExtension(ee.name,ne,se)}}throw new W.UnknownNamedOperator(ee.name.value)}static hasCorrectArity(ee,re){return Array.isArray(re)?re.includes(ee.length):ee.length===re}static transformAggregate(ee){const re=ee.aggregator;return new Q.Aggregate(re,ee)}static transformExistence(ee){return new Q.Existence(ee)}}D.AlgebraTransformer=te},"../node_modules/sparqlee/dist/lib/transformers/TermTransformer.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.TermTransformer=void 0;const G=F("../node_modules/rdf-string/index.js"),Q=F("sparqlalgebrajs"),X=F("../node_modules/sparqlee/dist/lib/expressions/index.js"),q=F("../node_modules/sparqlee/dist/lib/util/Consts.js"),W=F("../node_modules/sparqlee/dist/lib/util/Errors.js"),Y=F("../node_modules/sparqlee/dist/lib/util/Parsing.js"),J=F("../node_modules/sparqlee/dist/lib/util/TypeHandling.js");class te{constructor(ee){this.superTypeProvider=ee}transformRDFTermUnsafe(ee){return this.transformTerm({term:ee,type:Q.Algebra.types.EXPRESSION,expressionType:Q.Algebra.expressionTypes.TERM})}transformTerm(ee){if(!ee.term)throw new W.InvalidExpression(ee);switch(ee.term.termType){case"Variable":return new X.Variable(G.termToString(ee.term));case"Literal":return this.transformLiteral(ee.term);case"NamedNode":return new X.NamedNode(ee.term.value);case"BlankNode":return new X.BlankNode(ee.term.value);default:throw new W.InvalidTermType(ee)}}transformLiteral(ee){if(!ee.datatype||[null,void 0,""].includes(ee.datatype.value))return ee.language?new X.LangStringLiteral(ee.value,ee.language):new X.StringLiteral(ee.value);const re=ee.datatype.value,ne=(0,J.getSuperTypeDict)(re,this.superTypeProvider);if(q.TypeURL.XSD_STRING in ne)return new X.StringLiteral(ee.value,re);if(q.TypeURL.RDF_LANG_STRING in ne)return new X.LangStringLiteral(ee.value,ee.language);if(q.TypeURL.XSD_DATE_TIME in ne){const ie=new Date(ee.value);return Number.isNaN(ie.getTime())?new X.NonLexicalLiteral(void 0,re,this.superTypeProvider,ee.value):new X.DateTimeLiteral(new Date(ee.value),ee.value,re)}if(q.TypeURL.XSD_BOOLEAN in ne)return ee.value!=="true"&&ee.value!=="false"&&ee.value!=="1"&&ee.value!=="0"?new X.NonLexicalLiteral(void 0,re,this.superTypeProvider,ee.value):new X.BooleanLiteral(ee.value==="true"||ee.value==="1",ee.value);if(q.TypeURL.XSD_DECIMAL in ne){const ie=Y.parseXSDDecimal(ee.value);return ie===void 0?new X.NonLexicalLiteral(void 0,re,this.superTypeProvider,ee.value):q.TypeURL.XSD_INTEGER in ne?new X.IntegerLiteral(ie,re,ee.value):new X.DecimalLiteral(ie,re,ee.value)}const le=q.TypeURL.XSD_FLOAT in ne,se=q.TypeURL.XSD_DOUBLE in ne;if(le||se){const ie=Y.parseXSDFloat(ee.value);return ie===void 0?new X.NonLexicalLiteral(void 0,re,this.superTypeProvider,ee.value):le?new X.FloatLiteral(ie,re,ee.value):new X.DoubleLiteral(ie,re,ee.value)}return new X.Literal(ee.value,re,ee.value)}}D.TermTransformer=te},"../node_modules/sparqlee/dist/lib/util/Consts.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.NamedOperators=D.SetFunctions=D.SetFunction=D.Operators=D.SpecialOperators=D.RegularOperators=D.SpecialOperator=D.RegularOperator=D.TypeURL=D.TypeAlias=void 0,function(q){q.SPARQL_NUMERIC="SPARQL_NUMERIC",q.SPARQL_STRINGLY="SPARQL_STRINGLY",q.SPARQL_NON_LEXICAL="SPARQL_NON_LEXICAL"}(D.TypeAlias||(D.TypeAlias={}));var F;(function(q){q.XSD_ANY_URI="http://www.w3.org/2001/XMLSchema#anyURI",q.XSD_STRING="http://www.w3.org/2001/XMLSchema#string",q.RDF_LANG_STRING="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",q.XSD_BOOLEAN="http://www.w3.org/2001/XMLSchema#boolean",q.XSD_DATE_TIME="http://www.w3.org/2001/XMLSchema#dateTime",q.XSD_DATE_TIME_STAMP="http://www.w3.org/2001/XMLSchema#dateTimeStamp",q.XSD_DATE="http://www.w3.org/2001/XMLSchema#date",q.XSD_DECIMAL="http://www.w3.org/2001/XMLSchema#decimal",q.XSD_FLOAT="http://www.w3.org/2001/XMLSchema#float",q.XSD_DOUBLE="http://www.w3.org/2001/XMLSchema#double",q.XSD_INTEGER="http://www.w3.org/2001/XMLSchema#integer",q.XSD_NON_POSITIVE_INTEGER="http://www.w3.org/2001/XMLSchema#nonPositiveInteger",q.XSD_NEGATIVE_INTEGER="http://www.w3.org/2001/XMLSchema#negativeInteger",q.XSD_LONG="http://www.w3.org/2001/XMLSchema#long",q.XSD_INT="http://www.w3.org/2001/XMLSchema#int",q.XSD_SHORT="http://www.w3.org/2001/XMLSchema#short",q.XSD_BYTE="http://www.w3.org/2001/XMLSchema#byte",q.XSD_NON_NEGATIVE_INTEGER="http://www.w3.org/2001/XMLSchema#nonNegativeInteger",q.XSD_POSITIVE_INTEGER="http://www.w3.org/2001/XMLSchema#positiveInteger",q.XSD_UNSIGNED_LONG="http://www.w3.org/2001/XMLSchema#unsignedLong",q.XSD_UNSIGNED_INT="http://www.w3.org/2001/XMLSchema#unsignedInt",q.XSD_UNSIGNED_SHORT="http://www.w3.org/2001/XMLSchema#unsignedShort",q.XSD_UNSIGNED_BYTE="http://www.w3.org/2001/XMLSchema#unsignedByte",q.XSD_NORMALIZED_STRING="http://www.w3.org/2001/XMLSchema#normalizedString",q.XSD_TOKEN="http://www.w3.org/2001/XMLSchema#token",q.XSD_LANGUAGE="http://www.w3.org/2001/XMLSchema#language",q.XSD_NM_TOKEN="http://www.w3.org/2001/XMLSchema#NMTOKEN",q.XSD_NAME="http://www.w3.org/2001/XMLSchema#name",q.XSD_NC_NAME="http://www.w3.org/2001/XMLSchema#NCName",q.XSD_ENTITY="http://www.w3.org/2001/XMLSchema#ENTITY",q.XSD_ID="http://www.w3.org/2001/XMLSchema#ID",q.XSD_ID_REF="http://www.w3.org/2001/XMLSchema#IDREF",q.XSD_DURATION="http://www.w3.org/2001/XMLSchema#duration",q.XSD_YEAR_MONTH_DURATION="http://www.w3.org/2001/XMLSchema#yearMonthDuration",q.XSD_DAYTIME_DURATION="http://www.w3.org/2001/XMLSchema#dayTimeDuration"})(F=D.TypeURL||(D.TypeURL={}));var G;(function(q){q.NOT="!",q.UMINUS="uminus",q.UPLUS="uplus",q.EQUAL="=",q.NOT_EQUAL="!=",q.LT="<",q.GT=">",q.LTE="<=",q.GTE=">=",q.MULTIPLICATION="*",q.DIVISION="/",q.ADDITION="+",q.SUBTRACTION="-",q.IS_IRI="isiri",q.IS_URI="isuri",q.IS_BLANK="isblank",q.IS_LITERAL="isliteral",q.IS_NUMERIC="isnumeric",q.STR="str",q.LANG="lang",q.DATATYPE="datatype",q.IRI="iri",q.URI="uri",q.STRDT="strdt",q.STRLANG="strlang",q.UUID="uuid",q.STRUUID="struuid",q.STRLEN="strlen",q.SUBSTR="substr",q.UCASE="ucase",q.LCASE="lcase",q.STRSTARTS="strstarts",q.STRENDS="strends",q.CONTAINS="contains",q.STRBEFORE="strbefore",q.STRAFTER="strafter",q.ENCODE_FOR_URI="encode_for_uri",q.LANG_MATCHES="langmatches",q.REGEX="regex",q.REPLACE="replace",q.ABS="abs",q.ROUND="round",q.CEIL="ceil",q.FLOOR="floor",q.RAND="rand",q.NOW="now",q.YEAR="year",q.MONTH="month",q.DAY="day",q.HOURS="hours",q.MINUTES="minutes",q.SECONDS="seconds",q.TIMEZONE="timezone",q.TZ="tz",q.MD5="md5",q.SHA1="sha1",q.SHA256="sha256",q.SHA384="sha384",q.SHA512="sha512"})(G=D.RegularOperator||(D.RegularOperator={}));var Q;(function(q){q.BOUND="bound",q.IF="if",q.COALESCE="coalesce",q.LOGICAL_OR="||",q.LOGICAL_AND="&&",q.SAME_TERM="sameterm",q.IN="in",q.NOT_IN="notin",q.CONCAT="concat",q.BNODE="bnode"})(Q=D.SpecialOperator||(D.SpecialOperator={})),D.RegularOperators=new Set(Object.values(G)),D.SpecialOperators=new Set(Object.values(Q)),D.Operators=new Set([...D.RegularOperators,...D.SpecialOperators]);var X;(function(q){q.COUNT="count",q.SUM="sum",q.MIN="min",q.MAX="max",q.AVG="avg",q.GROUP_CONCAT="group_concat",q.SAMPLE="sample"})(X=D.SetFunction||(D.SetFunction={})),D.SetFunctions=new Set(Object.values(X)),D.NamedOperators=new Set([F.XSD_STRING,F.XSD_FLOAT,F.XSD_DOUBLE,F.XSD_DECIMAL,F.XSD_INTEGER,F.XSD_DATE_TIME,F.XSD_DATE,F.XSD_BOOLEAN])},"../node_modules/sparqlee/dist/lib/util/Errors.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.NoExistenceHook=D.NoAggregator=D.ExtensionFunctionError=D.UnknownNamedOperator=D.UnknownOperator=D.InvalidTermType=D.InvalidExpressionType=D.InvalidExpression=D.InvalidArity=D.UnexpectedError=D.EmptyAggregateError=D.IncompatibleLanguageOperation=D.InvalidTimezoneCall=D.CastError=D.InvalidArgumentTypes=D.InError=D.CoalesceError=D.RDFEqualTypeError=D.EBVCoercionError=D.UnboundVariableError=D.InvalidLexicalForm=D.isExpressionError=D.ExpressionError=void 0;class F extends Error{}D.ExpressionError=F;function G(Te){return Te instanceof F}D.isExpressionError=G;class Q extends F{constructor(ye){super(`Invalid lexical form '${be(ye)}'`),this.arg=ye}}D.InvalidLexicalForm=Q;class X extends F{constructor(ye,Ee){super(`Unbound variable '${be(ye)}'`),this.variable=ye,this.bindings=Ee}}D.UnboundVariableError=X;class q extends F{constructor(ye){super(`Cannot coerce term to EBV '${be(ye)}'`),this.arg=ye}}D.EBVCoercionError=q;class W extends F{constructor(ye){super("Equality test for literals with unsupported datatypes"),this.args=ye}}D.RDFEqualTypeError=W;class Y extends F{constructor(ye){super("All COALESCE arguments threw errors"),this.errors=ye}}D.CoalesceError=Y;class J extends F{constructor(ye){super(`Some argument to IN errorred and none where equal. ${ye.map(Ee=>`(${Ee.toString()}) `).join("and ")}`),this.errors=ye}}D.InError=J;class te extends F{constructor(ye,Ee){super(`Argument types not valid for operator: '${be(Ee)}' with '${be(ye)}`),this.args=ye,this.op=Ee}}D.InvalidArgumentTypes=te;class Z extends F{constructor(ye,Ee){super(`Invalid cast: '${be(ye)}' to '${be(Ee)}'`),this.arg=ye}}D.CastError=Z;class ee extends F{constructor(ye){super(`TIMEZONE call on ${ye} which has no timezone`),this.dateString=ye}}D.InvalidTimezoneCall=ee;class re extends F{constructor(ye,Ee){super(`Operation on incompatible language literals '${be(ye)}' and '${be(Ee)}'`),this.arg1=ye,this.arg2=Ee}}D.IncompatibleLanguageOperation=re;class ne extends F{constructor(){super("Empty aggregate expression")}}D.EmptyAggregateError=ne;class le extends Error{constructor(ye,Ee){super(`Programmer Error '${ye}'`),this.payload=Ee}}D.UnexpectedError=le;class se extends Error{constructor(ye,Ee){super(`The number of args does not match the arity of the operator '${be(Ee)}'.`),this.args=ye,this.op=Ee}}D.InvalidArity=se;class ie extends Error{constructor(ye){super(`Invalid SPARQL Expression '${be(ye)}'`)}}D.InvalidExpression=ie;class ge extends Error{constructor(ye){super(`Invalid expression type for SPARQL Expression '${be(ye)}'`),this.expr=ye}}D.InvalidExpressionType=ge;class fe extends Error{constructor(ye){super(`Invalid term type for term '${be(ye)}'`),this.term=ye}}D.InvalidTermType=fe;class ae extends Error{constructor(ye){super(`Unknown operator: '${be(ye)}`)}}D.UnknownOperator=ae;class ue extends Error{constructor(ye){super(`Unknown named operator: '${be(ye)}'`)}}D.UnknownNamedOperator=ue;class pe extends Error{constructor(ye,Ee){Ee instanceof Error?super(`Error thrown in ${ye}: ${Ee.message}${Ee.stack?`
${Ee.stack}`:""}`):super(`Error thrown in ${ye}`)}}D.ExtensionFunctionError=pe;class _e extends Error{constructor(ye){super(`Aggregate expression ${be(ye)} found, but no aggregate hook provided.`)}}D.NoAggregator=_e;class xe extends Error{constructor(){super("EXISTS found, but no existence hook provided.")}}D.NoExistenceHook=xe;function be(Te){return JSON.stringify(Te)}},"../node_modules/sparqlee/dist/lib/util/Ordering.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.orderTypes=void 0;const G=F("../node_modules/lru-cache/index.js"),Q=F("../node_modules/sparqlee/dist/lib/transformers/TermTransformer.js"),X=F("../node_modules/sparqlee/dist/lib/util/Consts.js"),q=F("../node_modules/sparqlee/dist/lib/util/TypeHandling.js");function W(Z,ee,re,ne,le,se){return Z===ee?0:Z===void 0?re?-1:1:ee===void 0?re?1:-1:Z.equals(ee)?0:Y(Z,ee,ne,le)===re?-1:1}D.orderTypes=W;function Y(Z,ee,re,ne,le){return Z.termType!==ee.termType?te[Z.termType]<te[ee.termType]:Z.termType==="Literal"?J(Z,ee,re,ne):Z.value<ee.value}function J(Z,ee,re,ne){const le={discoverer:re||(()=>"term"),cache:ne||new G},se=new Q.TermTransformer(le),ie=se.transformLiteral(Z),ge=se.transformLiteral(ee),fe=ie.dataType,ae=ge.dataType,ue=(0,q.getSuperTypeDict)(fe,le),pe=(0,q.getSuperTypeDict)(ae,le);return X.TypeURL.XSD_BOOLEAN in ue&&X.TypeURL.XSD_BOOLEAN in pe||X.TypeURL.XSD_DATE_TIME in ue&&X.TypeURL.XSD_DATE_TIME in pe||X.TypeAlias.SPARQL_NUMERIC in ue&&X.TypeAlias.SPARQL_NUMERIC in pe||X.TypeURL.XSD_STRING in ue&&X.TypeURL.XSD_STRING in pe?ie.typedValue<ge.typedValue:X.TypeURL.RDF_LANG_STRING in ue&&X.TypeURL.RDF_LANG_STRING in pe?ie.typedValue<ge.typedValue||ie.typedValue===ge.typedValue&&ie.language<ge.language:fe<ae||ie.dataType===ge.dataType&&ie.str()<ge.str()}const te={Variable:0,BlankNode:1,NamedNode:2,Literal:3,Quad:4,DefaultGraph:5}},"../node_modules/sparqlee/dist/lib/util/Parsing.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.parseXSDDateTime=D.parseXSDInteger=D.parseXSDDecimal=D.parseXSDFloat=void 0;function F(q){const W=Number(q);return Number.isNaN(W)?q==="NaN"?Number.NaN:q==="INF"||q==="+INF"?Number.POSITIVE_INFINITY:q==="-INF"?Number.NEGATIVE_INFINITY:void 0:W}D.parseXSDFloat=F;function G(q){const W=Number(q);return Number.isNaN(W)?void 0:W}D.parseXSDDecimal=G;function Q(q){const W=Number.parseInt(q,10);return Number.isNaN(W)?void 0:W}D.parseXSDInteger=Q;function X(q){const W=q.indexOf("T"),Y=W>=0?q.slice(0,Math.max(0,W)):q,[J,te,Z]=Y.split("-");let ee="00",re="00",ne="00",le="";if(W>=0){const se=q.slice(W+1),[ie,ge]=se.split(/[+Z-]/u);[ee,re,ne]=ie.split(":");const fe=/([+Z-].*)/u.exec(se);le=fe?fe[0]:""}return{year:J,month:te,day:Z,hours:ee,minutes:re,seconds:ne,timezone:le}}D.parseXSDDateTime=X},"../node_modules/sparqlee/dist/lib/util/TypeHandling.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.isSubTypeOf=D.getSuperTypeDict=D.isInternalSubType=D.asGeneralType=D.asOverrideType=D.asKnownLiteralType=D.asTypeAlias=D.typeAliasCheck=D.extensionTableInit=D.getSuperTypes=D.superTypeDictTable=D.extensionTableInput=void 0;const G=F("../node_modules/sparqlee/dist/lib/expressions/index.js"),Q=F("../node_modules/sparqlee/dist/lib/util/Consts.js");D.extensionTableInput={[Q.TypeURL.XSD_DATE_TIME_STAMP]:Q.TypeURL.XSD_DATE_TIME,[Q.TypeURL.XSD_DAYTIME_DURATION]:Q.TypeURL.XSD_DURATION,[Q.TypeURL.XSD_YEAR_MONTH_DURATION]:Q.TypeURL.XSD_DURATION,[Q.TypeURL.RDF_LANG_STRING]:Q.TypeAlias.SPARQL_STRINGLY,[Q.TypeURL.XSD_STRING]:Q.TypeAlias.SPARQL_STRINGLY,[Q.TypeURL.XSD_NORMALIZED_STRING]:Q.TypeURL.XSD_STRING,[Q.TypeURL.XSD_TOKEN]:Q.TypeURL.XSD_NORMALIZED_STRING,[Q.TypeURL.XSD_LANGUAGE]:Q.TypeURL.XSD_TOKEN,[Q.TypeURL.XSD_NM_TOKEN]:Q.TypeURL.XSD_TOKEN,[Q.TypeURL.XSD_NAME]:Q.TypeURL.XSD_TOKEN,[Q.TypeURL.XSD_NC_NAME]:Q.TypeURL.XSD_NAME,[Q.TypeURL.XSD_ENTITY]:Q.TypeURL.XSD_NC_NAME,[Q.TypeURL.XSD_ID]:Q.TypeURL.XSD_NC_NAME,[Q.TypeURL.XSD_ID_REF]:Q.TypeURL.XSD_NC_NAME,[Q.TypeURL.XSD_DOUBLE]:Q.TypeAlias.SPARQL_NUMERIC,[Q.TypeURL.XSD_FLOAT]:Q.TypeAlias.SPARQL_NUMERIC,[Q.TypeURL.XSD_DECIMAL]:Q.TypeAlias.SPARQL_NUMERIC,[Q.TypeURL.XSD_INTEGER]:Q.TypeURL.XSD_DECIMAL,[Q.TypeURL.XSD_NON_POSITIVE_INTEGER]:Q.TypeURL.XSD_INTEGER,[Q.TypeURL.XSD_NEGATIVE_INTEGER]:Q.TypeURL.XSD_NON_POSITIVE_INTEGER,[Q.TypeURL.XSD_LONG]:Q.TypeURL.XSD_INTEGER,[Q.TypeURL.XSD_INT]:Q.TypeURL.XSD_LONG,[Q.TypeURL.XSD_SHORT]:Q.TypeURL.XSD_INT,[Q.TypeURL.XSD_BYTE]:Q.TypeURL.XSD_SHORT,[Q.TypeURL.XSD_NON_NEGATIVE_INTEGER]:Q.TypeURL.XSD_INTEGER,[Q.TypeURL.XSD_POSITIVE_INTEGER]:Q.TypeURL.XSD_NON_NEGATIVE_INTEGER,[Q.TypeURL.XSD_UNSIGNED_LONG]:Q.TypeURL.XSD_NON_NEGATIVE_INTEGER,[Q.TypeURL.XSD_UNSIGNED_INT]:Q.TypeURL.XSD_UNSIGNED_LONG,[Q.TypeURL.XSD_UNSIGNED_SHORT]:Q.TypeURL.XSD_UNSIGNED_INT,[Q.TypeURL.XSD_UNSIGNED_BYTE]:Q.TypeURL.XSD_UNSIGNED_SHORT,[Q.TypeURL.XSD_DATE_TIME]:"term",[Q.TypeURL.XSD_BOOLEAN]:"term",[Q.TypeURL.XSD_DATE]:"term",[Q.TypeURL.XSD_DURATION]:"term",[Q.TypeAlias.SPARQL_NUMERIC]:"term",[Q.TypeAlias.SPARQL_STRINGLY]:"term",[Q.TypeAlias.SPARQL_NON_LEXICAL]:"term",[Q.TypeURL.XSD_ANY_URI]:"term"};function X(se,ie){const ge=ie.cache.get(se);if(ge)return ge;const fe=ie.discoverer(se);if(fe==="term"){const pe=Object.create(null);return pe.__depth=0,pe[se]=0,ie.cache.set(se,pe),pe}let ae;const ue=te(fe);return ue?ae=Object.assign({},D.superTypeDictTable[ue]):ae=Object.assign({},X(fe,ie)),ae.__depth++,ae[se]=ae.__depth,ie.cache.set(se,ae),ae}D.getSuperTypes=X;function q(){const se=Object.create(null);for(const[ie,ge]of Object.entries(D.extensionTableInput)){const fe=ie;se[fe]||W(fe,ge,se)}D.superTypeDictTable=se}D.extensionTableInit=q,q();function W(se,ie,ge){if(ie==="term"||ie===void 0){const fe=Object.create(null);fe.__depth=0,fe[se]=0,ge[se]=fe;return}ge[ie]||W(ie,D.extensionTableInput[ie],ge),ge[se]=Object.assign(Object.assign({},ge[ie]),{[se]:ge[ie].__depth+1,__depth:ge[ie].__depth+1})}function Y(){D.typeAliasCheck=Object.create(null);for(const se of Object.values(Q.TypeAlias))D.typeAliasCheck[se]=!0}Y();function J(se){if(se in D.typeAliasCheck)return se}D.asTypeAlias=J;function te(se){if(se in D.superTypeDictTable)return se}D.asKnownLiteralType=te;function Z(se){if(te(se)||se==="term")return se}D.asOverrideType=Z;function ee(se){if(se==="term"||(0,G.asTermType)(se))return se}D.asGeneralType=ee;function re(se,ie){return se!=="term"&&D.superTypeDictTable[se]&&D.superTypeDictTable[se][ie]!==void 0}D.isInternalSubType=re;function ne(se,ie){const ge=te(se);return ge?D.superTypeDictTable[ge]:X(se,ie)}D.getSuperTypeDict=ne;function le(se,ie,ge){return se==="term"?!1:ne(se,ge)[ie]!==void 0}D.isSubTypeOf=le},"../node_modules/stream-to-string/index.js":(U,D,F)=>{var G=F("./require-empty.js");U.exports=function(Q,X,q){typeof X=="function"&&(q=X,X=null),q=q||function(){};var W="";return new G(function(Y,J){Q.on("data",function(te){W+=typeof X=="string"?te.toString(X):te.toString()}),Q.on("end",function(){Y(W),q(null,W)}),Q.on("error",function(te){J(te),q(te)})})}},"../node_modules/typed-immutable-map/dist/HashMap/empty.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.empty=void 0;const Q={node:F("../node_modules/typed-immutable-map/dist/nodes/index.js").EMPTY,size:0};function X(){return Q}D.empty=X},"../node_modules/typed-immutable-map/dist/HashMap/entries.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.entries=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/index.js");function Q(q){return(0,G.iterator)((0,G.getNode)(q),X)}D.entries=Q;function X(q){return[q.key,q.value]}},"../node_modules/typed-immutable-map/dist/HashMap/filter.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.filter=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/empty.js"),Q=F("../node_modules/typed-immutable-map/dist/HashMap/reduce.js"),X=F("../node_modules/typed-immutable-map/dist/HashMap/set.js"),q=function(Y,J){return(0,Q.reduce)(function(te,Z,ee){return Y(Z,ee)?(0,X.set)(ee,Z,te):te},(0,G.empty)(),J)};D.filter=q},"../node_modules/typed-immutable-map/dist/HashMap/forEach.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.forEach=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/reduce.js"),Q=function(q,W){return(0,G.reduce)((Y,J,te)=>q(J,te),null,W),W};D.forEach=Q},"../node_modules/typed-immutable-map/dist/HashMap/from.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.fromObject=D.fromIterable=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/empty.js"),Q=F("../node_modules/typed-immutable-map/dist/HashMap/set.js");function X(W){let Y=(0,G.empty)();for(const[J,te]of W)Y=(0,Q.set)(J,te,Y);return Y}D.fromIterable=X;function q(W){let Y=(0,G.empty)();for(let J in W)W.hasOwnProperty(J)&&(Y=(0,Q.set)(J,W[J],Y));return Y}D.fromObject=q},"../node_modules/typed-immutable-map/dist/HashMap/get.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.get=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/index.js");function Q(X,q,W){const Y=(0,G.findHash)(X);return(0,G.getHash)(void 0,Y,X,q,W)}D.get=Q},"../node_modules/typed-immutable-map/dist/HashMap/has.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.has=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/index.js"),Q=F("../node_modules/typed-immutable-map/dist/nodes/index.js");function X(q,W,Y){const J=(0,G.findHash)(q);return(0,G.getHash)(Q.NOTHING,J,q,W,Y)!==Q.NOTHING}D.has=X},"../node_modules/typed-immutable-map/dist/HashMap/keys.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.keys=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/index.js");function Q(q){return(0,G.iterator)((0,G.getNode)(q),X)}D.keys=Q;function X(q){return q.key}},"../node_modules/typed-immutable-map/dist/HashMap/map.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.map=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/empty.js"),Q=F("../node_modules/typed-immutable-map/dist/HashMap/reduce.js"),X=F("../node_modules/typed-immutable-map/dist/HashMap/set.js"),q=function(Y,J){return(0,Q.reduce)(function(te,Z,ee){return(0,X.set)(ee,Y(Z,ee),te)},(0,G.empty)(),J)};D.map=q},"../node_modules/typed-immutable-map/dist/HashMap/primitives/findHash.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.findHash=void 0;const G=F("../node_modules/typed-immutable-map/dist/common/index.js");function Q(X){return typeof X=="number"?X:typeof X=="string"?(0,G.stringHash)(X):Math.abs((0,G.stringHash)(JSON.stringify(X)))}D.findHash=Q},"../node_modules/typed-immutable-map/dist/HashMap/primitives/fold.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.fold=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/getNode.js");function Q(X,q,W){const Y=(0,G.getNode)(W);if(Y.type===0)return q;if(Y.type===1)return X(q,Y.value,Y.key);const J=[Y.children];let te;for(;te=J.shift();)for(let Z=0;Z<te.length;++Z){const ee=te[Z];ee&&ee.type!==0&&(ee.type===1?q=X(q,ee.value,ee.key):J.push(ee.children))}return q}D.fold=Q},"../node_modules/typed-immutable-map/dist/HashMap/primitives/getHash.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.getHash=void 0;const G=F("../node_modules/typed-immutable-map/dist/common/index.js"),Q=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/getNode.js"),X=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/keyEquals.js");function q(W,Y,J,te,Z=X.defaultKeyEquals){let ee=(0,Q.getNode)(te),re=0;for(;;)switch(ee.type){case 1:return Z(J,ee.key)?ee.value:W;case 2:if(Y===ee.hash){const ne=ee.children;for(let le=0;le<ne.length;++le){const se=ne[le];if(Z(J,se.key))return se.value}return W}case 3:{const ne=(0,G.hashFragment)(re,Y),le=(0,G.toBitmap)(ne);if(ee.mask&le){const se=(0,G.bitmapToIndex)(ee.mask,le);ee=ee.children[se],re+=G.SIZE;break}return W}case 4:{if(ee=ee.children[(0,G.hashFragment)(re,Y)],ee){re+=G.SIZE;break}return W}default:return W}}D.getHash=q},"../node_modules/typed-immutable-map/dist/HashMap/primitives/getNode.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.getNode=void 0;function F(G){return G.node}D.getNode=F},"../node_modules/typed-immutable-map/dist/HashMap/primitives/getSize.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.getSize=void 0;function F(G){return G.size}D.getSize=F},"../node_modules/typed-immutable-map/dist/HashMap/primitives/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W),Object.defineProperty(X,Y,{enumerable:!0,get:function(){return q[W]}})}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/typed-immutable-map/dist/HashMap/primitives/getHash.js"),D),Q(F("../node_modules/typed-immutable-map/dist/HashMap/primitives/getNode.js"),D),Q(F("../node_modules/typed-immutable-map/dist/HashMap/primitives/setTree.js"),D),Q(F("../node_modules/typed-immutable-map/dist/HashMap/primitives/setKeyValue.js"),D),Q(F("../node_modules/typed-immutable-map/dist/HashMap/primitives/findHash.js"),D),Q(F("../node_modules/typed-immutable-map/dist/HashMap/primitives/iterateMap.js"),D),Q(F("../node_modules/typed-immutable-map/dist/HashMap/primitives/fold.js"),D),Q(F("../node_modules/typed-immutable-map/dist/HashMap/primitives/keyEquals.js"),D)},"../node_modules/typed-immutable-map/dist/HashMap/primitives/iterateMap.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.iterator=void 0;function F(Y,J){return new G(X(Y,J,[]))}D.iterator=F;class G{_iterate;constructor(J){this._iterate=J}next(){if(!this._iterate)return{done:!0,value:null};const{value:J,rest:te}=this._iterate;return this._iterate=Q(te),{done:!1,value:J}}[Symbol.iterator](){return this}}const Q=Y=>Y&&q(Y[0],Y[1],Y[2],Y[3],Y[4]);function X(Y,J,te){switch(Y.type){case 1:return{value:J(Y),rest:te};case 2:case 4:case 3:const Z=Y.children;return q(Z.length,Z,0,J,te);default:return Q(te)}}function q(Y,J,te,Z,ee){for(;te<Y;){const re=J[te++];if(re&&W(re))return X(re,Z,[Y,J,te,Z,ee])}return Q(ee)}function W(Y){return Y&&Y.type!==0}},"../node_modules/typed-immutable-map/dist/HashMap/primitives/keyEquals.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.defaultKeyEquals=void 0;const F=(G,Q)=>G===Q;D.defaultKeyEquals=F},"../node_modules/typed-immutable-map/dist/HashMap/primitives/setKeyValue.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.setKeyValue=void 0;const G=F("../node_modules/typed-immutable-map/dist/nodes/index.js"),Q=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/findHash.js"),X=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/getNode.js"),q=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/getSize.js"),W=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/setTree.js"),Y=te=>()=>te;function J(te,Z,ee){const re=(0,Q.findHash)(te),ne={value:(0,q.getSize)(ee)},le=(0,G.modify)((0,X.getNode)(ee),0,Y(Z),re,te,ne);return(0,W.setTree)(le,ne.value,ee)}D.setKeyValue=J},"../node_modules/typed-immutable-map/dist/HashMap/primitives/setTree.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.setTree=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/getNode.js");function Q(X,q,W){return X===(0,G.getNode)(W)?W:{node:X,size:q}}D.setTree=Q},"../node_modules/typed-immutable-map/dist/HashMap/reduce.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.reduce=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/index.js");D.reduce=G.fold},"../node_modules/typed-immutable-map/dist/HashMap/remove.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.remove=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/index.js"),Q=F("../node_modules/typed-immutable-map/dist/nodes/constants.js");function X(q,W){return(0,G.setKeyValue)(q,Q.NOTHING,W)}D.remove=X},"../node_modules/typed-immutable-map/dist/HashMap/set.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.set=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/index.js");D.set=G.setKeyValue},"../node_modules/typed-immutable-map/dist/HashMap/size.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.size=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/getSize.js");function Q(X){return(0,G.getSize)(X)}D.size=Q},"../node_modules/typed-immutable-map/dist/HashMap/values.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.values=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/primitives/index.js");function Q(q){return(0,G.iterator)((0,G.getNode)(q),X)}D.values=Q;function X(q){return q.value}},"../node_modules/typed-immutable-map/dist/common/array-operations.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.insert=D.remove=D.replace=void 0;function F(X,q,W){const Y=W.length,J=Array(Y);for(let te=0;te<Y;++te)J[te]=W[te];return J[X]=q,J}D.replace=F;function G(X,q){const W=q.length;if(W===0||X>=W)return q;if(W===1)return[];const Y=Array(W-1);let J=0;for(;J<X;++J)Y[J]=q[J];for(J=J+1;J<W;++J)Y[J-1]=q[J];return Y}D.remove=G;function Q(X,q,W){const Y=W.length,J=Array(Y+1);let te=0;for(;te<X;++te)J[te]=W[te];for(J[te++]=q;te<Y+1;++te)J[te]=W[te-1];return J}D.insert=Q},"../node_modules/typed-immutable-map/dist/common/bitwise-operations.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.bitmapToIndex=D.toBitmap=D.hashFragment=D.hammingWeight=void 0;const G=F("../node_modules/typed-immutable-map/dist/common/constants.js");function Q(Y){return Y=Y-(Y>>1&1431655765),Y=(Y&858993459)+(Y>>2&858993459),(Y+(Y>>4)&252645135)*16843009>>24}D.hammingWeight=Q;function X(Y,J){return J>>>Y&G.MASK}D.hashFragment=X;function q(Y){return 1<<Y}D.toBitmap=q;function W(Y,J){return Q(Y&J-1)}D.bitmapToIndex=W},"../node_modules/typed-immutable-map/dist/common/constants.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.MIN_ARRAY_NODE=D.MAX_INDEX_NODE=D.MASK=D.BUCKET_SIZE=D.SIZE=void 0,D.SIZE=5,D.BUCKET_SIZE=Math.pow(2,D.SIZE),D.MASK=D.BUCKET_SIZE-1,D.MAX_INDEX_NODE=D.BUCKET_SIZE/2,D.MIN_ARRAY_NODE=D.BUCKET_SIZE/4},"../node_modules/typed-immutable-map/dist/common/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W),Object.defineProperty(X,Y,{enumerable:!0,get:function(){return q[W]}})}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/typed-immutable-map/dist/common/array-operations.js"),D),Q(F("../node_modules/typed-immutable-map/dist/common/bitwise-operations.js"),D),Q(F("../node_modules/typed-immutable-map/dist/common/constants.js"),D),Q(F("../node_modules/typed-immutable-map/dist/common/stringHash.js"),D)},"../node_modules/typed-immutable-map/dist/common/stringHash.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.stringHash=void 0;function F(G){let Q=0;for(let X=0;X<G.length;++X)Q=(Q<<5)-Q+G.charCodeAt(X)|0;return Q}D.stringHash=F},"../node_modules/typed-immutable-map/dist/nodes/ArrayNode/ArrayNode.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.modifyListNode=void 0;const G=F("../node_modules/typed-immutable-map/dist/nodes/EmptyNode.js"),Q=F("../node_modules/typed-immutable-map/dist/nodes/modify.js"),X=F("../node_modules/typed-immutable-map/dist/common/index.js"),q=F("../node_modules/typed-immutable-map/dist/nodes/ArrayNode/toIndexNode.js");function W(J,te,Z,ee,re,ne){const{size:le,children:se}=J,ie=(0,X.hashFragment)(te,ee),ge=se[ie],fe=(0,Q.modify)(ge||(0,G.empty)(),te+X.SIZE,Z,ee,re,ne);return ge===fe?J:Y(ge)&&!Y(fe)?{type:4,size:le+1,children:(0,X.replace)(ie,fe,se)}:!Y(ge)&&Y(fe)?le-1<=X.MIN_ARRAY_NODE?(0,q.toIndexNode)(le,ie,se):{type:4,size:le-1,children:(0,X.replace)(ie,(0,G.empty)(),se)}:{type:4,size:le,children:(0,X.replace)(ie,fe,se)}}D.modifyListNode=W;function Y(J){return J&&J.type===0}},"../node_modules/typed-immutable-map/dist/nodes/ArrayNode/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W),Object.defineProperty(X,Y,{enumerable:!0,get:function(){return q[W]}})}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/typed-immutable-map/dist/nodes/ArrayNode/ArrayNode.js"),D)},"../node_modules/typed-immutable-map/dist/nodes/ArrayNode/toIndexNode.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.toIndexNode=void 0;function F(G,Q,X){const q=new Array(G-1);let W=0,Y=0;for(let J=0;J<X.length;++J)if(J!==Q){const te=X[J];te&&te.type>0&&(q[W++]=te,Y|=1<<J)}return{type:3,mask:Y,children:q}}D.toIndexNode=F},"../node_modules/typed-immutable-map/dist/nodes/CollisionNode/CollisionNode.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.modifyCollisionNode=void 0;const G=F("../node_modules/typed-immutable-map/dist/nodes/constants.js"),Q=F("../node_modules/typed-immutable-map/dist/nodes/LeafNode/index.js"),X=F("../node_modules/typed-immutable-map/dist/nodes/CollisionNode/newCollisionList.js");function q(W,Y,J,te,Z,ee){if(te===W.hash){const ne=(0,X.newCollisionList)(W.hash,W.children,J,Z,ee);return ne===W.children?W:ne.length>1?{type:2,hash:W.hash,children:ne}:ne[0]}const re=J();return re===G.NOTHING?W:(++ee.value,(0,Q.combineLeafNodes)(Y,W.hash,W,te,{type:1,hash:te,key:Z,value:re}))}D.modifyCollisionNode=q},"../node_modules/typed-immutable-map/dist/nodes/CollisionNode/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W),Object.defineProperty(X,Y,{enumerable:!0,get:function(){return q[W]}})}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/typed-immutable-map/dist/nodes/CollisionNode/CollisionNode.js"),D)},"../node_modules/typed-immutable-map/dist/nodes/CollisionNode/newCollisionList.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.newCollisionList=void 0;const G=F("../node_modules/typed-immutable-map/dist/nodes/constants.js"),Q=F("../node_modules/typed-immutable-map/dist/common/index.js");function X(q,W,Y,J,te){const Z=W.length;for(let re=0;re<Z;++re){const ne=W[re];if(ne.key===J){const le=ne.value,se=Y(le);return se===le?W:se===G.NOTHING?(--te.value,(0,Q.remove)(re,W)):(0,Q.insert)(re,{type:1,hash:q,key:J,value:se},W)}}const ee=Y();return ee===G.NOTHING?W:(++te.value,(0,Q.insert)(Z,{type:1,hash:q,key:J,value:ee},W))}D.newCollisionList=X},"../node_modules/typed-immutable-map/dist/nodes/EmptyNode.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.empty=D.EMPTY=D.modifyEmpty=void 0;const G=F("../node_modules/typed-immutable-map/dist/nodes/constants.js");function Q(q,W,Y,J,te,Z){const ee=Y(void 0);return ee===G.NOTHING?q:(++Z.value,{type:1,hash:J,key:te,value:ee})}D.modifyEmpty=Q,D.EMPTY={type:0};function X(){return D.EMPTY}D.empty=X},"../node_modules/typed-immutable-map/dist/nodes/IndexedNode/IndexedNode.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.modifyIndexedNode=void 0;const G=F("../node_modules/typed-immutable-map/dist/nodes/EmptyNode.js"),Q=F("../node_modules/typed-immutable-map/dist/common/index.js"),X=F("../node_modules/typed-immutable-map/dist/nodes/modify.js"),q=F("../node_modules/typed-immutable-map/dist/nodes/IndexedNode/toArrayNode.js");function W(J,te,Z,ee,re,ne){const{mask:le,children:se}=J,ie=(0,Q.hashFragment)(te,ee),ge=(0,Q.toBitmap)(ie),fe=(0,Q.bitmapToIndex)(le,ge),ae=!!(le&ge),ue=ae?se[fe]:(0,G.empty)(),pe=(0,X.modify)(ue,te+Q.SIZE,Z,ee,re,ne);if(ue===pe)return J;if(ae&&pe.type===0){const _e=le&~ge;return _e?se.length<=2&&Y(se[fe^1])?se[fe^1]:{type:3,mask:_e,children:(0,Q.remove)(fe,se)}:(0,G.empty)()}return!ae&&pe.type!==0?se.length>=Q.MAX_INDEX_NODE?(0,q.toArrayNode)(ie,pe,le,se):{type:3,mask:le|ge,children:(0,Q.insert)(fe,pe,se)}:{type:3,mask:le,children:(0,Q.replace)(fe,pe,se)}}D.modifyIndexedNode=W;function Y(J){const te=J.type;return te===0||te===1||te===2}},"../node_modules/typed-immutable-map/dist/nodes/IndexedNode/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W),Object.defineProperty(X,Y,{enumerable:!0,get:function(){return q[W]}})}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/typed-immutable-map/dist/nodes/IndexedNode/IndexedNode.js"),D)},"../node_modules/typed-immutable-map/dist/nodes/IndexedNode/toArrayNode.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.toArrayNode=void 0;function F(G,Q,X,q){const W=[];let Y=X,J=0;for(let te=0;Y;++te)Y&1&&(W[te]=q[J++]),Y>>>=1;return W[G]=Q,{type:4,size:J+1,children:W}}D.toArrayNode=F},"../node_modules/typed-immutable-map/dist/nodes/LeafNode/LeafNode.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.modifyLeaf=void 0;const G=F("../node_modules/typed-immutable-map/dist/nodes/constants.js"),Q=F("../node_modules/typed-immutable-map/dist/nodes/EmptyNode.js"),X=F("../node_modules/typed-immutable-map/dist/nodes/LeafNode/combineLeafNodes.js");function q(W,Y,J,te,Z,ee){if(Z===W.key){const ne=J(W.value);return ne===W.value?W:ne===G.NOTHING?(--ee.value,(0,Q.empty)()):{type:1,hash:te,key:Z,value:ne}}const re=J();return re===G.NOTHING?W:(++ee.value,(0,X.combineLeafNodes)(Y,W.hash,W,te,{type:1,hash:te,key:Z,value:re}))}D.modifyLeaf=q},"../node_modules/typed-immutable-map/dist/nodes/LeafNode/combineLeafNodes.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.combineLeafNodes=void 0;const G=F("../node_modules/typed-immutable-map/dist/common/index.js");function Q(X,q,W,Y,J){if(q===Y)return{type:2,hash:q,children:[J,W]};const te=(0,G.hashFragment)(X,q),Z=(0,G.hashFragment)(X,Y);return{type:3,mask:(0,G.toBitmap)(te)|(0,G.toBitmap)(Z),children:te===Z?[Q(X+G.SIZE,q,W,Y,J)]:te<Z?[W,J]:[J,W]}}D.combineLeafNodes=Q},"../node_modules/typed-immutable-map/dist/nodes/LeafNode/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W),Object.defineProperty(X,Y,{enumerable:!0,get:function(){return q[W]}})}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/typed-immutable-map/dist/nodes/LeafNode/LeafNode.js"),D),Q(F("../node_modules/typed-immutable-map/dist/nodes/LeafNode/combineLeafNodes.js"),D)},"../node_modules/typed-immutable-map/dist/nodes/constants.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.NOTHING=void 0,D.NOTHING=Object.create(null)},"../node_modules/typed-immutable-map/dist/nodes/index.js":function(U,D,F){var G=this&&this.__createBinding||(Object.create?function(X,q,W,Y){Y===void 0&&(Y=W),Object.defineProperty(X,Y,{enumerable:!0,get:function(){return q[W]}})}:function(X,q,W,Y){Y===void 0&&(Y=W),X[Y]=q[W]}),Q=this&&this.__exportStar||function(X,q){for(var W in X)W!=="default"&&!Object.prototype.hasOwnProperty.call(q,W)&&G(q,X,W)};Object.defineProperty(D,"__esModule",{value:!0}),Q(F("../node_modules/typed-immutable-map/dist/nodes/types.js"),D),Q(F("../node_modules/typed-immutable-map/dist/nodes/constants.js"),D),Q(F("../node_modules/typed-immutable-map/dist/nodes/EmptyNode.js"),D),Q(F("../node_modules/typed-immutable-map/dist/nodes/ArrayNode/index.js"),D),Q(F("../node_modules/typed-immutable-map/dist/nodes/CollisionNode/index.js"),D),Q(F("../node_modules/typed-immutable-map/dist/nodes/IndexedNode/index.js"),D),Q(F("../node_modules/typed-immutable-map/dist/nodes/LeafNode/index.js"),D),Q(F("../node_modules/typed-immutable-map/dist/nodes/modify.js"),D)},"../node_modules/typed-immutable-map/dist/nodes/modify.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.modify=void 0;const G=F("../node_modules/typed-immutable-map/dist/nodes/LeafNode/index.js"),Q=F("../node_modules/typed-immutable-map/dist/nodes/EmptyNode.js"),X=F("../node_modules/typed-immutable-map/dist/nodes/ArrayNode/index.js"),q=F("../node_modules/typed-immutable-map/dist/nodes/IndexedNode/index.js"),W=F("../node_modules/typed-immutable-map/dist/nodes/CollisionNode/index.js");function Y(J,te,Z,ee,re,ne){switch(J.type){case 1:return(0,G.modifyLeaf)(J,te,Z,ee,re,ne);case 0:return(0,Q.modifyEmpty)(J,te,Z,ee,re,ne);case 4:return(0,X.modifyListNode)(J,te,Z,ee,re,ne);case 3:return(0,q.modifyIndexedNode)(J,te,Z,ee,re,ne);case 2:return(0,W.modifyCollisionNode)(J,te,Z,ee,re,ne);default:throw new Error("never")}}D.modify=Y},"../node_modules/typed-immutable-map/dist/nodes/types.js":(U,D)=>{Object.defineProperty(D,"__esModule",{value:!0})},"../node_modules/uuid-random/index.js":(U,D,F)=>{(function(){var G,Q=0,X=[],q;for(q=0;q<256;q++)X[q]=(q+256).toString(16).substr(1);te.BUFFER_SIZE=4096,te.bin=J,te.clearBuffer=function(){G=null,Q=0},te.test=function(Z){return typeof Z=="string"?/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Z):!1};var W;typeof crypto<"u"?W=crypto:typeof window<"u"&&typeof window.msCrypto<"u"&&(W=window.msCrypto),W=W||F("?699d"),U.exports=te,te.randomBytes=function(){if(W){if(W.randomBytes)return W.randomBytes;if(W.getRandomValues)return typeof Uint8Array.prototype.slice!="function"?function(Z){var ee=new Uint8Array(Z);return W.getRandomValues(ee),Array.from(ee)}:function(Z){var ee=new Uint8Array(Z);return W.getRandomValues(ee),ee}}return function(Z){var ee,re=[];for(ee=0;ee<Z;ee++)re.push(Math.floor(Math.random()*256));return re}}();function Y(Z){return(!G||Q+Z>te.BUFFER_SIZE)&&(Q=0,G=te.randomBytes(te.BUFFER_SIZE)),G.slice(Q,Q+=Z)}function J(){var Z=Y(16);return Z[6]=Z[6]&15|64,Z[8]=Z[8]&63|128,Z}function te(){var Z=J();return X[Z[0]]+X[Z[1]]+X[Z[2]]+X[Z[3]]+"-"+X[Z[4]]+X[Z[5]]+"-"+X[Z[6]]+X[Z[7]]+"-"+X[Z[8]]+X[Z[9]]+"-"+X[Z[10]]+X[Z[11]]+X[Z[12]]+X[Z[13]]+X[Z[14]]+X[Z[15]]}})()},"../node_modules/yallist/iterator.js":U=>{U.exports=function(D){D.prototype[Symbol.iterator]=function*(){for(let F=this.head;F;F=F.next)yield F.value}}},"../node_modules/yallist/yallist.js":(U,D,F)=>{U.exports=G,G.Node=W,G.create=G;function G(Y){var J=this;if(J instanceof G||(J=new G),J.tail=null,J.head=null,J.length=0,Y&&typeof Y.forEach=="function")Y.forEach(function(ee){J.push(ee)});else if(arguments.length>0)for(var te=0,Z=arguments.length;te<Z;te++)J.push(arguments[te]);return J}G.prototype.removeNode=function(Y){if(Y.list!==this)throw new Error("removing node which does not belong to this list");var J=Y.next,te=Y.prev;return J&&(J.prev=te),te&&(te.next=J),Y===this.head&&(this.head=J),Y===this.tail&&(this.tail=te),Y.list.length--,Y.next=null,Y.prev=null,Y.list=null,J},G.prototype.unshiftNode=function(Y){if(Y!==this.head){Y.list&&Y.list.removeNode(Y);var J=this.head;Y.list=this,Y.next=J,J&&(J.prev=Y),this.head=Y,this.tail||(this.tail=Y),this.length++}},G.prototype.pushNode=function(Y){if(Y!==this.tail){Y.list&&Y.list.removeNode(Y);var J=this.tail;Y.list=this,Y.prev=J,J&&(J.next=Y),this.tail=Y,this.head||(this.head=Y),this.length++}},G.prototype.push=function(){for(var Y=0,J=arguments.length;Y<J;Y++)X(this,arguments[Y]);return this.length},G.prototype.unshift=function(){for(var Y=0,J=arguments.length;Y<J;Y++)q(this,arguments[Y]);return this.length},G.prototype.pop=function(){if(this.tail){var Y=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,Y}},G.prototype.shift=function(){if(this.head){var Y=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,Y}},G.prototype.forEach=function(Y,J){J=J||this;for(var te=this.head,Z=0;te!==null;Z++)Y.call(J,te.value,Z,this),te=te.next},G.prototype.forEachReverse=function(Y,J){J=J||this;for(var te=this.tail,Z=this.length-1;te!==null;Z--)Y.call(J,te.value,Z,this),te=te.prev},G.prototype.get=function(Y){for(var J=0,te=this.head;te!==null&&J<Y;J++)te=te.next;if(J===Y&&te!==null)return te.value},G.prototype.getReverse=function(Y){for(var J=0,te=this.tail;te!==null&&J<Y;J++)te=te.prev;if(J===Y&&te!==null)return te.value},G.prototype.map=function(Y,J){J=J||this;for(var te=new G,Z=this.head;Z!==null;)te.push(Y.call(J,Z.value,this)),Z=Z.next;return te},G.prototype.mapReverse=function(Y,J){J=J||this;for(var te=new G,Z=this.tail;Z!==null;)te.push(Y.call(J,Z.value,this)),Z=Z.prev;return te},G.prototype.reduce=function(Y,J){var te,Z=this.head;if(arguments.length>1)te=J;else if(this.head)Z=this.head.next,te=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var ee=0;Z!==null;ee++)te=Y(te,Z.value,ee),Z=Z.next;return te},G.prototype.reduceReverse=function(Y,J){var te,Z=this.tail;if(arguments.length>1)te=J;else if(this.tail)Z=this.tail.prev,te=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var ee=this.length-1;Z!==null;ee--)te=Y(te,Z.value,ee),Z=Z.prev;return te},G.prototype.toArray=function(){for(var Y=new Array(this.length),J=0,te=this.head;te!==null;J++)Y[J]=te.value,te=te.next;return Y},G.prototype.toArrayReverse=function(){for(var Y=new Array(this.length),J=0,te=this.tail;te!==null;J++)Y[J]=te.value,te=te.prev;return Y},G.prototype.slice=function(Y,J){J=J||this.length,J<0&&(J+=this.length),Y=Y||0,Y<0&&(Y+=this.length);var te=new G;if(J<Y||J<0)return te;Y<0&&(Y=0),J>this.length&&(J=this.length);for(var Z=0,ee=this.head;ee!==null&&Z<Y;Z++)ee=ee.next;for(;ee!==null&&Z<J;Z++,ee=ee.next)te.push(ee.value);return te},G.prototype.sliceReverse=function(Y,J){J=J||this.length,J<0&&(J+=this.length),Y=Y||0,Y<0&&(Y+=this.length);var te=new G;if(J<Y||J<0)return te;Y<0&&(Y=0),J>this.length&&(J=this.length);for(var Z=this.length,ee=this.tail;ee!==null&&Z>J;Z--)ee=ee.prev;for(;ee!==null&&Z>Y;Z--,ee=ee.prev)te.push(ee.value);return te},G.prototype.splice=function(Y,J,...te){Y>this.length&&(Y=this.length-1),Y<0&&(Y=this.length+Y);for(var Z=0,ee=this.head;ee!==null&&Z<Y;Z++)ee=ee.next;for(var re=[],Z=0;ee&&Z<J;Z++)re.push(ee.value),ee=this.removeNode(ee);ee===null&&(ee=this.tail),ee!==this.head&&ee!==this.tail&&(ee=ee.prev);for(var Z=0;Z<te.length;Z++)ee=Q(this,ee,te[Z]);return re},G.prototype.reverse=function(){for(var Y=this.head,J=this.tail,te=Y;te!==null;te=te.prev){var Z=te.prev;te.prev=te.next,te.next=Z}return this.head=J,this.tail=Y,this};function Q(Y,J,te){var Z=J===Y.head?new W(te,null,J,Y):new W(te,J,J.next,Y);return Z.next===null&&(Y.tail=Z),Z.prev===null&&(Y.head=Z),Y.length++,Z}function X(Y,J){Y.tail=new W(J,Y.tail,null,Y),Y.head||(Y.head=Y.tail),Y.length++}function q(Y,J){Y.head=new W(J,null,Y.head,Y),Y.tail||(Y.tail=Y.head),Y.length++}function W(Y,J,te,Z){if(!(this instanceof W))return new W(Y,J,te,Z);this.list=Z,this.value=Y,J?(J.next=this,this.prev=J):this.prev=null,te?(te.prev=this,this.next=te):this.next=null}try{F("../node_modules/yallist/iterator.js")(G)}catch{}},"../packages/immutable/dist/Map.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Map=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/has.js"),Q=F("../node_modules/typed-immutable-map/dist/HashMap/get.js"),X=F("../node_modules/typed-immutable-map/dist/HashMap/set.js"),q=F("../node_modules/typed-immutable-map/dist/HashMap/forEach.js"),W=F("../node_modules/typed-immutable-map/dist/HashMap/map.js"),Y=F("../node_modules/typed-immutable-map/dist/HashMap/filter.js"),J=F("../node_modules/typed-immutable-map/dist/HashMap/remove.js"),te=F("../node_modules/typed-immutable-map/dist/HashMap/entries.js"),Z=F("../node_modules/typed-immutable-map/dist/HashMap/values.js"),ee=F("../node_modules/typed-immutable-map/dist/HashMap/keys.js"),re=F("../node_modules/typed-immutable-map/dist/HashMap/size.js");class ne{hashmap;constructor(se){this.hashmap=se}get size(){return(0,re.size)(this.hashmap)}set(se,ie){return new ne((0,X.set)(se,ie,this.hashmap))}delete(se){return new ne((0,J.remove)(se,this.hashmap))}get(se){return(0,Q.get)(se,this.hashmap)}has(se){return(0,G.has)(se,this.hashmap)}forEach(se){(0,q.forEach)(se,this.hashmap)}map(se){return new ne((0,W.map)(se,this.hashmap))}filter(se){return new ne((0,Y.filter)(se,this.hashmap))}toJS(){return Object.fromEntries(this)}toJSON(){return this.toJS()}keys(){return(0,ee.keys)(this.hashmap)}values(){return(0,Z.values)(this.hashmap)}entries(){return(0,te.entries)(this.hashmap)}[Symbol.iterator](){return this.entries()}}D.Map=ne},"../packages/immutable/dist/index.js":(U,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.Map=void 0;const G=F("../node_modules/typed-immutable-map/dist/HashMap/empty.js"),Q=F("../node_modules/typed-immutable-map/dist/HashMap/from.js"),X=F("../packages/immutable/dist/Map.js"),q=Y=>Symbol.iterator in Y;function W(Y){return Y?q(Y)?new X.Map((0,Q.fromIterable)(Y)):new X.Map((0,Q.fromObject)(Y)):new X.Map((0,G.empty)())}D.Map=W},"../packages/uuid/dist/index.js":function(U,D,F){var G=this&&this.__importDefault||function(X){return X&&X.__esModule?X:{default:X}};Object.defineProperty(D,"__esModule",{value:!0}),D.v4=void 0;const Q=G(F("../node_modules/uuid-random/index.js"));D.v4=Q.default},asynciterator:U=>{U.exports=__QUADSTORE_COMUNICA_EXTERNAL_MODULE_asynciterator__},sparqlalgebrajs:U=>{U.exports=__QUADSTORE_COMUNICA_EXTERNAL_MODULE_sparqlalgebrajs__},sparqljs:U=>{U.exports=__QUADSTORE_COMUNICA_EXTERNAL_MODULE_sparqljs__},"?699d":()=>{},"./require-empty.js":()=>{},"./src/crypto-polyfill.js":(__unused_webpack_module,__unused_webpack_exports,__quadstore_comunica_require__)=>{const isNode=typeof process<"u"&&process.versions!=null&&process.versions.node!=null,polyfillCrypto=({randomFillSync:U})=>{__quadstore_comunica_require__.g.crypto={},__quadstore_comunica_require__.g.crypto.getRandomValues=D=>(U(D),D)};isNode&&typeof crypto>"u"&&(eval("typeof require === 'function'")?polyfillCrypto(eval("require('crypto');")):eval("import('crypto');").then(polyfillCrypto).catch(U=>{console.error(U),process.exit(1)}))},"./src/engine.js":(U,D,F)=>{const G=new(F("../node_modules/@comunica/logger-void/lib/index.js")).LoggerVoid,Q=new(F("../node_modules/@comunica/core/lib/index.js")).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-init/^2.0.0/components/ActorInit.jsonld#ActorInit_default_bus"}),X=new(F("../node_modules/@comunica/core/lib/index.js")).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-context-preprocess/^2.0.0/components/ActorContextPreprocess.jsonld#ActorContextPreprocess_default_bus"}),q=new(F("../node_modules/@comunica/core/lib/index.js")).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-hash-bindings/^2.0.0/components/ActorHashBindings.jsonld#ActorHashBindings_default_bus"}),W=new(F("../node_modules/@comunica/core/lib/index.js")).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-optimize-query-operation/^2.0.0/components/ActorOptimizeQueryOperation.jsonld#ActorOptimizeQueryOperation_default_bus"}),Y=new(F("../node_modules/@comunica/bus-query-operation/lib/index.js")).BusQueryOperation({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-operation/^2.0.0/components/ActorQueryOperation.jsonld#ActorQueryOperation_default_bus"}),J=new(F("../node_modules/@comunica/core/lib/index.js")).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-parse/^2.0.0/components/ActorQueryParse.jsonld#ActorQueryParse_default_bus"}),te=new(F("../node_modules/@comunica/core/lib/index.js")).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-result-serialize/^2.0.0/components/ActorQueryResultSerialize.jsonld#ActorQueryResultSerialize_default_bus"}),Z=new(F("../node_modules/@comunica/core/lib/index.js")).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-http-invalidate/^2.0.0/components/ActorHttpInvalidate.jsonld#ActorHttpInvalidate_default_bus"}),ee=new(F("../node_modules/@comunica/core/lib/index.js")).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-join-entries-sort/^2.0.0/components/ActorRdfJoinEntriesSort.jsonld#ActorRdfJoinEntriesSort_default_bus"}),re=new(F("../node_modules/@comunica/core/lib/index.js")).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-join-selectivity/^2.0.0/components/ActorRdfJoinSelectivity.jsonld#ActorRdfJoinSelectivity_default_bus"}),ne=new(F("../node_modules/@comunica/core/lib/index.js")).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-update-quads/^2.0.0/components/ActorRdfUpdateQuads.jsonld#ActorRdfUpdateQuads_default_bus"}),le=new(F("../node_modules/@comunica/core/lib/index.js")).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-join/^2.0.0/components/ActorRdfJoin.jsonld#ActorRdfJoin_default_bus"}),se=new(F("../node_modules/@comunica/core/lib/index.js")).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-resolve-quad-pattern/^2.0.0/components/ActorRdfResolveQuadPattern.jsonld#ActorRdfResolveQuadPattern_default_bus"});new(F("../node_modules/@comunica/actor-context-preprocess-source-to-destination/lib/index.js")).ActorContextPreprocessSourceToDestination({name:"urn:comunica:default:context-preprocess/actors#source-to-destination",bus:X});const ie=new(F("../node_modules/@comunica/mediator-combine-pipeline/lib/index.js")).MediatorCombinePipeline({name:"urn:comunica:default:context-preprocess/mediators#main",bus:X});new(F("../node_modules/@comunica/actor-hash-bindings-sha1/lib/index.js")).ActorHashBindingsSha1({name:"urn:comunica:default:hash-bindings/actors#sha1",bus:q});const ge=new(F("../node_modules/@comunica/mediator-race/lib/index.js")).MediatorRace({name:"urn:comunica:default:hash-bindings/mediators#main",bus:q}),fe=new(F("../node_modules/@comunica/mediator-combine-pipeline/lib/index.js")).MediatorCombinePipeline({name:"urn:comunica:default:optimize-query-operation/mediators#main",bus:W});new(F("../node_modules/@comunica/actor-optimize-query-operation-join-bgp/lib/index.js")).ActorOptimizeQueryOperationJoinBgp({name:"urn:comunica:default:optimize-query-operation/actors#join-bgp",bus:W}),new(F("../node_modules/@comunica/actor-optimize-query-operation-bgp-to-join/lib/index.js")).ActorOptimizeQueryOperationBgpToJoin({name:"urn:comunica:default:optimize-query-operation/actors#bgp-to-join",bus:W}),new(F("../node_modules/@comunica/actor-optimize-query-operation-join-connected/lib/index.js")).ActorOptimizeQueryOperationJoinConnected({name:"urn:comunica:default:optimize-query-operation/actors#join-connected",bus:W});const ae=new(F("../node_modules/@comunica/mediator-number/lib/index.js")).MediatorNumber({field:"httpRequests",type:"min",ignoreErrors:!0,name:"urn:comunica:default:query-operation/mediators#main",bus:Y});new(F("../node_modules/@comunica/actor-query-operation-values/lib/index.js")).ActorQueryOperationValues({name:"urn:comunica:default:query-operation/actors#values",bus:Y});const ue=new(F("../node_modules/@comunica/mediator-race/lib/index.js")).MediatorRace({name:"urn:comunica:default:query-parse/mediators#main",bus:J});new(F("../node_modules/@comunica/actor-query-parse-sparql/lib/index.js")).ActorQueryParseSparql({prefixes:{dbpedia:"http://dbpedia.org/resource/","dbpedia-owl":"http://dbpedia.org/ontology/",dbpprop:"http://dbpedia.org/property/",dc:"http://purl.org/dc/terms/",dc11:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",owl:"http://www.w3.org/2002/07/owl#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",schema:"http://schema.org/",skos:"http://www.w3.org/2008/05/skos#",xsd:"http://www.w3.org/2001/XMLSchema#"},name:"urn:comunica:default:query-parse/actors#sparql",bus:J});const pe=new(F("../node_modules/@comunica/mediator-race/lib/index.js")).MediatorRace({name:"urn:comunica:default:query-result-serialize/mediators#serialize",bus:te}),_e=new(F("../node_modules/@comunica/mediator-combine-union/lib/index.js")).MediatorCombineUnion({field:"mediaTypes",name:"urn:comunica:default:query-result-serialize/mediators#mediaType",bus:te}),xe=new(F("../node_modules/@comunica/mediator-combine-union/lib/index.js")).MediatorCombineUnion({field:"mediaTypeFormats",name:"urn:comunica:default:query-result-serialize/mediators#mediaTypeFormat",bus:te}),be=new(F("../node_modules/@comunica/mediator-all/lib/index.js")).MediatorAll({name:"urn:comunica:default:http-invalidate/mediators#main",bus:Z});new(F("../node_modules/@comunica/actor-rdf-join-entries-sort-cardinality/lib/index.js")).ActorRdfJoinEntriesSortCardinality({name:"urn:comunica:default:rdf-join-entries-sort/actors#cardinality",bus:ee});const Te=new(F("../node_modules/@comunica/mediator-race/lib/index.js")).MediatorRace({name:"urn:comunica:default:rdf-join-entries-sort/mediators#main",bus:ee});new(F("../node_modules/@comunica/actor-rdf-join-selectivity-variable-counting/lib/index.js")).ActorRdfJoinSelectivityVariableCounting({name:"urn:comunica:default:rdf-join-selectivity/actors#variable-counting",bus:re});const ye=new(F("../node_modules/@comunica/mediator-number/lib/index.js")).MediatorNumber({field:"accuracy",type:"max",ignoreErrors:!0,name:"urn:comunica:default:rdf-join-selectivity/mediators#main",bus:re});new(F("../node_modules/@comunica/actor-rdf-update-quads-rdfjs-store/lib/index.js")).ActorRdfUpdateQuadsRdfJsStore({name:"urn:comunica:default:rdf-update-quads/actors#rdfjs-store",bus:ne});const Ee=new(F("../node_modules/@comunica/mediator-race/lib/index.js")).MediatorRace({name:"urn:comunica:default:rdf-update-quads/mediators#main",bus:ne}),he=new(F("../node_modules/@comunica/mediator-join-coefficients-fixed/lib/index.js")).MediatorJoinCoefficientsFixed({cpuWeight:1,memoryWeight:1,timeWeight:10,ioWeight:100,name:"urn:comunica:default:rdf-join/mediators#main",bus:le}),oe=new(F("../node_modules/@comunica/mediator-race/lib/index.js")).MediatorRace({name:"urn:comunica:default:rdf-resolve-quad-pattern/mediators#main",bus:se});new(F("../node_modules/@comunica/actor-rdf-resolve-quad-pattern-rdfjs-source/lib/index.js")).ActorRdfResolveQuadPatternRdfJsSource({name:"urn:comunica:default:rdf-resolve-quad-pattern/actors#rdfjs-source",bus:se}),new(F("../node_modules/@comunica/actor-query-operation-ask/lib/index.js")).ActorQueryOperationAsk({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#ask",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-bgp-join/lib/index.js")).ActorQueryOperationBgpJoin({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#bgp",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-construct/lib/index.js")).ActorQueryOperationConstruct({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#construct",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-describe-subject/lib/index.js")).ActorQueryOperationDescribeSubject({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#describe",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-distinct-hash/lib/index.js")).ActorQueryOperationDistinctHash({mediatorHashBindings:ge,mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#distinct",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-extend/lib/index.js")).ActorQueryOperationExtend({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#extend",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-filter-sparqlee/lib/index.js")).ActorQueryOperationFilterSparqlee({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#filter",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-from-quad/lib/index.js")).ActorQueryOperationFromQuad({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#from",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-group/lib/index.js")).ActorQueryOperationGroup({mediatorHashBindings:ge,mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#group",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-orderby-sparqlee/lib/index.js")).ActorQueryOperationOrderBySparqlee({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#orderby",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-nop/lib/index.js")).ActorQueryOperationNop({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#nop",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-project/lib/index.js")).ActorQueryOperationProject({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#project",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-reduced-hash/lib/index.js")).ActorQueryOperationReducedHash({mediatorHashBindings:ge,cacheSize:100,mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#reduced",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-service/lib/index.js")).ActorQueryOperationService({forceSparqlEndpoint:!1,mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#service",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-slice/lib/index.js")).ActorQueryOperationSlice({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#slice",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-union/lib/index.js")).ActorQueryOperationUnion({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#union",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-path-alt/lib/index.js")).ActorQueryOperationPathAlt({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#path-alt",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-path-inv/lib/index.js")).ActorQueryOperationPathInv({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#path-inv",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-path-link/lib/index.js")).ActorQueryOperationPathLink({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#path-link",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-path-zero-or-one/lib/index.js")).ActorQueryOperationPathZeroOrOne({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#path-zero-or-one",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-update-add-rewrite/lib/index.js")).ActorQueryOperationAddRewrite({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#update-add",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-path-zero-or-more/lib/index.js")).ActorQueryOperationPathZeroOrMore({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#path-zero-or-more",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-path-one-or-more/lib/index.js")).ActorQueryOperationPathOneOrMore({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#path-one-or-more",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-update-compositeupdate/lib/index.js")).ActorQueryOperationUpdateCompositeUpdate({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#update-composite",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-path-nps/lib/index.js")).ActorQueryOperationPathNps({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#path-nps",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-update-copy-rewrite/lib/index.js")).ActorQueryOperationCopyRewrite({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#update-copy",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-update-move-rewrite/lib/index.js")).ActorQueryOperationMoveRewrite({mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#update-move",bus:Y});const me=new(F("../node_modules/@comunica/actor-init-query/lib/index-browser.js")).ActorInitQuery({mediatorOptimizeQueryOperation:fe,mediatorQueryOperation:ae,mediatorQueryParse:ue,mediatorQueryResultSerialize:pe,mediatorQueryResultSerializeMediaTypeCombiner:_e,mediatorQueryResultSerializeMediaTypeFormatCombiner:xe,mediatorContextPreprocess:ie,mediatorHttpInvalidate:be,logger:G,defaultQueryInputFormat:"sparql",allowNoSources:!1,contextKeyShortcuts:{baseIRI:"@comunica/actor-init-query:baseIRI",datetime:"@comunica/actor-http-memento:datetime",destination:"@comunica/bus-rdf-update-quads:destination",explain:"@comunica/actor-init-query:explain",extensionFunctionCreator:"@comunica/actor-init-query:extensionFunctionCreator",extensionFunctions:"@comunica/actor-init-query:extensionFunctions",fetch:"@comunica/bus-http:fetch",functionArgumentsCache:"@comunica/actor-init-query:functionArgumentsCache",httpAuth:"@comunica/bus-http:auth",httpBodyTimeout:"@comunica/bus-http:http-body-timeout",httpIncludeCredentials:"@comunica/bus-http:include-credentials",httpProxyHandler:"@comunica/actor-http-proxy:httpProxyHandler",httpRetryCount:"@comunica/bus-http:http-retry-count",httpRetryDelay:"@comunica/bus-http:http-retry-delay",httpRetryOnServerError:"@comunica/bus-http:http-retry-on-server-error",httpTimeout:"@comunica/bus-http:http-timeout",initialBindings:"@comunica/actor-init-query:initialBindings",lenient:"@comunica/actor-init-query:lenient",localizeBlankNodes:"@comunica/actor-query-operation:localizeBlankNodes",log:"@comunica/core:log",queryFormat:"@comunica/actor-init-query:queryFormat",queryTimestamp:"@comunica/actor-init-query:queryTimestamp",readOnly:"@comunica/bus-query-operation:readOnly",recoverBrokenLinks:"@comunica/bus-http-wayback:recover-broken-links",source:"@comunica/bus-rdf-resolve-quad-pattern:source",sources:"@comunica/bus-rdf-resolve-quad-pattern:sources",unionDefaultGraph:"@comunica/bus-query-operation:unionDefaultGraph"},name:"urn:comunica:default:init/actors#query",bus:Q});new(F("../node_modules/@comunica/actor-rdf-join-inner-none/lib/index.js")).ActorRdfJoinNone({mediatorJoinSelectivity:ye,name:"urn:comunica:default:rdf-join/actors#inner-none",bus:le}),new(F("../node_modules/@comunica/actor-rdf-join-inner-single/lib/index.js")).ActorRdfJoinSingle({mediatorJoinSelectivity:ye,name:"urn:comunica:default:rdf-join/actors#inner-single",bus:le}),new(F("../node_modules/@comunica/actor-rdf-join-inner-multi-empty/lib/index.js")).ActorRdfJoinMultiEmpty({mediatorJoinSelectivity:ye,name:"urn:comunica:default:rdf-join/actors#inner-multi-empty",bus:le}),new(F("../node_modules/@comunica/actor-rdf-join-inner-multi-bind/lib/index.js")).ActorRdfJoinMultiBind({bindOrder:"depth-first",selectivityModifier:1e-4,mediatorJoinEntriesSort:Te,mediatorQueryOperation:ae,mediatorJoinSelectivity:ye,name:"urn:comunica:default:rdf-join/actors#inner-multi-bind",bus:le}),new(F("../node_modules/@comunica/actor-rdf-join-inner-hash/lib/index.js")).ActorRdfJoinHash({mediatorJoinSelectivity:ye,name:"urn:comunica:default:rdf-join/actors#inner-hash",bus:le}),new(F("../node_modules/@comunica/actor-rdf-join-inner-symmetrichash/lib/index.js")).ActorRdfJoinSymmetricHash({mediatorJoinSelectivity:ye,name:"urn:comunica:default:rdf-join/actors#inner-symmetric-hash",bus:le}),new(F("../node_modules/@comunica/actor-rdf-join-inner-nestedloop/lib/index.js")).ActorRdfJoinNestedLoop({mediatorJoinSelectivity:ye,name:"urn:comunica:default:rdf-join/actors#inner-nested-loop",bus:le}),new(F("../node_modules/@comunica/actor-rdf-join-optional-bind/lib/index.js")).ActorRdfJoinOptionalBind({bindOrder:"depth-first",selectivityModifier:1e-4,mediatorQueryOperation:ae,mediatorJoinSelectivity:ye,name:"urn:comunica:default:rdf-join/actors#optional-bind",bus:le}),new(F("../node_modules/@comunica/actor-rdf-join-optional-nestedloop/lib/index.js")).ActorRdfJoinOptionalNestedLoop({mediatorJoinSelectivity:ye,name:"urn:comunica:default:rdf-join/actors#optional-nested-loop",bus:le}),new(F("../node_modules/@comunica/actor-rdf-join-minus-hash/lib/index.js")).ActorRdfJoinMinusHash({mediatorJoinSelectivity:ye,name:"urn:comunica:default:rdf-join/actors#minus-hash",bus:le}),new(F("../node_modules/@comunica/actor-rdf-join-minus-hash-undef/lib/index.js")).ActorRdfJoinMinusHashUndef({mediatorJoinSelectivity:ye,name:"urn:comunica:default:rdf-join/actors#minus-hash-undef",bus:le}),new(F("../node_modules/@comunica/actor-query-operation-update-clear/lib/index.js")).ActorQueryOperationClear({mediatorUpdateQuads:Ee,mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#update-clear",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-update-create/lib/index.js")).ActorQueryOperationCreate({mediatorUpdateQuads:Ee,mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#update-create",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-update-deleteinsert/lib/index.js")).ActorQueryOperationUpdateDeleteInsert({mediatorUpdateQuads:Ee,mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#update-delete-insert",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-update-drop/lib/index.js")).ActorQueryOperationDrop({mediatorUpdateQuads:Ee,mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#update-drop",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-update-load/lib/index.js")).ActorQueryOperationLoad({mediatorUpdateQuads:Ee,mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#update-load",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-join/lib/index.js")).ActorQueryOperationJoin({mediatorJoin:he,mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#join",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-leftjoin/lib/index.js")).ActorQueryOperationLeftJoin({mediatorJoin:he,mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#leftjoin",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-minus/lib/index.js")).ActorQueryOperationMinus({mediatorJoin:he,mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#minus",bus:Y}),new(F("../node_modules/@comunica/actor-query-operation-path-seq/lib/index.js")).ActorQueryOperationPathSeq({mediatorJoin:he,mediatorQueryOperation:ae,name:"urn:comunica:default:query-operation/actors#path-seq",bus:Y}),new(F("../node_modules/@comunica/actor-rdf-join-inner-multi-smallest/lib/index.js")).ActorRdfJoinMultiSmallest({mediatorJoinEntriesSort:Te,mediatorJoin:he,mediatorJoinSelectivity:ye,name:"urn:comunica:default:rdf-join/actors#inner-multi-smallest",bus:le}),new(F("../node_modules/@comunica/actor-query-operation-quadpattern/lib/index.js")).ActorQueryOperationQuadpattern({mediatorResolveQuadPattern:oe,unionDefaultGraph:!1,name:"urn:comunica:default:query-operation/actors#quadpattern",bus:Y}),new(F("../node_modules/@comunica/actor-rdf-resolve-quad-pattern-federated/lib/index.js")).ActorRdfResolveQuadPatternFederated({mediatorResolveQuadPattern:oe,skipEmptyPatterns:!1,name:"urn:comunica:default:rdf-resolve-quad-pattern/actors#federated",bus:se}),U.exports=me},"./src/index.js":(U,D,F)=>{F("./src/crypto-polyfill.js");const{QueryEngineBase:G}=F("../node_modules/@comunica/actor-init-query/lib/index-browser.js"),Q=new G(F("./src/engine.js")),X=Object.create(null);class q{constructor(Y){this.store=Y,this.engine=Q}getContext(Y){return{...Y,source:this.store,destination:this.store}}query(Y,J=X){return Q.query(Y,this.getContext(J))}queryVoid(Y,J=X){return Q.queryVoid(Y,this.getContext(J))}queryBindings(Y,J=X){return Q.queryBindings(Y,this.getContext(J))}queryQuads(Y,J=X){return Q.queryQuads(Y,this.getContext(J))}queryBoolean(Y,J=X){return Q.queryBoolean(Y,this.getContext(J))}}U.exports.D=q,U.exports.H=Q},"../node_modules/@comunica/actor-query-operation-reduced-hash/node_modules/lru-cache/index.js":U=>{const D=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,G=typeof AbortController=="function"?AbortController:class{constructor(){this.signal=new q}abort(ae=new Error("This operation was aborted")){this.signal.reason=this.signal.reason||ae,this.signal.aborted=!0,this.signal.dispatchEvent({type:"abort",target:this.signal})}},Q=typeof AbortSignal=="function",X=typeof G.AbortSignal=="function",q=Q?AbortSignal:X?G.AbortController:class{constructor(){this.reason=void 0,this.aborted=!1,this._listeners=[]}dispatchEvent(ae){ae.type==="abort"&&(this.aborted=!0,this.onabort(ae),this._listeners.forEach(ue=>ue(ae),this))}onabort(){}addEventListener(ae,ue){ae==="abort"&&this._listeners.push(ue)}removeEventListener(ae,ue){ae==="abort"&&(this._listeners=this._listeners.filter(pe=>pe!==ue))}},W=new Set,Y=(fe,ae)=>{const ue=`LRU_CACHE_OPTION_${fe}`;ee(ue)&&re(ue,`${fe} option`,`options.${ae}`,ge)},J=(fe,ae)=>{const ue=`LRU_CACHE_METHOD_${fe}`;if(ee(ue)){const{prototype:pe}=ge,{get:_e}=Object.getOwnPropertyDescriptor(pe,fe);re(ue,`${fe} method`,`cache.${ae}()`,_e)}},te=(fe,ae)=>{const ue=`LRU_CACHE_PROPERTY_${fe}`;if(ee(ue)){const{prototype:pe}=ge,{get:_e}=Object.getOwnPropertyDescriptor(pe,fe);re(ue,`${fe} property`,`cache.${ae}`,_e)}},Z=(...fe)=>{typeof process=="object"&&process&&typeof process.emitWarning=="function"?process.emitWarning(...fe):console.error(...fe)},ee=fe=>!W.has(fe),re=(fe,ae,ue,pe)=>{W.add(fe);const _e=`The ${ae} is deprecated. Please use ${ue} instead.`;Z(_e,"DeprecationWarning",fe,pe)},ne=fe=>fe&&fe===Math.floor(fe)&&fe>0&&isFinite(fe),le=fe=>ne(fe)?fe<=Math.pow(2,8)?Uint8Array:fe<=Math.pow(2,16)?Uint16Array:fe<=Math.pow(2,32)?Uint32Array:fe<=Number.MAX_SAFE_INTEGER?se:null:null;class se extends Array{constructor(ae){super(ae),this.fill(0)}}class ie{constructor(ae){if(ae===0)return[];const ue=le(ae);this.heap=new ue(ae),this.length=0}push(ae){this.heap[this.length++]=ae}pop(){return this.heap[--this.length]}}class ge{constructor(ae={}){const{max:ue=0,ttl:pe,ttlResolution:_e=1,ttlAutopurge:xe,updateAgeOnGet:be,updateAgeOnHas:Te,allowStale:ye,dispose:Ee,disposeAfter:he,noDisposeOnSet:oe,noUpdateTTL:me,maxSize:ve=0,maxEntrySize:we=0,sizeCalculation:Pe,fetchMethod:Me,fetchContext:De,noDeleteOnFetchRejection:Oe,noDeleteOnStaleGet:Ie,allowStaleOnFetchRejection:Be,allowStaleOnFetchAbort:ze,ignoreFetchAbort:et}=ae,{length:qe,maxAge:je,stale:it}=ae instanceof ge?{}:ae;if(ue!==0&&!ne(ue))throw new TypeError("max option must be a nonnegative integer");const ct=ue?le(ue):Array;if(!ct)throw new Error("invalid max value: "+ue);if(this.max=ue,this.maxSize=ve,this.maxEntrySize=we||this.maxSize,this.sizeCalculation=Pe||qe,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=Me||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=De,!this.fetchMethod&&De!==void 0)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(ue).fill(null),this.valList=new Array(ue).fill(null),this.next=new ct(ue),this.prev=new ct(ue),this.head=0,this.tail=0,this.free=new ie(ue),this.initialFill=1,this.size=0,typeof Ee=="function"&&(this.dispose=Ee),typeof he=="function"?(this.disposeAfter=he,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!oe,this.noUpdateTTL=!!me,this.noDeleteOnFetchRejection=!!Oe,this.allowStaleOnFetchRejection=!!Be,this.allowStaleOnFetchAbort=!!ze,this.ignoreFetchAbort=!!et,this.maxEntrySize!==0){if(this.maxSize!==0&&!ne(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!ne(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!ye||!!it,this.noDeleteOnStaleGet=!!Ie,this.updateAgeOnGet=!!be,this.updateAgeOnHas=!!Te,this.ttlResolution=ne(_e)||_e===0?_e:1,this.ttlAutopurge=!!xe,this.ttl=pe||je||0,this.ttl){if(!ne(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const rt="LRU_CACHE_UNBOUNDED";ee(rt)&&(W.add(rt),Z("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",rt,ge))}it&&Y("stale","allowStale"),je&&Y("maxAge","ttl"),qe&&Y("length","sizeCalculation")}getRemainingTTL(ae){return this.has(ae,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new se(this.max),this.starts=new se(this.max),this.setItemTTL=(pe,_e,xe=D.now())=>{if(this.starts[pe]=_e!==0?xe:0,this.ttls[pe]=_e,_e!==0&&this.ttlAutopurge){const be=setTimeout(()=>{this.isStale(pe)&&this.delete(this.keyList[pe])},_e+1);be.unref&&be.unref()}},this.updateItemAge=pe=>{this.starts[pe]=this.ttls[pe]!==0?D.now():0},this.statusTTL=(pe,_e)=>{pe&&(pe.ttl=this.ttls[_e],pe.start=this.starts[_e],pe.now=ae||ue(),pe.remainingTTL=pe.now+pe.ttl-pe.start)};let ae=0;const ue=()=>{const pe=D.now();if(this.ttlResolution>0){ae=pe;const _e=setTimeout(()=>ae=0,this.ttlResolution);_e.unref&&_e.unref()}return pe};this.getRemainingTTL=pe=>{const _e=this.keyMap.get(pe);return _e===void 0?0:this.ttls[_e]===0||this.starts[_e]===0?1/0:this.starts[_e]+this.ttls[_e]-(ae||ue())},this.isStale=pe=>this.ttls[pe]!==0&&this.starts[pe]!==0&&(ae||ue())-this.starts[pe]>this.ttls[pe]}updateItemAge(ae){}statusTTL(ae,ue){}setItemTTL(ae,ue,pe){}isStale(ae){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new se(this.max),this.removeItemSize=ae=>{this.calculatedSize-=this.sizes[ae],this.sizes[ae]=0},this.requireSize=(ae,ue,pe,_e)=>{if(this.isBackgroundFetch(ue))return 0;if(!ne(pe))if(_e){if(typeof _e!="function")throw new TypeError("sizeCalculation must be a function");if(pe=_e(ue,ae),!ne(pe))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return pe},this.addItemSize=(ae,ue,pe)=>{if(this.sizes[ae]=ue,this.maxSize){const _e=this.maxSize-this.sizes[ae];for(;this.calculatedSize>_e;)this.evict(!0)}this.calculatedSize+=this.sizes[ae],pe&&(pe.entrySize=ue,pe.totalCalculatedSize=this.calculatedSize)}}removeItemSize(ae){}addItemSize(ae,ue){}requireSize(ae,ue,pe,_e){if(pe||_e)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:ae=this.allowStale}={}){if(this.size)for(let ue=this.tail;!(!this.isValidIndex(ue)||((ae||!this.isStale(ue))&&(yield ue),ue===this.head));)ue=this.prev[ue]}*rindexes({allowStale:ae=this.allowStale}={}){if(this.size)for(let ue=this.head;!(!this.isValidIndex(ue)||((ae||!this.isStale(ue))&&(yield ue),ue===this.tail));)ue=this.next[ue]}isValidIndex(ae){return ae!==void 0&&this.keyMap.get(this.keyList[ae])===ae}*entries(){for(const ae of this.indexes())this.valList[ae]!==void 0&&this.keyList[ae]!==void 0&&!this.isBackgroundFetch(this.valList[ae])&&(yield[this.keyList[ae],this.valList[ae]])}*rentries(){for(const ae of this.rindexes())this.valList[ae]!==void 0&&this.keyList[ae]!==void 0&&!this.isBackgroundFetch(this.valList[ae])&&(yield[this.keyList[ae],this.valList[ae]])}*keys(){for(const ae of this.indexes())this.keyList[ae]!==void 0&&!this.isBackgroundFetch(this.valList[ae])&&(yield this.keyList[ae])}*rkeys(){for(const ae of this.rindexes())this.keyList[ae]!==void 0&&!this.isBackgroundFetch(this.valList[ae])&&(yield this.keyList[ae])}*values(){for(const ae of this.indexes())this.valList[ae]!==void 0&&!this.isBackgroundFetch(this.valList[ae])&&(yield this.valList[ae])}*rvalues(){for(const ae of this.rindexes())this.valList[ae]!==void 0&&!this.isBackgroundFetch(this.valList[ae])&&(yield this.valList[ae])}[Symbol.iterator](){return this.entries()}find(ae,ue){for(const pe of this.indexes()){const _e=this.valList[pe],xe=this.isBackgroundFetch(_e)?_e.__staleWhileFetching:_e;if(xe!==void 0&&ae(xe,this.keyList[pe],this))return this.get(this.keyList[pe],ue)}}forEach(ae,ue=this){for(const pe of this.indexes()){const _e=this.valList[pe],xe=this.isBackgroundFetch(_e)?_e.__staleWhileFetching:_e;xe!==void 0&&ae.call(ue,xe,this.keyList[pe],this)}}rforEach(ae,ue=this){for(const pe of this.rindexes()){const _e=this.valList[pe],xe=this.isBackgroundFetch(_e)?_e.__staleWhileFetching:_e;xe!==void 0&&ae.call(ue,xe,this.keyList[pe],this)}}get prune(){return J("prune","purgeStale"),this.purgeStale}purgeStale(){let ae=!1;for(const ue of this.rindexes({allowStale:!0}))this.isStale(ue)&&(this.delete(this.keyList[ue]),ae=!0);return ae}dump(){const ae=[];for(const ue of this.indexes({allowStale:!0})){const pe=this.keyList[ue],_e=this.valList[ue],xe=this.isBackgroundFetch(_e)?_e.__staleWhileFetching:_e;if(xe===void 0)continue;const be={value:xe};if(this.ttls){be.ttl=this.ttls[ue];const Te=D.now()-this.starts[ue];be.start=Math.floor(Date.now()-Te)}this.sizes&&(be.size=this.sizes[ue]),ae.unshift([pe,be])}return ae}load(ae){this.clear();for(const[ue,pe]of ae){if(pe.start){const _e=Date.now()-pe.start;pe.start=D.now()-_e}this.set(ue,pe.value,pe)}}dispose(ae,ue,pe){}set(ae,ue,{ttl:pe=this.ttl,start:_e,noDisposeOnSet:xe=this.noDisposeOnSet,size:be=0,sizeCalculation:Te=this.sizeCalculation,noUpdateTTL:ye=this.noUpdateTTL,status:Ee}={}){if(be=this.requireSize(ae,ue,be,Te),this.maxEntrySize&&be>this.maxEntrySize)return Ee&&(Ee.set="miss",Ee.maxEntrySizeExceeded=!0),this.delete(ae),this;let he=this.size===0?void 0:this.keyMap.get(ae);if(he===void 0)he=this.newIndex(),this.keyList[he]=ae,this.valList[he]=ue,this.keyMap.set(ae,he),this.next[this.tail]=he,this.prev[he]=this.tail,this.tail=he,this.size++,this.addItemSize(he,be,Ee),Ee&&(Ee.set="add"),ye=!1;else{this.moveToTail(he);const oe=this.valList[he];if(ue!==oe){if(this.isBackgroundFetch(oe)?oe.__abortController.abort(new Error("replaced")):xe||(this.dispose(oe,ae,"set"),this.disposeAfter&&this.disposed.push([oe,ae,"set"])),this.removeItemSize(he),this.valList[he]=ue,this.addItemSize(he,be,Ee),Ee){Ee.set="replace";const me=oe&&this.isBackgroundFetch(oe)?oe.__staleWhileFetching:oe;me!==void 0&&(Ee.oldValue=me)}}else Ee&&(Ee.set="update")}if(pe!==0&&this.ttl===0&&!this.ttls&&this.initializeTTLTracking(),ye||this.setItemTTL(he,pe,_e),this.statusTTL(Ee,he),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max&&this.max!==0?this.evict(!1):this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){const ae=this.valList[this.head];return this.evict(!0),ae}}evict(ae){const ue=this.head,pe=this.keyList[ue],_e=this.valList[ue];return this.isBackgroundFetch(_e)?_e.__abortController.abort(new Error("evicted")):(this.dispose(_e,pe,"evict"),this.disposeAfter&&this.disposed.push([_e,pe,"evict"])),this.removeItemSize(ue),ae&&(this.keyList[ue]=null,this.valList[ue]=null,this.free.push(ue)),this.head=this.next[ue],this.keyMap.delete(pe),this.size--,ue}has(ae,{updateAgeOnHas:ue=this.updateAgeOnHas,status:pe}={}){const _e=this.keyMap.get(ae);if(_e!==void 0)if(this.isStale(_e))pe&&(pe.has="stale",this.statusTTL(pe,_e));else return ue&&this.updateItemAge(_e),pe&&(pe.has="hit"),this.statusTTL(pe,_e),!0;else pe&&(pe.has="miss");return!1}peek(ae,{allowStale:ue=this.allowStale}={}){const pe=this.keyMap.get(ae);if(pe!==void 0&&(ue||!this.isStale(pe))){const _e=this.valList[pe];return this.isBackgroundFetch(_e)?_e.__staleWhileFetching:_e}}backgroundFetch(ae,ue,pe,_e){const xe=ue===void 0?void 0:this.valList[ue];if(this.isBackgroundFetch(xe))return xe;const be=new G;pe.signal&&pe.signal.addEventListener("abort",()=>be.abort(pe.signal.reason));const Te={signal:be.signal,options:pe,context:_e},ye=(ve,we=!1)=>{const{aborted:Pe}=be.signal,Me=pe.ignoreFetchAbort&&ve!==void 0;return pe.status&&(Pe&&!we?(pe.status.fetchAborted=!0,pe.status.fetchError=be.signal.reason,Me&&(pe.status.fetchAbortIgnored=!0)):pe.status.fetchResolved=!0),Pe&&!Me&&!we?he(be.signal.reason):(this.valList[ue]===me&&(ve===void 0?me.__staleWhileFetching?this.valList[ue]=me.__staleWhileFetching:this.delete(ae):(pe.status&&(pe.status.fetchUpdated=!0),this.set(ae,ve,Te.options))),ve)},Ee=ve=>(pe.status&&(pe.status.fetchRejected=!0,pe.status.fetchError=ve),he(ve)),he=ve=>{const{aborted:we}=be.signal,Pe=we&&pe.allowStaleOnFetchAbort,Me=Pe||pe.allowStaleOnFetchRejection,De=Me||pe.noDeleteOnFetchRejection;if(this.valList[ue]===me&&(!De||me.__staleWhileFetching===void 0?this.delete(ae):Pe||(this.valList[ue]=me.__staleWhileFetching)),Me)return pe.status&&me.__staleWhileFetching!==void 0&&(pe.status.returnedStale=!0),me.__staleWhileFetching;if(me.__returned===me)throw ve},oe=(ve,we)=>{this.fetchMethod(ae,xe,Te).then(Pe=>ve(Pe),we),be.signal.addEventListener("abort",()=>{(!pe.ignoreFetchAbort||pe.allowStaleOnFetchAbort)&&(ve(),pe.allowStaleOnFetchAbort&&(ve=Pe=>ye(Pe,!0)))})};pe.status&&(pe.status.fetchDispatched=!0);const me=new Promise(oe).then(ye,Ee);return me.__abortController=be,me.__staleWhileFetching=xe,me.__returned=null,ue===void 0?(this.set(ae,me,{...Te.options,status:void 0}),ue=this.keyMap.get(ae)):this.valList[ue]=me,me}isBackgroundFetch(ae){return ae&&typeof ae=="object"&&typeof ae.then=="function"&&Object.prototype.hasOwnProperty.call(ae,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(ae,"__returned")&&(ae.__returned===ae||ae.__returned===null)}async fetch(ae,{allowStale:ue=this.allowStale,updateAgeOnGet:pe=this.updateAgeOnGet,noDeleteOnStaleGet:_e=this.noDeleteOnStaleGet,ttl:xe=this.ttl,noDisposeOnSet:be=this.noDisposeOnSet,size:Te=0,sizeCalculation:ye=this.sizeCalculation,noUpdateTTL:Ee=this.noUpdateTTL,noDeleteOnFetchRejection:he=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:oe=this.allowStaleOnFetchRejection,ignoreFetchAbort:me=this.ignoreFetchAbort,allowStaleOnFetchAbort:ve=this.allowStaleOnFetchAbort,fetchContext:we=this.fetchContext,forceRefresh:Pe=!1,status:Me,signal:De}={}){if(!this.fetchMethod)return Me&&(Me.fetch="get"),this.get(ae,{allowStale:ue,updateAgeOnGet:pe,noDeleteOnStaleGet:_e,status:Me});const Oe={allowStale:ue,updateAgeOnGet:pe,noDeleteOnStaleGet:_e,ttl:xe,noDisposeOnSet:be,size:Te,sizeCalculation:ye,noUpdateTTL:Ee,noDeleteOnFetchRejection:he,allowStaleOnFetchRejection:oe,allowStaleOnFetchAbort:ve,ignoreFetchAbort:me,status:Me,signal:De};let Ie=this.keyMap.get(ae);if(Ie===void 0){Me&&(Me.fetch="miss");const Be=this.backgroundFetch(ae,Ie,Oe,we);return Be.__returned=Be}else{const Be=this.valList[Ie];if(this.isBackgroundFetch(Be)){const it=ue&&Be.__staleWhileFetching!==void 0;return Me&&(Me.fetch="inflight",it&&(Me.returnedStale=!0)),it?Be.__staleWhileFetching:Be.__returned=Be}const ze=this.isStale(Ie);if(!Pe&&!ze)return Me&&(Me.fetch="hit"),this.moveToTail(Ie),pe&&this.updateItemAge(Ie),this.statusTTL(Me,Ie),Be;const et=this.backgroundFetch(ae,Ie,Oe,we),qe=et.__staleWhileFetching!==void 0,je=qe&&ue;return Me&&(Me.fetch=qe&&ze?"stale":"refresh",je&&ze&&(Me.returnedStale=!0)),je?et.__staleWhileFetching:et.__returned=et}}get(ae,{allowStale:ue=this.allowStale,updateAgeOnGet:pe=this.updateAgeOnGet,noDeleteOnStaleGet:_e=this.noDeleteOnStaleGet,status:xe}={}){const be=this.keyMap.get(ae);if(be!==void 0){const Te=this.valList[be],ye=this.isBackgroundFetch(Te);return this.statusTTL(xe,be),this.isStale(be)?(xe&&(xe.get="stale"),ye?(xe&&(xe.returnedStale=ue&&Te.__staleWhileFetching!==void 0),ue?Te.__staleWhileFetching:void 0):(_e||this.delete(ae),xe&&(xe.returnedStale=ue),ue?Te:void 0)):(xe&&(xe.get="hit"),ye?Te.__staleWhileFetching:(this.moveToTail(be),pe&&this.updateItemAge(be),Te))}else xe&&(xe.get="miss")}connect(ae,ue){this.prev[ue]=ae,this.next[ae]=ue}moveToTail(ae){ae!==this.tail&&(ae===this.head?this.head=this.next[ae]:this.connect(this.prev[ae],this.next[ae]),this.connect(this.tail,ae),this.tail=ae)}get del(){return J("del","delete"),this.delete}delete(ae){let ue=!1;if(this.size!==0){const pe=this.keyMap.get(ae);if(pe!==void 0)if(ue=!0,this.size===1)this.clear();else{this.removeItemSize(pe);const _e=this.valList[pe];this.isBackgroundFetch(_e)?_e.__abortController.abort(new Error("deleted")):(this.dispose(_e,ae,"delete"),this.disposeAfter&&this.disposed.push([_e,ae,"delete"])),this.keyMap.delete(ae),this.keyList[pe]=null,this.valList[pe]=null,pe===this.tail?this.tail=this.prev[pe]:pe===this.head?this.head=this.next[pe]:(this.next[this.prev[pe]]=this.next[pe],this.prev[this.next[pe]]=this.prev[pe]),this.size--,this.free.push(pe)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return ue}clear(){for(const ae of this.rindexes({allowStale:!0})){const ue=this.valList[ae];if(this.isBackgroundFetch(ue))ue.__abortController.abort(new Error("deleted"));else{const pe=this.keyList[ae];this.dispose(ue,pe,"delete"),this.disposeAfter&&this.disposed.push([ue,pe,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return J("reset","clear"),this.clear}get length(){return te("length","size"),this.size}static get AbortController(){return G}static get AbortSignal(){return q}}U.exports=ge}},__quadstore_comunica_module_cache__={};function __quadstore_comunica_require__(U){var D=__quadstore_comunica_module_cache__[U];if(D!==void 0)return D.exports;var F=__quadstore_comunica_module_cache__[U]={exports:{}};return __quadstore_comunica_modules__[U].call(F.exports,F,F.exports,__quadstore_comunica_require__),F.exports}__quadstore_comunica_require__.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var __quadstore_comunica_exports__=__quadstore_comunica_require__("./src/index.js"),__quadstore_comunica_exports__Engine=__quadstore_comunica_exports__.D;__quadstore_comunica_exports__.H;const DEPENDS_ON="http://dat-ecosystem.org#dependson",OWNS="http://dat-ecosystem.org#owns",directDependentsQuery=U=>`
  PREFIX dependson: <http://dat-ecosystem.org#dependson>
  SELECT DISTINCT ?dependent WHERE {
    ?dependent dependson: <${U}> .
  }`,directDependenciesQuery=U=>`
  PREFIX dependson: <http://dat-ecosystem.org#dependson>
  SELECT DISTINCT ?dependency WHERE {
    <${U}> dependson: ?dependency .
  }`;var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global;const freeGlobal$1=freeGlobal;var freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root$1=freeGlobal$1||freeSelf||Function("return this")();const root$2=root$1;var Symbol$1=root$2.Symbol;const Symbol$2=Symbol$1;var objectProto$4=Object.prototype,hasOwnProperty$4=objectProto$4.hasOwnProperty,nativeObjectToString$1=objectProto$4.toString,symToStringTag$1=Symbol$2?Symbol$2.toStringTag:void 0;function getRawTag(U){var D=hasOwnProperty$4.call(U,symToStringTag$1),F=U[symToStringTag$1];try{U[symToStringTag$1]=void 0;var G=!0}catch{}var Q=nativeObjectToString$1.call(U);return G&&(D?U[symToStringTag$1]=F:delete U[symToStringTag$1]),Q}var objectProto$3=Object.prototype,nativeObjectToString=objectProto$3.toString;function objectToString(U){return nativeObjectToString.call(U)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$2?Symbol$2.toStringTag:void 0;function baseGetTag(U){return U==null?U===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(U)?getRawTag(U):objectToString(U)}function isObjectLike(U){return U!=null&&typeof U=="object"}var symbolTag="[object Symbol]";function isSymbol(U){return typeof U=="symbol"||isObjectLike(U)&&baseGetTag(U)==symbolTag}var reWhitespace=/\s/;function trimmedEndIndex(U){for(var D=U.length;D--&&reWhitespace.test(U.charAt(D)););return D}var reTrimStart=/^\s+/;function baseTrim(U){return U&&U.slice(0,trimmedEndIndex(U)+1).replace(reTrimStart,"")}function isObject(U){var D=typeof U;return U!=null&&(D=="object"||D=="function")}var NAN=0/0,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(U){if(typeof U=="number")return U;if(isSymbol(U))return NAN;if(isObject(U)){var D=typeof U.valueOf=="function"?U.valueOf():U;U=isObject(D)?D+"":D}if(typeof U!="string")return U===0?U:+U;U=baseTrim(U);var F=reIsBinary.test(U);return F||reIsOctal.test(U)?freeParseInt(U.slice(2),F?2:8):reIsBadHex.test(U)?NAN:+U}function identity$2(U){return U}var asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(U){if(!isObject(U))return!1;var D=baseGetTag(U);return D==funcTag||D==genTag||D==asyncTag||D==proxyTag}var coreJsData=root$2["__core-js_shared__"];const coreJsData$1=coreJsData;var maskSrcKey=function(){var U=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return U?"Symbol(src)_1."+U:""}();function isMasked(U){return!!maskSrcKey&&maskSrcKey in U}var funcProto$1=Function.prototype,funcToString$1=funcProto$1.toString;function toSource(U){if(U!=null){try{return funcToString$1.call(U)}catch{}try{return U+""}catch{}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto$2=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$3=objectProto$2.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty$3).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(U){if(!isObject(U)||isMasked(U))return!1;var D=isFunction(U)?reIsNative:reIsHostCtor;return D.test(toSource(U))}function getValue(U,D){return U?.[D]}function getNative(U,D){var F=getValue(U,D);return baseIsNative(F)?F:void 0}function noop$2(){}function baseFindIndex(U,D,F,G){for(var Q=U.length,X=F+(G?1:-1);G?X--:++X<Q;)if(D(U[X],X,U))return X;return-1}function baseIsNaN(U){return U!==U}function strictIndexOf(U,D,F){for(var G=F-1,Q=U.length;++G<Q;)if(U[G]===D)return G;return-1}function baseIndexOf(U,D,F){return D===D?strictIndexOf(U,D,F):baseFindIndex(U,baseIsNaN,F)}function arrayIncludes(U,D){var F=U==null?0:U.length;return!!F&&baseIndexOf(U,D,0)>-1}function eq(U,D){return U===D||U!==U&&D!==D}var nativeCreate=getNative(Object,"create");const nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete(U){var D=this.has(U)&&delete this.__data__[U];return this.size-=D?1:0,D}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$1=Object.prototype,hasOwnProperty$2=objectProto$1.hasOwnProperty;function hashGet(U){var D=this.__data__;if(nativeCreate$1){var F=D[U];return F===HASH_UNDEFINED$2?void 0:F}return hasOwnProperty$2.call(D,U)?D[U]:void 0}var objectProto=Object.prototype,hasOwnProperty$1=objectProto.hasOwnProperty;function hashHas(U){var D=this.__data__;return nativeCreate$1?D[U]!==void 0:hasOwnProperty$1.call(D,U)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(U,D){var F=this.__data__;return this.size+=this.has(U)?0:1,F[U]=nativeCreate$1&&D===void 0?HASH_UNDEFINED$1:D,this}function Hash(U){var D=-1,F=U==null?0:U.length;for(this.clear();++D<F;){var G=U[D];this.set(G[0],G[1])}}Hash.prototype.clear=hashClear;Hash.prototype.delete=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(U,D){for(var F=U.length;F--;)if(eq(U[F][0],D))return F;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(U){var D=this.__data__,F=assocIndexOf(D,U);if(F<0)return!1;var G=D.length-1;return F==G?D.pop():splice.call(D,F,1),--this.size,!0}function listCacheGet(U){var D=this.__data__,F=assocIndexOf(D,U);return F<0?void 0:D[F][1]}function listCacheHas(U){return assocIndexOf(this.__data__,U)>-1}function listCacheSet(U,D){var F=this.__data__,G=assocIndexOf(F,U);return G<0?(++this.size,F.push([U,D])):F[G][1]=D,this}function ListCache(U){var D=-1,F=U==null?0:U.length;for(this.clear();++D<F;){var G=U[D];this.set(G[0],G[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype.delete=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative(root$2,"Map");const Map$2=Map$1;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$2||ListCache),string:new Hash}}function isKeyable(U){var D=typeof U;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?U!=="__proto__":U===null}function getMapData(U,D){var F=U.__data__;return isKeyable(D)?F[typeof D=="string"?"string":"hash"]:F.map}function mapCacheDelete(U){var D=getMapData(this,U).delete(U);return this.size-=D?1:0,D}function mapCacheGet(U){return getMapData(this,U).get(U)}function mapCacheHas(U){return getMapData(this,U).has(U)}function mapCacheSet(U,D){var F=getMapData(this,U),G=F.size;return F.set(U,D),this.size+=F.size==G?0:1,this}function MapCache(U){var D=-1,F=U==null?0:U.length;for(this.clear();++D<F;){var G=U[D];this.set(G[0],G[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype.delete=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;var Set$1=getNative(root$2,"Set");const Set$2=Set$1;var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(U){return this.__data__.set(U,HASH_UNDEFINED),this}function setCacheHas(U){return this.__data__.has(U)}function SetCache(U){var D=-1,F=U==null?0:U.length;for(this.__data__=new MapCache;++D<F;)this.add(U[D])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function cacheHas(U,D){return U.has(D)}function setToArray(U){var D=-1,F=Array(U.size);return U.forEach(function(G){F[++D]=G}),F}var now$2=function(){return root$2.Date.now()};const now$3=now$2;var FUNC_ERROR_TEXT$1="Expected a function",nativeMax=Math.max,nativeMin=Math.min;function debounce(U,D,F){var G,Q,X,q,W,Y,J=0,te=!1,Z=!1,ee=!0;if(typeof U!="function")throw new TypeError(FUNC_ERROR_TEXT$1);D=toNumber(D)||0,isObject(F)&&(te=!!F.leading,Z="maxWait"in F,X=Z?nativeMax(toNumber(F.maxWait)||0,D):X,ee="trailing"in F?!!F.trailing:ee);function re(pe){var _e=G,xe=Q;return G=Q=void 0,J=pe,q=U.apply(xe,_e),q}function ne(pe){return J=pe,W=setTimeout(ie,D),te?re(pe):q}function le(pe){var _e=pe-Y,xe=pe-J,be=D-_e;return Z?nativeMin(be,X-xe):be}function se(pe){var _e=pe-Y,xe=pe-J;return Y===void 0||_e>=D||_e<0||Z&&xe>=X}function ie(){var pe=now$3();if(se(pe))return ge(pe);W=setTimeout(ie,le(pe))}function ge(pe){return W=void 0,ee&&G?re(pe):(G=Q=void 0,q)}function fe(){W!==void 0&&clearTimeout(W),J=0,G=Y=Q=W=void 0}function ae(){return W===void 0?q:ge(now$3())}function ue(){var pe=now$3(),_e=se(pe);if(G=arguments,Q=this,Y=pe,_e){if(W===void 0)return ne(Y);if(Z)return clearTimeout(W),W=setTimeout(ie,D),re(Y)}return W===void 0&&(W=setTimeout(ie,D)),q}return ue.cancel=fe,ue.flush=ae,ue}function arrayIncludesWith(U,D,F){for(var G=-1,Q=U==null?0:U.length;++G<Q;)if(F(D,U[G]))return!0;return!1}function fromPairs(U){for(var D=-1,F=U==null?0:U.length,G={};++D<F;){var Q=U[D];G[Q[0]]=Q[1]}return G}var FUNC_ERROR_TEXT="Expected a function";function throttle(U,D,F){var G=!0,Q=!0;if(typeof U!="function")throw new TypeError(FUNC_ERROR_TEXT);return isObject(F)&&(G="leading"in F?!!F.leading:G,Q="trailing"in F?!!F.trailing:Q),debounce(U,D,{leading:G,maxWait:D,trailing:Q})}var INFINITY=1/0,createSet=Set$2&&1/setToArray(new Set$2([,-0]))[1]==INFINITY?function(U){return new Set$2(U)}:noop$2;const createSet$1=createSet;var LARGE_ARRAY_SIZE=200;function baseUniq(U,D,F){var G=-1,Q=arrayIncludes,X=U.length,q=!0,W=[],Y=W;if(F)q=!1,Q=arrayIncludesWith;else if(X>=LARGE_ARRAY_SIZE){var J=D?null:createSet$1(U);if(J)return setToArray(J);q=!1,Q=cacheHas,Y=new SetCache}else Y=D?[]:W;e:for(;++G<X;){var te=U[G],Z=D?D(te):te;if(te=F||te!==0?te:0,q&&Z===Z){for(var ee=Y.length;ee--;)if(Y[ee]===Z)continue e;D&&Y.push(Z),W.push(te)}else Q(Y,Z,F)||(Y!==W&&Y.push(Z),W.push(te))}return W}function uniqWith(U,D){return D=typeof D=="function"?D:void 0,U&&U.length?baseUniq(U,void 0,D):[]}const backend=new MemoryLevel_1,df=new rdfDataFactory.DataFactory,store=new Quadstore({backend,dataFactory:df}),engine=new __quadstore_comunica_exports__Engine(store);async function buildGraph$1(U){console.log("BUILDING GRAPH",U);const{valueNetworkData:D,projectsData:F,organizationsData:G}=U,Q=Object.entries(D).flatMap(([Y,{dependents:J,dependencies:te,owner:Z}])=>[Z&&Y&&df.quad(df.namedNode(Z),df.literal(OWNS),df.namedNode(Y),df.defaultGraph()),...(J||[]).filter(ee=>ee).map(ee=>df.quad(df.namedNode(ee),df.namedNode(DEPENDS_ON),df.namedNode(Y),df.defaultGraph())),...(te||[]).filter(ee=>ee).map(ee=>df.quad(df.namedNode(Y),df.namedNode(DEPENDS_ON),df.namedNode(ee),df.defaultGraph()))]).filter(Y=>Y),X=[...Object.entries(G).flatMap(([Y,J])=>Object.entries(J).flatMap(([te,Z])=>Z&&df.quad(df.namedNode(Y),df.namedNode(te),df.literal(Z))).filter(te=>te))],q=[...Object.entries(F).flatMap(([Y,J])=>Object.entries(J).flatMap(([te,Z])=>Z&&df.quad(df.namedNode(Y),df.namedNode(te),df.literal(Z))).filter(te=>te))],W=[...Q,...X,...q];await store.open(),await store.multiPut(W),console.log("inserted",W.length,"entries")}const getProps=U=>(async D=>fromPairs([D].flat().map(F=>[F,U.get(F)]))).bind(U),doQuery$1=async(U,D,F,G)=>{await engine.queryBindings(U).then(Q=>{D&&Q.on("data",X=>D(X,proxy(getProps(X)))),F&&Q.on("end",X=>F(X,X&&proxy(X.get.bind(X)))),G&&Q.on("error",X=>G(X,X&&proxy(X.get.bind(X))))})},db=Object.freeze(Object.defineProperty({__proto__:null,buildGraph:buildGraph$1,doQuery:doQuery$1},Symbol.toStringTag,{value:"Module"}));var rafExports={},raf$1={get exports(){return rafExports},set exports(U){rafExports=U}},performanceNowExports={},performanceNow={get exports(){return performanceNowExports},set exports(U){performanceNowExports=U}};(function(){var U,D,F,G,Q,X;typeof performance<"u"&&performance!==null&&performance.now?performanceNow.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(performanceNow.exports=function(){return(U()-Q)/1e6},D=process.hrtime,U=function(){var q;return q=D(),q[0]*1e9+q[1]},G=U(),X=process.uptime()*1e9,Q=G-X):Date.now?(performanceNow.exports=function(){return Date.now()-F},F=Date.now()):(performanceNow.exports=function(){return new Date().getTime()-F},F=new Date().getTime())}).call(commonjsGlobal);var now$1=performanceNowExports,root=typeof window>"u"?commonjsGlobal:window,vendors=["moz","webkit"],suffix="AnimationFrame",raf=root["request"+suffix],caf=root["cancel"+suffix]||root["cancelRequest"+suffix];for(var i$2=0;!raf&&i$2<vendors.length;i$2++)raf=root[vendors[i$2]+"Request"+suffix],caf=root[vendors[i$2]+"Cancel"+suffix]||root[vendors[i$2]+"CancelRequest"+suffix];if(!raf||!caf){var last=0,id=0,queue=[],frameDuration=1e3/60;raf=function(U){if(queue.length===0){var D=now$1(),F=Math.max(0,frameDuration-(D-last));last=F+D,setTimeout(function(){var G=queue.slice(0);queue.length=0;for(var Q=0;Q<G.length;Q++)if(!G[Q].cancelled)try{G[Q].callback(last)}catch(X){setTimeout(function(){throw X},0)}},Math.round(F))}return queue.push({handle:++id,callback:U,cancelled:!1}),id},caf=function(U){for(var D=0;D<queue.length;D++)queue[D].handle===U&&(queue[D].cancelled=!0)}}raf$1.exports=function(U){return raf.call(root,U)};rafExports.cancel=function(){caf.apply(root,arguments)};rafExports.polyfill=function(U){U||(U=root),U.requestAnimationFrame=raf,U.cancelAnimationFrame=caf};function forceCenter(U,D,F){var G,Q=1;U==null&&(U=0),D==null&&(D=0),F==null&&(F=0);function X(){var q,W=G.length,Y,J=0,te=0,Z=0;for(q=0;q<W;++q)Y=G[q],J+=Y.x||0,te+=Y.y||0,Z+=Y.z||0;for(J=(J/W-U)*Q,te=(te/W-D)*Q,Z=(Z/W-F)*Q,q=0;q<W;++q)Y=G[q],J&&(Y.x-=J),te&&(Y.y-=te),Z&&(Y.z-=Z)}return X.initialize=function(q){G=q},X.x=function(q){return arguments.length?(U=+q,X):U},X.y=function(q){return arguments.length?(D=+q,X):D},X.z=function(q){return arguments.length?(F=+q,X):F},X.strength=function(q){return arguments.length?(Q=+q,X):Q},X}function tree_add$2(U){const D=+this._x.call(null,U);return add$3(this.cover(D),D,U)}function add$3(U,D,F){if(isNaN(D))return U;var G,Q=U._root,X={data:F},q=U._x0,W=U._x1,Y,J,te,Z,ee;if(!Q)return U._root=X,U;for(;Q.length;)if((te=D>=(Y=(q+W)/2))?q=Y:W=Y,G=Q,!(Q=Q[Z=+te]))return G[Z]=X,U;if(J=+U._x.call(null,Q.data),D===J)return X.next=Q,G?G[Z]=X:U._root=X,U;do G=G?G[Z]=new Array(2):U._root=new Array(2),(te=D>=(Y=(q+W)/2))?q=Y:W=Y;while((Z=+te)==(ee=+(J>=Y)));return G[ee]=Q,G[Z]=X,U}function addAll$2(U){Array.isArray(U)||(U=Array.from(U));const D=U.length,F=new Float64Array(D);let G=1/0,Q=-1/0;for(let X=0,q;X<D;++X)isNaN(q=+this._x.call(null,U[X]))||(F[X]=q,q<G&&(G=q),q>Q&&(Q=q));if(G>Q)return this;this.cover(G).cover(Q);for(let X=0;X<D;++X)add$3(this,F[X],U[X]);return this}function tree_cover$2(U){if(isNaN(U=+U))return this;var D=this._x0,F=this._x1;if(isNaN(D))F=(D=Math.floor(U))+1;else{for(var G=F-D||1,Q=this._root,X,q;D>U||U>=F;)switch(q=+(U<D),X=new Array(2),X[q]=Q,Q=X,G*=2,q){case 0:F=D+G;break;case 1:D=F-G;break}this._root&&this._root.length&&(this._root=Q)}return this._x0=D,this._x1=F,this}function tree_data$2(){var U=[];return this.visit(function(D){if(!D.length)do U.push(D.data);while(D=D.next)}),U}function tree_extent$2(U){return arguments.length?this.cover(+U[0][0]).cover(+U[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function Half(U,D,F){this.node=U,this.x0=D,this.x1=F}function tree_find$2(U,D){var F,G=this._x0,Q,X,q=this._x1,W=[],Y=this._root,J,te;for(Y&&W.push(new Half(Y,G,q)),D==null?D=1/0:(G=U-D,q=U+D);J=W.pop();)if(!(!(Y=J.node)||(Q=J.x0)>q||(X=J.x1)<G))if(Y.length){var Z=(Q+X)/2;W.push(new Half(Y[1],Z,X),new Half(Y[0],Q,Z)),(te=+(U>=Z))&&(J=W[W.length-1],W[W.length-1]=W[W.length-1-te],W[W.length-1-te]=J)}else{var ee=Math.abs(U-+this._x.call(null,Y.data));ee<D&&(D=ee,G=U-ee,q=U+ee,F=Y.data)}return F}function tree_remove$2(U){if(isNaN(Y=+this._x.call(null,U)))return this;var D,F=this._root,G,Q,X,q=this._x0,W=this._x1,Y,J,te,Z,ee;if(!F)return this;if(F.length)for(;;){if((te=Y>=(J=(q+W)/2))?q=J:W=J,D=F,!(F=F[Z=+te]))return this;if(!F.length)break;D[Z+1&1]&&(G=D,ee=Z)}for(;F.data!==U;)if(Q=F,!(F=F.next))return this;return(X=F.next)&&delete F.next,Q?(X?Q.next=X:delete Q.next,this):D?(X?D[Z]=X:delete D[Z],(F=D[0]||D[1])&&F===(D[1]||D[0])&&!F.length&&(G?G[ee]=F:this._root=F),this):(this._root=X,this)}function removeAll$2(U){for(var D=0,F=U.length;D<F;++D)this.remove(U[D]);return this}function tree_root$2(){return this._root}function tree_size$2(){var U=0;return this.visit(function(D){if(!D.length)do++U;while(D=D.next)}),U}function tree_visit$2(U){var D=[],F,G=this._root,Q,X,q;for(G&&D.push(new Half(G,this._x0,this._x1));F=D.pop();)if(!U(G=F.node,X=F.x0,q=F.x1)&&G.length){var W=(X+q)/2;(Q=G[1])&&D.push(new Half(Q,W,q)),(Q=G[0])&&D.push(new Half(Q,X,W))}return this}function tree_visitAfter$2(U){var D=[],F=[],G;for(this._root&&D.push(new Half(this._root,this._x0,this._x1));G=D.pop();){var Q=G.node;if(Q.length){var X,q=G.x0,W=G.x1,Y=(q+W)/2;(X=Q[0])&&D.push(new Half(X,q,Y)),(X=Q[1])&&D.push(new Half(X,Y,W))}F.push(G)}for(;G=F.pop();)U(G.node,G.x0,G.x1);return this}function defaultX$2(U){return U[0]}function tree_x$2(U){return arguments.length?(this._x=U,this):this._x}function binarytree(U,D){var F=new Binarytree(D??defaultX$2,NaN,NaN);return U==null?F:F.addAll(U)}function Binarytree(U,D,F){this._x=U,this._x0=D,this._x1=F,this._root=void 0}function leaf_copy$2(U){for(var D={data:U.data},F=D;U=U.next;)F=F.next={data:U.data};return D}var treeProto$2=binarytree.prototype=Binarytree.prototype;treeProto$2.copy=function(){var U=new Binarytree(this._x,this._x0,this._x1),D=this._root,F,G;if(!D)return U;if(!D.length)return U._root=leaf_copy$2(D),U;for(F=[{source:D,target:U._root=new Array(2)}];D=F.pop();)for(var Q=0;Q<2;++Q)(G=D.source[Q])&&(G.length?F.push({source:G,target:D.target[Q]=new Array(2)}):D.target[Q]=leaf_copy$2(G));return U};treeProto$2.add=tree_add$2;treeProto$2.addAll=addAll$2;treeProto$2.cover=tree_cover$2;treeProto$2.data=tree_data$2;treeProto$2.extent=tree_extent$2;treeProto$2.find=tree_find$2;treeProto$2.remove=tree_remove$2;treeProto$2.removeAll=removeAll$2;treeProto$2.root=tree_root$2;treeProto$2.size=tree_size$2;treeProto$2.visit=tree_visit$2;treeProto$2.visitAfter=tree_visitAfter$2;treeProto$2.x=tree_x$2;function tree_add$1(U){const D=+this._x.call(null,U),F=+this._y.call(null,U);return add$2(this.cover(D,F),D,F,U)}function add$2(U,D,F,G){if(isNaN(D)||isNaN(F))return U;var Q,X=U._root,q={data:G},W=U._x0,Y=U._y0,J=U._x1,te=U._y1,Z,ee,re,ne,le,se,ie,ge;if(!X)return U._root=q,U;for(;X.length;)if((le=D>=(Z=(W+J)/2))?W=Z:J=Z,(se=F>=(ee=(Y+te)/2))?Y=ee:te=ee,Q=X,!(X=X[ie=se<<1|le]))return Q[ie]=q,U;if(re=+U._x.call(null,X.data),ne=+U._y.call(null,X.data),D===re&&F===ne)return q.next=X,Q?Q[ie]=q:U._root=q,U;do Q=Q?Q[ie]=new Array(4):U._root=new Array(4),(le=D>=(Z=(W+J)/2))?W=Z:J=Z,(se=F>=(ee=(Y+te)/2))?Y=ee:te=ee;while((ie=se<<1|le)===(ge=(ne>=ee)<<1|re>=Z));return Q[ge]=X,Q[ie]=q,U}function addAll$1(U){var D,F,G=U.length,Q,X,q=new Array(G),W=new Array(G),Y=1/0,J=1/0,te=-1/0,Z=-1/0;for(F=0;F<G;++F)isNaN(Q=+this._x.call(null,D=U[F]))||isNaN(X=+this._y.call(null,D))||(q[F]=Q,W[F]=X,Q<Y&&(Y=Q),Q>te&&(te=Q),X<J&&(J=X),X>Z&&(Z=X));if(Y>te||J>Z)return this;for(this.cover(Y,J).cover(te,Z),F=0;F<G;++F)add$2(this,q[F],W[F],U[F]);return this}function tree_cover$1(U,D){if(isNaN(U=+U)||isNaN(D=+D))return this;var F=this._x0,G=this._y0,Q=this._x1,X=this._y1;if(isNaN(F))Q=(F=Math.floor(U))+1,X=(G=Math.floor(D))+1;else{for(var q=Q-F||1,W=this._root,Y,J;F>U||U>=Q||G>D||D>=X;)switch(J=(D<G)<<1|U<F,Y=new Array(4),Y[J]=W,W=Y,q*=2,J){case 0:Q=F+q,X=G+q;break;case 1:F=Q-q,X=G+q;break;case 2:Q=F+q,G=X-q;break;case 3:F=Q-q,G=X-q;break}this._root&&this._root.length&&(this._root=W)}return this._x0=F,this._y0=G,this._x1=Q,this._y1=X,this}function tree_data$1(){var U=[];return this.visit(function(D){if(!D.length)do U.push(D.data);while(D=D.next)}),U}function tree_extent$1(U){return arguments.length?this.cover(+U[0][0],+U[0][1]).cover(+U[1][0],+U[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Quad(U,D,F,G,Q){this.node=U,this.x0=D,this.y0=F,this.x1=G,this.y1=Q}function tree_find$1(U,D,F){var G,Q=this._x0,X=this._y0,q,W,Y,J,te=this._x1,Z=this._y1,ee=[],re=this._root,ne,le;for(re&&ee.push(new Quad(re,Q,X,te,Z)),F==null?F=1/0:(Q=U-F,X=D-F,te=U+F,Z=D+F,F*=F);ne=ee.pop();)if(!(!(re=ne.node)||(q=ne.x0)>te||(W=ne.y0)>Z||(Y=ne.x1)<Q||(J=ne.y1)<X))if(re.length){var se=(q+Y)/2,ie=(W+J)/2;ee.push(new Quad(re[3],se,ie,Y,J),new Quad(re[2],q,ie,se,J),new Quad(re[1],se,W,Y,ie),new Quad(re[0],q,W,se,ie)),(le=(D>=ie)<<1|U>=se)&&(ne=ee[ee.length-1],ee[ee.length-1]=ee[ee.length-1-le],ee[ee.length-1-le]=ne)}else{var ge=U-+this._x.call(null,re.data),fe=D-+this._y.call(null,re.data),ae=ge*ge+fe*fe;if(ae<F){var ue=Math.sqrt(F=ae);Q=U-ue,X=D-ue,te=U+ue,Z=D+ue,G=re.data}}return G}function tree_remove$1(U){if(isNaN(te=+this._x.call(null,U))||isNaN(Z=+this._y.call(null,U)))return this;var D,F=this._root,G,Q,X,q=this._x0,W=this._y0,Y=this._x1,J=this._y1,te,Z,ee,re,ne,le,se,ie;if(!F)return this;if(F.length)for(;;){if((ne=te>=(ee=(q+Y)/2))?q=ee:Y=ee,(le=Z>=(re=(W+J)/2))?W=re:J=re,D=F,!(F=F[se=le<<1|ne]))return this;if(!F.length)break;(D[se+1&3]||D[se+2&3]||D[se+3&3])&&(G=D,ie=se)}for(;F.data!==U;)if(Q=F,!(F=F.next))return this;return(X=F.next)&&delete F.next,Q?(X?Q.next=X:delete Q.next,this):D?(X?D[se]=X:delete D[se],(F=D[0]||D[1]||D[2]||D[3])&&F===(D[3]||D[2]||D[1]||D[0])&&!F.length&&(G?G[ie]=F:this._root=F),this):(this._root=X,this)}function removeAll$1(U){for(var D=0,F=U.length;D<F;++D)this.remove(U[D]);return this}function tree_root$1(){return this._root}function tree_size$1(){var U=0;return this.visit(function(D){if(!D.length)do++U;while(D=D.next)}),U}function tree_visit$1(U){var D=[],F,G=this._root,Q,X,q,W,Y;for(G&&D.push(new Quad(G,this._x0,this._y0,this._x1,this._y1));F=D.pop();)if(!U(G=F.node,X=F.x0,q=F.y0,W=F.x1,Y=F.y1)&&G.length){var J=(X+W)/2,te=(q+Y)/2;(Q=G[3])&&D.push(new Quad(Q,J,te,W,Y)),(Q=G[2])&&D.push(new Quad(Q,X,te,J,Y)),(Q=G[1])&&D.push(new Quad(Q,J,q,W,te)),(Q=G[0])&&D.push(new Quad(Q,X,q,J,te))}return this}function tree_visitAfter$1(U){var D=[],F=[],G;for(this._root&&D.push(new Quad(this._root,this._x0,this._y0,this._x1,this._y1));G=D.pop();){var Q=G.node;if(Q.length){var X,q=G.x0,W=G.y0,Y=G.x1,J=G.y1,te=(q+Y)/2,Z=(W+J)/2;(X=Q[0])&&D.push(new Quad(X,q,W,te,Z)),(X=Q[1])&&D.push(new Quad(X,te,W,Y,Z)),(X=Q[2])&&D.push(new Quad(X,q,Z,te,J)),(X=Q[3])&&D.push(new Quad(X,te,Z,Y,J))}F.push(G)}for(;G=F.pop();)U(G.node,G.x0,G.y0,G.x1,G.y1);return this}function defaultX$1(U){return U[0]}function tree_x$1(U){return arguments.length?(this._x=U,this):this._x}function defaultY$1(U){return U[1]}function tree_y$1(U){return arguments.length?(this._y=U,this):this._y}function quadtree(U,D,F){var G=new Quadtree(D??defaultX$1,F??defaultY$1,NaN,NaN,NaN,NaN);return U==null?G:G.addAll(U)}function Quadtree(U,D,F,G,Q,X){this._x=U,this._y=D,this._x0=F,this._y0=G,this._x1=Q,this._y1=X,this._root=void 0}function leaf_copy$1(U){for(var D={data:U.data},F=D;U=U.next;)F=F.next={data:U.data};return D}var treeProto$1=quadtree.prototype=Quadtree.prototype;treeProto$1.copy=function(){var U=new Quadtree(this._x,this._y,this._x0,this._y0,this._x1,this._y1),D=this._root,F,G;if(!D)return U;if(!D.length)return U._root=leaf_copy$1(D),U;for(F=[{source:D,target:U._root=new Array(4)}];D=F.pop();)for(var Q=0;Q<4;++Q)(G=D.source[Q])&&(G.length?F.push({source:G,target:D.target[Q]=new Array(4)}):D.target[Q]=leaf_copy$1(G));return U};treeProto$1.add=tree_add$1;treeProto$1.addAll=addAll$1;treeProto$1.cover=tree_cover$1;treeProto$1.data=tree_data$1;treeProto$1.extent=tree_extent$1;treeProto$1.find=tree_find$1;treeProto$1.remove=tree_remove$1;treeProto$1.removeAll=removeAll$1;treeProto$1.root=tree_root$1;treeProto$1.size=tree_size$1;treeProto$1.visit=tree_visit$1;treeProto$1.visitAfter=tree_visitAfter$1;treeProto$1.x=tree_x$1;treeProto$1.y=tree_y$1;function tree_add(U){const D=+this._x.call(null,U),F=+this._y.call(null,U),G=+this._z.call(null,U);return add$1(this.cover(D,F,G),D,F,G,U)}function add$1(U,D,F,G,Q){if(isNaN(D)||isNaN(F)||isNaN(G))return U;var X,q=U._root,W={data:Q},Y=U._x0,J=U._y0,te=U._z0,Z=U._x1,ee=U._y1,re=U._z1,ne,le,se,ie,ge,fe,ae,ue,pe,_e,xe;if(!q)return U._root=W,U;for(;q.length;)if((ae=D>=(ne=(Y+Z)/2))?Y=ne:Z=ne,(ue=F>=(le=(J+ee)/2))?J=le:ee=le,(pe=G>=(se=(te+re)/2))?te=se:re=se,X=q,!(q=q[_e=pe<<2|ue<<1|ae]))return X[_e]=W,U;if(ie=+U._x.call(null,q.data),ge=+U._y.call(null,q.data),fe=+U._z.call(null,q.data),D===ie&&F===ge&&G===fe)return W.next=q,X?X[_e]=W:U._root=W,U;do X=X?X[_e]=new Array(8):U._root=new Array(8),(ae=D>=(ne=(Y+Z)/2))?Y=ne:Z=ne,(ue=F>=(le=(J+ee)/2))?J=le:ee=le,(pe=G>=(se=(te+re)/2))?te=se:re=se;while((_e=pe<<2|ue<<1|ae)===(xe=(fe>=se)<<2|(ge>=le)<<1|ie>=ne));return X[xe]=q,X[_e]=W,U}function addAll(U){Array.isArray(U)||(U=Array.from(U));const D=U.length,F=new Float64Array(D),G=new Float64Array(D),Q=new Float64Array(D);let X=1/0,q=1/0,W=1/0,Y=-1/0,J=-1/0,te=-1/0;for(let Z=0,ee,re,ne,le;Z<D;++Z)isNaN(re=+this._x.call(null,ee=U[Z]))||isNaN(ne=+this._y.call(null,ee))||isNaN(le=+this._z.call(null,ee))||(F[Z]=re,G[Z]=ne,Q[Z]=le,re<X&&(X=re),re>Y&&(Y=re),ne<q&&(q=ne),ne>J&&(J=ne),le<W&&(W=le),le>te&&(te=le));if(X>Y||q>J||W>te)return this;this.cover(X,q,W).cover(Y,J,te);for(let Z=0;Z<D;++Z)add$1(this,F[Z],G[Z],Q[Z],U[Z]);return this}function tree_cover(U,D,F){if(isNaN(U=+U)||isNaN(D=+D)||isNaN(F=+F))return this;var G=this._x0,Q=this._y0,X=this._z0,q=this._x1,W=this._y1,Y=this._z1;if(isNaN(G))q=(G=Math.floor(U))+1,W=(Q=Math.floor(D))+1,Y=(X=Math.floor(F))+1;else{for(var J=q-G||1,te=this._root,Z,ee;G>U||U>=q||Q>D||D>=W||X>F||F>=Y;)switch(ee=(F<X)<<2|(D<Q)<<1|U<G,Z=new Array(8),Z[ee]=te,te=Z,J*=2,ee){case 0:q=G+J,W=Q+J,Y=X+J;break;case 1:G=q-J,W=Q+J,Y=X+J;break;case 2:q=G+J,Q=W-J,Y=X+J;break;case 3:G=q-J,Q=W-J,Y=X+J;break;case 4:q=G+J,W=Q+J,X=Y-J;break;case 5:G=q-J,W=Q+J,X=Y-J;break;case 6:q=G+J,Q=W-J,X=Y-J;break;case 7:G=q-J,Q=W-J,X=Y-J;break}this._root&&this._root.length&&(this._root=te)}return this._x0=G,this._y0=Q,this._z0=X,this._x1=q,this._y1=W,this._z1=Y,this}function tree_data(){var U=[];return this.visit(function(D){if(!D.length)do U.push(D.data);while(D=D.next)}),U}function tree_extent(U){return arguments.length?this.cover(+U[0][0],+U[0][1],+U[0][2]).cover(+U[1][0],+U[1][1],+U[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function Octant(U,D,F,G,Q,X,q){this.node=U,this.x0=D,this.y0=F,this.z0=G,this.x1=Q,this.y1=X,this.z1=q}function tree_find(U,D,F,G){var Q,X=this._x0,q=this._y0,W=this._z0,Y,J,te,Z,ee,re,ne=this._x1,le=this._y1,se=this._z1,ie=[],ge=this._root,fe,ae;for(ge&&ie.push(new Octant(ge,X,q,W,ne,le,se)),G==null?G=1/0:(X=U-G,q=D-G,W=F-G,ne=U+G,le=D+G,se=F+G,G*=G);fe=ie.pop();)if(!(!(ge=fe.node)||(Y=fe.x0)>ne||(J=fe.y0)>le||(te=fe.z0)>se||(Z=fe.x1)<X||(ee=fe.y1)<q||(re=fe.z1)<W))if(ge.length){var ue=(Y+Z)/2,pe=(J+ee)/2,_e=(te+re)/2;ie.push(new Octant(ge[7],ue,pe,_e,Z,ee,re),new Octant(ge[6],Y,pe,_e,ue,ee,re),new Octant(ge[5],ue,J,_e,Z,pe,re),new Octant(ge[4],Y,J,_e,ue,pe,re),new Octant(ge[3],ue,pe,te,Z,ee,_e),new Octant(ge[2],Y,pe,te,ue,ee,_e),new Octant(ge[1],ue,J,te,Z,pe,_e),new Octant(ge[0],Y,J,te,ue,pe,_e)),(ae=(F>=_e)<<2|(D>=pe)<<1|U>=ue)&&(fe=ie[ie.length-1],ie[ie.length-1]=ie[ie.length-1-ae],ie[ie.length-1-ae]=fe)}else{var xe=U-+this._x.call(null,ge.data),be=D-+this._y.call(null,ge.data),Te=F-+this._z.call(null,ge.data),ye=xe*xe+be*be+Te*Te;if(ye<G){var Ee=Math.sqrt(G=ye);X=U-Ee,q=D-Ee,W=F-Ee,ne=U+Ee,le=D+Ee,se=F+Ee,Q=ge.data}}return Q}function tree_remove(U){if(isNaN(ee=+this._x.call(null,U))||isNaN(re=+this._y.call(null,U))||isNaN(ne=+this._z.call(null,U)))return this;var D,F=this._root,G,Q,X,q=this._x0,W=this._y0,Y=this._z0,J=this._x1,te=this._y1,Z=this._z1,ee,re,ne,le,se,ie,ge,fe,ae,ue,pe;if(!F)return this;if(F.length)for(;;){if((ge=ee>=(le=(q+J)/2))?q=le:J=le,(fe=re>=(se=(W+te)/2))?W=se:te=se,(ae=ne>=(ie=(Y+Z)/2))?Y=ie:Z=ie,D=F,!(F=F[ue=ae<<2|fe<<1|ge]))return this;if(!F.length)break;(D[ue+1&7]||D[ue+2&7]||D[ue+3&7]||D[ue+4&7]||D[ue+5&7]||D[ue+6&7]||D[ue+7&7])&&(G=D,pe=ue)}for(;F.data!==U;)if(Q=F,!(F=F.next))return this;return(X=F.next)&&delete F.next,Q?(X?Q.next=X:delete Q.next,this):D?(X?D[ue]=X:delete D[ue],(F=D[0]||D[1]||D[2]||D[3]||D[4]||D[5]||D[6]||D[7])&&F===(D[7]||D[6]||D[5]||D[4]||D[3]||D[2]||D[1]||D[0])&&!F.length&&(G?G[pe]=F:this._root=F),this):(this._root=X,this)}function removeAll(U){for(var D=0,F=U.length;D<F;++D)this.remove(U[D]);return this}function tree_root(){return this._root}function tree_size(){var U=0;return this.visit(function(D){if(!D.length)do++U;while(D=D.next)}),U}function tree_visit(U){var D=[],F,G=this._root,Q,X,q,W,Y,J,te;for(G&&D.push(new Octant(G,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));F=D.pop();)if(!U(G=F.node,X=F.x0,q=F.y0,W=F.z0,Y=F.x1,J=F.y1,te=F.z1)&&G.length){var Z=(X+Y)/2,ee=(q+J)/2,re=(W+te)/2;(Q=G[7])&&D.push(new Octant(Q,Z,ee,re,Y,J,te)),(Q=G[6])&&D.push(new Octant(Q,X,ee,re,Z,J,te)),(Q=G[5])&&D.push(new Octant(Q,Z,q,re,Y,ee,te)),(Q=G[4])&&D.push(new Octant(Q,X,q,re,Z,ee,te)),(Q=G[3])&&D.push(new Octant(Q,Z,ee,W,Y,J,re)),(Q=G[2])&&D.push(new Octant(Q,X,ee,W,Z,J,re)),(Q=G[1])&&D.push(new Octant(Q,Z,q,W,Y,ee,re)),(Q=G[0])&&D.push(new Octant(Q,X,q,W,Z,ee,re))}return this}function tree_visitAfter(U){var D=[],F=[],G;for(this._root&&D.push(new Octant(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));G=D.pop();){var Q=G.node;if(Q.length){var X,q=G.x0,W=G.y0,Y=G.z0,J=G.x1,te=G.y1,Z=G.z1,ee=(q+J)/2,re=(W+te)/2,ne=(Y+Z)/2;(X=Q[0])&&D.push(new Octant(X,q,W,Y,ee,re,ne)),(X=Q[1])&&D.push(new Octant(X,ee,W,Y,J,re,ne)),(X=Q[2])&&D.push(new Octant(X,q,re,Y,ee,te,ne)),(X=Q[3])&&D.push(new Octant(X,ee,re,Y,J,te,ne)),(X=Q[4])&&D.push(new Octant(X,q,W,ne,ee,re,Z)),(X=Q[5])&&D.push(new Octant(X,ee,W,ne,J,re,Z)),(X=Q[6])&&D.push(new Octant(X,q,re,ne,ee,te,Z)),(X=Q[7])&&D.push(new Octant(X,ee,re,ne,J,te,Z))}F.push(G)}for(;G=F.pop();)U(G.node,G.x0,G.y0,G.z0,G.x1,G.y1,G.z1);return this}function defaultX(U){return U[0]}function tree_x(U){return arguments.length?(this._x=U,this):this._x}function defaultY(U){return U[1]}function tree_y(U){return arguments.length?(this._y=U,this):this._y}function defaultZ(U){return U[2]}function tree_z(U){return arguments.length?(this._z=U,this):this._z}function octree(U,D,F,G){var Q=new Octree(D??defaultX,F??defaultY,G??defaultZ,NaN,NaN,NaN,NaN,NaN,NaN);return U==null?Q:Q.addAll(U)}function Octree(U,D,F,G,Q,X,q,W,Y){this._x=U,this._y=D,this._z=F,this._x0=G,this._y0=Q,this._z0=X,this._x1=q,this._y1=W,this._z1=Y,this._root=void 0}function leaf_copy(U){for(var D={data:U.data},F=D;U=U.next;)F=F.next={data:U.data};return D}var treeProto=octree.prototype=Octree.prototype;treeProto.copy=function(){var U=new Octree(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),D=this._root,F,G;if(!D)return U;if(!D.length)return U._root=leaf_copy(D),U;for(F=[{source:D,target:U._root=new Array(8)}];D=F.pop();)for(var Q=0;Q<8;++Q)(G=D.source[Q])&&(G.length?F.push({source:G,target:D.target[Q]=new Array(8)}):D.target[Q]=leaf_copy(G));return U};treeProto.add=tree_add;treeProto.addAll=addAll;treeProto.cover=tree_cover;treeProto.data=tree_data;treeProto.extent=tree_extent;treeProto.find=tree_find;treeProto.remove=tree_remove;treeProto.removeAll=removeAll;treeProto.root=tree_root;treeProto.size=tree_size;treeProto.visit=tree_visit;treeProto.visitAfter=tree_visitAfter;treeProto.x=tree_x;treeProto.y=tree_y;treeProto.z=tree_z;function constant(U){return function(){return U}}function jiggle(U){return(U()-.5)*1e-6}function index(U){return U.index}function find(U,D){var F=U.get(D);if(!F)throw new Error("node not found: "+D);return F}function forceLink(U){var D=index,F=ee,G,Q=constant(30),X,q,W,Y,J,te,Z=1;U==null&&(U=[]);function ee(ie){return 1/Math.min(Y[ie.source.index],Y[ie.target.index])}function re(ie){for(var ge=0,fe=U.length;ge<Z;++ge)for(var ae=0,ue,pe,_e,xe=0,be=0,Te=0,ye,Ee;ae<fe;++ae)ue=U[ae],pe=ue.source,_e=ue.target,xe=_e.x+_e.vx-pe.x-pe.vx||jiggle(te),W>1&&(be=_e.y+_e.vy-pe.y-pe.vy||jiggle(te)),W>2&&(Te=_e.z+_e.vz-pe.z-pe.vz||jiggle(te)),ye=Math.sqrt(xe*xe+be*be+Te*Te),ye=(ye-X[ae])/ye*ie*G[ae],xe*=ye,be*=ye,Te*=ye,_e.vx-=xe*(Ee=J[ae]),W>1&&(_e.vy-=be*Ee),W>2&&(_e.vz-=Te*Ee),pe.vx+=xe*(Ee=1-Ee),W>1&&(pe.vy+=be*Ee),W>2&&(pe.vz+=Te*Ee)}function ne(){if(q){var ie,ge=q.length,fe=U.length,ae=new Map(q.map((pe,_e)=>[D(pe,_e,q),pe])),ue;for(ie=0,Y=new Array(ge);ie<fe;++ie)ue=U[ie],ue.index=ie,typeof ue.source!="object"&&(ue.source=find(ae,ue.source)),typeof ue.target!="object"&&(ue.target=find(ae,ue.target)),Y[ue.source.index]=(Y[ue.source.index]||0)+1,Y[ue.target.index]=(Y[ue.target.index]||0)+1;for(ie=0,J=new Array(fe);ie<fe;++ie)ue=U[ie],J[ie]=Y[ue.source.index]/(Y[ue.source.index]+Y[ue.target.index]);G=new Array(fe),le(),X=new Array(fe),se()}}function le(){if(q)for(var ie=0,ge=U.length;ie<ge;++ie)G[ie]=+F(U[ie],ie,U)}function se(){if(q)for(var ie=0,ge=U.length;ie<ge;++ie)X[ie]=+Q(U[ie],ie,U)}return re.initialize=function(ie,...ge){q=ie,te=ge.find(fe=>typeof fe=="function")||Math.random,W=ge.find(fe=>[1,2,3].includes(fe))||2,ne()},re.links=function(ie){return arguments.length?(U=ie,ne(),re):U},re.id=function(ie){return arguments.length?(D=ie,re):D},re.iterations=function(ie){return arguments.length?(Z=+ie,re):Z},re.strength=function(ie){return arguments.length?(F=typeof ie=="function"?ie:constant(+ie),le(),re):F},re.distance=function(ie){return arguments.length?(Q=typeof ie=="function"?ie:constant(+ie),se(),re):Q},re}var noop$1={value:()=>{}};function dispatch(){for(var U=0,D=arguments.length,F={},G;U<D;++U){if(!(G=arguments[U]+"")||G in F||/[\s.]/.test(G))throw new Error("illegal type: "+G);F[G]=[]}return new Dispatch(F)}function Dispatch(U){this._=U}function parseTypenames(U,D){return U.trim().split(/^|\s+/).map(function(F){var G="",Q=F.indexOf(".");if(Q>=0&&(G=F.slice(Q+1),F=F.slice(0,Q)),F&&!D.hasOwnProperty(F))throw new Error("unknown type: "+F);return{type:F,name:G}})}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(U,D){var F=this._,G=parseTypenames(U+"",F),Q,X=-1,q=G.length;if(arguments.length<2){for(;++X<q;)if((Q=(U=G[X]).type)&&(Q=get(F[Q],U.name)))return Q;return}if(D!=null&&typeof D!="function")throw new Error("invalid callback: "+D);for(;++X<q;)if(Q=(U=G[X]).type)F[Q]=set(F[Q],U.name,D);else if(D==null)for(Q in F)F[Q]=set(F[Q],U.name,null);return this},copy:function(){var U={},D=this._;for(var F in D)U[F]=D[F].slice();return new Dispatch(U)},call:function(U,D){if((Q=arguments.length-2)>0)for(var F=new Array(Q),G=0,Q,X;G<Q;++G)F[G]=arguments[G+2];if(!this._.hasOwnProperty(U))throw new Error("unknown type: "+U);for(X=this._[U],G=0,Q=X.length;G<Q;++G)X[G].value.apply(D,F)},apply:function(U,D,F){if(!this._.hasOwnProperty(U))throw new Error("unknown type: "+U);for(var G=this._[U],Q=0,X=G.length;Q<X;++Q)G[Q].value.apply(D,F)}};function get(U,D){for(var F=0,G=U.length,Q;F<G;++F)if((Q=U[F]).name===D)return Q.value}function set(U,D,F){for(var G=0,Q=U.length;G<Q;++G)if(U[G].name===D){U[G]=noop$1,U=U.slice(0,G).concat(U.slice(G+1));break}return F!=null&&U.push({name:D,value:F}),U}var frame=0,timeout=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(U){setTimeout(U,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}Timer.prototype=timer.prototype={constructor:Timer,restart:function(U,D,F){if(typeof U!="function")throw new TypeError("callback is not a function");F=(F==null?now():+F)+(D==null?0:+D),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=U,this._time=F,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};function timer(U,D,F){var G=new Timer;return G.restart(U,D,F),G}function timerFlush(){now(),++frame;for(var U=taskHead,D;U;)(D=clockNow-U._time)>=0&&U._call.call(void 0,D),U=U._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var U=clock.now(),D=U-clockLast;D>pokeDelay&&(clockSkew-=D,clockLast=U)}function nap(){for(var U,D=taskHead,F,G=1/0;D;)D._call?(G>D._time&&(G=D._time),U=D,D=D._next):(F=D._next,D._next=null,D=U?U._next=F:taskHead=F);taskTail=U,sleep(G)}function sleep(U){if(!frame){timeout&&(timeout=clearTimeout(timeout));var D=U-clockNow;D>24?(U<1/0&&(timeout=setTimeout(wake,U-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}const a$2=1664525,c$3=1013904223,m$3=4294967296;function lcg(){let U=1;return()=>(U=(a$2*U+c$3)%m$3)/m$3}var MAX_DIMENSIONS=3;function x$3(U){return U.x}function y$3(U){return U.y}function z$1(U){return U.z}var initialRadius=10,initialAngleRoll=Math.PI*(3-Math.sqrt(5)),initialAngleYaw=Math.PI*20/(9+Math.sqrt(221));function forceSimulation(U,D){D=D||2;var F=Math.min(MAX_DIMENSIONS,Math.max(1,Math.round(D))),G,Q=1,X=.001,q=1-Math.pow(X,1/300),W=0,Y=.6,J=new Map,te=timer(re),Z=dispatch("tick","end"),ee=lcg();U==null&&(U=[]);function re(){ne(),Z.call("tick",G),Q<X&&(te.stop(),Z.call("end",G))}function ne(ie){var ge,fe=U.length,ae;ie===void 0&&(ie=1);for(var ue=0;ue<ie;++ue)for(Q+=(W-Q)*q,J.forEach(function(pe){pe(Q)}),ge=0;ge<fe;++ge)ae=U[ge],ae.fx==null?ae.x+=ae.vx*=Y:(ae.x=ae.fx,ae.vx=0),F>1&&(ae.fy==null?ae.y+=ae.vy*=Y:(ae.y=ae.fy,ae.vy=0)),F>2&&(ae.fz==null?ae.z+=ae.vz*=Y:(ae.z=ae.fz,ae.vz=0));return G}function le(){for(var ie=0,ge=U.length,fe;ie<ge;++ie){if(fe=U[ie],fe.index=ie,fe.fx!=null&&(fe.x=fe.fx),fe.fy!=null&&(fe.y=fe.fy),fe.fz!=null&&(fe.z=fe.fz),isNaN(fe.x)||F>1&&isNaN(fe.y)||F>2&&isNaN(fe.z)){var ae=initialRadius*(F>2?Math.cbrt(.5+ie):F>1?Math.sqrt(.5+ie):ie),ue=ie*initialAngleRoll,pe=ie*initialAngleYaw;F===1?fe.x=ae:F===2?(fe.x=ae*Math.cos(ue),fe.y=ae*Math.sin(ue)):(fe.x=ae*Math.sin(ue)*Math.cos(pe),fe.y=ae*Math.cos(ue),fe.z=ae*Math.sin(ue)*Math.sin(pe))}(isNaN(fe.vx)||F>1&&isNaN(fe.vy)||F>2&&isNaN(fe.vz))&&(fe.vx=0,F>1&&(fe.vy=0),F>2&&(fe.vz=0))}}function se(ie){return ie.initialize&&ie.initialize(U,ee,F),ie}return le(),G={tick:ne,restart:function(){return te.restart(re),G},stop:function(){return te.stop(),G},numDimensions:function(ie){return arguments.length?(F=Math.min(MAX_DIMENSIONS,Math.max(1,Math.round(ie))),J.forEach(se),G):F},nodes:function(ie){return arguments.length?(U=ie,le(),J.forEach(se),G):U},alpha:function(ie){return arguments.length?(Q=+ie,G):Q},alphaMin:function(ie){return arguments.length?(X=+ie,G):X},alphaDecay:function(ie){return arguments.length?(q=+ie,G):+q},alphaTarget:function(ie){return arguments.length?(W=+ie,G):W},velocityDecay:function(ie){return arguments.length?(Y=1-ie,G):1-Y},randomSource:function(ie){return arguments.length?(ee=ie,J.forEach(se),G):ee},force:function(ie,ge){return arguments.length>1?(ge==null?J.delete(ie):J.set(ie,se(ge)),G):J.get(ie)},find:function(){var ie=Array.prototype.slice.call(arguments),ge=ie.shift()||0,fe=(F>1?ie.shift():null)||0,ae=(F>2?ie.shift():null)||0,ue=ie.shift()||1/0,pe=0,_e=U.length,xe,be,Te,ye,Ee,he;for(ue*=ue,pe=0;pe<_e;++pe)Ee=U[pe],xe=ge-Ee.x,be=fe-(Ee.y||0),Te=ae-(Ee.z||0),ye=xe*xe+be*be+Te*Te,ye<ue&&(he=Ee,ue=ye);return he},on:function(ie,ge){return arguments.length>1?(Z.on(ie,ge),G):Z.on(ie)}}}function forceManyBody(){var U,D,F,G,Q,X=constant(-30),q,W=1,Y=1/0,J=.81;function te(ne){var le,se=U.length,ie=(D===1?binarytree(U,x$3):D===2?quadtree(U,x$3,y$3):D===3?octree(U,x$3,y$3,z$1):null).visitAfter(ee);for(Q=ne,le=0;le<se;++le)F=U[le],ie.visit(re)}function Z(){if(U){var ne,le=U.length,se;for(q=new Array(le),ne=0;ne<le;++ne)se=U[ne],q[se.index]=+X(se,ne,U)}}function ee(ne){var le=0,se,ie,ge=0,fe,ae,ue,pe,_e=ne.length;if(_e){for(fe=ae=ue=pe=0;pe<_e;++pe)(se=ne[pe])&&(ie=Math.abs(se.value))&&(le+=se.value,ge+=ie,fe+=ie*(se.x||0),ae+=ie*(se.y||0),ue+=ie*(se.z||0));le*=Math.sqrt(4/_e),ne.x=fe/ge,D>1&&(ne.y=ae/ge),D>2&&(ne.z=ue/ge)}else{se=ne,se.x=se.data.x,D>1&&(se.y=se.data.y),D>2&&(se.z=se.data.z);do le+=q[se.data.index];while(se=se.next)}ne.value=le}function re(ne,le,se,ie,ge){if(!ne.value)return!0;var fe=[se,ie,ge][D-1],ae=ne.x-F.x,ue=D>1?ne.y-F.y:0,pe=D>2?ne.z-F.z:0,_e=fe-le,xe=ae*ae+ue*ue+pe*pe;if(_e*_e/J<xe)return xe<Y&&(ae===0&&(ae=jiggle(G),xe+=ae*ae),D>1&&ue===0&&(ue=jiggle(G),xe+=ue*ue),D>2&&pe===0&&(pe=jiggle(G),xe+=pe*pe),xe<W&&(xe=Math.sqrt(W*xe)),F.vx+=ae*ne.value*Q/xe,D>1&&(F.vy+=ue*ne.value*Q/xe),D>2&&(F.vz+=pe*ne.value*Q/xe)),!0;if(ne.length||xe>=Y)return;(ne.data!==F||ne.next)&&(ae===0&&(ae=jiggle(G),xe+=ae*ae),D>1&&ue===0&&(ue=jiggle(G),xe+=ue*ue),D>2&&pe===0&&(pe=jiggle(G),xe+=pe*pe),xe<W&&(xe=Math.sqrt(W*xe)));do ne.data!==F&&(_e=q[ne.data.index]*Q/xe,F.vx+=ae*_e,D>1&&(F.vy+=ue*_e),D>2&&(F.vz+=pe*_e));while(ne=ne.next)}return te.initialize=function(ne,...le){U=ne,G=le.find(se=>typeof se=="function")||Math.random,D=le.find(se=>[1,2,3].includes(se))||2,Z()},te.strength=function(ne){return arguments.length?(X=typeof ne=="function"?ne:constant(+ne),Z(),te):X},te.distanceMin=function(ne){return arguments.length?(W=ne*ne,te):Math.sqrt(W)},te.distanceMax=function(ne){return arguments.length?(Y=ne*ne,te):Math.sqrt(Y)},te.theta=function(ne){return arguments.length?(J=ne*ne,te):Math.sqrt(J)},te}var ngraph_forcelayoutExports={},ngraph_forcelayout={get exports(){return ngraph_forcelayoutExports},set exports(U){ngraph_forcelayoutExports=U}},generateCreateBodyExports={},generateCreateBody={get exports(){return generateCreateBodyExports},set exports(U){generateCreateBodyExports=U}},getVariableName$2=function U(D){return D===0?"x":D===1?"y":D===2?"z":"c"+(D+1)};const getVariableName$1=getVariableName$2;var createPatternBuilder$6=function U(D){return F;function F(G,Q){let X=Q&&Q.indent||0,q=Q&&Q.join!==void 0?Q.join:`
`,W=Array(X+1).join(" "),Y=[];for(let J=0;J<D;++J){let te=getVariableName$1(J),Z=J===0?"":W;Y.push(Z+G.replace(/{var}/g,te))}return Y.join(q)}};const createPatternBuilder$5=createPatternBuilder$6;generateCreateBody.exports=generateCreateBodyFunction$1;generateCreateBodyExports.generateCreateBodyFunctionBody=generateCreateBodyFunctionBody;generateCreateBodyExports.getVectorCode=getVectorCode;generateCreateBodyExports.getBodyCode=getBodyCode;function generateCreateBodyFunction$1(U,D){let F=generateCreateBodyFunctionBody(U,D),{Body:G}=new Function(F)();return G}function generateCreateBodyFunctionBody(U,D){return`
${getVectorCode(U,D)}
${getBodyCode(U)}
return {Body: Body, Vector: Vector};
`}function getBodyCode(U){let D=createPatternBuilder$5(U),F=D("{var}",{join:", "});return`
function Body(${F}) {
  this.isPinned = false;
  this.pos = new Vector(${F});
  this.force = new Vector();
  this.velocity = new Vector();
  this.mass = 1;

  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.reset = function() {
  this.force.reset();
  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.setPosition = function (${F}) {
  ${D("this.pos.{var} = {var} || 0;",{indent:2})}
};`}function getVectorCode(U,D){let F=createPatternBuilder$5(U),G="";return D&&(G=`${F(`
   var v{var};
Object.defineProperty(this, '{var}', {
  set: function(v) { 
    if (!Number.isFinite(v)) throw new Error('Cannot set non-numbers to {var}');
    v{var} = v; 
  },
  get: function() { return v{var}; }
});`)}`),`function Vector(${F("{var}",{join:", "})}) {
  ${G}
    if (typeof arguments[0] === 'object') {
      // could be another vector
      let v = arguments[0];
      ${F('if (!Number.isFinite(v.{var})) throw new Error("Expected value is not a finite number at Vector constructor ({var})");',{indent:4})}
      ${F("this.{var} = v.{var};",{indent:4})}
    } else {
      ${F('this.{var} = typeof {var} === "number" ? {var} : 0;',{indent:4})}
    }
  }
  
  Vector.prototype.reset = function () {
    ${F("this.{var} = ",{join:""})}0;
  };`}var generateQuadTreeExports={},generateQuadTree={get exports(){return generateQuadTreeExports},set exports(U){generateQuadTreeExports=U}};const createPatternBuilder$4=createPatternBuilder$6,getVariableName=getVariableName$2;generateQuadTree.exports=generateQuadTreeFunction$1;generateQuadTreeExports.generateQuadTreeFunctionBody=generateQuadTreeFunctionBody;generateQuadTreeExports.getInsertStackCode=getInsertStackCode;generateQuadTreeExports.getQuadNodeCode=getQuadNodeCode;generateQuadTreeExports.isSamePosition=isSamePosition;generateQuadTreeExports.getChildBodyCode=getChildBodyCode;generateQuadTreeExports.setChildBodyCode=setChildBodyCode;function generateQuadTreeFunction$1(U){let D=generateQuadTreeFunctionBody(U);return new Function(D)()}function generateQuadTreeFunctionBody(U){let D=createPatternBuilder$4(U),F=Math.pow(2,U);return`
${getInsertStackCode()}
${getQuadNodeCode(U)}
${isSamePosition(U)}
${getChildBodyCode(U)}
${setChildBodyCode(U)}

function createQuadTree(options, random) {
  options = options || {};
  options.gravity = typeof options.gravity === 'number' ? options.gravity : -1;
  options.theta = typeof options.theta === 'number' ? options.theta : 0.8;

  var gravity = options.gravity;
  var updateQueue = [];
  var insertStack = new InsertStack();
  var theta = options.theta;

  var nodesCache = [];
  var currentInCache = 0;
  var root = newNode();

  return {
    insertBodies: insertBodies,

    /**
     * Gets root node if it is present
     */
    getRoot: function() {
      return root;
    },

    updateBodyForce: update,

    options: function(newOptions) {
      if (newOptions) {
        if (typeof newOptions.gravity === 'number') {
          gravity = newOptions.gravity;
        }
        if (typeof newOptions.theta === 'number') {
          theta = newOptions.theta;
        }

        return this;
      }

      return {
        gravity: gravity,
        theta: theta
      };
    }
  };

  function newNode() {
    // To avoid pressure on GC we reuse nodes.
    var node = nodesCache[currentInCache];
    if (node) {
${q("      node.")}
      node.body = null;
      node.mass = ${D("node.mass_{var} = ",{join:""})}0;
      ${D("node.min_{var} = node.max_{var} = ",{join:""})}0;
    } else {
      node = new QuadNode();
      nodesCache[currentInCache] = node;
    }

    ++currentInCache;
    return node;
  }

  function update(sourceBody) {
    var queue = updateQueue;
    var v;
    ${D("var d{var};",{indent:4})}
    var r; 
    ${D("var f{var} = 0;",{indent:4})}
    var queueLength = 1;
    var shiftIdx = 0;
    var pushIdx = 1;

    queue[0] = root;

    while (queueLength) {
      var node = queue[shiftIdx];
      var body = node.body;

      queueLength -= 1;
      shiftIdx += 1;
      var differentBody = (body !== sourceBody);
      if (body && differentBody) {
        // If the current node is a leaf node (and it is not source body),
        // calculate the force exerted by the current node on body, and add this
        // amount to body's net force.
        ${D("d{var} = body.pos.{var} - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${D("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Poor man's protection against zero distance.
          ${D("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${D("d{var} * d{var}",{join:" + "})});
        }

        // This is standard gravitation force calculation but we divide
        // by r^3 to save two operations when normalizing force vector.
        v = gravity * body.mass * sourceBody.mass / (r * r * r);
        ${D("f{var} += v * d{var};",{indent:8})}
      } else if (differentBody) {
        // Otherwise, calculate the ratio s / r,  where s is the width of the region
        // represented by the internal node, and r is the distance between the body
        // and the node's center-of-mass
        ${D("d{var} = node.mass_{var} / node.mass - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${D("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Sorry about code duplication. I don't want to create many functions
          // right away. Just want to see performance first.
          ${D("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${D("d{var} * d{var}",{join:" + "})});
        }
        // If s / r < , treat this internal node as a single body, and calculate the
        // force it exerts on sourceBody, and add this amount to sourceBody's net force.
        if ((node.max_${getVariableName(0)} - node.min_${getVariableName(0)}) / r < theta) {
          // in the if statement above we consider node's width only
          // because the region was made into square during tree creation.
          // Thus there is no difference between using width or height.
          v = gravity * node.mass * sourceBody.mass / (r * r * r);
          ${D("f{var} += v * d{var};",{indent:10})}
        } else {
          // Otherwise, run the procedure recursively on each of the current node's children.

          // I intentionally unfolded this loop, to save several CPU cycles.
${X()}
        }
      }
    }

    ${D("sourceBody.force.{var} += f{var};",{indent:4})}
  }

  function insertBodies(bodies) {
    ${D("var {var}min = Number.MAX_VALUE;",{indent:4})}
    ${D("var {var}max = Number.MIN_VALUE;",{indent:4})}
    var i = bodies.length;

    // To reduce quad tree depth we are looking for exact bounding box of all particles.
    while (i--) {
      var pos = bodies[i].pos;
      ${D("if (pos.{var} < {var}min) {var}min = pos.{var};",{indent:6})}
      ${D("if (pos.{var} > {var}max) {var}max = pos.{var};",{indent:6})}
    }

    // Makes the bounds square.
    var maxSideLength = -Infinity;
    ${D("if ({var}max - {var}min > maxSideLength) maxSideLength = {var}max - {var}min ;",{indent:4})}

    currentInCache = 0;
    root = newNode();
    ${D("root.min_{var} = {var}min;",{indent:4})}
    ${D("root.max_{var} = {var}min + maxSideLength;",{indent:4})}

    i = bodies.length - 1;
    if (i >= 0) {
      root.body = bodies[i];
    }
    while (i--) {
      insert(bodies[i], root);
    }
  }

  function insert(newBody) {
    insertStack.reset();
    insertStack.push(root, newBody);

    while (!insertStack.isEmpty()) {
      var stackItem = insertStack.pop();
      var node = stackItem.node;
      var body = stackItem.body;

      if (!node.body) {
        // This is internal node. Update the total mass of the node and center-of-mass.
        ${D("var {var} = body.pos.{var};",{indent:8})}
        node.mass += body.mass;
        ${D("node.mass_{var} += body.mass * {var};",{indent:8})}

        // Recursively insert the body in the appropriate quadrant.
        // But first find the appropriate quadrant.
        var quadIdx = 0; // Assume we are in the 0's quad.
        ${D("var min_{var} = node.min_{var};",{indent:8})}
        ${D("var max_{var} = (min_{var} + node.max_{var}) / 2;",{indent:8})}

${Q(8)}

        var child = getChild(node, quadIdx);

        if (!child) {
          // The node is internal but this quadrant is not taken. Add
          // subnode to it.
          child = newNode();
          ${D("child.min_{var} = min_{var};",{indent:10})}
          ${D("child.max_{var} = max_{var};",{indent:10})}
          child.body = body;

          setChild(node, quadIdx, child);
        } else {
          // continue searching in this quadrant.
          insertStack.push(child, body);
        }
      } else {
        // We are trying to add to the leaf node.
        // We have to convert current leaf into internal node
        // and continue adding two nodes.
        var oldBody = node.body;
        node.body = null; // internal nodes do not cary bodies

        if (isSamePosition(oldBody.pos, body.pos)) {
          // Prevent infinite subdivision by bumping one node
          // anywhere in this quadrant
          var retriesCount = 3;
          do {
            var offset = random.nextDouble();
            ${D("var d{var} = (node.max_{var} - node.min_{var}) * offset;",{indent:12})}

            ${D("oldBody.pos.{var} = node.min_{var} + d{var};",{indent:12})}
            retriesCount -= 1;
            // Make sure we don't bump it out of the box. If we do, next iteration should fix it
          } while (retriesCount > 0 && isSamePosition(oldBody.pos, body.pos));

          if (retriesCount === 0 && isSamePosition(oldBody.pos, body.pos)) {
            // This is very bad, we ran out of precision.
            // if we do not return from the method we'll get into
            // infinite loop here. So we sacrifice correctness of layout, and keep the app running
            // Next layout iteration should get larger bounding box in the first step and fix this
            return;
          }
        }
        // Next iteration should subdivide node further.
        insertStack.push(node, oldBody);
        insertStack.push(node, body);
      }
    }
  }
}
return createQuadTree;

`;function Q(W){let Y=[],J=Array(W+1).join(" ");for(let te=0;te<U;++te)Y.push(J+`if (${getVariableName(te)} > max_${getVariableName(te)}) {`),Y.push(J+`  quadIdx = quadIdx + ${Math.pow(2,te)};`),Y.push(J+`  min_${getVariableName(te)} = max_${getVariableName(te)};`),Y.push(J+`  max_${getVariableName(te)} = node.max_${getVariableName(te)};`),Y.push(J+"}");return Y.join(`
`)}function X(){let W=Array(11).join(" "),Y=[];for(let J=0;J<F;++J)Y.push(W+`if (node.quad${J}) {`),Y.push(W+`  queue[pushIdx] = node.quad${J};`),Y.push(W+"  queueLength += 1;"),Y.push(W+"  pushIdx += 1;"),Y.push(W+"}");return Y.join(`
`)}function q(W){let Y=[];for(let J=0;J<F;++J)Y.push(`${W}quad${J} = null;`);return Y.join(`
`)}}function isSamePosition(U){let D=createPatternBuilder$4(U);return`
  function isSamePosition(point1, point2) {
    ${D("var d{var} = Math.abs(point1.{var} - point2.{var});",{indent:2})}
  
    return ${D("d{var} < 1e-8",{join:" && "})};
  }  
`}function setChildBodyCode(U){var D=Math.pow(2,U);return`
function setChild(node, idx, child) {
  ${F()}
}`;function F(){let G=[];for(let Q=0;Q<D;++Q){let X=Q===0?"  ":"  else ";G.push(`${X}if (idx === ${Q}) node.quad${Q} = child;`)}return G.join(`
`)}}function getChildBodyCode(U){return`function getChild(node, idx) {
${D()}
  return null;
}`;function D(){let F=[],G=Math.pow(2,U);for(let Q=0;Q<G;++Q)F.push(`  if (idx === ${Q}) return node.quad${Q};`);return F.join(`
`)}}function getQuadNodeCode(U){let D=createPatternBuilder$4(U),F=Math.pow(2,U);var G=`
function QuadNode() {
  // body stored inside this node. In quad tree only leaf nodes (by construction)
  // contain bodies:
  this.body = null;

  // Child nodes are stored in quads. Each quad is presented by number:
  // 0 | 1
  // -----
  // 2 | 3
${Q("  this.")}

  // Total mass of current node
  this.mass = 0;

  // Center of mass coordinates
  ${D("this.mass_{var} = 0;",{indent:2})}

  // bounding box coordinates
  ${D("this.min_{var} = 0;",{indent:2})}
  ${D("this.max_{var} = 0;",{indent:2})}
}
`;return G;function Q(X){let q=[];for(let W=0;W<F;++W)q.push(`${X}quad${W} = null;`);return q.join(`
`)}}function getInsertStackCode(){return`
/**
 * Our implementation of QuadTree is non-recursive to avoid GC hit
 * This data structure represent stack of elements
 * which we are trying to insert into quad tree.
 */
function InsertStack () {
    this.stack = [];
    this.popIdx = 0;
}

InsertStack.prototype = {
    isEmpty: function() {
        return this.popIdx === 0;
    },
    push: function (node, body) {
        var item = this.stack[this.popIdx];
        if (!item) {
            // we are trying to avoid memory pressure: create new element
            // only when absolutely necessary
            this.stack[this.popIdx] = new InsertStackElement(node, body);
        } else {
            item.node = node;
            item.body = body;
        }
        ++this.popIdx;
    },
    pop: function () {
        if (this.popIdx > 0) {
            return this.stack[--this.popIdx];
        }
    },
    reset: function () {
        this.popIdx = 0;
    }
};

function InsertStackElement(node, body) {
    this.node = node; // QuadTree node
    this.body = body; // physical body which needs to be inserted to node
}
`}var generateBoundsExports={},generateBounds={get exports(){return generateBoundsExports},set exports(U){generateBoundsExports=U}};generateBounds.exports=generateBoundsFunction$1;generateBoundsExports.generateFunctionBody=generateBoundsFunctionBody;const createPatternBuilder$3=createPatternBuilder$6;function generateBoundsFunction$1(U){let D=generateBoundsFunctionBody(U);return new Function("bodies","settings","random",D)}function generateBoundsFunctionBody(U){let D=createPatternBuilder$3(U);return`
  var boundingBox = {
    ${D("min_{var}: 0, max_{var}: 0,",{indent:4})}
  };

  return {
    box: boundingBox,

    update: updateBoundingBox,

    reset: resetBoundingBox,

    getBestNewPosition: function (neighbors) {
      var ${D("base_{var} = 0",{join:", "})};

      if (neighbors.length) {
        for (var i = 0; i < neighbors.length; ++i) {
          let neighborPos = neighbors[i].pos;
          ${D("base_{var} += neighborPos.{var};",{indent:10})}
        }

        ${D("base_{var} /= neighbors.length;",{indent:8})}
      } else {
        ${D("base_{var} = (boundingBox.min_{var} + boundingBox.max_{var}) / 2;",{indent:8})}
      }

      var springLength = settings.springLength;
      return {
        ${D("{var}: base_{var} + (random.nextDouble() - 0.5) * springLength,",{indent:8})}
      };
    }
  };

  function updateBoundingBox() {
    var i = bodies.length;
    if (i === 0) return; // No bodies - no borders.

    ${D("var max_{var} = -Infinity;",{indent:4})}
    ${D("var min_{var} = Infinity;",{indent:4})}

    while(i--) {
      // this is O(n), it could be done faster with quadtree, if we check the root node bounds
      var bodyPos = bodies[i].pos;
      ${D("if (bodyPos.{var} < min_{var}) min_{var} = bodyPos.{var};",{indent:6})}
      ${D("if (bodyPos.{var} > max_{var}) max_{var} = bodyPos.{var};",{indent:6})}
    }

    ${D("boundingBox.min_{var} = min_{var};",{indent:4})}
    ${D("boundingBox.max_{var} = max_{var};",{indent:4})}
  }

  function resetBoundingBox() {
    ${D("boundingBox.min_{var} = boundingBox.max_{var} = 0;",{indent:4})}
  }
`}var generateCreateDragForceExports={},generateCreateDragForce={get exports(){return generateCreateDragForceExports},set exports(U){generateCreateDragForceExports=U}};const createPatternBuilder$2=createPatternBuilder$6;generateCreateDragForce.exports=generateCreateDragForceFunction$1;generateCreateDragForceExports.generateCreateDragForceFunctionBody=generateCreateDragForceFunctionBody;function generateCreateDragForceFunction$1(U){let D=generateCreateDragForceFunctionBody(U);return new Function("options",D)}function generateCreateDragForceFunctionBody(U){return`
  if (!Number.isFinite(options.dragCoefficient)) throw new Error('dragCoefficient is not a finite number');

  return {
    update: function(body) {
      ${createPatternBuilder$2(U)("body.force.{var} -= options.dragCoefficient * body.velocity.{var};",{indent:6})}
    }
  };
`}var generateCreateSpringForceExports={},generateCreateSpringForce={get exports(){return generateCreateSpringForceExports},set exports(U){generateCreateSpringForceExports=U}};const createPatternBuilder$1=createPatternBuilder$6;generateCreateSpringForce.exports=generateCreateSpringForceFunction$1;generateCreateSpringForceExports.generateCreateSpringForceFunctionBody=generateCreateSpringForceFunctionBody;function generateCreateSpringForceFunction$1(U){let D=generateCreateSpringForceFunctionBody(U);return new Function("options","random",D)}function generateCreateSpringForceFunctionBody(U){let D=createPatternBuilder$1(U);return`
  if (!Number.isFinite(options.springCoefficient)) throw new Error('Spring coefficient is not a number');
  if (!Number.isFinite(options.springLength)) throw new Error('Spring length is not a number');

  return {
    /**
     * Updates forces acting on a spring
     */
    update: function (spring) {
      var body1 = spring.from;
      var body2 = spring.to;
      var length = spring.length < 0 ? options.springLength : spring.length;
      ${D("var d{var} = body2.pos.{var} - body1.pos.{var};",{indent:6})}
      var r = Math.sqrt(${D("d{var} * d{var}",{join:" + "})});

      if (r === 0) {
        ${D("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:8})}
        r = Math.sqrt(${D("d{var} * d{var}",{join:" + "})});
      }

      var d = r - length;
      var coefficient = ((spring.coefficient > 0) ? spring.coefficient : options.springCoefficient) * d / r;

      ${D("body1.force.{var} += coefficient * d{var}",{indent:6})};
      body1.springCount += 1;
      body1.springLength += r;

      ${D("body2.force.{var} -= coefficient * d{var}",{indent:6})};
      body2.springCount += 1;
      body2.springLength += r;
    }
  };
`}var generateIntegratorExports={},generateIntegrator={get exports(){return generateIntegratorExports},set exports(U){generateIntegratorExports=U}};const createPatternBuilder=createPatternBuilder$6;generateIntegrator.exports=generateIntegratorFunction$1;generateIntegratorExports.generateIntegratorFunctionBody=generateIntegratorFunctionBody;function generateIntegratorFunction$1(U){let D=generateIntegratorFunctionBody(U);return new Function("bodies","timeStep","adaptiveTimeStepWeight",D)}function generateIntegratorFunctionBody(U){let D=createPatternBuilder(U);return`
  var length = bodies.length;
  if (length === 0) return 0;

  ${D("var d{var} = 0, t{var} = 0;",{indent:2})}

  for (var i = 0; i < length; ++i) {
    var body = bodies[i];
    if (body.isPinned) continue;

    if (adaptiveTimeStepWeight && body.springCount) {
      timeStep = (adaptiveTimeStepWeight * body.springLength/body.springCount);
    }

    var coeff = timeStep / body.mass;

    ${D("body.velocity.{var} += coeff * body.force.{var};",{indent:4})}
    ${D("var v{var} = body.velocity.{var};",{indent:4})}
    var v = Math.sqrt(${D("v{var} * v{var}",{join:" + "})});

    if (v > 1) {
      // We normalize it so that we move within timeStep range. 
      // for the case when v <= 1 - we let velocity to fade out.
      ${D("body.velocity.{var} = v{var} / v;",{indent:6})}
    }

    ${D("d{var} = timeStep * body.velocity.{var};",{indent:4})}

    ${D("body.pos.{var} += d{var};",{indent:4})}

    ${D("t{var} += Math.abs(d{var});",{indent:4})}
  }

  return (${D("t{var} * t{var}",{join:" + "})})/length;
`}var spring,hasRequiredSpring;function requireSpring(){if(hasRequiredSpring)return spring;hasRequiredSpring=1,spring=U;function U(D,F,G,Q){this.from=D,this.to=F,this.length=G,this.coefficient=Q}return spring}var ngraph_merge,hasRequiredNgraph_merge;function requireNgraph_merge(){if(hasRequiredNgraph_merge)return ngraph_merge;hasRequiredNgraph_merge=1,ngraph_merge=U;function U(D,F){var G;if(D||(D={}),F){for(G in F)if(F.hasOwnProperty(G)){var Q=D.hasOwnProperty(G),X=typeof F[G],q=!Q||typeof D[G]!==X;q?D[G]=F[G]:X==="object"&&(D[G]=U(D[G],F[G]))}}return D}return ngraph_merge}var ngraph_events=function U(D){validateSubject(D);var F=createEventsStorage(D);return D.on=F.on,D.off=F.off,D.fire=F.fire,D};function createEventsStorage(U){var D=Object.create(null);return{on:function(F,G,Q){if(typeof G!="function")throw new Error("callback is expected to be a function");var X=D[F];return X||(X=D[F]=[]),X.push({callback:G,ctx:Q}),U},off:function(F,G){var Q=typeof F>"u";if(Q)return D=Object.create(null),U;if(D[F]){var X=typeof G!="function";if(X)delete D[F];else for(var q=D[F],W=0;W<q.length;++W)q[W].callback===G&&q.splice(W,1)}return U},fire:function(F){var G=D[F];if(!G)return U;var Q;arguments.length>1&&(Q=Array.prototype.splice.call(arguments,1));for(var X=0;X<G.length;++X){var q=G[X];q.callback.apply(q.ctx,Q)}return U}}}function validateSubject(U){if(!U)throw new Error("Eventify cannot use falsy object as events subject");for(var D=["on","fire","off"],F=0;F<D.length;++F)if(U.hasOwnProperty(D[F]))throw new Error("Subject cannot be eventified, since it already has property '"+D[F]+"'")}var ngraph_randomExports={},ngraph_random={get exports(){return ngraph_randomExports},set exports(U){ngraph_randomExports=U}},hasRequiredNgraph_random;function requireNgraph_random(){if(hasRequiredNgraph_random)return ngraph_randomExports;hasRequiredNgraph_random=1,ngraph_random.exports=U,ngraph_randomExports.random=U,ngraph_randomExports.randomIterator=W;function U(Y){var J=typeof Y=="number"?Y:+new Date;return new D(J)}function D(Y){this.seed=Y}D.prototype.next=q,D.prototype.nextDouble=X,D.prototype.uniform=X,D.prototype.gaussian=F;function F(){var Y,J,te;do J=this.nextDouble()*2-1,te=this.nextDouble()*2-1,Y=J*J+te*te;while(Y>=1||Y===0);return J*Math.sqrt(-2*Math.log(Y)/Y)}D.prototype.levy=G;function G(){var Y=1.5,J=Math.pow(Q(1+Y)*Math.sin(Math.PI*Y/2)/(Q((1+Y)/2)*Y*Math.pow(2,(Y-1)/2)),1/Y);return this.gaussian()*J/Math.pow(Math.abs(this.gaussian()),1/Y)}function Q(Y){return Math.sqrt(2*Math.PI/Y)*Math.pow(1/Math.E*(Y+1/(12*Y-1/(10*Y))),Y)}function X(){var Y=this.seed;return Y=Y+2127912214+(Y<<12)&4294967295,Y=(Y^3345072700^Y>>>19)&4294967295,Y=Y+374761393+(Y<<5)&4294967295,Y=(Y+3550635116^Y<<9)&4294967295,Y=Y+4251993797+(Y<<3)&4294967295,Y=(Y^3042594569^Y>>>16)&4294967295,this.seed=Y,(Y&268435455)/268435456}function q(Y){return Math.floor(this.nextDouble()*Y)}function W(Y,J){var te=J||U();if(typeof te.next!="function")throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:ee,shuffle:Z};function Z(){var re,ne,le;for(re=Y.length-1;re>0;--re)ne=te.next(re+1),le=Y[ne],Y[ne]=Y[re],Y[re]=le;return Y}function ee(re){var ne,le,se;for(ne=Y.length-1;ne>0;--ne)le=te.next(ne+1),se=Y[le],Y[le]=Y[ne],Y[ne]=se,re(se);Y.length&&re(Y[0])}}return ngraph_randomExports}var createPhysicsSimulator_1=createPhysicsSimulator,generateCreateBodyFunction=generateCreateBodyExports,generateQuadTreeFunction=generateQuadTreeExports,generateBoundsFunction=generateBoundsExports,generateCreateDragForceFunction=generateCreateDragForceExports,generateCreateSpringForceFunction=generateCreateSpringForceExports,generateIntegratorFunction=generateIntegratorExports,dimensionalCache={};function createPhysicsSimulator(U){var D=requireSpring(),F=requireNgraph_merge(),G=ngraph_events;if(U){if(U.springCoeff!==void 0)throw new Error("springCoeff was renamed to springCoefficient");if(U.dragCoeff!==void 0)throw new Error("dragCoeff was renamed to dragCoefficient")}U=F(U,{springLength:10,springCoefficient:.8,gravity:-12,theta:.8,dragCoefficient:.9,timeStep:.5,adaptiveTimeStepWeight:0,dimensions:2,debug:!1});var Q=dimensionalCache[U.dimensions];if(!Q){var X=U.dimensions;Q={Body:generateCreateBodyFunction(X,U.debug),createQuadTree:generateQuadTreeFunction(X),createBounds:generateBoundsFunction(X),createDragForce:generateCreateDragForceFunction(X),createSpringForce:generateCreateSpringForceFunction(X),integrate:generateIntegratorFunction(X)},dimensionalCache[X]=Q}var q=Q.Body,W=Q.createQuadTree,Y=Q.createBounds,J=Q.createDragForce,te=Q.createSpringForce,Z=Q.integrate,ee=me=>new q(me),re=requireNgraph_random().random(42),ne=[],le=[],se=W(U,re),ie=Y(ne,U,re),ge=te(U,re),fe=J(U),ae=0,ue=[],pe=new Map,_e=0;Te("nbody",he),Te("spring",oe);var xe={bodies:ne,quadTree:se,springs:le,settings:U,addForce:Te,removeForce:ye,getForces:Ee,step:function(){for(var me=0;me<ue.length;++me)ue[me](_e);var ve=Z(ne,U.timeStep,U.adaptiveTimeStepWeight);return _e+=1,ve},addBody:function(me){if(!me)throw new Error("Body is required");return ne.push(me),me},addBodyAt:function(me){if(!me)throw new Error("Body position is required");var ve=ee(me);return ne.push(ve),ve},removeBody:function(me){if(me){var ve=ne.indexOf(me);if(!(ve<0))return ne.splice(ve,1),ne.length===0&&ie.reset(),!0}},addSpring:function(me,ve,we,Pe){if(!me||!ve)throw new Error("Cannot add null spring to force simulator");typeof we!="number"&&(we=-1);var Me=new D(me,ve,we,Pe>=0?Pe:-1);return le.push(Me),Me},getTotalMovement:function(){return ae},removeSpring:function(me){if(me){var ve=le.indexOf(me);if(ve>-1)return le.splice(ve,1),!0}},getBestNewBodyPosition:function(me){return ie.getBestNewPosition(me)},getBBox:be,getBoundingBox:be,invalidateBBox:function(){console.warn("invalidateBBox() is deprecated, bounds always recomputed on `getBBox()` call")},gravity:function(me){return me!==void 0?(U.gravity=me,se.options({gravity:me}),this):U.gravity},theta:function(me){return me!==void 0?(U.theta=me,se.options({theta:me}),this):U.theta},random:re};return expose(U,xe),G(xe),xe;function be(){return ie.update(),ie.box}function Te(me,ve){if(pe.has(me))throw new Error("Force "+me+" is already added");pe.set(me,ve),ue.push(ve)}function ye(me){var ve=ue.indexOf(pe.get(me));ve<0||(ue.splice(ve,1),pe.delete(me))}function Ee(){return pe}function he(){if(ne.length!==0){se.insertBodies(ne);for(var me=ne.length;me--;){var ve=ne[me];ve.isPinned||(ve.reset(),se.updateBodyForce(ve),fe.update(ve))}}}function oe(){for(var me=le.length;me--;)ge.update(le[me])}}function expose(U,D){for(var F in U)augment(U,D,F)}function augment(U,D,F){if(U.hasOwnProperty(F)&&typeof D[F]!="function"){var G=Number.isFinite(U[F]);G?D[F]=function(Q){if(Q!==void 0){if(!Number.isFinite(Q))throw new Error("Value of "+F+" should be a valid number.");return U[F]=Q,D}return U[F]}:D[F]=function(Q){return Q!==void 0?(U[F]=Q,D):U[F]}}}ngraph_forcelayout.exports=createLayout;ngraph_forcelayoutExports.simulator=createPhysicsSimulator_1;var eventify$1=ngraph_events;function createLayout(U,D){if(!U)throw new Error("Graph structure cannot be undefined");var F=D&&D.createSimulator||createPhysicsSimulator_1,G=F(D);if(Array.isArray(D))throw new Error("Physics settings is expected to be an object");var Q=U.version>19?he:Ee;D&&typeof D.nodeMass=="function"&&(Q=D.nodeMass);var X=new Map,q={},W=0,Y=G.settings.springTransform||noop;fe(),se();var J=!1,te={step:function(){if(W===0)return Z(!0),!0;var oe=G.step();te.lastMove=oe,te.fire("step");var me=oe/W,ve=me<=.01;return Z(ve),ve},getNodePosition:function(oe){return ye(oe).pos},setNodePosition:function(oe){var me=ye(oe);me.setPosition.apply(me,Array.prototype.slice.call(arguments,1))},getLinkPosition:function(oe){var me=q[oe];if(me)return{from:me.from.pos,to:me.to.pos}},getGraphRect:function(){return G.getBBox()},forEachBody:ee,pinNode:function(oe,me){var ve=ye(oe.id);ve.isPinned=!!me},isNodePinned:function(oe){return ye(oe.id).isPinned},dispose:function(){U.off("changed",ge),te.fire("disposed")},getBody:le,getSpring:ne,getForceVectorLength:re,simulator:G,graph:U,lastMove:0};return eventify$1(te),te;function Z(oe){J!==oe&&(J=oe,ie(oe))}function ee(oe){X.forEach(oe)}function re(){var oe=0,me=0;return ee(function(ve){oe+=Math.abs(ve.force.x),me+=Math.abs(ve.force.y)}),Math.sqrt(oe*oe+me*me)}function ne(oe,me){var ve;if(me===void 0)typeof oe!="object"?ve=oe:ve=oe.id;else{var we=U.hasLink(oe,me);if(!we)return;ve=we.id}return q[ve]}function le(oe){return X.get(oe)}function se(){U.on("changed",ge)}function ie(oe){te.fire("stable",oe)}function ge(oe){for(var me=0;me<oe.length;++me){var ve=oe[me];ve.changeType==="add"?(ve.node&&ae(ve.node.id),ve.link&&pe(ve.link)):ve.changeType==="remove"&&(ve.node&&ue(ve.node),ve.link&&_e(ve.link))}W=U.getNodesCount()}function fe(){W=0,U.forEachNode(function(oe){ae(oe.id),W+=1}),U.forEachLink(pe)}function ae(oe){var me=X.get(oe);if(!me){var ve=U.getNode(oe);if(!ve)throw new Error("initBody() was called with unknown node id");var we=ve.position;if(!we){var Pe=xe(ve);we=G.getBestNewBodyPosition(Pe)}me=G.addBodyAt(we),me.id=oe,X.set(oe,me),be(oe),Te(ve)&&(me.isPinned=!0)}}function ue(oe){var me=oe.id,ve=X.get(me);ve&&(X.delete(me),G.removeBody(ve))}function pe(oe){be(oe.fromId),be(oe.toId);var me=X.get(oe.fromId),ve=X.get(oe.toId),we=G.addSpring(me,ve,oe.length);Y(oe,we),q[oe.id]=we}function _e(oe){var me=q[oe.id];if(me){var ve=U.getNode(oe.fromId),we=U.getNode(oe.toId);ve&&be(ve.id),we&&be(we.id),delete q[oe.id],G.removeSpring(me)}}function xe(oe){var me=[];if(!oe.links)return me;for(var ve=Math.min(oe.links.length,2),we=0;we<ve;++we){var Pe=oe.links[we],Me=Pe.fromId!==oe.id?X.get(Pe.fromId):X.get(Pe.toId);Me&&Me.pos&&me.push(Me)}return me}function be(oe){var me=X.get(oe);if(me.mass=Q(oe),Number.isNaN(me.mass))throw new Error("Node mass should be a number")}function Te(oe){return oe&&(oe.isPinned||oe.data&&oe.data.isPinned)}function ye(oe){var me=X.get(oe);return me||(ae(oe),me=X.get(oe)),me}function Ee(oe){var me=U.getLinks(oe);return me?1+me.length/3:1}function he(oe){var me=U.getLinks(oe);return me?1+me.size/3:1}}function noop(){}var ngraph_graph=createGraph,eventify=ngraph_events;function createGraph(U){if(U=U||{},"uniqueLinkId"in U&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n",`
`,`Note: there is also change in default behavior: From now on each graph
is considered to be not a multigraph by default (each edge is unique).`),U.multigraph=U.uniqueLinkId),U.multigraph===void 0&&(U.multigraph=!1),typeof Map!="function")throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var D=new Map,F=new Map,G={},Q=0,X=U.multigraph?ae:fe,q=[],W=ve,Y=ve,J=ve,te=ve,Z={version:20,addNode:le,addLink:ge,removeLink:xe,removeNode:ie,getNode:se,getNodeCount:ue,getLinkCount:pe,getEdgeCount:pe,getLinksCount:pe,getNodesCount:ue,getLinks:_e,forEachNode:Me,forEachLinkedNode:he,forEachLink:Ee,beginUpdate:J,endUpdate:te,clear:ye,hasLink:Te,hasNode:se,getLink:Te};return eventify(Z),ee(),Z;function ee(){var De=Z.on;Z.on=Oe;function Oe(){return Z.beginUpdate=J=we,Z.endUpdate=te=Pe,W=re,Y=ne,Z.on=De,De.apply(Z,arguments)}}function re(De,Oe){q.push({link:De,changeType:Oe})}function ne(De,Oe){q.push({node:De,changeType:Oe})}function le(De,Oe){if(De===void 0)throw new Error("Invalid node identifier");J();var Ie=se(De);return Ie?(Ie.data=Oe,Y(Ie,"update")):(Ie=new Node(De,Oe),Y(Ie,"add")),D.set(De,Ie),te(),Ie}function se(De){return D.get(De)}function ie(De){var Oe=se(De);if(!Oe)return!1;J();var Ie=Oe.links;return Ie&&(Ie.forEach(be),Oe.links=null),D.delete(De),Y(Oe,"remove"),te(),!0}function ge(De,Oe,Ie){J();var Be=se(De)||le(De),ze=se(Oe)||le(Oe),et=X(De,Oe,Ie),qe=F.has(et.id);return F.set(et.id,et),addLinkToNode(Be,et),De!==Oe&&addLinkToNode(ze,et),W(et,qe?"update":"add"),te(),et}function fe(De,Oe,Ie){var Be=makeLinkId(De,Oe),ze=F.get(Be);return ze?(ze.data=Ie,ze):new Link(De,Oe,Ie,Be)}function ae(De,Oe,Ie){var Be=makeLinkId(De,Oe),ze=G.hasOwnProperty(Be);if(ze||Te(De,Oe)){ze||(G[Be]=0);var et="@"+ ++G[Be];Be=makeLinkId(De+et,Oe+et)}return new Link(De,Oe,Ie,Be)}function ue(){return D.size}function pe(){return F.size}function _e(De){var Oe=se(De);return Oe?Oe.links:null}function xe(De,Oe){return Oe!==void 0&&(De=Te(De,Oe)),be(De)}function be(De){if(!De||!F.get(De.id))return!1;J(),F.delete(De.id);var Oe=se(De.fromId),Ie=se(De.toId);return Oe&&Oe.links.delete(De),Ie&&Ie.links.delete(De),W(De,"remove"),te(),!0}function Te(De,Oe){if(!(De===void 0||Oe===void 0))return F.get(makeLinkId(De,Oe))}function ye(){J(),Me(function(De){ie(De.id)}),te()}function Ee(De){if(typeof De=="function")for(var Oe=F.values(),Ie=Oe.next();!Ie.done;){if(De(Ie.value))return!0;Ie=Oe.next()}}function he(De,Oe,Ie){var Be=se(De);if(Be&&Be.links&&typeof Oe=="function")return Ie?me(Be.links,De,Oe):oe(Be.links,De,Oe)}function oe(De,Oe,Ie){for(var Be,ze=De.values(),et=ze.next();!et.done;){var qe=et.value,je=qe.fromId===Oe?qe.toId:qe.fromId;if(Be=Ie(D.get(je),qe),Be)return!0;et=ze.next()}}function me(De,Oe,Ie){for(var Be,ze=De.values(),et=ze.next();!et.done;){var qe=et.value;if(qe.fromId===Oe&&(Be=Ie(D.get(qe.toId),qe),Be))return!0;et=ze.next()}}function ve(){}function we(){Q+=1}function Pe(){Q-=1,Q===0&&q.length>0&&(Z.fire("changed",q),q.length=0)}function Me(De){if(typeof De!="function")throw new Error("Function is expected to iterate over graph nodes. You passed "+De);for(var Oe=D.values(),Ie=Oe.next();!Ie.done;){if(De(Ie.value))return!0;Ie=Oe.next()}}}function Node(U,D){this.id=U,this.links=null,this.data=D}function addLinkToNode(U,D){U.links?U.links.add(D):U.links=new Set([D])}function Link(U,D,F,G){this.fromId=U,this.toId=D,this.data=F,this.id=G}function makeLinkId(U,D){return U.toString()+"\uD83D\uDC49 "+D.toString()}class GraphLayoutSim{constructor(D){this.positions=new Float32Array(0),this.graphData=D}get positionsBuffer(){return new Float32Array(this.positions)}start(){throw new Error("not implemented")}stop(){throw new Error("not implemented")}getPositions(D){const F=this.positionsBuffer;D(F)}}let D3ForceLayout$1=class extends GraphLayoutSim{constructor(D){super(D),this.layoutEngine=forceSimulation(D.nodes,3).force("charge",forceManyBody()).force("link",forceLink(D.links).id(F=>F.id)).force("center",forceCenter()),this.layoutEngine.on("tick",()=>{const F=this.graphData.nodes.flatMap(({x:G,y:Q,z:X})=>[G,Q,X].map(q=>q));this.positions=new Float32Array(F)})}start(){this.layoutEngine.restart()}stop(){this.layoutEngine.stop()}},NgraphForceLayout$1=class extends GraphLayoutSim{constructor(D){super(D);const F=ngraph_graph();D.nodes.forEach(G=>{F.addNode(G.id,G)}),D.links.forEach(G=>{F.addLink(G.source,G.target)}),this.layoutEngine=ngraph_forcelayoutExports(F,{dimensions:3});for(let G of D.nodes)this.layoutEngine.setNodePosition(G.id,G.x,G.y,G.z);this.layoutEngine.on("step",()=>{const G=D.nodes.flatMap(({id:Q})=>{const{x:X,y:q,z:W}=this.layoutEngine.getNodePosition(Q);return[X,q,W].map(Y=>Y)});this.positions=new Float32Array(G)})}start(){const D=()=>{this.layoutEngine.step(),using===this.layoutEngine&&rafExports(D)};D()}stop(){this.layoutEngine.dispose()}};const layout=Object.freeze(Object.defineProperty({__proto__:null,D3ForceLayout:D3ForceLayout$1,NgraphForceLayout:NgraphForceLayout$1},Symbol.toStringTag,{value:"Module"})),transfer=(U,D)=>transfer$1(U,D);var transformMat4_1=transformMat4$2;function transformMat4$2(U,D,F){var G=D[0],Q=D[1],X=D[2],q=F[3]*G+F[7]*Q+F[11]*X+F[15];return q=q||1,U[0]=(F[0]*G+F[4]*Q+F[8]*X+F[12])/q,U[1]=(F[1]*G+F[5]*Q+F[9]*X+F[13])/q,U[2]=(F[2]*G+F[6]*Q+F[10]*X+F[14])/q,U}var rotateY_1=rotateY;function rotateY(U,D,F,G){var Q=F[0],X=F[2],q=D[0]-Q,W=D[2]-X,Y=Math.sin(G),J=Math.cos(G);return U[0]=Q+W*Y+q*J,U[1]=D[1],U[2]=X+W*J-q*Y,U}var rotateX_1=rotateX;function rotateX(U,D,F,G){var Q=F[1],X=F[2],q=D[1]-Q,W=D[2]-X,Y=Math.sin(G),J=Math.cos(G);return U[0]=D[0],U[1]=Q+q*J-W*Y,U[2]=X+q*Y+W*J,U}var epsilon=1e-6,equals_1=equals,EPSILON=epsilon;function equals(U,D){var F=U[0],G=U[1],Q=U[2],X=D[0],q=D[1],W=D[2];return Math.abs(F-X)<=EPSILON*Math.max(1,Math.abs(F),Math.abs(X))&&Math.abs(G-q)<=EPSILON*Math.max(1,Math.abs(G),Math.abs(q))&&Math.abs(Q-W)<=EPSILON*Math.max(1,Math.abs(Q),Math.abs(W))}var add_1=add;function add(U,D,F){return U[0]=D[0]+F[0],U[1]=D[1]+F[1],U[2]=D[2]+F[2],U}var scaleAndAdd_1=scaleAndAdd;function scaleAndAdd(U,D,F,G){return U[0]=D[0]+F[0]*G,U[1]=D[1]+F[1]*G,U[2]=D[2]+F[2]*G,U}var copy_1=copy;function copy(U,D){return U[0]=D[0],U[1]=D[1],U[2]=D[2],U}var normalize_1=normalize;function normalize(U,D){var F=D[0],G=D[1],Q=D[2],X=F*F+G*G+Q*Q;return X>0&&(X=1/Math.sqrt(X),U[0]=D[0]*X,U[1]=D[1]*X,U[2]=D[2]*X),U}var identity_1=identity$1;function identity$1(U){return U[0]=1,U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[5]=1,U[6]=0,U[7]=0,U[8]=0,U[9]=0,U[10]=1,U[11]=0,U[12]=0,U[13]=0,U[14]=0,U[15]=1,U}var invert_1=invert;function invert(U,D){var F=D[0],G=D[1],Q=D[2],X=D[3],q=D[4],W=D[5],Y=D[6],J=D[7],te=D[8],Z=D[9],ee=D[10],re=D[11],ne=D[12],le=D[13],se=D[14],ie=D[15],ge=F*W-G*q,fe=F*Y-Q*q,ae=F*J-X*q,ue=G*Y-Q*W,pe=G*J-X*W,_e=Q*J-X*Y,xe=te*le-Z*ne,be=te*se-ee*ne,Te=te*ie-re*ne,ye=Z*se-ee*le,Ee=Z*ie-re*le,he=ee*ie-re*se,oe=ge*he-fe*Ee+ae*ye+ue*Te-pe*be+_e*xe;return oe?(oe=1/oe,U[0]=(W*he-Y*Ee+J*ye)*oe,U[1]=(Q*Ee-G*he-X*ye)*oe,U[2]=(le*_e-se*pe+ie*ue)*oe,U[3]=(ee*pe-Z*_e-re*ue)*oe,U[4]=(Y*Te-q*he-J*be)*oe,U[5]=(F*he-Q*Te+X*be)*oe,U[6]=(se*ae-ne*_e-ie*fe)*oe,U[7]=(te*_e-ee*ae+re*fe)*oe,U[8]=(q*Ee-W*Te+J*xe)*oe,U[9]=(G*Te-F*Ee-X*xe)*oe,U[10]=(ne*pe-le*ae+ie*ge)*oe,U[11]=(Z*ae-te*pe-re*ge)*oe,U[12]=(W*be-q*ye-Y*xe)*oe,U[13]=(F*ye-G*be+Q*xe)*oe,U[14]=(le*fe-ne*ue-se*ge)*oe,U[15]=(te*ue-Z*fe+ee*ge)*oe,U):null}var translate_1=translate;function translate(U,D,F){var G=F[0],Q=F[1],X=F[2],q,W,Y,J,te,Z,ee,re,ne,le,se,ie;return D===U?(U[12]=D[0]*G+D[4]*Q+D[8]*X+D[12],U[13]=D[1]*G+D[5]*Q+D[9]*X+D[13],U[14]=D[2]*G+D[6]*Q+D[10]*X+D[14],U[15]=D[3]*G+D[7]*Q+D[11]*X+D[15]):(q=D[0],W=D[1],Y=D[2],J=D[3],te=D[4],Z=D[5],ee=D[6],re=D[7],ne=D[8],le=D[9],se=D[10],ie=D[11],U[0]=q,U[1]=W,U[2]=Y,U[3]=J,U[4]=te,U[5]=Z,U[6]=ee,U[7]=re,U[8]=ne,U[9]=le,U[10]=se,U[11]=ie,U[12]=q*G+te*Q+ne*X+D[12],U[13]=W*G+Z*Q+le*X+D[13],U[14]=Y*G+ee*Q+se*X+D[14],U[15]=J*G+re*Q+ie*X+D[15]),U}var scale_1=scale$2;function scale$2(U,D,F){var G=F[0],Q=F[1],X=F[2];return U[0]=D[0]*G,U[1]=D[1]*G,U[2]=D[2]*G,U[3]=D[3]*G,U[4]=D[4]*Q,U[5]=D[5]*Q,U[6]=D[6]*Q,U[7]=D[7]*Q,U[8]=D[8]*X,U[9]=D[9]*X,U[10]=D[10]*X,U[11]=D[11]*X,U[12]=D[12],U[13]=D[13],U[14]=D[14],U[15]=D[15],U}var identity=identity_1,lookAt_1=lookAt$1;function lookAt$1(U,D,F,G){var Q,X,q,W,Y,J,te,Z,ee,re,ne=D[0],le=D[1],se=D[2],ie=G[0],ge=G[1],fe=G[2],ae=F[0],ue=F[1],pe=F[2];return Math.abs(ne-ae)<1e-6&&Math.abs(le-ue)<1e-6&&Math.abs(se-pe)<1e-6?identity(U):(te=ne-ae,Z=le-ue,ee=se-pe,re=1/Math.sqrt(te*te+Z*Z+ee*ee),te*=re,Z*=re,ee*=re,Q=ge*ee-fe*Z,X=fe*te-ie*ee,q=ie*Z-ge*te,re=Math.sqrt(Q*Q+X*X+q*q),re?(re=1/re,Q*=re,X*=re,q*=re):(Q=0,X=0,q=0),W=Z*q-ee*X,Y=ee*Q-te*q,J=te*X-Z*Q,re=Math.sqrt(W*W+Y*Y+J*J),re?(re=1/re,W*=re,Y*=re,J*=re):(W=0,Y=0,J=0),U[0]=Q,U[1]=W,U[2]=te,U[3]=0,U[4]=X,U[5]=Y,U[6]=Z,U[7]=0,U[8]=q,U[9]=J,U[10]=ee,U[11]=0,U[12]=-(Q*ne+X*le+q*se),U[13]=-(W*ne+Y*le+J*se),U[14]=-(te*ne+Z*le+ee*se),U[15]=1,U)}var perspective_1=perspective$1;function perspective$1(U,D,F,G,Q){var X=1/Math.tan(D/2),q=1/(G-Q);return U[0]=X/F,U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[5]=X,U[6]=0,U[7]=0,U[8]=0,U[9]=0,U[10]=(Q+G)*q,U[11]=-1,U[12]=0,U[13]=0,U[14]=2*Q*G*q,U[15]=0,U}var transformMat4$1=transformMat4_1,vec3RotateY=rotateY_1,vec3RotateX=rotateX_1,vec3Equals=equals_1,vec3Add=add_1,vec3ScaleAndAdd=scaleAndAdd_1,vec3Copy=copy_1,vec3Normalize=normalize_1,mat4Identity=identity_1,mat4Invert=invert_1,mat4Translate=translate_1,mat4Scale=scale_1,lookAt=lookAt_1,perspective=perspective_1,MAX_PHI=Math.PI*.5-1e-4,MIN_PHI=-Math.PI*.5+1e-4,inertialTurntableCamera=function U(D){D=D||{};var F=!0,G={aspectRatio:D.aspectRatio?D.aspectRatio:1,zoomAboutCursor:D.zoomAboutCursor===void 0?!0:D.zoomAboutCursor,distance:D.distance===void 0?10:D.distance,phi:D.phi===void 0?0:D.phi,theta:D.theta===void 0?0:D.theta,fovY:D.fovY===void 0?Math.PI/4:D.fovY,near:D.near===void 0?.1:D.near,far:D.far===void 0?100:D.far,panDecayTime:D.panDecayTime||100,zoomDecayTime:D.zoomDecayTime||100,rotationDecayTime:D.rotationDecayTime||100,dirty:!0,up:D.up||new Float32Array([0,1,0]),center:D.center||new Float32Array(3),rotationCenter:D.rotationCenter||D.center&&D.center.slice()||new Float32Array(3),zoom:0,panX:0,panY:0,panZ:0,pitch:0,yaw:0,dTheta:0,dPhi:0,mouseX:0,mouseY:0},Q=null,X={tick:function(he){if(_e.zoom&&(G.zoom=_e.zoom),_e.dTheta&&(G.dTheta=_e.dTheta),_e.dPhi&&(G.dPhi=_e.dPhi),_e.panX&&(G.panX=_e.panX),_e.panY&&(G.panY=_e.panY),_e.panZ&&(G.panZ=_e.panZ),_e.yaw&&(G.yaw=_e.yaw),_e.pitch&&(G.pitch=_e.pitch),ue(_e),he){var oe=G.dPhi,me=G.dTheta,ve=G.zoom,we=G.panX,Pe=G.panY,Me=G.panZ,De=G.pitch,Oe=G.yaw;Object.assign(G,he),he.dPhi!==void 0&&(G.dPhi+=oe),he.dTheta!==void 0&&(G.dTheta+=me),he.zoom!==void 0&&(G.zoom+=ve),he.panX!==void 0&&(G.panX+=we),he.panY!==void 0&&(G.panY+=Pe),he.panZ!==void 0&&(G.panZ+=Me),he.pitch!==void 0&&(G.pitch+=De),he.yaw!==void 0&&(G.yaw+=Oe)}ne()&&se(),ae()?Ee(G):ue(G);var Ie=Date.now();Q!==null&&pe(Ie-Q),Q=Ie,X.state.dirty=F,F=!1,re()},taint:ge,resize:fe,params:G,rotate:ye,pivot:Te,pan:xe,zoom:be};X.state={},X.state.projection=new Float32Array(16),X.state.viewInv=new Float32Array(16),X.state.view=new Float32Array(16),X.state.width=null,X.state.height=null,X.state.eye=new Float32Array(3);var q=new Float32Array(3),W=new Float32Array(3),Y=new Float32Array(3),J=new Float32Array(3),te=new Float32Array(3),Z=new Float32Array(16),ee={up:new Float32Array(3),center:new Float32Array(3)};re();function re(){vec3Copy(ee.up,G.up),vec3Copy(ee.center,G.center),ee.near=G.near,ee.far=G.far,ee.distance=G.distance,ee.phi=G.phi,ee.theta=G.theta,ee.fovY=G.fovY}function ne(){return!vec3Equals(G.up,ee.up)||!vec3Equals(G.center,ee.center)||G.near!==ee.near||G.far!==ee.far||G.phi!==ee.phi||G.theta!==ee.theta||G.distance!==ee.distance||G.fovY!==ee.fovY}var le={};function se(){le.dPhi=G.phi-ee.phi,le.dTheta=G.theta-ee.theta,le.zoom=G.distance/ee.distance-1,G.theta=ee.theta,G.distance=ee.distance,G.phi=ee.phi,le.yaw=0,le.pitch=0,le.panX=0,le.panY=0,le.panZ=0,le.mouseX=0,le.mouseY=0,Ee(le)}function ie(){X.state.eye[0]=0,X.state.eye[1]=0,X.state.eye[2]=G.distance,vec3RotateX(X.state.eye,X.state.eye,te,-G.phi),vec3RotateY(X.state.eye,X.state.eye,te,G.theta),vec3Add(X.state.eye,X.state.eye,G.center),lookAt(X.state.view,X.state.eye,G.center,G.up),perspective(X.state.projection,G.fovY,X.params.aspectRatio,G.near,G.far),mat4Invert(X.state.viewInv,X.state.view)}function ge(){F=!0}function fe(he){X.params.aspectRatio=he,ie(),ge()}function ae(){if(Math.abs(G.zoom)>1e-4||Math.abs(G.panX)>1e-4||Math.abs(G.panY)>1e-4||Math.abs(G.panZ)>1e-4||Math.abs(G.dTheta)>1e-4||Math.abs(G.dPhi)>1e-4||Math.abs(G.yaw)>1e-4||Math.abs(G.pitch)>1e-4)return!0}function ue(he){he.zoom=0,he.dTheta=0,he.dPhi=0,he.panX=0,he.panY=0,he.panZ=0,he.yaw=0,he.pitch=0}function pe(he){var oe=G.panDecayTime?Math.exp(-he/G.panDecayTime/Math.LN2):0,me=G.zoomDecayTime?Math.exp(-he/G.zoomDecayTime/Math.LN2):0,ve=G.rotationDecayTime?Math.exp(-he/G.rotationDecayTime/Math.LN2):0;G.zoom*=me,G.panX*=oe,G.panY*=oe,G.panZ*=oe,G.dTheta*=ve,G.dPhi*=ve,G.yaw*=ve,G.pitch*=ve}var _e={};ue(_e);function xe(he,oe){var me=X.params.distance*Math.tan(X.params.fovY*.5)*2;return _e.panX+=he*G.aspectRatio*me,_e.panY+=oe*me,X}function be(he,oe,me){return _e.zoom+=me,G.mouseX=he,G.mouseY=oe,X}function Te(he,oe){var me=X.params.fovY;_e.yaw+=he*me*G.aspectRatio,_e.pitch+=oe*me}function ye(he,oe){_e.dTheta+=he,_e.dPhi+=oe}function Ee(he){var oe;mat4Identity(Z),G.zoomAboutCursor&&(oe=G.distance*Math.tan(G.fovY*.5),q[0]=he.mouseX*G.aspectRatio*oe,q[1]=he.mouseY*oe,q[2]=0,mat4Translate(Z,Z,q)),q[0]=1+he.zoom,q[1]=1+he.zoom,q[2]=1,mat4Scale(Z,Z,q),G.zoomAboutCursor&&(oe=G.distance*Math.tan(G.fovY*.5),q[0]=-he.mouseX*G.aspectRatio*oe,q[1]=-he.mouseY*oe,q[2]=0,mat4Translate(Z,Z,q)),Z[12]-=he.panX*.5,Z[13]-=he.panY*.5,transformMat4$1(G.center,G.center,X.state.view),transformMat4$1(G.center,G.center,Z),transformMat4$1(G.center,G.center,X.state.viewInv),G.rotateAboutCenter&&vec3Copy(G.rotationCenter,G.center),G.distance*=1+he.zoom;var me=G.phi;G.phi+=he.dPhi,G.phi=Math.min(MAX_PHI,Math.max(MIN_PHI,G.phi));var ve=G.phi-me,we=G.theta;G.theta+=he.dTheta;var Pe=G.theta-we;if(vec3RotateY(G.center,G.center,G.rotationCenter,Pe-G.theta),vec3RotateX(G.center,G.center,G.rotationCenter,-ve),vec3RotateY(G.center,G.center,G.rotationCenter,G.theta),he.yaw!==0||he.pitch!==0){Y[0]=X.state.view[0],Y[1]=X.state.view[4],Y[2]=X.state.view[8],vec3Normalize(Y,Y),W[0]=X.state.view[1],W[1]=X.state.view[5],W[2]=X.state.view[9],vec3Normalize(W,W),J[0]=X.state.view[2],J[1]=X.state.view[6],J[2]=X.state.view[10],vec3Normalize(J,J);var Me=Math.min(MAX_PHI,Math.max(MIN_PHI,G.phi+he.pitch*.5)),De=Me-G.phi;vec3ScaleAndAdd(G.center,G.center,Y,-Math.sin(he.yaw*.5)*G.distance),vec3ScaleAndAdd(G.center,G.center,W,-Math.sin(De)*G.distance),vec3ScaleAndAdd(G.center,G.center,J,(2-Math.cos(he.yaw*.5)-Math.cos(De))*G.distance),G.phi=Me,G.theta+=he.yaw*.5}ie(),ge()}return fe(X.params.aspectRatio),X},ARRAY_TYPE=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var U=0,D=arguments.length;D--;)U+=arguments[D]*arguments[D];return Math.sqrt(U)});function create$1(){var U=new ARRAY_TYPE(16);return ARRAY_TYPE!=Float32Array&&(U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[6]=0,U[7]=0,U[8]=0,U[9]=0,U[11]=0,U[12]=0,U[13]=0,U[14]=0),U[0]=1,U[5]=1,U[10]=1,U[15]=1,U}function fromValues$1(U,D,F,G,Q,X,q,W,Y,J,te,Z,ee,re,ne,le){var se=new ARRAY_TYPE(16);return se[0]=U,se[1]=D,se[2]=F,se[3]=G,se[4]=Q,se[5]=X,se[6]=q,se[7]=W,se[8]=Y,se[9]=J,se[10]=te,se[11]=Z,se[12]=ee,se[13]=re,se[14]=ne,se[15]=le,se}function multiply(U,D,F){var G=D[0],Q=D[1],X=D[2],q=D[3],W=D[4],Y=D[5],J=D[6],te=D[7],Z=D[8],ee=D[9],re=D[10],ne=D[11],le=D[12],se=D[13],ie=D[14],ge=D[15],fe=F[0],ae=F[1],ue=F[2],pe=F[3];return U[0]=fe*G+ae*W+ue*Z+pe*le,U[1]=fe*Q+ae*Y+ue*ee+pe*se,U[2]=fe*X+ae*J+ue*re+pe*ie,U[3]=fe*q+ae*te+ue*ne+pe*ge,fe=F[4],ae=F[5],ue=F[6],pe=F[7],U[4]=fe*G+ae*W+ue*Z+pe*le,U[5]=fe*Q+ae*Y+ue*ee+pe*se,U[6]=fe*X+ae*J+ue*re+pe*ie,U[7]=fe*q+ae*te+ue*ne+pe*ge,fe=F[8],ae=F[9],ue=F[10],pe=F[11],U[8]=fe*G+ae*W+ue*Z+pe*le,U[9]=fe*Q+ae*Y+ue*ee+pe*se,U[10]=fe*X+ae*J+ue*re+pe*ie,U[11]=fe*q+ae*te+ue*ne+pe*ge,fe=F[12],ae=F[13],ue=F[14],pe=F[15],U[12]=fe*G+ae*W+ue*Z+pe*le,U[13]=fe*Q+ae*Y+ue*ee+pe*se,U[14]=fe*X+ae*J+ue*re+pe*ie,U[15]=fe*q+ae*te+ue*ne+pe*ge,U}function create(){var U=new ARRAY_TYPE(4);return ARRAY_TYPE!=Float32Array&&(U[0]=0,U[1]=0,U[2]=0,U[3]=0),U}function fromValues(U,D,F,G){var Q=new ARRAY_TYPE(4);return Q[0]=U,Q[1]=D,Q[2]=F,Q[3]=G,Q}function scale$1(U,D,F){return U[0]=D[0]*F,U[1]=D[1]*F,U[2]=D[2]*F,U[3]=D[3]*F,U}function transformMat4(U,D,F){var G=D[0],Q=D[1],X=D[2],q=D[3];return U[0]=F[0]*G+F[4]*Q+F[8]*X+F[12]*q,U[1]=F[1]*G+F[5]*Q+F[9]*X+F[13]*q,U[2]=F[2]*G+F[6]*Q+F[10]*X+F[14]*q,U[3]=F[3]*G+F[7]*Q+F[11]*X+F[15]*q,U}(function(){var U=create();return function(D,F,G,Q,X,q){var W,Y;for(F||(F=4),G||(G=0),Q?Y=Math.min(Q*F+G,D.length):Y=D.length,W=G;W<Y;W+=F)U[0]=D[W],U[1]=D[W+1],U[2]=D[W+2],U[3]=D[W+3],X(U,U,q),D[W]=U[0],D[W+1]=U[1],D[W+2]=U[2],D[W+3]=U[3];return D}})();class SpringDamper{constructor(D,F=15,G=15){this.target=D,this.stiffness=F,this.damping=G,this.velocity=this._initializeVelocity(D),this.animationFrameId=null,this.currentValues=this._clone(D),this.paused=!1}_initializeVelocity(D){if(typeof D=="number")return 0;if(Array.isArray(D)||ArrayBuffer.isView(D))return D.map(()=>0);{const F={};for(const G in D)F[G]=0;return F}}_clone(D){return Array.isArray(D)?[...D]:ArrayBuffer.isView(D)?D.slice():typeof D=="object"?{...D}:D}updateTarget(D){this.target=D}updateInitialValues(D){this.currentValues=this._clone(D)}_interpolateSpring(D,F,G,Q,X,q){const W=F-D,Y=Q*W,J=-X*G,te=Y+J,Z=G+te*q;return{newCurrentValue:D+Z*q,newVelocity:Z}}step(D){if(this.paused)return this.currentValues;const F=(G,Q,X)=>this._interpolateSpring(G,Q,X,this.stiffness,this.damping,D);if(typeof this.target=="number"){const{newCurrentValue:G,newVelocity:Q}=F(this.currentValues,this.target,this.velocity);this.currentValues=G,this.velocity=Q}else if(Array.isArray(this.target)||ArrayBuffer.isView(this.target))for(let G=0;G<this.target.length;G++){const{newCurrentValue:Q,newVelocity:X}=F(this.currentValues[G],this.target[G],this.velocity[G]);this.currentValues[G]=Q,this.velocity[G]=X}else for(const G in this.target){const{newCurrentValue:Q,newVelocity:X}=F(this.currentValues[G],this.target[G],this.velocity[G]);this.currentValues[G]=Q,this.velocity[G]=X}return this.currentValues}animate(D){const F=.016666666666666666,G=()=>{const Q=this.step(F);D(Q),this.animationFrameId=rafExports(G)};this.stop(),this.animationFrameId=rafExports(G)}pause(){this.paused=!0}resume(){this.paused=!1}stop(){rafExports.cancel(this.animationFrameId)}}const getGlobalCamera=moize.infinite(()=>inertialTurntableCamera({panDecayTime:200,zoomDecayTime:200,rotationDecayTime:500,distance:2e3})),getOrthographicCamera=moize.infinite(U=>inertialTurntableCamera({phi:Math.PI/4,theta:Math.PI/4,distance:200,center:[0,0,0],fovY:.013888888888888888*(Math.PI/2),near:2,far:400})),globalCamera$1=getGlobalCamera();getOrthographicCamera("zoomed");const updateCameras$1=(U,D,F)=>{const G=getGlobalCamera(),Q={near:G.params.distance*.1,far:G.params.distance*5e4};G.resize(D/F),G.tick({fovY:Math.PI/3,...Q});const X=getOrthographicCamera("zoomed");X.params.distance=G.params.distance,X.params.center=[0,0,0],X.resize(D/F),X.tick(Q);const q=getOrthographicCamera("fixed");q.resize(D/F),q.tick({near:q.params.distance*.1,far:q.params.distance*1e4});const W=new Float32Array(G.state.projection),Y=new Float32Array(G.state.view),J=new Float32Array(X.state.projection),te=new Float32Array(X.state.view),Z=new Float32Array(q.state.projection),ee=new Float32Array(q.state.view),re=new Float32Array([G.params.distance,G.params.rotationCenter[0],G.params.rotationCenter[1],G.params.rotationCenter[2],G.params.center[0],G.params.center[1],G.params.center[2],G.params.phi,G.params.theta]);U(transfer(W,[W.buffer]),transfer(Y,[Y.buffer]),transfer(J,[J.buffer]),transfer(te,[te.buffer]),transfer(Z,[Z.buffer]),transfer(ee,[ee.buffer]),transfer(re,[re.buffer]))},c$2=globalCamera$1.params.center,centerSpringDamper=new SpringDamper(c$2),centerUpdate=U=>{globalCamera$1.params.center=U},startCenterSpring=debounce(()=>{centerSpringDamper.updateInitialValues(globalCamera$1.params.center),centerSpringDamper.animate(centerUpdate)},100),setCameraCenter$1=(U,D=3e3)=>{globalCamera$1.params.rotationCenter=U,centerSpringDamper.updateTarget(U),startCenterSpring()},distanceSpringDamper=new SpringDamper(globalCamera$1.params.distance),distanceUpdate=U=>{globalCamera$1.params.distance=U},startDistanceSpring=debounce(()=>{distanceSpringDamper.updateTarget(globalCamera$1.params.distance),distanceSpringDamper.updateInitialValues(globalCamera$1.params.distance),distanceSpringDamper.animate(distanceUpdate)},100),setCameraDistance$1=(U,D=5e3)=>{distanceSpringDamper.updateTarget(U)};startCenterSpring();startDistanceSpring();const startPanning$1=()=>{centerSpringDamper.stop()},stopPanning$1=()=>{},startZooming$1=()=>{distanceSpringDamper.stop()},stopZooming$1=()=>{startDistanceSpring()},zoomGlobalCamera$1=(U,D,F)=>{(globalCamera$1.params.distance>25||F>0)&&globalCamera$1.zoom(U,D,F)},panGlobalCamera$1=(...U)=>{globalCamera$1.pan(...U)},getGlobalCameraParams$1=()=>globalCamera$1.params,computeScreenPosition$1=([U,D,F])=>{const{projection:G,view:Q}=getGlobalCamera().state,X=fromValues(U,D,F,1),q=create(),W=create(),Y=fromValues$1(...G),J=fromValues$1(...Q),te=create$1();return multiply(te,Y,J),transformMat4(q,X,te),scale$1(W,q,1/q[3]),[W[0],W[1],W[2]]},cameraAnimation=Object.freeze(Object.defineProperty({__proto__:null,computeScreenPosition:computeScreenPosition$1,getGlobalCameraParams:getGlobalCameraParams$1,globalCamera:globalCamera$1,panGlobalCamera:panGlobalCamera$1,setCameraCenter:setCameraCenter$1,setCameraDistance:setCameraDistance$1,startPanning:startPanning$1,startZooming:startZooming$1,stopPanning:stopPanning$1,stopZooming:stopZooming$1,updateCameras:updateCameras$1,zoomGlobalCamera:zoomGlobalCamera$1},Symbol.toStringTag,{value:"Module"}));expose$1({...db,...layout,...cameraAnimation});var __spreadArray=globalThis&&globalThis.__spreadArray||function(U,D,F){if(F||arguments.length===2)for(var G=0,Q=D.length,X;G<Q;G++)(X||!(G in D))&&(X||(X=Array.prototype.slice.call(D,0,G)),X[G]=D[G]);return U.concat(X||Array.prototype.slice.call(D))},BrowserInfo=function(){function U(D,F,G){this.name=D,this.version=F,this.os=G,this.type="browser"}return U}(),NodeInfo=function(){function U(D){this.version=D,this.type="node",this.name="node",this.os=process.platform}return U}(),SearchBotDeviceInfo=function(){function U(D,F,G,Q){this.name=D,this.version=F,this.os=G,this.bot=Q,this.type="bot-device"}return U}(),BotInfo=function(){function U(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return U}(),ReactNativeInfo=function(){function U(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return U}(),SEARCHBOX_UA_REGEX=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,SEARCHBOT_OS_REGEX=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,REQUIRED_VERSION_PARTS=3,userAgentRules=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",SEARCHBOX_UA_REGEX]],operatingSystemRules=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function detect(U){return U?parseUserAgent(U):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new ReactNativeInfo:typeof navigator<"u"?parseUserAgent(navigator.userAgent):getNodeVersion()}function matchUserAgent(U){return U!==""&&userAgentRules.reduce(function(D,F){var G=F[0],Q=F[1];if(D)return D;var X=Q.exec(U);return!!X&&[G,X]},!1)}function parseUserAgent(U){var D=matchUserAgent(U);if(!D)return null;var F=D[0],G=D[1];if(F==="searchbot")return new BotInfo;var Q=G[1]&&G[1].split(".").join("_").split("_").slice(0,3);Q?Q.length<REQUIRED_VERSION_PARTS&&(Q=__spreadArray(__spreadArray([],Q,!0),createVersionParts(REQUIRED_VERSION_PARTS-Q.length),!0)):Q=[];var X=Q.join("."),q=detectOS(U),W=SEARCHBOT_OS_REGEX.exec(U);return W&&W[1]?new SearchBotDeviceInfo(F,X,q,W[1]):new BrowserInfo(F,X,q)}function detectOS(U){for(var D=0,F=operatingSystemRules.length;D<F;D++){var G=operatingSystemRules[D],Q=G[0],X=G[1],q=X.exec(U);if(q)return Q}return null}function getNodeVersion(){var U=typeof process<"u"&&process.version;return U?new NodeInfo(process.version.slice(1)):null}function createVersionParts(U){for(var D=[],F=0;F<U;F++)D.push("0");return D}const useWorkers=detect(navigator.userAgent)?.name!=="safari";console.log(useWorkers?"Using workers":"Not using workers");const graphDb=useWorkers?wrap$1(new WorkerWrapper):db,graphLayout=useWorkers?wrap$1(new WorkerWrapper):layout,graphCameraAnimation=cameraAnimation;var colorHash$1={};(function(U){var D=commonjsGlobal&&commonjsGlobal.__extends||function(){var Oe=function(Ie,Be){return Oe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ze,et){ze.__proto__=et}||function(ze,et){for(var qe in et)Object.prototype.hasOwnProperty.call(et,qe)&&(ze[qe]=et[qe])},Oe(Ie,Be)};return function(Ie,Be){if(typeof Be!="function"&&Be!==null)throw new TypeError("Class extends value "+String(Be)+" is not a constructor or null");Oe(Ie,Be);function ze(){this.constructor=Ie}Ie.prototype=Be===null?Object.create(Be):(ze.prototype=Be.prototype,new ze)}}(),F=commonjsGlobal&&commonjsGlobal.__classPrivateFieldSet||function(Oe,Ie,Be){if(!Ie.has(Oe))throw new TypeError("attempted to set private field on non-instance");return Ie.set(Oe,Be),Be},G=commonjsGlobal&&commonjsGlobal.__classPrivateFieldGet||function(Oe,Ie){if(!Ie.has(Oe))throw new TypeError("attempted to get private field on non-instance");return Ie.get(Oe)},Q,X,q,W,Y,J,te,Z,ee,re,ne,le,se,ie,ge,fe,ae,ue,pe,_e,xe,be;U.__esModule=!0,U.default=void 0;var Te=function(Oe){var Ie=131,Be=137,ze=0;Oe+="x";for(var et=Math.floor(9007199254740991/Be),qe=0;qe<Oe.length;qe++)ze>et&&(ze=Math.floor(ze/Be)),ze=ze*Ie+Oe.charCodeAt(qe);return ze},ye="0123456789abcdef".split(""),Ee=[-2147483648,8388608,32768,128],he=[24,16,8,0],oe=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],me=[],ve=function(){function Oe(Ie,Be){Ie===void 0&&(Ie=!1),Be===void 0&&(Be=!1),Q.set(this,void 0),X.set(this,void 0),q.set(this,void 0),W.set(this,void 0),Y.set(this,void 0),J.set(this,void 0),te.set(this,void 0),Z.set(this,void 0),ee.set(this,void 0),re.set(this,void 0),ne.set(this,void 0),le.set(this,void 0),se.set(this,void 0),ie.set(this,void 0),ge.set(this,void 0),fe.set(this,void 0),ae.set(this,0),ue.set(this,void 0),this.init(Ie,Be)}return Oe.prototype.init=function(Ie,Be){Be?(me[0]=me[16]=me[1]=me[2]=me[3]=me[4]=me[5]=me[6]=me[7]=me[8]=me[9]=me[10]=me[11]=me[12]=me[13]=me[14]=me[15]=0,F(this,X,me)):F(this,X,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ie?(F(this,J,3238371032),F(this,te,914150663),F(this,Z,812702999),F(this,ee,4144912697),F(this,re,4290775857),F(this,ne,1750603025),F(this,le,1694076839),F(this,se,3204075428)):(F(this,J,1779033703),F(this,te,3144134277),F(this,Z,1013904242),F(this,ee,2773480762),F(this,re,1359893119),F(this,ne,2600822924),F(this,le,528734635),F(this,se,1541459225)),F(this,Q,F(this,ue,F(this,q,F(this,ge,0)))),F(this,W,F(this,ie,!1)),F(this,Y,!0),F(this,fe,Ie)},Oe.prototype.update=function(Ie){if(G(this,W))return this;var Be;Ie instanceof ArrayBuffer?Be=new Uint8Array(Ie):Be=Ie;for(var ze=0,et=Be.length,qe=G(this,X);ze<et;){var je=void 0;if(G(this,ie)&&(F(this,ie,!1),qe[0]=G(this,Q),qe[16]=qe[1]=qe[2]=qe[3]=qe[4]=qe[5]=qe[6]=qe[7]=qe[8]=qe[9]=qe[10]=qe[11]=qe[12]=qe[13]=qe[14]=qe[15]=0),typeof Be!="string")for(je=G(this,ue);ze<et&&je<64;++ze)qe[je>>2]|=Be[ze]<<he[je++&3];else for(je=G(this,ue);ze<et&&je<64;++ze){var it=Be.charCodeAt(ze);it<128?qe[je>>2]|=it<<he[je++&3]:it<2048?(qe[je>>2]|=(192|it>>6)<<he[je++&3],qe[je>>2]|=(128|it&63)<<he[je++&3]):it<55296||it>=57344?(qe[je>>2]|=(224|it>>12)<<he[je++&3],qe[je>>2]|=(128|it>>6&63)<<he[je++&3],qe[je>>2]|=(128|it&63)<<he[je++&3]):(it=65536+((it&1023)<<10|Be.charCodeAt(++ze)&1023),qe[je>>2]|=(240|it>>18)<<he[je++&3],qe[je>>2]|=(128|it>>12&63)<<he[je++&3],qe[je>>2]|=(128|it>>6&63)<<he[je++&3],qe[je>>2]|=(128|it&63)<<he[je++&3])}F(this,ae,je),F(this,q,G(this,q)+(je-G(this,ue))),je>=64?(F(this,Q,qe[16]),F(this,ue,je-64),this.hash(),F(this,ie,!0)):F(this,ue,je)}return G(this,q)>4294967295&&(F(this,ge,G(this,ge)+(G(this,q)/4294967296<<0)),F(this,q,G(this,q)%4294967296)),this},Oe.prototype.finalize=function(){if(!G(this,W)){F(this,W,!0);var Ie=G(this,X),Be=G(this,ae);Ie[16]=G(this,Q),Ie[Be>>2]|=Ee[Be&3],F(this,Q,Ie[16]),Be>=56&&(G(this,ie)||this.hash(),Ie[0]=G(this,Q),Ie[16]=Ie[1]=Ie[2]=Ie[3]=Ie[4]=Ie[5]=Ie[6]=Ie[7]=Ie[8]=Ie[9]=Ie[10]=Ie[11]=Ie[12]=Ie[13]=Ie[14]=Ie[15]=0),Ie[14]=G(this,ge)<<3|G(this,q)>>>29,Ie[15]=G(this,q)<<3,this.hash()}},Oe.prototype.hash=function(){for(var Ie=G(this,J),Be=G(this,te),ze=G(this,Z),et=G(this,ee),qe=G(this,re),je=G(this,ne),it=G(this,le),ct=G(this,se),rt=G(this,X),ut,We,Re,Ue,Le,Ge,ke,He,Ke,$e,Qe=16;Qe<64;++Qe)Ue=rt[Qe-15],ut=(Ue>>>7|Ue<<25)^(Ue>>>18|Ue<<14)^Ue>>>3,Ue=rt[Qe-2],We=(Ue>>>17|Ue<<15)^(Ue>>>19|Ue<<13)^Ue>>>10,rt[Qe]=rt[Qe-16]+ut+rt[Qe-7]+We<<0;$e=Be&ze;for(var Ne=0;Ne<64;Ne+=4)G(this,Y)?(G(this,fe)?(ke=300032,Ue=rt[0]-1413257819,ct=Ue-150054599<<0,et=Ue+24177077<<0):(ke=704751109,Ue=rt[0]-210244248,ct=Ue-1521486534<<0,et=Ue+143694565<<0),F(this,Y,!1)):(ut=(Ie>>>2|Ie<<30)^(Ie>>>13|Ie<<19)^(Ie>>>22|Ie<<10),We=(qe>>>6|qe<<26)^(qe>>>11|qe<<21)^(qe>>>25|qe<<7),ke=Ie&Be,Re=ke^Ie&ze^$e,Ge=qe&je^~qe&it,Ue=ct+We+Ge+oe[Ne]+rt[Ne],Le=ut+Re,ct=et+Ue<<0,et=Ue+Le<<0),ut=(et>>>2|et<<30)^(et>>>13|et<<19)^(et>>>22|et<<10),We=(ct>>>6|ct<<26)^(ct>>>11|ct<<21)^(ct>>>25|ct<<7),He=et&Ie,Re=He^et&Be^ke,Ge=ct&qe^~ct&je,Ue=it+We+Ge+oe[Ne+1]+rt[Ne+1],Le=ut+Re,it=ze+Ue<<0,ze=Ue+Le<<0,ut=(ze>>>2|ze<<30)^(ze>>>13|ze<<19)^(ze>>>22|ze<<10),We=(it>>>6|it<<26)^(it>>>11|it<<21)^(it>>>25|it<<7),Ke=ze&et,Re=Ke^ze&Ie^He,Ge=it&ct^~it&qe,Ue=je+We+Ge+oe[Ne+2]+rt[Ne+2],Le=ut+Re,je=Be+Ue<<0,Be=Ue+Le<<0,ut=(Be>>>2|Be<<30)^(Be>>>13|Be<<19)^(Be>>>22|Be<<10),We=(je>>>6|je<<26)^(je>>>11|je<<21)^(je>>>25|je<<7),$e=Be&ze,Re=$e^Be&et^Ke,Ge=je&it^~je&ct,Ue=qe+We+Ge+oe[Ne+3]+rt[Ne+3],Le=ut+Re,qe=Ie+Ue<<0,Ie=Ue+Le<<0;F(this,J,G(this,J)+Ie<<0),F(this,te,G(this,te)+Be<<0),F(this,Z,G(this,Z)+ze<<0),F(this,ee,G(this,ee)+et<<0),F(this,re,G(this,re)+qe<<0),F(this,ne,G(this,ne)+je<<0),F(this,le,G(this,le)+it<<0),F(this,se,G(this,se)+ct<<0)},Oe.prototype.hex=function(){this.finalize();var Ie=G(this,J),Be=G(this,te),ze=G(this,Z),et=G(this,ee),qe=G(this,re),je=G(this,ne),it=G(this,le),ct=G(this,se),rt=ye[Ie>>28&15]+ye[Ie>>24&15]+ye[Ie>>20&15]+ye[Ie>>16&15]+ye[Ie>>12&15]+ye[Ie>>8&15]+ye[Ie>>4&15]+ye[Ie&15]+ye[Be>>28&15]+ye[Be>>24&15]+ye[Be>>20&15]+ye[Be>>16&15]+ye[Be>>12&15]+ye[Be>>8&15]+ye[Be>>4&15]+ye[Be&15]+ye[ze>>28&15]+ye[ze>>24&15]+ye[ze>>20&15]+ye[ze>>16&15]+ye[ze>>12&15]+ye[ze>>8&15]+ye[ze>>4&15]+ye[ze&15]+ye[et>>28&15]+ye[et>>24&15]+ye[et>>20&15]+ye[et>>16&15]+ye[et>>12&15]+ye[et>>8&15]+ye[et>>4&15]+ye[et&15]+ye[qe>>28&15]+ye[qe>>24&15]+ye[qe>>20&15]+ye[qe>>16&15]+ye[qe>>12&15]+ye[qe>>8&15]+ye[qe>>4&15]+ye[qe&15]+ye[je>>28&15]+ye[je>>24&15]+ye[je>>20&15]+ye[je>>16&15]+ye[je>>12&15]+ye[je>>8&15]+ye[je>>4&15]+ye[je&15]+ye[it>>28&15]+ye[it>>24&15]+ye[it>>20&15]+ye[it>>16&15]+ye[it>>12&15]+ye[it>>8&15]+ye[it>>4&15]+ye[it&15];return G(this,fe)||(rt+=ye[ct>>28&15]+ye[ct>>24&15]+ye[ct>>20&15]+ye[ct>>16&15]+ye[ct>>12&15]+ye[ct>>8&15]+ye[ct>>4&15]+ye[ct&15]),rt},Oe.prototype.toString=function(){return this.hex()},Oe.prototype.digest=function(){this.finalize();var Ie=G(this,J),Be=G(this,te),ze=G(this,Z),et=G(this,ee),qe=G(this,re),je=G(this,ne),it=G(this,le),ct=G(this,se),rt=[Ie>>24&255,Ie>>16&255,Ie>>8&255,Ie&255,Be>>24&255,Be>>16&255,Be>>8&255,Be&255,ze>>24&255,ze>>16&255,ze>>8&255,ze&255,et>>24&255,et>>16&255,et>>8&255,et&255,qe>>24&255,qe>>16&255,qe>>8&255,qe&255,je>>24&255,je>>16&255,je>>8&255,je&255,it>>24&255,it>>16&255,it>>8&255,it&255];return G(this,fe)||rt.push(ct>>24&255,ct>>16&255,ct>>8&255,ct&255),rt},Oe.prototype.array=function(){return this.digest()},Oe.prototype.arrayBuffer=function(){this.finalize();var Ie=new ArrayBuffer(G(this,fe)?28:32),Be=new DataView(Ie);return Be.setUint32(0,G(this,J)),Be.setUint32(4,G(this,te)),Be.setUint32(8,G(this,Z)),Be.setUint32(12,G(this,ee)),Be.setUint32(16,G(this,re)),Be.setUint32(20,G(this,ne)),Be.setUint32(24,G(this,le)),G(this,fe)||Be.setUint32(28,G(this,se)),Ie},Oe}();Q=new WeakMap,X=new WeakMap,q=new WeakMap,W=new WeakMap,Y=new WeakMap,J=new WeakMap,te=new WeakMap,Z=new WeakMap,ee=new WeakMap,re=new WeakMap,ne=new WeakMap,le=new WeakMap,se=new WeakMap,ie=new WeakMap,ge=new WeakMap,fe=new WeakMap,ae=new WeakMap,ue=new WeakMap,function(Oe){D(Ie,Oe);function Ie(Be,ze,et){ze===void 0&&(ze=!1),et===void 0&&(et=!1);var qe=Oe.call(this,ze,et)||this;pe.set(qe,void 0),_e.set(qe,void 0),xe.set(qe,void 0),be.set(qe,void 0);var je;if(typeof Be=="string"){for(var it=[],ct=Be.length,rt=0,ut=0;ut<ct;++ut){var We=Be.charCodeAt(ut);We<128?it[rt++]=We:We<2048?(it[rt++]=192|We>>6,it[rt++]=128|We&63):We<55296||We>=57344?(it[rt++]=224|We>>12,it[rt++]=128|We>>6&63,it[rt++]=128|We&63):(We=65536+((We&1023)<<10|Be.charCodeAt(++ut)&1023),it[rt++]=240|We>>18,it[rt++]=128|We>>12&63,it[rt++]=128|We>>6&63,it[rt++]=128|We&63)}je=it}else Be instanceof ArrayBuffer?je=new Uint8Array(Be):je=Be;je.length>64&&(je=new ve(ze,!0).update(je).array());for(var Re=[],Ue=[],ut=0;ut<64;++ut){var Le=je[ut]||0;Re[ut]=92^Le,Ue[ut]=54^Le}return qe.update(Ue),F(qe,xe,Re),F(qe,pe,!0),F(qe,_e,ze),F(qe,be,et),qe}return Ie.prototype.finalize=function(){if(Oe.prototype.finalize.call(this),G(this,pe)){F(this,pe,!1);var Be=this.array();Oe.prototype.init.call(this,G(this,_e),G(this,be)),this.update(G(this,xe)),this.update(Be),Oe.prototype.finalize.call(this)}},Ie}(ve),pe=new WeakMap,_e=new WeakMap,xe=new WeakMap,be=new WeakMap;function we(Oe){var Ie=new ve;return Ie.update(Oe),parseInt(Ie.hex().substring(0,8),16)}var Pe=function(Oe){var Ie="#";return Oe.forEach(function(Be){Be<16&&(Ie+=0),Ie+=Be.toString(16)}),Ie},Me=function(Oe,Ie,Be){Oe/=360;var ze=Be<.5?Be*(1+Ie):Be+Ie-Be*Ie,et=2*Be-ze;return[Oe+1/3,Oe,Oe-1/3].map(function(qe){return qe<0&&qe++,qe>1&&qe--,qe<1/6?qe=et+(ze-et)*6*qe:qe<.5?qe=ze:qe<2/3?qe=et+(ze-et)*6*(2/3-qe):qe=et,Math.round(qe*255)})},De=function(){function Oe(Ie){Ie===void 0&&(Ie={});var Be=[Ie.lightness,Ie.saturation].map(function(qe){return qe=qe!==void 0?qe:[.35,.5,.65],Array.isArray(qe)?qe.concat():[qe]}),ze=Be[0],et=Be[1];this.L=ze,this.S=et,typeof Ie.hue=="number"&&(Ie.hue={min:Ie.hue,max:Ie.hue}),typeof Ie.hue=="object"&&!Array.isArray(Ie.hue)&&(Ie.hue=[Ie.hue]),typeof Ie.hue>"u"&&(Ie.hue=[]),this.hueRanges=Ie.hue.map(function(qe){return{min:typeof qe.min>"u"?0:qe.min,max:typeof qe.max>"u"?360:qe.max}}),this.hash=we,typeof Ie.hash=="function"&&(this.hash=Ie.hash),Ie.hash==="bkdr"&&(this.hash=Te)}return Oe.prototype.hsl=function(Ie){var Be,ze,et,qe=this.hash(Ie),je=727;if(this.hueRanges.length){var it=this.hueRanges[qe%this.hueRanges.length];Be=qe/this.hueRanges.length%je*(it.max-it.min)/je+it.min}else Be=qe%359;return qe=Math.ceil(qe/360),ze=this.S[qe%this.S.length],qe=Math.ceil(qe/this.S.length),et=this.L[qe%this.L.length],[Be,ze,et]},Oe.prototype.rgb=function(Ie){var Be=this.hsl(Ie);return Me.apply(this,Be)},Oe.prototype.hex=function(Ie){var Be=this.rgb(Ie);return Pe(Be)},Oe}();U.default=De})(colorHash$1);const ColorHash=getDefaultExportFromCjs(colorHash$1);var gpuIoExports={},gpuIo={get exports(){return gpuIoExports},set exports(U){gpuIoExports=U}};(function(U,D){(function(G,Q){U.exports=Q()})(self,()=>(()=>{var F={566:function(q,W){(function(Y,J){J(W)})(this,function(Y){function J(ye){return!Number.isNaN(ye)&&typeof ye=="number"}function te(ye){return J(ye)&&Number.isFinite(ye)}function Z(ye){return te(ye)&&ye%1===0}function ee(ye){return J(ye)&&ye>0}function re(ye){return Z(ye)&&ye>0}function ne(ye){return J(ye)&&ye<0}function le(ye){return Z(ye)&&ye<0}function se(ye){return J(ye)&&ye>=0}function ie(ye){return Z(ye)&&ye>=0}function ge(ye){return J(ye)&&ye<=0}function fe(ye){return Z(ye)&&ye<=0}function ae(ye,Ee,he){return J(ye)&&ye>=Ee&&ye<=he}function ue(ye,Ee,he){return Z(ye)&&ye>=Ee&&ye<=he}function pe(ye){return typeof ye=="string"}function _e(ye){return ArrayBuffer.isView(ye)&&!(ye instanceof DataView)}function xe(ye){return Array.isArray(ye)||_e(ye)}function be(ye){return typeof ye=="object"&&!xe(ye)&&ye!==null&&!(ye instanceof ArrayBuffer)&&!(ye instanceof DataView)}function Te(ye){return typeof ye=="boolean"}Y.isArray=xe,Y.isBoolean=Te,Y.isFiniteNumber=te,Y.isInteger=Z,Y.isIntegerInRange=ue,Y.isNegativeInteger=le,Y.isNegativeNumber=ne,Y.isNonNegativeInteger=ie,Y.isNonNegativeNumber=se,Y.isNonPositiveInteger=fe,Y.isNonPositiveNumber=ge,Y.isNumber=J,Y.isNumberInRange=ae,Y.isObject=be,Y.isPositiveInteger=re,Y.isPositiveNumber=ee,Y.isString=pe,Y.isTypedArray=_e,Object.defineProperty(Y,"__esModule",{value:!0})})},809:(q,W)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.changeDpiBlob=ue,W.changeDpiDataUrl=pe;function Y(Te){if(Array.isArray(Te)){for(var ye=0,Ee=Array(Te.length);ye<Te.length;ye++)Ee[ye]=Te[ye];return Ee}else return Array.from(Te)}function J(){for(var Te=new Int32Array(256),ye=0;ye<256;ye++){for(var Ee=ye,he=0;he<8;he++)Ee=Ee&1?3988292384^Ee>>>1:Ee>>>1;Te[ye]=Ee}return Te}function te(Te){var ye=-1;Z||(Z=J());for(var Ee=0;Ee<Te.length;Ee++)ye=Z[(ye^Te[Ee])&255]^ye>>>8;return ye^-1}var Z=void 0,ee="image/png",re="image/jpeg",ne="AAlwSFlz",le="AAAJcEhZ",se="AAAACXBI",ie="p".charCodeAt(0),ge="H".charCodeAt(0),fe="Y".charCodeAt(0),ae="s".charCodeAt(0);function ue(Te,ye){var Ee=Te.slice(0,33);return new Promise(function(he,oe){var me=new FileReader;me.onload=function(){var ve=new Uint8Array(me.result),we=Te.slice(33),Pe=be(ve,ye,Te.type);he(new Blob([Pe,we],{type:Te.type}))},me.readAsArrayBuffer(Ee)})}function pe(Te,ye){var Ee=Te.split(","),he=Ee[0],oe=Ee[1],me=void 0,ve=void 0,we=!1;if(he.indexOf(ee)!==-1){me=ee;var Pe=_e(oe);Pe>=0?(ve=Math.ceil((Pe+28)/3)*4,we=!0):ve=44}he.indexOf(re)!==-1&&(me=re,ve=24);for(var Me=oe.substring(0,ve),De=oe.substring(ve),Oe=atob(Me),Ie=new Uint8Array(Oe.length),Be=0;Be<Ie.length;Be++)Ie[Be]=Oe.charCodeAt(Be);var ze=be(Ie,ye,me,we),et=btoa(String.fromCharCode.apply(String,Y(ze)));return[he,",",et,De].join("")}function _e(Te){var ye=Te.indexOf(ne);return ye===-1&&(ye=Te.indexOf(le)),ye===-1&&(ye=Te.indexOf(se)),ye}function xe(Te){for(var ye=Te.length-1,Ee=ye;Ee>=4;Ee--)if(Te[Ee-4]===9&&Te[Ee-3]===ie&&Te[Ee-2]===ge&&Te[Ee-1]===fe&&Te[Ee]===ae)return Ee-3}function be(Te,ye,Ee,he){if(Ee===re)return Te[13]=1,Te[14]=ye>>8,Te[15]=ye&255,Te[16]=ye>>8,Te[17]=ye&255,Te;if(Ee===ee){var oe=new Uint8Array(13);ye*=39.3701,oe[0]=ie,oe[1]=ge,oe[2]=fe,oe[3]=ae,oe[4]=ye>>>24,oe[5]=ye>>>16,oe[6]=ye>>>8,oe[7]=ye&255,oe[8]=oe[4],oe[9]=oe[5],oe[10]=oe[6],oe[11]=oe[7],oe[12]=1;var me=te(oe),ve=new Uint8Array(4);if(ve[0]=me>>>24,ve[1]=me>>>16,ve[2]=me>>>8,ve[3]=me&255,he){var we=xe(Te);return Te.set(oe,we),Te.set(ve,we+13),Te}else{var Pe=new Uint8Array(4);Pe[0]=0,Pe[1]=0,Pe[2]=0,Pe[3]=9;var Me=new Uint8Array(54);return Me.set(Te,0),Me.set(Pe,33),Me.set(oe,37),Me.set(ve,50),Me}}}},162:function(q,W,Y){var J,te,Z;(function(ee,re){te=[],J=re,Z=typeof J=="function"?J.apply(W,te):J,Z!==void 0&&(q.exports=Z)})(this,function(){function ee(fe,ae){return typeof ae>"u"?ae={autoBom:!1}:typeof ae!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),ae={autoBom:!ae}),ae.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(fe.type)?new Blob(["\uFEFF",fe],{type:fe.type}):fe}function re(fe,ae,ue){var pe=new XMLHttpRequest;pe.open("GET",fe),pe.responseType="blob",pe.onload=function(){ge(pe.response,ae,ue)},pe.onerror=function(){console.error("could not download file")},pe.send()}function ne(fe){var ae=new XMLHttpRequest;ae.open("HEAD",fe,!1);try{ae.send()}catch{}return 200<=ae.status&&299>=ae.status}function le(fe){try{fe.dispatchEvent(new MouseEvent("click"))}catch{var ae=document.createEvent("MouseEvents");ae.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),fe.dispatchEvent(ae)}}var se=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Y.g=="object"&&Y.g.global===Y.g?Y.g:void 0,ie=se.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),ge=se.saveAs||(typeof window!="object"||window!==se?function(){}:"download"in HTMLAnchorElement.prototype&&!ie?function(fe,ae,ue){var pe=se.URL||se.webkitURL,_e=document.createElement("a");ae=ae||fe.name||"download",_e.download=ae,_e.rel="noopener",typeof fe=="string"?(_e.href=fe,_e.origin===location.origin?le(_e):ne(_e.href)?re(fe,ae,ue):le(_e,_e.target="_blank")):(_e.href=pe.createObjectURL(fe),setTimeout(function(){pe.revokeObjectURL(_e.href)},4e4),setTimeout(function(){le(_e)},0))}:"msSaveOrOpenBlob"in navigator?function(fe,ae,ue){if(ae=ae||fe.name||"download",typeof fe!="string")navigator.msSaveOrOpenBlob(ee(fe,ue),ae);else if(ne(fe))re(fe,ae,ue);else{var pe=document.createElement("a");pe.href=fe,pe.target="_blank",setTimeout(function(){le(pe)})}}:function(fe,ae,ue,pe){if(pe=pe||open("","_blank"),pe&&(pe.document.title=pe.document.body.innerText="downloading..."),typeof fe=="string")return re(fe,ae,ue);var _e=fe.type==="application/octet-stream",xe=/constructor/i.test(se.HTMLElement)||se.safari,be=/CriOS\/[\d]+/.test(navigator.userAgent);if((be||_e&&xe||ie)&&typeof FileReader<"u"){var Te=new FileReader;Te.onloadend=function(){var he=Te.result;he=be?he:he.replace(/^data:[^;]*;/,"data:attachment/file;"),pe?pe.location.href=he:location=he,pe=null},Te.readAsDataURL(fe)}else{var ye=se.URL||se.webkitURL,Ee=ye.createObjectURL(fe);pe?pe.location=Ee:location.href=Ee,pe=null,setTimeout(function(){ye.revokeObjectURL(Ee)},4e4)}});se.saveAs=ge.saveAs=ge,q.exports=ge})},484:function(q,W,Y){var J=this&&this.__assign||function(){return J=Object.assign||function(he){for(var oe,me=1,ve=arguments.length;me<ve;me++){oe=arguments[me];for(var we in oe)Object.prototype.hasOwnProperty.call(oe,we)&&(he[we]=oe[we])}return he},J.apply(this,arguments)},te=this&&this.__spreadArray||function(he,oe,me){if(me||arguments.length===2)for(var ve=0,we=oe.length,Pe;ve<we;ve++)(Pe||!(ve in oe))&&(Pe||(Pe=Array.prototype.slice.call(oe,0,ve)),Pe[ve]=oe[ve]);return he.concat(Pe||Array.prototype.slice.call(oe))};Object.defineProperty(W,"__esModule",{value:!0}),W.GPUComposer=void 0;var Z=Y(809),ee=Y(566),re=Y(355);Y(191);var ne=Y(601),le=Y(404),se=Y(593),ie=Y(651),ge=Y(567),fe=Y(946),ae=Y(929),ue=Y(634),pe=Y(380),_e=Y(690),xe=Y(579),be=Y(707),Te=Y(798),ye=Y(581),Ee=function(){function he(oe){var me;this._errorState=!1,this._circlePositionsBuffer={},this._vertexAttributeLocations={},this._enabledVertexAttributes={},this._extensions={},this._clearValue=0,this._copyPrograms={},this._setValuePrograms={},this._vertexShaders=(me={},me[ne.DEFAULT_PROGRAM_NAME]={src:ie.DEFAULT_VERT_SHADER_SOURCE,compiledShaders:{}},me[ne.SEGMENT_PROGRAM_NAME]={src:fe.SEGMENT_VERTEX_SHADER_SOURCE,compiledShaders:{}},me[ne.LAYER_POINTS_PROGRAM_NAME]={src:ae.LAYER_POINTS_VERTEX_SHADER_SOURCE,compiledShaders:{}},me[ne.LAYER_VECTOR_FIELD_PROGRAM_NAME]={src:ue.LAYER_VECTOR_FIELD_VERTEX_SHADER_SOURCE,compiledShaders:{}},me[ne.LAYER_LINES_PROGRAM_NAME]={src:ge.LAYER_LINES_VERTEX_SHADER_SOURCE,compiledShaders:{}},me[ne.LAYER_MESH_PROGRAM_NAME]={src:pe.LAYER_MESH_VERTEX_SHADER_SOURCE,compiledShaders:{}},me),this.verboseLogging=!1,this._numTicks=0;var ve=["canvas","context","contextID","contextAttributes","glslVersion","intPrecision","floatPrecision","clearValue","verboseLogging","errorCallback"],we=["canvas"],Pe=Object.keys(oe);(0,be.checkValidKeys)(Pe,ve,"GPUComposer(params)"),(0,be.checkRequiredKeys)(Pe,we,"GPUComposer(params)"),oe.verboseLogging!==void 0&&(this.verboseLogging=oe.verboseLogging);var Me=this;this._errorCallback=function(et){Me._errorState||(Me._errorState=!0,oe.errorCallback?oe.errorCallback(et):(0,ne.DEFAULT_ERROR_CALLBACK)(et))};var De=oe.canvas,Oe=oe.context;if(!Oe){if(oe.contextID){var Ie=De.getContext(oe.contextID,oe.contextAttributes);Ie?Oe=Ie:console.warn("Unable to initialize WebGL context with contextID: ".concat(oe.contextID,"."))}if(!Oe){var Ie=De.getContext(ne.WEBGL2,oe.contextAttributes)||De.getContext(ne.WEBGL1,oe.contextAttributes)||De.getContext(ne.EXPERIMENTAL_WEBGL2,oe.contextAttributes)||De.getContext(ne.EXPERIMENTAL_WEBGL,oe.contextAttributes);Ie&&(Oe=Ie)}if(!Oe){this._errorCallback("Unable to initialize WebGL context.");return}}this.isWebGL2=(0,se.isWebGL2)(Oe),this.isWebGL2?this.verboseLogging&&console.log("Using WebGL 2.0 context."):this.verboseLogging&&console.log("Using WebGL 1.0 context."),this.gl=Oe;var Be=oe.glslVersion||(this.isWebGL2?ne.GLSL3:ne.GLSL1);if(!this.isWebGL2&&Be===ne.GLSL3&&(console.warn("GLSL3.x is incompatible with WebGL1.0 contexts, falling back to GLSL1."),Be=ne.GLSL1),this.glslVersion=Be,this.intPrecision=oe.intPrecision||ne.PRECISION_HIGH_P,this.floatPrecision=oe.floatPrecision||ne.PRECISION_HIGH_P,Oe.disable(Oe.DEPTH_TEST),Oe.pixelStorei(Oe.UNPACK_ALIGNMENT,1),this.isWebGL2)Oe.bindVertexArray(null);else{var ze=(0,ye.getExtension)(this,ye.OES_VERTEX_ARRAY_OBJECT,!0);ze.bindVertexArrayOES(null)}Oe.bindBuffer(Oe.ARRAY_BUFFER,null),oe.clearValue!==void 0&&(this.clearValue=oe.clearValue),this.resize([De.clientWidth,De.clientHeight]),this.verboseLogging&&console.log("".concat(this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS)," textures max."))}return he.initWithThreeRenderer=function(oe,me){var ve=new he(J(J({floatPrecision:oe.capabilities.precision,intPrecision:oe.capabilities.precision},me),{canvas:oe.domElement,context:oe.getContext()}));return ve._threeRenderer=oe,ve},Object.defineProperty(he.prototype,"canvas",{get:function(){return this.gl.canvas},enumerable:!1,configurable:!0}),he.prototype._setValueProgramForType=function(oe){var me=this._setValuePrograms,ve=(0,_e.uniformTypeForType)(oe,this.glslVersion);return me[ve]===void 0&&(me[ve]=(0,xe.setValueProgram)(this,{type:oe,value:[0,0,0,0]})),me[ve]},he.prototype._copyProgramForType=function(oe){var me=this._copyPrograms,ve=(0,_e.uniformTypeForType)(oe,this.glslVersion);return me[ve]===void 0&&(me[ve]=(0,xe.copyProgram)(this,{type:oe})),me[ve]},he.prototype._initVertexBuffer=function(oe){var me=this,ve=me._errorCallback,we=me.gl,Pe=me.isWebGL2;if(Pe)we.bindVertexArray(null);else{var Me=(0,ye.getExtension)(this,ye.OES_VERTEX_ARRAY_OBJECT,!0);Me.bindVertexArrayOES(null)}var De=we.createBuffer();if(!De){ve("Unable to allocate gl buffer.");return}return we.bindBuffer(we.ARRAY_BUFFER,De),we.bufferData(we.ARRAY_BUFFER,oe,we.STATIC_DRAW),De},he.prototype._getQuadPositionsBuffer=function(){if(this._quadPositionsBuffer===void 0){var oe=new Float32Array([-1,-1,1,-1,-1,1,1,1]);this._quadPositionsBuffer=this._initVertexBuffer(oe)}return this._quadPositionsBuffer},he.prototype._getBoundaryPositionsBuffer=function(){if(this._boundaryPositionsBuffer===void 0){var oe=new Float32Array([-1,-1,1,-1,1,1,-1,1,-1,-1]);this._boundaryPositionsBuffer=this._initVertexBuffer(oe)}return this._boundaryPositionsBuffer},he.prototype._getCirclePositionsBuffer=function(oe){var me=this._circlePositionsBuffer;if(me[oe]==null){for(var ve=[0,0],we=0;we<oe;we++)ve.push(Math.cos(2*Math.PI*we/oe),Math.sin(2*Math.PI*we/oe));ve.push(Math.cos(0),Math.sin(0));var Pe=new Float32Array(ve),Me=this._initVertexBuffer(Pe);me[oe]=Me}return me[oe]},he.prototype._cloneGPULayer=function(oe,me){for(var ve=oe.is1D()?oe.length:[oe.width,oe.height],we=new re.GPULayer(this,{name:me||"".concat(oe.name,"-clone"),dimensions:ve,type:oe.type,numComponents:oe.numComponents,filter:oe.filter,wrapX:oe.wrapX,wrapY:oe.wrapY,numBuffers:oe.numBuffers,clearValue:oe.clearValue}),Pe=this._copyProgramForType(oe.type),Me=0;Me<oe.numBuffers-1;Me++)we.incrementBufferIndex();for(var Me=0;Me<oe.numBuffers;Me++)this.step({program:Pe,input:oe.getStateAtIndex(Me),output:we});for(var Me=-1;Me<oe.bufferIndex;Me++)we.incrementBufferIndex();return we},he.prototype._getVertexShader=function(oe,me,ve,we){var Pe=this,Me=Pe._errorCallback,De=Pe._vertexShaders,Oe=Pe.gl,Ie=Pe.glslVersion,Be=Pe.intPrecision,ze=Pe.floatPrecision,et=De[oe],qe=et.compiledShaders,je=et.src;if(me===""&&(me="_default"),qe[me]===void 0){if(je==="")throw new Error('Error compiling GPUProgram "'.concat(we,'": no source for vertex shader with name "').concat(oe,'".'));var it=(0,se.preprocessVertexShader)(je,Ie),ct=(0,se.compileShader)(Oe,Ie,Be,ze,it,Oe.VERTEX_SHADER,we,Me,ve,void 0,!0);if(!ct){Me('Unable to compile "'.concat(oe).concat(me,'" vertex shader for GPUProgram "').concat(we,'".'));return}qe[me]=ct}return qe[me]},he.prototype.resize=function(oe){var me=this.canvas,ve=oe[0],we=oe[1];if(!(0,ee.isNonNegativeInteger)(ve)||!(0,ee.isNonNegativeInteger)(we))throw(0,ee.isArray)(oe)?new Error("Invalid dimensions parameter supplied to GPUComposer.resize(), expected positive integers, got: ".concat(ve,", ").concat(we)):new Error("Invalid dimensions parameter supplied to GPUComposer.resize(), expected dimensions array of length 2, got: ".concat(JSON.stringify(oe)));me.width=ve,me.height=we,this._width=ve,this._height=we},he.prototype._drawSetup=function(oe,me,ve,we,Pe,Me){var De=this.gl,Oe=[];if(Pe)if(Pe.layer)Oe.push(Pe);else if(Pe.constructor===re.GPULayer)Oe.push(Pe.currentState);else for(var Ie=0;Ie<Pe.length;Ie++){var Be=Pe[Ie];Oe.push(Be.currentState?Be.currentState:Be)}var ze=oe._getProgramWithName(me,ve,Oe);this._setOutputLayer(oe.name,we,Pe,Me),De.useProgram(ze);for(var Ie=0;Ie<Oe.length;Ie++)De.activeTexture(De.TEXTURE0+Ie),De.bindTexture(De.TEXTURE_2D,Oe[Ie].texture);return oe._setInternalFragmentUniforms(ze,Oe),ze},he.prototype._setBlendMode=function(oe){var me=this.gl;oe&&(me.enable(me.BLEND),me.blendFunc(me.SRC_ALPHA,me.ONE_MINUS_SRC_ALPHA))},he.prototype._addLayerToInputs=function(oe,me){return me===void 0?[oe]:(0,ee.isArray)(me)?(0,se.indexOfLayerInArray)(oe,me)>=0?me:te(te([],me,!0),[oe],!1):me===oe||me.layer===oe?[me]:[me,oe]},he.prototype._passThroughLayerDataFromInputToOutput=function(oe){var me=this._copyProgramForType(oe._internalType);this.step({program:me,input:oe,output:oe})},he.prototype._setOutputLayer=function(oe,me,ve,we){var Pe=this,Me=Pe.gl,De=Pe.isWebGL2;if(!we){Me.bindFramebuffer(Me.FRAMEBUFFER,null);var Oe=this,Ie=Oe._width,Be=Oe._height;Me.viewport(0,0,Ie,Be);return}for(var ze=(0,ee.isArray)(we)?we:[we],et=0,qe=ze.length;et<qe;et++){var je=ze[et];if(ve&&(ve===we||ve.layer===we||(0,ee.isArray)(ve)&&(0,se.indexOfLayerInArray)(je,ve)>=0)){if(je.numBuffers===1)throw new Error('Cannot use same buffer "'.concat(je.name,'" for input and output of a program. Try increasing the number of buffers in your output layer to at least 2 so you can render to nextState using currentState as an input.'));me?je._prepareForWrite(!0):(this._passThroughLayerDataFromInputToOutput(je),je._prepareForWrite(!1))}else me?je._prepareForWrite(!0):(je._usingTextureOverrideForCurrentBuffer()&&this._passThroughLayerDataFromInputToOutput(je),je._prepareForWrite(!1))}var it=ze[0],ct=void 0,rt=[Me.COLOR_ATTACHMENT0];if(ze.length>1){ct=[];for(var et=1,qe=ze.length;et<qe;et++)ct.push(ze[et]._currentTexture),rt.push(Me.COLOR_ATTACHMENT0+et)}(0,Te.bindFrameBuffer)(this,it,it._currentTexture,ct),De&&Me.drawBuffers(rt);var ut=this._widthHeightForOutput(oe,we),We=ut.width,Re=ut.height;Me.viewport(0,0,We,Re)},he.prototype._setVertexAttribute=function(oe,me,ve,we){var Pe=this,Me=Pe.gl,De=Pe._vertexAttributeLocations,Oe=Pe._enabledVertexAttributes,Ie=De[me],Be;if(Ie||(Ie=new WeakMap,De[me]=Ie),Be===void 0){if(Be=Me.getAttribLocation(oe,me),Be<0)throw new Error('Unable to find vertex attribute "'.concat(me,'" in program "').concat(we,'".'));Ie.set(oe,Be)}Me.vertexAttribPointer(Be,ve,Me.FLOAT,!1,0,0),Me.enableVertexAttribArray(Be),Oe[Be]=!0},he.prototype._disableVertexAttributes=function(){for(var oe=this,me=oe._enabledVertexAttributes,ve=oe.gl,we=Object.keys(me),Pe=0,Me=we.length;Pe<Me;Pe++){var De=we[Pe];me[De]&&(ve.disableVertexAttribArray(De),delete me[De])}},he.prototype._setPositionAttribute=function(oe,me){this._setVertexAttribute(oe,"a_gpuio_position",2,me)},he.prototype._setIndexAttribute=function(oe,me){this._setVertexAttribute(oe,"a_gpuio_index",1,me)},he.prototype._setUVAttribute=function(oe,me){this._setVertexAttribute(oe,"a_gpuio_uv",2,me)},he.prototype._widthHeightForOutput=function(oe,me){if((0,ee.isArray)(me)){for(var ve=me[0],we=ve?ve.width:this._width,Pe=ve?ve.height:this._height,Me=1,De=me.length;Me<De;Me++){var Oe=me[Me];if(Oe.width!==we||Oe.height!==Pe)throw new Error("Output GPULayers must have the same dimensions, got dimensions [".concat(we,", ").concat(Pe,"] and [").concat(Oe.width,", ").concat(Oe.height,'] for program "').concat(oe,'".'))}return{width:we,height:Pe}}var Ie=me?me.width:this._width,Be=me?me.height:this._height;return{width:Ie,height:Be}},he.prototype._iterateOverOutputsIfNeeded=function(oe,me){if(oe.output&&(0,ee.isArray)(oe.output)&&this.glslVersion===ne.GLSL1){for(var ve=0,we=oe.output.length;ve<we;ve++)this[me](J(J({},oe),{program:ve===0?oe.program:oe.program._childPrograms[ve-1],output:oe.output[ve]}));return!0}return!1},he.prototype._drawFinish=function(oe){var me=this.gl;oe.blendAlpha&&me.disable(me.BLEND)},he.prototype.step=function(oe){var me=["program","input","output","blendAlpha"],ve=["program"],we=Object.keys(oe);if((0,be.checkValidKeys)(we,me,"GPUComposer.step(params)"),(0,be.checkRequiredKeys)(we,ve,"GPUComposer.step(params)"),!this._iterateOverOutputsIfNeeded(oe,"step")){var Pe=this,Me=Pe.gl,De=Pe._errorState,Oe=oe.program,Ie=oe.input,Be=oe.output;if(!De){var ze=this._drawSetup(Oe,ne.DEFAULT_PROGRAM_NAME,{},!0,Ie,Be);Oe._setVertexUniform(ze,"u_gpuio_scale",[1,1],ne.FLOAT),Oe._setVertexUniform(ze,"u_gpuio_translation",[0,0],ne.FLOAT),Me.bindBuffer(Me.ARRAY_BUFFER,this._getQuadPositionsBuffer()),this._setPositionAttribute(ze,Oe.name),this._setBlendMode(oe.blendAlpha),Me.drawArrays(Me.TRIANGLE_STRIP,0,4),this._drawFinish(oe)}}},he.prototype.stepBoundary=function(oe){var me=["program","input","output","edges","blendAlpha"],ve=["program"],we=Object.keys(oe);if((0,be.checkValidKeys)(we,me,"GPUComposer.stepBoundary(params)"),(0,be.checkRequiredKeys)(we,ve,"GPUComposer.stepBoundary(params)"),!this._iterateOverOutputsIfNeeded(oe,"stepBoundary")){var Pe=this,Me=Pe.gl,De=Pe._errorState,Oe=oe.program,Ie=oe.input,Be=oe.output;if(!De){var ze=this._widthHeightForOutput(Oe.name,Be),et=ze.width,qe=ze.height,je=this._drawSetup(Oe,ne.DEFAULT_PROGRAM_NAME,{},!1,Ie,Be),it=[1/et,1/qe];if(Oe._setVertexUniform(je,"u_gpuio_scale",[1-it[0],1-it[1]],ne.FLOAT),Oe._setVertexUniform(je,"u_gpuio_translation",it,ne.FLOAT),Me.bindBuffer(Me.ARRAY_BUFFER,this._getBoundaryPositionsBuffer()),this._setPositionAttribute(je,Oe.name),this._setBlendMode(oe.blendAlpha),oe.edges){var ct=oe.edges;(0,ee.isArray)(ct)||(ct=[ct]);for(var rt=0,ut=ct.length;rt<ut;rt++){var We=ct[rt];We===ne.BOUNDARY_LEFT&&Me.drawArrays(Me.LINES,3,2),We===ne.BOUNDARY_RIGHT&&Me.drawArrays(Me.LINES,1,2),We===ne.BOUNDARY_TOP&&Me.drawArrays(Me.LINES,2,2),We===ne.BOUNDARY_BOTTOM&&Me.drawArrays(Me.LINES,0,2)}}else Me.drawArrays(Me.LINE_LOOP,0,4);this._drawFinish(oe)}}},he.prototype.stepNonBoundary=function(oe){var me=["program","input","output","blendAlpha"],ve=["program"],we=Object.keys(oe);if((0,be.checkValidKeys)(we,me,"GPUComposer.stepNonBoundary(params)"),(0,be.checkRequiredKeys)(we,ve,"GPUComposer.stepNonBoundary(params)"),!this._iterateOverOutputsIfNeeded(oe,"stepNonBoundary")){var Pe=this,Me=Pe.gl,De=Pe._errorState,Oe=oe.program,Ie=oe.input,Be=oe.output;if(!De){var ze=this._widthHeightForOutput(Oe.name,Be),et=ze.width,qe=ze.height,je=this._drawSetup(Oe,ne.DEFAULT_PROGRAM_NAME,{},!1,Ie,Be),it=[1/et,1/qe];Oe._setVertexUniform(je,"u_gpuio_scale",[1-2*it[0],1-2*it[1]],ne.FLOAT),Oe._setVertexUniform(je,"u_gpuio_translation",it,ne.FLOAT),Me.bindBuffer(Me.ARRAY_BUFFER,this._getQuadPositionsBuffer()),this._setPositionAttribute(je,Oe.name),this._setBlendMode(oe.blendAlpha),Me.drawArrays(Me.TRIANGLE_STRIP,0,4),this._drawFinish(oe)}}},he.prototype.stepCircle=function(oe){var me,ve=["program","position","diameter","useOutputScale","input","output","numSegments","blendAlpha"],we=["program","position","diameter"],Pe=Object.keys(oe);if((0,be.checkValidKeys)(Pe,ve,"GPUComposer.stepCircle(params)"),(0,be.checkRequiredKeys)(Pe,we,"GPUComposer.stepCircle(params)"),!this._iterateOverOutputsIfNeeded(oe,"stepCircle")){var Me=this,De=Me.gl,Oe=Me._errorState,Ie=oe.program,Be=oe.position,ze=oe.diameter,et=oe.input,qe=oe.output;if(!Oe){var je=this._width,it=this._height;oe.useOutputScale&&(me=this._widthHeightForOutput(Ie.name,qe),je=me.width,it=me.height);var ct=this._drawSetup(Ie,ne.DEFAULT_PROGRAM_NAME,{},!1,et,qe);Ie._setVertexUniform(ct,"u_gpuio_scale",[ze/je,ze/it],ne.FLOAT),Ie._setVertexUniform(ct,"u_gpuio_translation",[2*Be[0]/je-1,2*Be[1]/it-1],ne.FLOAT);var rt=oe.numSegments?oe.numSegments:ne.DEFAULT_CIRCLE_NUM_SEGMENTS;if(rt<3)throw new Error("numSegments for GPUComposer.stepCircle must be greater than 2, got ".concat(rt,"."));De.bindBuffer(De.ARRAY_BUFFER,this._getCirclePositionsBuffer(rt)),this._setPositionAttribute(ct,Ie.name),this._setBlendMode(oe.blendAlpha),De.drawArrays(De.TRIANGLE_FAN,0,rt+2),this._drawFinish(oe)}}},he.prototype.stepSegment=function(oe){var me,ve=["program","position1","position2","thickness","useOutputScale","input","output","endCaps","numCapSegments","blendAlpha"],we=["program","position1","position2","thickness"],Pe=Object.keys(oe);if((0,be.checkValidKeys)(Pe,ve,"GPUComposer.stepSegment(params)"),(0,be.checkRequiredKeys)(Pe,we,"GPUComposer.stepSegment(params)"),!this._iterateOverOutputsIfNeeded(oe,"stepSegment")){var Me=this,De=Me.gl,Oe=Me._errorState,Ie=oe.program,Be=oe.position1,ze=oe.position2,et=oe.thickness,qe=oe.input,je=oe.output;if(!Oe){var it=this._width,ct=this._height;oe.useOutputScale&&(me=this._widthHeightForOutput(Ie.name,je),it=me.width,ct=me.height);var rt=this._drawSetup(Ie,ne.SEGMENT_PROGRAM_NAME,{},!1,qe,je);Ie._setVertexUniform(rt,"u_gpuio_halfThickness",et/2,ne.FLOAT),Ie._setVertexUniform(rt,"u_gpuio_scale",[2/it,2/ct],ne.FLOAT);var ut=Be[0]-ze[0],We=Be[1]-ze[1],Re=Math.atan2(We,ut);Ie._setVertexUniform(rt,"u_gpuio_rotation",Re,ne.FLOAT);var Ue=(Be[0]+ze[0])/2,Le=(Be[1]+ze[1])/2;Ie._setVertexUniform(rt,"u_gpuio_translation",[2*Ue/it-1,2*Le/ct-1],ne.FLOAT);var Ge=Math.sqrt(ut*ut+We*We),ke=oe.numCapSegments?oe.numCapSegments*2:ne.DEFAULT_CIRCLE_NUM_SEGMENTS;if(oe.endCaps){if(ke<6||ke%6!==0)throw new Error("numCapSegments for GPUComposer.stepSegment must be divisible by 3, got ".concat(ke/2,"."));Ie._setVertexUniform(rt,"u_gpuio_length",Ge,ne.FLOAT),De.bindBuffer(De.ARRAY_BUFFER,this._getCirclePositionsBuffer(ke))}else Ie._setVertexUniform(rt,"u_gpuio_length",Ge-et,ne.FLOAT),De.bindBuffer(De.ARRAY_BUFFER,this._getQuadPositionsBuffer());this._setPositionAttribute(rt,Ie.name),this._setBlendMode(oe.blendAlpha),oe.endCaps?De.drawArrays(De.TRIANGLE_FAN,0,ke+2):De.drawArrays(De.TRIANGLE_STRIP,0,4),this._drawFinish(oe)}}},he.prototype.stepRect=function(oe){var me=["program","position","size","useOutputScale","input","output","blendAlpha"],ve=["program","position","size"],we=Object.keys(oe);if((0,be.checkValidKeys)(we,me,"GPUComposer.stepRect(params)"),(0,be.checkRequiredKeys)(we,ve,"GPUComposer.stepRect(params)"),!this._iterateOverOutputsIfNeeded(oe,"stepRect")){var Pe=[oe.position[0],oe.position[1]+oe.size[1]/2],Me=[oe.position[0]+oe.size[0],Pe[1]];this.stepSegment({program:oe.program,position1:Pe,position2:Me,thickness:oe.size[1],useOutputScale:oe.useOutputScale,input:oe.input,output:oe.output,endCaps:!1,blendAlpha:oe.blendAlpha})}},he.prototype.drawLayerAsPoints=function(oe){var me,ve=["layer","program","input","output","pointSize","useOutputScale","count","color","wrapX","wrapY","blendAlpha"],we=["layer"],Pe=Object.keys(oe);if((0,be.checkValidKeys)(Pe,ve,"GPUComposer.drawLayerAsPoints(params)"),(0,be.checkRequiredKeys)(Pe,we,"GPUComposer.drawLayerAsPoints(params)"),!this._iterateOverOutputsIfNeeded(oe,"drawLayerAsPoints")){var Me=this,De=Me.gl,Oe=Me._pointIndexArray,Ie=Me.glslVersion,Be=Me._errorState,ze=oe.layer,et=oe.output;if(!Be){if(ze.numComponents!==2&&ze.numComponents!==4)throw new Error('GPUComposer.drawLayerAsPoints() must be passed a layer parameter with either 2 or 4 components, got layer "'.concat(ze.name,'" with ').concat(ze.numComponents," components."));var qe=ze.length,je=oe.count||qe;if(je>qe)throw new Error("Invalid count ".concat(je," for layer parameter of length ").concat(qe,"."));Ie===ne.GLSL1&&je>ne.MAX_FLOAT_INT&&console.warn("Points positions array length: ".concat(je," is longer than what is supported by GLSL1 : ").concat(ne.MAX_FLOAT_INT,"."));var it=oe.program;if(it===void 0){it=this._setValueProgramForType(ne.FLOAT);var ct=oe.color||[1,0,0];if(ct.length!==3)throw new Error("Color parameter must have length 3, got ".concat(JSON.stringify(ct),"."));it.setUniform("u_value",te(te([],ct,!0),[1],!1),ne.FLOAT)}var rt=this._addLayerToInputs(ze,oe.input),ut={};ze.numComponents===4&&(ut[ne.GPUIO_VS_POSITION_W_ACCUM]="1"),oe.wrapX&&(ut[ne.GPUIO_VS_WRAP_X]="1"),oe.wrapY&&(ut[ne.GPUIO_VS_WRAP_Y]="1");var We=this._drawSetup(it,ne.LAYER_POINTS_PROGRAM_NAME,ut,!1,rt,et);it._setVertexUniform(We,"u_gpuio_positions",(0,se.indexOfLayerInArray)(ze,rt),ne.INT);var Re=this._width,Ue=this._height;oe.useOutputScale&&(me=this._widthHeightForOutput(it.name,et),Re=me.width,Ue=me.height),it._setVertexUniform(We,"u_gpuio_scale",[1/Re,1/Ue],ne.FLOAT);var Le=oe.pointSize||1;it._setVertexUniform(We,"u_gpuio_pointSize",Le,ne.FLOAT);var Ge=[ze.width,ze.height];if(it._setVertexUniform(We,"u_gpuio_positionsDimensions",Ge,ne.FLOAT),Ie===ne.GLSL1){if(this._pointIndexBuffer===void 0||Oe&&Oe.length<je){var ke=(0,se.initSequentialFloatArray)(qe);this._pointIndexArray=ke,this._pointIndexBuffer=this._initVertexBuffer(ke)}De.bindBuffer(De.ARRAY_BUFFER,this._pointIndexBuffer),this._setIndexAttribute(We,it.name)}this._setBlendMode(oe.blendAlpha),De.drawArrays(De.POINTS,0,je),this._drawFinish(oe)}}},he.prototype.drawLayerAsVectorField=function(oe){var me=["layer","program","input","output","vectorSpacing","vectorScale","color","blendAlpha"],ve=["layer"],we=Object.keys(oe);if((0,be.checkValidKeys)(we,me,"GPUComposer.drawLayerAsVectorField(params)"),(0,be.checkRequiredKeys)(we,ve,"GPUComposer.drawLayerAsVectorField(params)"),!this._iterateOverOutputsIfNeeded(oe,"drawLayerAsVectorField")){var Pe=this,Me=Pe.gl,De=Pe._vectorFieldIndexArray,Oe=Pe._width,Ie=Pe._height,Be=Pe.glslVersion,ze=Pe._errorState,et=oe.layer,qe=oe.output;if(!ze){if(et.numComponents!==2)throw new Error('GPUComposer.drawLayerAsVectorField() must be passed a fieldLayer with 2 components, got fieldLayer "'.concat(et.name,'" with ').concat(et.numComponents," components."));var je=oe.program;if(je===void 0){je=this._setValueProgramForType(ne.FLOAT);var it=oe.color||[1,0,0];if(it.length!==3)throw new Error("color parameter must have length 3, got ".concat(JSON.stringify(it),"."));je.setUniform("u_value",te(te([],it,!0),[1],!1),ne.FLOAT)}var ct=this._addLayerToInputs(et,oe.input),rt=this._drawSetup(je,ne.LAYER_VECTOR_FIELD_PROGRAM_NAME,{},!1,ct,qe);je._setVertexUniform(rt,"u_gpuio_vectors",(0,se.indexOfLayerInArray)(et,ct),ne.INT);var ut=oe.vectorScale||1;je._setVertexUniform(rt,"u_gpuio_scale",[ut/Oe,ut/Ie],ne.FLOAT);var We=oe.vectorSpacing||10,Re=[Math.floor(Oe/We),Math.floor(Ie/We)];je._setVertexUniform(rt,"u_gpuio_dimensions",Re,ne.FLOAT);var Ue=2*Re[0]*Re[1];if(Be===ne.GLSL1){if(this._vectorFieldIndexBuffer===void 0||De&&De.length<Ue){var Le=(0,se.initSequentialFloatArray)(Ue);this._vectorFieldIndexArray=Le,this._vectorFieldIndexBuffer=this._initVertexBuffer(Le)}Me.bindBuffer(Me.ARRAY_BUFFER,this._vectorFieldIndexBuffer),this._setIndexAttribute(rt,je.name)}this._setBlendMode(oe.blendAlpha),Me.drawArrays(Me.LINES,0,Ue),this._drawFinish(oe)}}},he.prototype.drawLayerAsMesh=function(oe){var me,ve=["layer","indices","program","input","output","useOutputScale","color","blendAlpha"],we=["layer"],Pe=Object.keys(oe);if((0,be.checkValidKeys)(Pe,ve,"GPUComposer.drawLayerAsMesh(params)"),(0,be.checkRequiredKeys)(Pe,we,"GPUComposer.drawLayerAsMesh(params)"),!this._iterateOverOutputsIfNeeded(oe,"drawLayerAsMesh")){var Me=this,De=Me.gl,Oe=Me._width,Ie=Me._height,Be=Me.glslVersion,ze=Me._errorState,et=Me._meshIndexBuffer,qe=Me._meshIndexArray,je=oe.layer,it=oe.output;if(!ze){if(je.numComponents!==2&&je.numComponents!==4)throw new Error('GPUComposer.drawLayerAsMesh() must be passed a layer parameter with either 2 or 4 components, got position GPULayer "'.concat(je.name,'" with ').concat(je.numComponents," components."));var ct=je.is1D()?je.length:je.width*je.height;Be===ne.GLSL1&&ct>ne.MAX_FLOAT_INT&&console.warn("Mesh positions array length: ".concat(ct," is longer than what is supported by GLSL1 : ").concat(ne.MAX_FLOAT_INT,"."));var rt=oe.program;if(rt===void 0){rt=this._setValueProgramForType(ne.FLOAT);var ut=oe.color||[1,0,0];if(ut.length!==3)throw new Error("Color parameter must have length 3, got ".concat(JSON.stringify(ut),"."));rt.setUniform("u_value",te(te([],ut,!0),[1],!1),ne.FLOAT)}var We=this._addLayerToInputs(je,oe.input),Re={};je.numComponents===4&&(Re[ne.GPUIO_VS_POSITION_W_ACCUM]="1");var Ue=this._drawSetup(rt,ne.LAYER_MESH_PROGRAM_NAME,Re,!1,We,it);rt._setVertexUniform(Ue,"u_gpuio_positions",(0,se.indexOfLayerInArray)(je,We),ne.INT);var Le=Oe,Ge=Ie;oe.useOutputScale&&(me=this._widthHeightForOutput(rt.name,it),Le=me.width,Ge=me.height),rt._setVertexUniform(Ue,"u_gpuio_scale",[1/Le,1/Ge],ne.FLOAT);var ke=[je.width,je.height];if(rt._setVertexUniform(Ue,"u_gpuio_positionsDimensions",ke,ne.FLOAT),Be===ne.GLSL1){if(et===void 0||qe&&qe.length<ct){var He=(0,se.initSequentialFloatArray)(ct);this._meshIndexArray=He,this._meshIndexBuffer=this._initVertexBuffer(He)}De.bindBuffer(De.ARRAY_BUFFER,this._meshIndexBuffer),this._setIndexAttribute(Ue,rt.name)}if(this._setBlendMode(oe.blendAlpha),oe.indices){var Ke=oe.indices,$e=Ke.glType,Qe=Ke.count,Ne=Ke.buffer;De.bindBuffer(De.ELEMENT_ARRAY_BUFFER,Ne);var Ce=0;De.drawElements(De.TRIANGLES,Qe,$e,Ce)}else De.drawArrays(De.TRIANGLES,0,ct);this._drawFinish(oe)}}},Object.defineProperty(he.prototype,"clearValue",{get:function(){return this._clearValue},set:function(oe){var me=ne.FLOAT,ve=4;if(!(0,be.isValidClearValue)(oe,ve,me))throw new Error("Invalid clearValue: ".concat(JSON.stringify(oe)," for GPUComposer, expected ").concat(me," or array of ").concat(me," of length ").concat(ve,"."));this._clearValue=(0,ee.isArray)(oe)?oe.slice():oe,this._clearValueVec4=void 0},enumerable:!1,configurable:!0}),Object.defineProperty(he.prototype,"clearValueVec4",{get:function(){var oe=this._clearValueVec4;if(!oe){var me=this.clearValue;if(oe=[],(0,ee.isFiniteNumber)(me))oe.push(me,me,me,me);else{oe.push.apply(oe,me);for(var ve=oe.length;ve<4;ve++)oe.push(0)}this._clearValueVec4=oe}return oe},enumerable:!1,configurable:!0}),he.prototype.clear=function(){var oe=this,me=oe.verboseLogging,ve=oe.clearValueVec4;me&&console.log("Clearing GPUComoser.");var we=this._setValueProgramForType(ne.FLOAT);we.setUniform("u_value",ve),this.step({program:we})},he.prototype.undoThreeState=function(){var oe=this,me=oe.gl,ve=oe._threeRenderer,we=oe.isWebGL2;if(!ve)throw new Error("Can't call undoThreeState() on a GPUComposer that was not inited with GPUComposer.initWithThreeRenderer().");if(me.disable(me.BLEND),ve)if(we)me.bindVertexArray(null);else{var Pe=(0,ye.getExtension)(this,ye.OES_VERTEX_ARRAY_OBJECT,!0);Pe.bindVertexArrayOES(null)}},he.prototype.resetThreeState=function(){var oe=this,me=oe.gl,ve=oe._threeRenderer;if(!ve)throw new Error("Can't call resetThreeState() on a GPUComposer that was not inited with GPUComposer.initWithThreeRenderer().");var we=ve.getViewport(new le.Vector4);me.viewport(we.x,we.y,we.width,we.height),ve.resetState()},he.prototype.savePNG=function(oe){oe===void 0&&(oe={});var me=["filename","dpi","callback"],ve=Object.keys(oe);(0,be.checkValidKeys)(ve,me,"GPUComposer.savePNG(params)");var we=this.canvas,Pe=oe.filename||"output",Me=oe.callback||saveAs;we.toBlob(function(De){if(!De){console.warn("Problem saving PNG, unable to init blob from canvas.");return}oe.dpi?(0,Z.changeDpiBlob)(De,oe.dpi).then(function(Oe){Me(Oe,"".concat(Pe,".png"))}):Me(De,"".concat(Pe,".png"))},"image/png")},he.prototype.tick=function(){this._numTicks+=1;var oe=this,me=oe._lastTickTime,ve=oe._lastTickFPS,we=performance.now();if(this._lastTickTime=we,!me)return{fps:0,numTicks:this._numTicks};var Pe=1e3/(we-me);ve||(ve=Pe);var Me=.9,De=Number.parseFloat((Me*ve+(1-Me)*Pe).toFixed(1));return this._lastTickFPS=De,{fps:De,numTicks:this._numTicks}},Object.defineProperty(he.prototype,"numTicks",{get:function(){return this._numTicks},enumerable:!1,configurable:!0}),he.prototype.dispose=function(){var oe=this,me,ve=this,we=ve.gl,Pe=ve.verboseLogging;Pe&&console.log("Deallocating GPUComposer."),this._quadPositionsBuffer&&(we.deleteBuffer(this._quadPositionsBuffer),delete this._quadPositionsBuffer),this._boundaryPositionsBuffer&&(we.deleteBuffer(this._boundaryPositionsBuffer),delete this._boundaryPositionsBuffer),Object.keys(this._circlePositionsBuffer).forEach(function(Me){we.deleteBuffer(oe._circlePositionsBuffer[Me])}),delete this._circlePositionsBuffer,delete this._pointIndexArray,this._pointIndexBuffer&&(we.deleteBuffer(this._pointIndexBuffer),delete this._pointIndexBuffer),delete this._vectorFieldIndexArray,this._vectorFieldIndexBuffer&&(we.deleteBuffer(this._vectorFieldIndexBuffer),delete this._vectorFieldIndexBuffer),this._indexedLinesIndexBuffer&&(we.deleteBuffer(this._indexedLinesIndexBuffer),delete this._indexedLinesIndexBuffer),Object.keys(this._vertexAttributeLocations).forEach(function(Me){delete oe._vertexAttributeLocations[Me]}),delete this._vertexAttributeLocations,delete this._enabledVertexAttributes,Object.values(this._vertexShaders).forEach(function(Me){var De=Me.compiledShaders;Object.keys(De).forEach(function(Oe){we.deleteShader(De[Oe]),delete De[Oe]})}),delete this._vertexShaders,Object.values(this._copyPrograms).forEach(function(Me){Me.dispose()}),Object.keys(this._copyPrograms).forEach(function(Me){delete oe._copyPrograms[Me]}),delete this._copyPrograms,Object.values(this._setValuePrograms).forEach(function(Me){Me.dispose()}),Object.keys(this._setValuePrograms).forEach(function(Me){delete oe._setValuePrograms[Me]}),delete this._setValuePrograms,(me=this._wrappedLineColorProgram)===null||me===void 0||me.dispose(),delete this._wrappedLineColorProgram,delete this._threeRenderer,delete this.gl,delete this.canvas,delete this._errorCallback,delete this._extensions,delete this._errorState,delete this.verboseLogging,delete this._numTicks,delete this.isWebGL2,delete this.glslVersion,delete this.intPrecision,delete this.floatPrecision,delete this._width,delete this._height,delete this._clearValue,delete this._clearValueVec4},he}();W.GPUComposer=Ee},981:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.GPUIndexBuffer=void 0;var J=Y(566),te=Y(650),Z=Y(707),ee=Y(581),re=function(){function ne(le,se){if(this._composer=le,!se)throw new Error("Error initing GPUIndexBuffer: must pass params to GPUIndexBuffer(composer, params).");if(!(0,J.isObject)(se))throw new Error("Error initing GPUIndexBuffer: must pass valid params object to GPUIndexBuffer(composer, params), got ".concat(JSON.stringify(se),"."));var ie=["indices","name"],ge=["indices"],fe=Object.keys(se);(0,Z.checkValidKeys)(fe,ie,"GPUIndexBuffer(composer, params)",se.name),(0,Z.checkRequiredKeys)(fe,ge,"GPUIndexBuffer(composer, params)",se.name);var ae=se.indices,ue=le.gl,pe=le.isWebGL2,_e=ue.createBuffer();ue.bindBuffer(ue.ELEMENT_ARRAY_BUFFER,_e),(0,te.isTypedArray)(ae)||(ae=new Uint32Array(ae));var xe;switch(ae.constructor){case Uint8Array:xe=ue.UNSIGNED_BYTE;break;case Uint16Array:xe=ue.UNSIGNED_SHORT;break;case Uint32Array:if(!pe){var be=(0,ee.getExtension)(le,ee.OES_ELEMENT_INDEX_UINT,!0);if(!be){xe=ue.UNSIGNED_SHORT,ae=Uint16Array.from(ae);break}}xe=ue.UNSIGNED_INT;break}ue.bufferData(ue.ELEMENT_ARRAY_BUFFER,ae,ue.STATIC_DRAW),this.buffer=_e,this.glType=xe,this.count=ae.length}return ne.prototype.dispose=function(){var le=this,se=le._composer,ie=le.buffer;se.gl.deleteBuffer(ie),delete this._composer,delete this.buffer,delete this.glType,delete this.count},ne}();W.GPUIndexBuffer=re},355:function(q,W,Y){var J=this&&this.__awaiter||function(ue,pe,_e,xe){function be(Te){return Te instanceof _e?Te:new _e(function(ye){ye(Te)})}return new(_e||(_e=Promise))(function(Te,ye){function Ee(me){try{oe(xe.next(me))}catch(ve){ye(ve)}}function he(me){try{oe(xe.throw(me))}catch(ve){ye(ve)}}function oe(me){me.done?Te(me.value):be(me.value).then(Ee,he)}oe((xe=xe.apply(ue,pe||[])).next())})},te=this&&this.__generator||function(ue,pe){var _e={label:0,sent:function(){if(Te[0]&1)throw Te[1];return Te[1]},trys:[],ops:[]},xe,be,Te,ye;return ye={next:Ee(0),throw:Ee(1),return:Ee(2)},typeof Symbol=="function"&&(ye[Symbol.iterator]=function(){return this}),ye;function Ee(oe){return function(me){return he([oe,me])}}function he(oe){if(xe)throw new TypeError("Generator is already executing.");for(;_e;)try{if(xe=1,be&&(Te=oe[0]&2?be.return:oe[0]?be.throw||((Te=be.return)&&Te.call(be),0):be.next)&&!(Te=Te.call(be,oe[1])).done)return Te;switch(be=0,Te&&(oe=[oe[0]&2,Te.value]),oe[0]){case 0:case 1:Te=oe;break;case 4:return _e.label++,{value:oe[1],done:!1};case 5:_e.label++,be=oe[1],oe=[0];continue;case 7:oe=_e.ops.pop(),_e.trys.pop();continue;default:if(Te=_e.trys,!(Te=Te.length>0&&Te[Te.length-1])&&(oe[0]===6||oe[0]===2)){_e=0;continue}if(oe[0]===3&&(!Te||oe[1]>Te[0]&&oe[1]<Te[3])){_e.label=oe[1];break}if(oe[0]===6&&_e.label<Te[1]){_e.label=Te[1],Te=oe;break}if(Te&&_e.label<Te[2]){_e.label=Te[2],_e.ops.push(oe);break}Te[2]&&_e.ops.pop(),_e.trys.pop();continue}oe=pe.call(ue,_e)}catch(me){oe=[6,me],be=0}finally{xe=Te=0}if(oe[0]&5)throw oe[1];return{value:oe[0]?oe[1]:void 0,done:!0}}};Object.defineProperty(W,"__esModule",{value:!0}),W.GPULayer=void 0;var Z=Y(650),ee=Y(566),re=Y(809),ne=Y(162),le=Y(707),se=Y(601),ie=Y(593),ge=Y(798),fe=Y(690),ae=function(){function ue(pe,_e){this._clearValue=0,this._bufferIndex=0,this._buffers=[];var xe=(_e||{}).name;if(!pe)throw new Error('Error initing GPULayer "'.concat(xe,'": must pass GPUComposer instance to GPULayer(composer, params).'));if(!_e)throw new Error("Error initing GPULayer: must pass params to GPULayer(composer, params).");if(!(0,ee.isObject)(_e))throw new Error("Error initing GPULayer: must pass valid params object to GPULayer(composer, params), got ".concat(JSON.stringify(_e),"."));var be=["name","type","numComponents","dimensions","filter","wrapX","wrapY","numBuffers","clearValue","array"],Te=["name","type","numComponents","dimensions"],ye=Object.keys(_e);(0,le.checkValidKeys)(ye,be,"GPULayer(composer, params)",_e.name),(0,le.checkRequiredKeys)(ye,Te,"GPULayer(composer, params)",_e.name);var Ee=_e.dimensions,he=_e.type,oe=_e.numComponents,me=pe.gl;if(this._composer=pe,this.name=xe,!(0,ee.isPositiveInteger)(oe)||oe>4)throw new Error("Invalid numComponents: ".concat(JSON.stringify(oe),' for GPULayer "').concat(xe,'", must be number in range [1-4].'));this.numComponents=oe;var ve=ue.calcGPULayerSize(Ee,xe,pe.verboseLogging),we=ve.length,Pe=ve.width,Me=ve.height;this._length=we,this._width=Pe,this._height=Me;var De=we===void 0&&(he===se.FLOAT||he==se.HALF_FLOAT)?se.LINEAR:se.NEAREST,Oe=_e.filter!==void 0?_e.filter:De;if(!(0,le.isValidFilter)(Oe))throw new Error("Invalid filter: ".concat(JSON.stringify(Oe),' for GPULayer "').concat(xe,'", must be one of ').concat(JSON.stringify(se.validFilters),"."));if(Oe===se.LINEAR&&!(he===se.FLOAT||he==se.HALF_FLOAT))throw new Error('LINEAR filtering is not supported on integer types, please use NEAREST filtering for GPULayer "'.concat(xe,'" with type: ').concat(he,"."));this.filter=Oe;var Ie=_e.wrapX!==void 0?_e.wrapX:se.CLAMP_TO_EDGE;if(!(0,le.isValidWrap)(Ie))throw new Error("Invalid wrapX: ".concat(JSON.stringify(Ie),' for GPULayer "').concat(xe,'", must be one of ').concat(JSON.stringify(se.validWraps),"."));this.wrapX=Ie;var Be=_e.wrapY!==void 0?_e.wrapY:se.CLAMP_TO_EDGE;if(!(0,le.isValidWrap)(Be))throw new Error("Invalid wrapY: ".concat(JSON.stringify(Be),' for GPULayer "').concat(xe,'", must be one of ').concat(JSON.stringify(se.validWraps),"."));if(this.wrapY=Be,!(0,le.isValidDataType)(he))throw new Error("Invalid type: ".concat(JSON.stringify(he),' for GPULayer "').concat(xe,'", must be one of ').concat(JSON.stringify(se.validDataTypes),"."));this.type=he;var ze=ue.getGPULayerInternalType({composer:pe,type:he,name:xe});this._internalType=ze;var et=ue.getGLTextureParameters({composer:pe,name:xe,numComponents:oe,internalType:ze}),qe=et.glFormat,je=et.glInternalFormat,it=et.glType,ct=et.glNumChannels;this._glInternalFormat=je,this._glFormat=qe,this._glType=it,this._glNumChannels=ct;var rt=ue.getGPULayerInternalFilter({composer:pe,filter:Oe,wrapX:Ie,wrapY:Be,internalType:ze,name:xe});this._internalFilter=rt,this._glFilter=me[rt],this._internalWrapX=ue.getGPULayerInternalWrap({composer:pe,wrap:Ie,internalFilter:rt,internalType:ze,name:xe}),this._glWrapS=me[this._internalWrapX],this._internalWrapY=ue.getGPULayerInternalWrap({composer:pe,wrap:Be,internalFilter:rt,internalType:ze,name:xe}),this._glWrapT=me[this._internalWrapY];var ut=_e.numBuffers!==void 0?_e.numBuffers:1;if(!(0,ee.isPositiveInteger)(ut))throw new Error("Invalid numBuffers: ".concat(JSON.stringify(ut),' for GPULayer "').concat(xe,'", must be positive integer.'));this.numBuffers=ut,_e.clearValue!==void 0&&(this.clearValue=_e.clearValue),this._initBuffers(_e.array)}return ue.initFromImageURL=function(pe,_e){return J(this,void 0,void 0,function(){return te(this,function(xe){return[2,new Promise(function(be,Te){if(!_e)throw new Error("Error initing GPULayer: must pass params to GPULayer.initFromImageURL(composer, params).");if(!(0,ee.isObject)(_e))throw new Error("Error initing GPULayer: must pass valid params object to GPULayer.initFromImageURL(composer, params), got ".concat(JSON.stringify(_e),"."));var ye=["name","url","filter","wrapX","wrapY","format","type","clearValue"],Ee=["name","url"],he=Object.keys(_e);(0,le.checkValidKeys)(he,ye,"GPULayer.initFromImageURL(composer, params)",_e.name),(0,le.checkRequiredKeys)(he,Ee,"GPULayer.initFromImageURL(composer, params)",_e.name);var oe=_e.url,me=_e.name,ve=_e.filter,we=_e.wrapX,Pe=_e.wrapY,Me=_e.type,De=_e.format;if(!(0,ee.isString)(oe))throw new Error("Expected GPULayer.initFromImageURL params to have url of type string, got ".concat(oe," of type ").concat(typeof oe,"."));if(Me&&!(0,le.isValidImageType)(Me))throw new Error('Invalid type: "'.concat(Me,'" for GPULayer.initFromImageURL "').concat(me,'", must be one of ').concat(JSON.stringify(se.validImageTypes),"."));if(De&&!(0,le.isValidImageFormat)(De))throw new Error('Invalid format: "'.concat(De,'" for GPULayer.initFromImageURL "').concat(me,'", must be one of ').concat(JSON.stringify(se.validImageFormats),"."));var Oe=new ue(pe,{name:me,type:Me||se.FLOAT,numComponents:De?De.length:4,dimensions:[1,1],filter:ve,wrapX:we,wrapY:Pe,numBuffers:1,clearValue:_e.clearValue}),Ie=new Image;Ie.onload=function(){Oe.resize([Ie.width,Ie.height],Ie),be(Oe)},Ie.onerror=function(Be){Te(new Error('Error loading image "'.concat(me,'": ').concat(Be)))},Ie.src=oe})]})})},Object.defineProperty(ue.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(ue.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),Object.defineProperty(ue.prototype,"length",{get:function(){if(!this._length)throw new Error('Cannot access length on 2D GPULayer "'.concat(this.name,'".'));return this._length},enumerable:!1,configurable:!0}),ue.prototype.is1D=function(){return this._length!==void 0},ue.prototype.is2D=function(){return!this.is1D()},ue.prototype._usingTextureOverrideForCurrentBuffer=function(){return!!(this._textureOverrides&&this._textureOverrides[this.bufferIndex])},ue.prototype.copyCurrentStateToGPULayer=function(pe){var _e=this._composer;if(this===pe)throw new Error("Can't call GPULayer.copyCurrentStateToGPULayer() on self.");var xe=_e._copyProgramForType(this._internalType);_e.step({program:xe,input:this,output:pe})},ue.prototype._initBuffers=function(pe){var _e=this,xe=_e.name,be=_e.numBuffers,Te=_e._composer,ye=_e._glInternalFormat,Ee=_e._glFormat,he=_e._glType,oe=_e._glFilter,me=_e._glWrapS,ve=_e._glWrapT,we=_e.width,Pe=_e.height,Me=Te.gl,De=Te._errorCallback,Oe=null;(0,ee.isArray)(pe)?Oe=ue.validateGPULayerArray(pe,this):pe?.constructor===HTMLImageElement&&(Oe=pe);for(var Ie=0;Ie<be;Ie++){var Be=Me.createTexture();if(!Be){De('Could not init texture for GPULayer "'.concat(xe,'": ').concat(Me.getError(),"."));return}Me.bindTexture(Me.TEXTURE_2D,Be),Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_WRAP_S,me),Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_WRAP_T,ve),Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_MIN_FILTER,oe),Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_MAG_FILTER,oe),Me.texImage2D(Me.TEXTURE_2D,0,ye,we,Pe,0,Ee,he,Oe),this._buffers.push(Be)}Me.bindTexture(Me.TEXTURE_2D,null),Me.bindFramebuffer(Me.FRAMEBUFFER,null)},Object.defineProperty(ue.prototype,"bufferIndex",{get:function(){return this._bufferIndex},enumerable:!1,configurable:!0}),ue.prototype.incrementBufferIndex=function(){var pe=this.numBuffers;pe!==1&&(this._bufferIndex=(this.bufferIndex+1)%pe)},ue.prototype.decrementBufferIndex=function(){var pe=this.numBuffers;pe!==1&&(this._bufferIndex=(this.bufferIndex-1+pe)%pe)},Object.defineProperty(ue.prototype,"currentState",{get:function(){return this.getStateAtIndex(this.bufferIndex)},enumerable:!1,configurable:!0}),Object.defineProperty(ue.prototype,"_currentTexture",{get:function(){var pe=this,_e=pe._buffers,xe=pe._bufferIndex,be=pe._textureOverrides;return be&&be[xe]?be[xe]:_e[xe]},enumerable:!1,configurable:!0}),Object.defineProperty(ue.prototype,"lastState",{get:function(){if(this.numBuffers===1)throw new Error('Cannot access lastState on GPULayer "'.concat(this.name,'" with only one buffer.'));return this.getStateAtIndex((this.bufferIndex-1+this.numBuffers)%this.numBuffers)},enumerable:!1,configurable:!0}),ue.prototype.getStateAtIndex=function(pe){var _e=this,xe=_e.numBuffers,be=_e._textureOverrides,Te=_e._buffers;pe<0&&pe>-xe&&(pe+=xe),(pe<0||pe>=xe)&&(console.warn("Out of range buffer index: ".concat(pe,' for GPULayer "').concat(this.name,'" with $.numBuffers} buffer').concat(xe>1?"s":"",".  Was this intentional?")),pe<0?pe+=xe*Math.ceil(Math.abs(pe)/xe):pe=pe%xe);var ye=Te[pe];return be&&be[pe]&&(ye=be[pe]),{texture:ye,layer:this}},ue.prototype._prepareForWrite=function(pe){pe&&this.incrementBufferIndex(),this._textureOverrides&&(this._textureOverrides[this.bufferIndex]=void 0)},ue.prototype.setFromArray=function(pe){var _e=this,xe=_e._composer,be=_e._glInternalFormat,Te=_e._glFormat,ye=_e._glType,Ee=_e.width,he=_e.height,oe=_e._currentTexture,me=xe.gl,ve=ue.validateGPULayerArray(pe,this);me.bindTexture(me.TEXTURE_2D,oe),me.texImage2D(me.TEXTURE_2D,0,be,Ee,he,0,Te,ye,ve),me.bindTexture(me.TEXTURE_2D,null)},ue.prototype.setAtIndex2D=function(pe,_e,xe){var be=this,Te=be._composer,ye=be.width,Ee=be.height,he=be._currentTexture,oe=Te.gl;if(pe<0||pe>=ye||_e<0||_e>=Ee)throw new Error("Invalid coordinates [".concat(pe,", ").concat(_e,'] for GPULayer "').concat(this.name,'" with dimensions [').concat(ye,", ").concat(Ee,"]."));var me=ue.validateGPULayerArray(xe,this,1);oe.bindTexture(oe.TEXTURE_2D,he),oe.texSubImage2D(oe.TEXTURE_2D,0,pe,_e,1,1,this._glFormat,this._glType,me),oe.bindTexture(oe.TEXTURE_2D,null)},ue.prototype.setAtIndex1D=function(pe,_e){var xe=this;xe._glInternalFormat,xe._glFormat,xe._glType;var be=xe.width,Te=xe.height;if(xe._currentTexture,pe<0||pe>=be*Te)throw new Error("Invalid index ".concat(pe,' for GPULayer "').concat(this.name,'" with dimensions [').concat(be,", ").concat(Te,"]."));var ye=pe%be,Ee=Math.floor(pe/be);this.setAtIndex2D(ye,Ee,_e)},ue.prototype.resize=function(pe,_e){var xe=this,be=xe.name,Te=xe._composer,ye=Te.verboseLogging;ye&&console.log('Resizing GPULayer "'.concat(be,'" to ').concat(JSON.stringify(pe),"."));var Ee=ue.calcGPULayerSize(pe,be,ye),he=Ee.length,oe=Ee.width,me=Ee.height;this._length=he,this._width=oe,this._height=me,this._destroyBuffers(),this._initBuffers(_e)},Object.defineProperty(ue.prototype,"clearValue",{get:function(){return this._clearValue},set:function(pe){var _e=this,xe=_e.numComponents,be=_e.type;if(!(0,le.isValidClearValue)(pe,xe,be))throw new Error("Invalid clearValue: ".concat(JSON.stringify(pe),' for GPULayer "').concat(this.name,'", expected ').concat(be," or array of ").concat(be," of length ").concat(xe,"."));this._clearValue=(0,ee.isArray)(pe)?pe.slice():pe,this._clearValueVec4=void 0},enumerable:!1,configurable:!0}),Object.defineProperty(ue.prototype,"clearValueVec4",{get:function(){var pe=this._clearValueVec4;if(!pe){var _e=this.clearValue;if(pe=[],(0,ee.isFiniteNumber)(_e))pe.push(_e,_e,_e,_e);else{pe.push.apply(pe,_e);for(var xe=pe.length;xe<4;xe++)pe.push(0)}this._clearValueVec4=pe}return pe},enumerable:!1,configurable:!0}),ue.prototype.clear=function(pe){pe===void 0&&(pe=!1);var _e=this,xe=_e.name,be=_e._composer,Te=_e.clearValueVec4,ye=_e.numBuffers,Ee=_e.type,he=be.verboseLogging;he&&console.log('Clearing GPULayer "'.concat(xe,'".'));var oe=be._setValueProgramForType(Ee);oe.setUniform("u_value",Te),this.decrementBufferIndex();for(var me=pe?ye:1,ve=0;ve<me;ve++)be.step({program:oe,output:this});pe&&this.incrementBufferIndex()},ue.prototype._getValuesSetup=function(){var pe=this,_e=pe.width,xe=pe.height,be=pe._composer,Te=pe._currentTexture,ye=this._valuesRaw,Ee=be.gl;(0,ge.bindFrameBuffer)(be,this,Te);var he=this,oe=he._glNumChannels,me=he._glType,ve=he._glFormat,we=he._internalType;switch(we){case se.HALF_FLOAT:Ee.FLOAT!==void 0?(oe=4,ve=Ee.RGBA,me=Ee.FLOAT,ye=ye||new Float32Array(_e*xe*oe)):ye=ye||new Uint16Array(_e*xe*oe);break;case se.FLOAT:oe=4,ve=Ee.RGBA,ye=ye||new Float32Array(_e*xe*oe);break;case se.UNSIGNED_BYTE:oe=4,ve=Ee.RGBA_INTEGER,me=Ee.UNSIGNED_INT,ye=ye||new Uint32Array(_e*xe*oe);break;case se.UNSIGNED_SHORT:oe=4,ve=Ee.RGBA_INTEGER,me=Ee.UNSIGNED_INT,ye=ye||new Uint32Array(_e*xe*oe);break;case se.UNSIGNED_INT:oe=4,ve=Ee.RGBA_INTEGER,ye=ye||new Uint32Array(_e*xe*oe);break;case se.BYTE:oe=4,ve=Ee.RGBA_INTEGER,me=Ee.INT,ye=ye||new Int32Array(_e*xe*oe);break;case se.SHORT:oe=4,ve=Ee.RGBA_INTEGER,me=Ee.INT,ye=ye||new Int32Array(_e*xe*oe);break;case se.INT:oe=4,ve=Ee.RGBA_INTEGER,ye=ye||new Int32Array(_e*xe*oe);break;default:throw new Error("Unsupported internalType ".concat(we," for getValues()."))}if(this._valuesRaw=ye,(0,ie.readyToRead)(Ee))return{_glFormat:ve,_glType:me,_valuesRaw:ye,_glNumChannels:oe,_internalType:we};throw new Error("Unable to read values from Buffer with status: ".concat(Ee.checkFramebufferStatus(Ee.FRAMEBUFFER),"."))},ue.prototype._getValuesPost=function(pe,_e,xe){var be=this,Te=be.width,ye=be.height,Ee=be.numComponents,he=be.type,oe=(this._length?this._length:Te*ye)*Ee,me=xe===se.HALF_FLOAT&&pe.constructor===Uint16Array,ve=this._valuesBufferView;me&&!ve&&(ve=new DataView(pe.buffer),this._valuesBufferView=ve),pe.length===oe&&(0,fe.arrayConstructorForType)(he,!0)===pe.constructor?this._values=pe:this._values||(this._values=ue.initArrayForType(he,oe,!0));var we=this._values;if(ve||we!==pe||Ee!==_e)for(var Pe=0,Me=Te*ye;Pe<Me;Pe++){var De=Pe*_e,Oe=Pe*Ee;if(Oe>=oe)break;for(var Ie=0;Ie<Ee;Ie++)ve?we[Oe+Ie]=(0,Z.getFloat16)(ve,2*(De+Ie),!0):we[Oe+Ie]=pe[De+Ie]}return we},ue.prototype.getValues=function(){var pe=this,_e=pe.width,xe=pe.height,be=pe._composer,Te=be.gl,ye=this._getValuesSetup(),Ee=ye._glFormat,he=ye._glType,oe=ye._valuesRaw,me=ye._glNumChannels,ve=ye._internalType;return Te.readPixels(0,0,_e,xe,Ee,he,oe),this._getValuesPost(oe,me,ve)},ue.prototype.getValuesAsync=function(){return J(this,void 0,void 0,function(){var pe,_e,xe,be,Te,ye,Ee,he,oe,me,ve,we;return te(this,function(Pe){switch(Pe.label){case 0:return pe=this,_e=pe.width,xe=pe.height,be=pe._composer,Te=be.gl,ye=be.isWebGL2,ye?(Ee=this._getValuesSetup(),he=Ee._glFormat,oe=Ee._glType,me=Ee._valuesRaw,ve=Ee._glNumChannels,we=Ee._internalType,[4,(0,ie.readPixelsAsync)(Te,0,0,_e,xe,he,oe,me)]):[2,this.getValues()];case 1:return Pe.sent(),[2,this._getValuesPost(me,ve,we)]}})})},ue.prototype._getCanvasWithImageData=function(pe){var _e=this.getValues(),xe=this,be=xe.width,Te=xe.height,ye=xe.numComponents,Ee=xe.type;pe=pe||(Ee===se.FLOAT||Ee===se.HALF_FLOAT?255:1);var he=document.createElement("canvas");he.width=be,he.height=Te;for(var oe=he.getContext("2d"),me=oe.getImageData(0,0,be,Te),ve=me.data,we=0;we<Te;we++)for(var Pe=0;Pe<be;Pe++){for(var Me=we*be+Pe,De=(Te-1-we)*be+Pe,Oe=0;Oe<ye;Oe++)ve[4*De+Oe]=_e[ye*Me+Oe]*pe;ye===1&&(ve[4*De+1]=ve[4*De],ve[4*De+2]=ve[4*De]),ye<4&&(ve[4*De+3]=255)}return oe.putImageData(me,0,0),he},ue.prototype.getImage=function(pe){if(pe){var _e=["multiplier"],xe=Object.keys(pe);(0,le.checkValidKeys)(xe,_e,"GPULayer.getImage(params)")}var be=this._getCanvasWithImageData(pe&&pe.multiplier),Te=new Image;return Te.src=be.toDataURL(),Te},ue.prototype.savePNG=function(pe){pe===void 0&&(pe={});var _e=["filename","dpi","multiplier","callback"],xe=Object.keys(pe);(0,le.checkValidKeys)(xe,_e,"GPULayer.savePNG(params)");var be=this.name,Te=pe.callback||ne.saveAs,ye=pe.filename||be,Ee=this._getCanvasWithImageData(pe.multiplier);Ee.toBlob(function(he){if(!he){console.warn('Problem saving PNG from GPULayer "'.concat(be,'", unable to init blob.'));return}pe.dpi?(0,re.changeDpiBlob)(he,pe.dpi).then(function(oe){Te(oe,"".concat(ye,".png"))}):Te(he,"".concat(ye,".png"))},"image/png")},ue.prototype.attachToThreeTexture=function(pe){var _e=this,xe=_e._composer,be=_e.numBuffers,Te=_e.currentState,ye=_e.name,Ee=xe._threeRenderer,he=xe.gl;if(!Ee)throw new Error("GPUComposer was not inited with a renderer.");if(be>1)throw new Error('GPULayer "'.concat(ye,'" contains multiple WebGL textures (one for each buffer) that are flip-flopped during compute cycles, please choose a GPULayer with one buffer.  You can copy the current state of this GPULayer to a single buffer GPULayer during your render loop.'));var oe=Ee.properties.get(pe);he.deleteTexture(oe.__webglTexture),oe.__webglTexture=Te.texture,oe.__webglInit=!0},ue.prototype._destroyBuffers=function(){var pe=this,_e=pe._composer,xe=pe._buffers,be=_e.gl;xe.forEach(function(Te){be.deleteTexture(Te),(0,ge.disposeFramebuffers)(be,Te)}),xe.length=0,delete this._textureOverrides},ue.prototype.clone=function(pe){return this._composer._cloneGPULayer(this,pe)},ue.prototype.dispose=function(){var pe=this,_e=pe.name,xe=pe._composer,be=xe.gl,Te=xe.verboseLogging;if(Te&&console.log('Deallocating GPULayer "'.concat(_e,'".')),!be)throw new Error("Must call dispose() on all GPULayers before calling dispose() on GPUComposer.");this._destroyBuffers(),delete this._buffers,delete this._composer,this._values&&delete this._values,this._valuesRaw&&delete this._valuesRaw},ue}();W.GPULayer=ae},191:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.minMaxValuesForType=W.testFilterWrap=W.testWriteSupport=W.shouldCastIntTypeAsFloat=void 0;var J=Y(566),te=Y(650),Z=Y(601),ee=Y(690),re=Y(581),ne=Y(798),le=Y(355),se=Y(593),ie={writeSupport:{},filterWrapSupport:{}};le.GPULayer.initArrayForType=function(pe,_e,xe){return xe===void 0&&(xe=!1),new((0,ee.arrayConstructorForType)(pe,xe))(_e)},le.GPULayer.calcGPULayerSize=function(pe,_e,xe){if((0,J.isNumber)(pe)){if(!(0,J.isPositiveInteger)(pe))throw new Error("Invalid length: ".concat(JSON.stringify(pe),' for GPULayer "').concat(_e,'", must be positive integer.'));var be=pe,Te=Math.ceil(Math.sqrt(be)),ye=Math.ceil(be/Te);return xe&&console.log("Using [".concat(Te,", ").concat(ye,"] for 1D array of length ").concat(pe,' in GPULayer "').concat(_e,'".')),{width:Te,height:ye,length:be}}var Ee=pe[0];if(!(0,J.isPositiveInteger)(Ee))throw new Error("Invalid width: ".concat(JSON.stringify(Ee),' for GPULayer "').concat(_e,'", must be positive integer.'));var he=pe[1];if(!(0,J.isPositiveInteger)(he))throw new Error("Invalid height: ".concat(JSON.stringify(he),' for GPULayer "').concat(_e,'", must be positive integer.'));return{width:Ee,height:he}},le.GPULayer.getGPULayerInternalWrap=function(pe){var _e=pe.composer,xe=pe.wrap,be=pe.internalFilter,Te=pe.internalType;return xe===Z.CLAMP_TO_EDGE||ae(_e,Te,be,xe)?xe:Z.CLAMP_TO_EDGE},le.GPULayer.getGPULayerInternalFilter=function(pe){var _e=pe.filter;if(_e===Z.NEAREST)return _e;var xe=pe.composer,be=pe.internalType,Te=pe.wrapX,ye=pe.wrapY,Ee=pe.name;if(be===Z.HALF_FLOAT){var he=(0,re.getExtension)(xe,re.OES_TEXTURE_HAlF_FLOAT_LINEAR,!0)||(0,re.getExtension)(xe,re.OES_TEXTURE_FLOAT_LINEAR,!0);(!he||!ae(xe,be,_e,Te)||!ae(xe,be,_e,ye))&&(console.warn("This browser does not support ".concat(_e," filtering for type ").concat(be," and wrap [").concat(Te,", ").concat(ye,'].  Falling back to NEAREST filter for GPULayer "').concat(Ee,'" with ').concat(_e," polyfill in fragment shader.")),_e=Z.NEAREST)}if(be===Z.FLOAT){var he=(0,re.getExtension)(xe,re.OES_TEXTURE_FLOAT_LINEAR,!0);(!he||!ae(xe,be,_e,Te)||!ae(xe,be,_e,ye))&&(console.warn("This browser does not support ".concat(_e," filtering for type ").concat(be," and wrap [").concat(Te,", ").concat(ye,'].  Falling back to NEAREST filter for GPULayer "').concat(Ee,'" with ').concat(_e," polyfill in fragment shader.")),_e=Z.NEAREST)}return _e};function ge(pe,_e){var xe=pe.glslVersion,be=pe.isWebGL2;return xe===Z.GLSL3&&be?!1:_e===Z.UNSIGNED_BYTE||_e===Z.BYTE||_e===Z.SHORT||_e===Z.INT||_e===Z.UNSIGNED_SHORT||_e===Z.UNSIGNED_INT}W.shouldCastIntTypeAsFloat=ge,le.GPULayer.getGLTextureParameters=function(pe){var _e=pe.composer,xe=pe.name,be=pe.numComponents,Te=pe.internalType,ye=_e.gl,Ee=_e.glslVersion,he=_e.isWebGL2,oe,me,ve,we;if(he){if(we=be,be===3&&(we=4),Te===Z.FLOAT||Te===Z.HALF_FLOAT)switch(we){case 1:me=ye.RED;break;case 2:me=ye.RG;break;case 4:me=ye.RGBA;break;default:throw new Error("Unsupported glNumChannels: ".concat(we,' for GPULayer "').concat(xe,'".'))}else switch(we){case 1:me=ye.RED_INTEGER;break;case 2:me=ye.RG_INTEGER;break;case 4:me=ye.RGBA_INTEGER;break;default:throw new Error("Unsupported glNumChannels: ".concat(we,' for GPULayer "').concat(xe,'".'))}switch(Te){case Z.HALF_FLOAT:switch(oe=ye.HALF_FLOAT,we){case 1:ve=ye.R16F;break;case 2:ve=ye.RG16F;break;case 4:ve=ye.RGBA16F;break;default:throw new Error("Unsupported glNumChannels: ".concat(we,' for GPULayer "').concat(xe,'".'))}break;case Z.FLOAT:switch(oe=ye.FLOAT,we){case 1:ve=ye.R32F;break;case 2:ve=ye.RG32F;break;case 4:ve=ye.RGBA32F;break;default:throw new Error("Unsupported glNumChannels: ".concat(we,' for GPULayer "').concat(xe,'".'))}break;case Z.UNSIGNED_BYTE:if(oe=ye.UNSIGNED_BYTE,Ee===Z.GLSL1&&Te===Z.UNSIGNED_BYTE)ve=me;else switch(we){case 1:ve=ye.R8UI;break;case 2:ve=ye.RG8UI;break;case 4:ve=ye.RGBA8UI;break;default:throw new Error("Unsupported glNumChannels: ".concat(we,' for GPULayer "').concat(xe,'".'))}break;case Z.BYTE:switch(oe=ye.BYTE,we){case 1:ve=ye.R8I;break;case 2:ve=ye.RG8I;break;case 4:ve=ye.RGBA8I;break;default:throw new Error("Unsupported glNumChannels: ".concat(we,' for GPULayer "').concat(xe,'".'))}break;case Z.SHORT:switch(oe=ye.SHORT,we){case 1:ve=ye.R16I;break;case 2:ve=ye.RG16I;break;case 4:ve=ye.RGBA16I;break;default:throw new Error("Unsupported glNumChannels: ".concat(we,' for GPULayer "').concat(xe,'".'))}break;case Z.UNSIGNED_SHORT:switch(oe=ye.UNSIGNED_SHORT,we){case 1:ve=ye.R16UI;break;case 2:ve=ye.RG16UI;break;case 4:ve=ye.RGBA16UI;break;default:throw new Error("Unsupported glNumChannels: ".concat(we,' for GPULayer "').concat(xe,'".'))}break;case Z.INT:switch(oe=ye.INT,we){case 1:ve=ye.R32I;break;case 2:ve=ye.RG32I;break;case 4:ve=ye.RGBA32I;break;default:throw new Error("Unsupported glNumChannels: ".concat(we,' for GPULayer "').concat(xe,'".'))}break;case Z.UNSIGNED_INT:switch(oe=ye.UNSIGNED_INT,we){case 1:ve=ye.R32UI;break;case 2:ve=ye.RG32UI;break;case 4:ve=ye.RGBA32UI;break;default:throw new Error("Unsupported glNumChannels: ".concat(we,' for GPULayer "').concat(xe,'".'))}break;default:throw new Error('Unsupported type: "'.concat(Te,'" for GPULayer "').concat(xe,'".'))}}else{if(be<1||be>4)throw new Error("Unsupported numComponents: ".concat(be,' for GPULayer "').concat(xe,'".'));switch(we=4,me=ye.RGBA,ve=ye.RGBA,Te){case Z.FLOAT:oe=ye.FLOAT;break;case Z.HALF_FLOAT:oe=ye.HALF_FLOAT||(0,re.getExtension)(_e,re.OES_TEXTURE_HALF_FLOAT).HALF_FLOAT_OES;break;default:throw new Error('Unsupported type: "'.concat(Te,'" in WebGL 1.0 for GPULayer "').concat(xe,'".'))}}if(oe===void 0||me===void 0||ve===void 0){var Pe=[];throw oe===void 0&&Pe.push("glType"),me===void 0&&Pe.push("glFormat"),ve===void 0&&Pe.push("glInternalFormat"),new Error("Invalid type: ".concat(Te," for numComponents: ").concat(be,", unable to init parameter").concat(Pe.length>1?"s":""," ").concat(Pe.join(", "),' for GPULayer "').concat(xe,'".'))}if(we===void 0||be<1||be>4||we<be)throw new Error("Invalid numChannels: ".concat(we," for numComponents: ").concat(be,' for GPULayer "').concat(xe,'".'));return{glFormat:me,glInternalFormat:ve,glType:oe,glNumChannels:we}};function fe(pe,_e){var xe=pe.gl,be=pe.glslVersion,Te=pe.isWebGL2,ye="".concat(Te,",").concat(_e,",").concat(be===Z.GLSL3?"3":"1");if(ie.writeSupport[ye]!==void 0)return ie.writeSupport[ye];var Ee=xe.createTexture();if(!Ee)return ie.writeSupport[ye]=!1,ie.writeSupport[ye];xe.bindTexture(xe.TEXTURE_2D,Ee);var he=xe[Z.CLAMP_TO_EDGE],oe=xe[Z.NEAREST],me=10,ve=10;xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_WRAP_S,he),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_WRAP_T,he),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_MIN_FILTER,oe),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_MAG_FILTER,oe);var we=le.GPULayer.getGLTextureParameters({composer:pe,name:"testWriteSupport",numComponents:1,internalType:_e}),Pe=we.glInternalFormat,Me=we.glFormat,De=we.glType;xe.texImage2D(xe.TEXTURE_2D,0,Pe,me,ve,0,Me,De,null);var Oe=xe.createFramebuffer();if(!Oe)return xe.deleteTexture(Ee),ie.writeSupport[ye]=!1,ie.writeSupport[ye];xe.bindFramebuffer(xe.FRAMEBUFFER,Oe),xe.framebufferTexture2D(xe.FRAMEBUFFER,xe.COLOR_ATTACHMENT0,xe.TEXTURE_2D,Ee,0);var Ie=xe.checkFramebufferStatus(xe.FRAMEBUFFER)===xe.FRAMEBUFFER_COMPLETE;return xe.deleteTexture(Ee),xe.deleteFramebuffer(Oe),ie.writeSupport[ye]=Ie,ie.writeSupport[ye]}W.testWriteSupport=fe;function ae(pe,_e,xe,be){var Te,ye=pe.gl,Ee=pe.glslVersion,he=pe.intPrecision,oe=pe.floatPrecision,me=pe._errorCallback,ve=pe.isWebGL2,we="".concat(ve,",").concat(_e,",").concat(xe,",").concat(be,",").concat(Ee===Z.GLSL3?"3":"1");if(ie.filterWrapSupport[we]!==void 0)return ie.filterWrapSupport[we];var Pe=ye.createTexture();if(!Pe)return ie.filterWrapSupport[we]=!1,ie.filterWrapSupport[we];ye.bindTexture(ye.TEXTURE_2D,Pe);var Me=ye[be],De=ye[xe],Oe=3,Ie=3,Be=1;ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_WRAP_S,Me),ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_WRAP_T,Me),ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_MIN_FILTER,De),ye.texParameteri(ye.TEXTURE_2D,ye.TEXTURE_MAG_FILTER,De);for(var ze=le.GPULayer.getGLTextureParameters({composer:pe,name:"testFilterWrap",numComponents:Be,internalType:_e}),et=ze.glInternalFormat,qe=ze.glFormat,je=ze.glType,it=ze.glNumChannels,ct=[3,56.5,834,-53.6,.003,96.2,23,90.2,32],rt=le.GPULayer.initArrayForType(_e,ct.length*it,!0),ut=0;ut<ct.length;ut++)rt[ut*it]=ct[ut],ct[ut]=rt[ut*it];if(_e===Z.HALF_FLOAT){for(var We=new Uint16Array(rt.length),Re=new DataView(We.buffer),ut=0;ut<rt.length;ut++)(0,te.setFloat16)(Re,2*ut,rt[ut],!0);rt=We}ye.texImage2D(ye.TEXTURE_2D,0,et,Oe,Ie,0,qe,je,rt);var Ue=new le.GPULayer(pe,{name:"testFloatLinearFiltering-output",type:_e,numComponents:Be,dimensions:[Oe,Ie],wrapX:Z.CLAMP_TO_EDGE,wrapY:Z.CLAMP_TO_EDGE,filter:Z.NEAREST}),Le=xe===Z.LINEAR?.5:1,Ge="testFilterWrap-program",ke=`
in vec2 v_uv;
uniform vec2 u_offset;
#ifdef GPUIO_INT
	uniform isampler2D u_input;
	out int out_result;
#endif
#ifdef GPUIO_UINT
	uniform usampler2D u_input;
	out uint out_result;
#endif
#ifdef GPUIO_FLOAT
	uniform sampler2D u_input;
	out float out_result;
#endif
void main() {
	out_result = texture(u_input, v_uv + offset).x;
}`;Ee!==Z.GLSL3&&(ke=(0,se.convertFragmentShaderToGLSL1)(ke,Ge)[0]);var He=(0,se.compileShader)(ye,Ee,he,oe,ke,ye.FRAGMENT_SHADER,Ge,me,(Te={offset:"vec2(".concat(Le/Oe,", ").concat(Le/Ie,")")},Te[(0,se.isUnsignedIntType)(_e)?"GPUIO_UINT":(0,se.isIntType)(_e)?"GPUIO_INT":"GPUIO_FLOAT"]="1",Te),void 0,!0);function Ke(Ae,Fe){return be===Z.CLAMP_TO_EDGE?Math.max(0,Math.min(Fe-1,Ae)):(Ae+Fe)%Fe}var $e=pe._getVertexShader(Z.DEFAULT_PROGRAM_NAME,"",{},Ge);if($e&&He){var Qe=(0,se.initGLProgram)(ye,$e,He,Ge,me);if(Qe){Ue._prepareForWrite(!1),(0,ne.bindFrameBuffer)(pe,Ue,Ue._currentTexture),ye.viewport(0,0,Oe,Ie),ye.useProgram(Qe),ye.activeTexture(ye.TEXTURE0),ye.bindTexture(ye.TEXTURE_2D,Pe),ye.uniform2fv(ye.getUniformLocation(Qe,"u_gpuio_scale"),[1,1]),ye.uniform2fv(ye.getUniformLocation(Qe,"u_gpuio_translation"),[0,0]),ye.bindBuffer(ye.ARRAY_BUFFER,pe._getQuadPositionsBuffer()),pe._setPositionAttribute(Qe,Ge),ye.drawArrays(ye.TRIANGLE_STRIP,0,4),ye.disable(ye.BLEND);for(var Ne=Ue.getValues(),Ce=!0,Ze=(0,se.isIntType)(_e)?0:_e===Z.HALF_FLOAT?.01:1e-4,at=0;at<Oe;at++)for(var st=0;st<Ie;st++){var Se=void 0;if(xe===Z.LINEAR)Se=(ct[st*Oe+at]+ct[st*Oe+Ke(at+1,Oe)]+ct[Ke(st+1,Ie)*Oe+at]+ct[Ke(st+1,Ie)*Oe+Ke(at+1,Oe)])/4;else{var ce=Ke(at+Le,Oe),de=Ke(st+Le,Ie);Se=ct[de*Oe+ce]}var ut=st*Oe+at;if(Math.abs((Se-Ne[ut])/Se)>Ze){Ce=!1;break}}ie.filterWrapSupport[we]=Ce,ye.deleteProgram(Qe)}else ie.filterWrapSupport[we]=!1;ye.deleteShader(He)}else ie.filterWrapSupport[we]=!1;return Ue.dispose(),ye.deleteTexture(Pe),ie.filterWrapSupport[we]}W.testFilterWrap=ae,le.GPULayer.getGPULayerInternalType=function(pe){var _e=pe.composer,xe=pe.name,be=_e._errorCallback,Te=_e.isWebGL2,ye=pe.type,Ee=ye,he=ge(_e,ye);if(he&&(Ee===Z.UNSIGNED_BYTE||Ee===Z.BYTE?Ee=Z.HALF_FLOAT:(console.warn("Falling back ".concat(Ee,' type to FLOAT type for glsl1.x support for GPULayer "').concat(xe,`".
Large UNSIGNED_INT or INT with absolute value > 16,777,216 are not supported, on mobile UNSIGNED_INT, INT, UNSIGNED_SHORT, and SHORT with absolute value > 2,048 may not be supported.`)),Ee=Z.FLOAT)),Te){if(Ee===Z.FLOAT){var oe=(0,re.getExtension)(_e,re.EXT_COLOR_BUFFER_FLOAT,!0);if(!oe)console.warn('FLOAT not supported in this browser, falling back to HALF_FLOAT type for GPULayer "'.concat(xe,'".')),Ee=Z.HALF_FLOAT;else{var me=fe(_e,Ee);me||(console.warn('FLOAT not supported for writing operations in this browser, falling back to HALF_FLOAT type for GPULayer "'.concat(xe,'".')),Ee=Z.HALF_FLOAT)}}if(Ee===Z.HALF_FLOAT){var ve=(0,re.getExtension)(_e,re.EXT_COLOR_BUFFER_HALF_FLOAT,!0);ve||(0,re.getExtension)(_e,re.EXT_COLOR_BUFFER_FLOAT,!0);var me=fe(_e,Ee);me||(console.warn("This browser does not support writing to HALF_FLOAT textures."),be("This browser does not support writing to HALF_FLOAT textures."))}}else{if(Ee===Z.FLOAT){var oe=(0,re.getExtension)(_e,re.OES_TEXTURE_FLOAT,!0);if(oe){var me=fe(_e,Ee);me||(console.warn('FLOAT not supported for writing operations in this browser, falling back to HALF_FLOAT type for GPULayer "'.concat(xe,'".')),Ee=Z.HALF_FLOAT)}else console.warn('FLOAT not supported in this browser, falling back to HALF_FLOAT type for GPULayer "'.concat(xe,'".')),Ee=Z.HALF_FLOAT}if(Ee===Z.HALF_FLOAT){(0,re.getExtension)(_e,re.OES_TEXTURE_HALF_FLOAT,!0);var me=fe(_e,Ee);me||console.warn("This browser does not support writing to HALF_FLOAT textures.")}}return Ee};function ue(pe){var _e=-1/0,xe=1/0;switch(pe){case Z.UNSIGNED_BYTE:_e=Z.MIN_UNSIGNED_BYTE,xe=Z.MAX_UNSIGNED_BYTE;break;case Z.BYTE:_e=Z.MIN_BYTE,xe=Z.MAX_BYTE;break;case Z.UNSIGNED_SHORT:_e=Z.MIN_UNSIGNED_SHORT,xe=Z.MAX_UNSIGNED_SHORT;break;case Z.SHORT:_e=Z.MIN_SHORT,xe=Z.MAX_SHORT;break;case Z.UNSIGNED_INT:_e=Z.MIN_UNSIGNED_INT,xe=Z.MAX_UNSIGNED_INT;break;case Z.INT:_e=Z.MIN_INT,xe=Z.MAX_INT;break}return{min:_e,max:xe}}W.minMaxValuesForType=ue,le.GPULayer.validateGPULayerArray=function(pe,_e,xe){xe===void 0&&(xe=null);var be=_e.numComponents,Te=_e.width,ye=_e.height,Ee=_e.name,he=_e._glNumChannels,oe=_e._internalType,me=_e.is1D()?_e.length:null;if(xe){if(pe.length!==xe*be)throw new Error("Invalid data length: ".concat(pe.length,' for GPULayer "').concat(Ee,'" of numComponents: ').concat(be,"."))}else if(pe.length!==Te*ye*be&&(!me||me&&pe.length!==me*be))throw new Error("Invalid data length: ".concat(pe.length,' for GPULayer "').concat(Ee,'" of ').concat(me?"length ".concat(me," and "):"","dimensions: [").concat(Te,", ").concat(ye,"] and numComponents: ").concat(be,"."));var ve=!1;switch(pe.constructor){case Array:ve=!0;break;case Float32Array:ve=oe!==Z.FLOAT;break;case Uint8Array:ve=oe!==Z.UNSIGNED_BYTE;break;case Int8Array:ve=oe!==Z.BYTE;break;case Uint16Array:ve=oe!==Z.UNSIGNED_SHORT;break;case Int16Array:ve=oe!==Z.SHORT;break;case Uint32Array:ve=oe!==Z.UNSIGNED_INT;break;case Int32Array:ve=oe!==Z.INT;break;default:throw new Error("Invalid array type: ".concat(pe.constructor.name,' for GPULayer "').concat(Ee,'", please use one of [').concat(Z.validArrayTypes.map(function(ut){return ut.name}).join(", "),"]."))}var we=ue(oe),Pe=we.min,Me=we.max,De=xe?xe*he:Te*ye*he,Oe=pe.length!==De,Ie=pe;if(ve||Oe){Ie=le.GPULayer.initArrayForType(oe,De);for(var Be=oe===Z.HALF_FLOAT&&ve?new DataView(Ie.buffer):null,ze=0,et=pe.length/be;ze<et;ze++)for(var qe=0;qe<be;qe++){var je=pe[ze*be+qe],it=je,ct=!1;it<Pe?(it=Pe,ct=!0):it>Me&&(it=Me,ct=!0),ct&&console.warn("Clipping out of range value ".concat(je," to ").concat(it,' for GPULayer "').concat(Ee,'" with internal type ').concat(oe,"."));var rt=ze*he+qe;Be?(0,te.setFloat16)(Be,2*rt,it,!0):Ie[rt]=it}}return Ie}},664:function(q,W,Y){var J=this&&this.__extends||function(){var fe=function(ae,ue){return fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(pe,_e){pe.__proto__=_e}||function(pe,_e){for(var xe in _e)Object.prototype.hasOwnProperty.call(_e,xe)&&(pe[xe]=_e[xe])},fe(ae,ue)};return function(ae,ue){if(typeof ue!="function"&&ue!==null)throw new TypeError("Class extends value "+String(ue)+" is not a constructor or null");fe(ae,ue);function pe(){this.constructor=ae}ae.prototype=ue===null?Object.create(ue):(pe.prototype=ue.prototype,new pe)}}(),te=this&&this.__assign||function(){return te=Object.assign||function(fe){for(var ae,ue=1,pe=arguments.length;ue<pe;ue++){ae=arguments[ue];for(var _e in ae)Object.prototype.hasOwnProperty.call(ae,_e)&&(fe[_e]=ae[_e])}return fe},te.apply(this,arguments)};Object.defineProperty(W,"__esModule",{value:!0}),W.GPUProgram=void 0;var Z=Y(601),ee=Y(593),re=Y(360),ne=Y(566),le=Y(707),se=Y(581),ie=function(){function fe(ae,ue){var pe=this;this._fragmentShaders={},this._compileTimeConstants={},this._uniforms={},this._programs={},this._programsKeyLookup=new WeakMap,this._samplerUniformsIndices=[];var _e=(ue||{}).name;if(!ae)throw new Error('Error initing GPUProgram "'.concat(_e,'": must pass GPUComposer instance to GPUProgram(composer, params).'));if(!ue)throw new Error("Error initing GPUProgram: must pass params to GPUProgram(composer, params).");if(!(0,ne.isObject)(ue))throw new Error("Error initing GPUProgram: must pass valid params object to GPUProgram(composer, params), got ".concat(JSON.stringify(ue),"."));var xe=["name","fragmentShader","uniforms","compileTimeConstants"],be=["name","fragmentShader"],Te=Object.keys(ue);(0,le.checkValidKeys)(Te,xe,"GPUProgram(composer, params)",ue.name),(0,le.checkRequiredKeys)(Te,be,"GPUProgram(composer, params)",ue.name);var ye=ue.fragmentShader,Ee=ue.uniforms,he=ue.compileTimeConstants;this._composer=ae,this.name=_e;var oe=(0,ne.isString)(ye)?ye:ye.join(`
`),me=(0,ee.preprocessFragmentShader)(oe,ae.glslVersion,_e),ve=me.shaderSource,we=me.samplerUniforms,Pe=me.additionalSources;if(this._fragmentShaderSource=ve,we.forEach(function(qe,je){pe._samplerUniformsIndices.push({name:qe,inputIndex:0,shaderIndex:je})}),this.constructor===fe&&Pe){this._childPrograms=[];for(var Me=0,De=Pe.length;Me<De;Me++)this._childPrograms.push(new ge(ae,ue,{fragmentShaderSource:Pe[Me]}))}if(he&&(this._compileTimeConstants=te({},he)),ae.glslVersion===Z.GLSL1&&(ve.includes("dFdx")||ve.includes("dFdy")||ve.includes("fwidth"))){var Oe=(0,se.getExtension)(ae,se.OES_STANDARD_DERIVATIVES,!0);Oe&&(this._extensions=`#extension GL_OES_standard_derivatives : enable
`)}if(Ee)for(var Me=0;Me<Ee.length;Me++){var Ie=Ee[Me],Be=Ie.name,ze=Ie.value,et=Ie.type;this.setUniform(Be,ze,et)}}return fe.prototype.recompile=function(ae){var ue=this._compileTimeConstants,pe=!1;if(Object.keys(ae).forEach(function(ze){ue[ze]!==ae[ze]&&(pe=!0,ue[ze]=ae[ze])}),!!pe){for(var _e=this,xe=_e._fragmentShaders,be=_e._programs,Te=_e._programsKeyLookup,ye=_e._composer,Ee=_e._uniforms,he=ye.gl,oe=Object.keys(be),me=0,ve=oe.length;me<ve;me++){var we=oe[me],Pe=be[we];he.deleteProgram(Pe),Te.delete(Pe),delete be[we]}for(var Me=Object.keys(xe),me=0,De=Me.length;me<De;me++){var we=Me[me];he.deleteShader(xe[we]),delete xe[we]}for(var Oe=Object.values(Ee),me=0,Ie=Oe.length;me<Ie;me++)Oe[me].location=new WeakMap;if(this._childPrograms)for(var me=0,Be=this._childPrograms.length;me<Be;me++)this._childPrograms[me].recompile(ae)}},fe.prototype._getFragmentShader=function(ae,ue){var pe=this._fragmentShaders;if(pe[ae])return pe[ae];for(var _e=this,xe=_e._composer,be=_e.name,Te=_e._fragmentShaderSource,ye=_e._compileTimeConstants,Ee=_e._extensions,he=xe.gl,oe=xe._errorCallback,me=xe.verboseLogging,ve=xe.glslVersion,we=xe.floatPrecision,Pe=xe.intPrecision,Me=Object.keys(ue),De=0;De<Me.length;De++){var Oe=Me[De];ye[Oe]=ue[Oe]}me&&console.log('Compiling fragment shader for GPUProgram "'.concat(be,'" with compile time constants: ').concat(JSON.stringify(ye)));var Ie=(0,ee.compileShader)(he,ve,Pe,we,Te,he.FRAGMENT_SHADER,be,oe,ye,Ee,Object.keys(pe).length===0);if(!Ie){oe('Unable to compile fragment shader for GPUProgram "'.concat(be,'".'));return}return pe[ae]=Ie,pe[ae]},fe.prototype._getProgramWithName=function(ae,ue,pe){for(var _e=this,xe=_e._samplerUniformsIndices,be=_e._composer,Te="",ye={},Ee=0,he=xe.length;Ee<he;Ee++){var oe=xe[Ee].inputIndex,me=pe[oe].layer,ve=me.filter,we=me.wrapX,Pe=me.wrapY,Me=me.type,De=me._internalFilter,Oe=me._internalWrapX,Ie=me._internalWrapY,Be=we===Oe?0:we===Z.REPEAT?1:0,ze=Pe===Ie?0:Pe===Z.REPEAT?1:0,et=ve===De?0:ve===Z.LINEAR?1:0;Te+="_IN".concat(Ee,"_").concat(Be,"_").concat(ze,"_").concat(et),ye["".concat(re.SAMPLER2D_WRAP_X).concat(Ee)]="".concat(Be),ye["".concat(re.SAMPLER2D_WRAP_Y).concat(Ee)]="".concat(ze),ye["".concat(re.SAMPLER2D_FILTER).concat(Ee)]="".concat(et),be.glslVersion===Z.GLSL1&&(0,ee.isIntType)(Me)&&(ye["".concat(re.SAMPLER2D_CAST_INT).concat(Ee)]="1")}var qe=Object.keys(ue).map(function(Ne){return"_".concat(Ne,"_").concat(ue[Ne])}).join(),je="".concat(ae).concat(qe).concat(Te);if(this._programs[je])return this._programs[je];var it=this,ct=it._uniforms,rt=it._programs,ut=it._programsKeyLookup,We=be.gl,Re=be._errorCallback,Ue=be._getVertexShader(ae,qe,ue,this.name);if(Ue===void 0){Re('Unable to init vertex shader "'.concat(ae).concat(qe,'" for GPUProgram "').concat(this.name,'".'));return}var Le=this._getFragmentShader(Te,ye);if(Le===void 0){Re('Unable to init fragment shader "'.concat(Te,'" for GPUProgram "').concat(this.name,'".'));return}var Ge=(0,ee.initGLProgram)(We,Ue,Le,this.name,Re);if(Ge===void 0){We.deleteShader(Le),Re('Unable to init program "'.concat(je,'" for GPUProgram "').concat(this.name,'".'));return}We.useProgram(Ge);for(var ke=Object.keys(ct),Ee=0,He=ke.length;Ee<He;Ee++){var Ke=ke[Ee],$e=ct[Ke],Qe=$e.value,Me=$e.type;this._setProgramUniform(Ge,Ke,Qe,Me)}return rt[je]=Ge,ut.set(Ge,je),Ge},fe.prototype._setProgramUniform=function(ae,ue,pe,_e){var xe,be=this,Te=be._composer,ye=be._uniforms,Ee=Te.gl,he=Te._errorCallback,oe=Te.glslVersion,me=oe===Z.GLSL3,ve=(xe=ye[ue])===null||xe===void 0?void 0:xe.location.get(ae);if(ve===void 0){var we=Ee.getUniformLocation(ae,ue);if(we===null){console.warn('Could not init uniform "'.concat(ue,'" for program "').concat(this.name,'". Check that uniform is present in shader code, unused uniforms may be removed by compiler. Also check that uniform type in shader code matches type ').concat(_e,". Error code: ").concat(Ee.getError(),"."));return}ve=we,ye[ue]&&ye[ue].location.set(ae,ve);var Pe=Ee.getUniform(ae,ve),Me=!1;if(_e===Z.BOOL_1D_UNIFORM||_e===Z.BOOL_2D_UNIFORM||_e===Z.BOOL_3D_UNIFORM||_e===Z.BOOL_4D_UNIFORM?!(0,ne.isBoolean)(Pe)&&Pe.constructor!==Array&&(Me=!0):_e===Z.FLOAT_1D_UNIFORM||_e===Z.FLOAT_2D_UNIFORM||_e===Z.FLOAT_3D_UNIFORM||_e===Z.FLOAT_4D_UNIFORM?!(0,ne.isFiniteNumber)(Pe)&&Pe.constructor!==Float32Array&&(Me=!0):_e===Z.INT_1D_UNIFORM||_e===Z.INT_2D_UNIFORM||_e===Z.INT_3D_UNIFORM||_e===Z.INT_4D_UNIFORM?!(0,ne.isInteger)(Pe)&&Pe.constructor!==Int32Array&&(Me=!0):(_e===Z.UINT_1D_UNIFORM||_e===Z.UINT_2D_UNIFORM||_e===Z.UINT_3D_UNIFORM||_e===Z.UINT_4D_UNIFORM)&&(me?!(0,ne.isNonNegativeInteger)(Pe)&&Pe.constructor!==Uint32Array&&(Me=!0):!(0,ne.isNonNegativeInteger)(Pe)&&Pe.constructor!==Int32Array&&(Me=!0)),Me){he('Invalid uniform "'.concat(ue,'" for program "').concat(this.name,'". Check that uniform type in shader code matches type ').concat(_e,", gl.getUniform(program, location) returned type: ").concat(Pe.constructor.name,"."));return}}switch(_e){case Z.BOOL_1D_UNIFORM:Ee.uniform1i(ve,pe?1:0);break;case Z.BOOL_2D_UNIFORM:Ee.uniform2i(ve,pe[0]?1:0,pe[1]?1:0);break;case Z.BOOL_3D_UNIFORM:Ee.uniform3i(ve,pe[0]?1:0,pe[1]?1:0,pe[2]?1:0);break;case Z.BOOL_4D_UNIFORM:Ee.uniform4i(ve,pe[0]?1:0,pe[1]?1:0,pe[2]?1:0,pe[3]?1:0);break;case Z.FLOAT_1D_UNIFORM:Ee.uniform1f(ve,pe);break;case Z.FLOAT_2D_UNIFORM:Ee.uniform2fv(ve,pe);break;case Z.FLOAT_3D_UNIFORM:Ee.uniform3fv(ve,pe);break;case Z.FLOAT_4D_UNIFORM:Ee.uniform4fv(ve,pe);break;case Z.INT_1D_UNIFORM:Ee.uniform1i(ve,pe);break;case Z.INT_2D_UNIFORM:Ee.uniform2iv(ve,pe);break;case Z.INT_3D_UNIFORM:Ee.uniform3iv(ve,pe);break;case Z.INT_4D_UNIFORM:Ee.uniform4iv(ve,pe);break;case Z.UINT_1D_UNIFORM:me?Ee.uniform1ui(ve,pe):Ee.uniform1i(ve,pe);break;case Z.UINT_2D_UNIFORM:me?Ee.uniform2uiv(ve,pe):Ee.uniform2iv(ve,pe);break;case Z.UINT_3D_UNIFORM:me?Ee.uniform3uiv(ve,pe):Ee.uniform3iv(ve,pe);break;case Z.UINT_4D_UNIFORM:me?Ee.uniform4uiv(ve,pe):Ee.uniform4iv(ve,pe);break;default:throw new Error("Unknown uniform type ".concat(_e,' for GPUProgram "').concat(this.name,'".'))}},fe.prototype._cacheUniformValue=function(ae,ue,pe){var _e=this._uniforms,xe=_e[ae];if(!xe)return _e[ae]={location:new WeakMap,value:(0,ne.isArray)(ue)?ue.slice():ue,type:pe},!0;var be=xe.value;if(xe.value=(0,ne.isArray)(ue)?ue.slice():ue,(0,ne.isArray)(ue)){for(var Te=0,ye=ue.length;Te<ye;Te++)if(ue[Te]!==be[Te])return!0;return!1}return ue!==be},fe.prototype.setUniform=function(ae,ue,pe){var _e,xe=this,be=xe._programs,Te=xe._uniforms,ye=xe._composer,Ee=xe._samplerUniformsIndices,he=ye.verboseLogging,oe=ye.gl;if((0,ne.isArray)(ue)){var me=ue.length;if(me>4)throw new Error("Invalid uniform value: [".concat(ue.join(", "),'] passed to GPUProgram "').concat(this.name,', uniforms must be of type number[] with length <= 4, number, or boolean."'))}var ve=(_e=Te[ae])===null||_e===void 0?void 0:_e.type;if(pe){var we=(0,ee.uniformInternalTypeForValue)(ue,pe,ae,this.name);if(ve===void 0)ve=we;else if(ve!==we)throw new Error('Uniform "'.concat(ae,'" for GPUProgram "').concat(this.name,'" cannot change from type ').concat(ve," to type ").concat(we,"."))}if(ve===void 0)throw new Error('Unknown type for uniform "'.concat(ae,'", please pass in type to GPUProgram.setUniform(name, value, type) when initing a new uniform.'));var Pe=this._cacheUniformValue(ae,ue,ve);if(Pe){var Me=Ee.find(function(qe){return qe.name===ae});Me&&(0,ne.isInteger)(ue)&&(Me.inputIndex=ue),he&&console.log('Setting uniform "'.concat(ae,'" for program "').concat(this.name,'" to value ').concat(JSON.stringify(ue),"."));for(var De=Object.keys(be),Oe=0,Ie=De.length;Oe<Ie;Oe++){var Be=De[Oe],ze=be[Be];oe.useProgram(ze),this._setProgramUniform(ze,ae,ue,ve)}if(this._childPrograms)for(var Oe=0,et=this._childPrograms.length;Oe<et;Oe++)this._childPrograms[Oe].setUniform(ae,ue,pe)}},fe.prototype._setInternalFragmentUniforms=function(ae,ue){if(ue.length!==0){if(!ae)throw new Error("Must pass in valid WebGLProgram to GPUProgram._setInternalFragmentUniforms, got undefined.");var pe=this,_e=pe._programsKeyLookup,xe=pe._samplerUniformsIndices,be=_e.get(ae);if(!be)throw new Error('Could not find valid programName for WebGLProgram in GPUProgram "'.concat(this.name,'".'));for(var Te=new Array(Math.max(ue.length,xe.length)).fill(-1),ye=0,Ee=xe.length;ye<Ee;ye++){var he=xe[ye],oe=he.inputIndex,me=he.shaderIndex;Te[oe]>=0?console.warn("Found > 1 sampler2D uniforms at texture index ".concat(oe,' for GPUProgram "').concat(this.name,'".')):Te[oe]=me}for(var ye=0,ve=ue.length;ye<ve;ye++){var we=ue[ye].layer,Pe=we.width,Me=we.height,De=Te[ye];if(!(De<0)){var Oe=we.filter,Ie=we.wrapX,Be=we.wrapY,ze=we._internalFilter,et=we._internalWrapX,qe=we._internalWrapY,je=Oe!==ze;if(je||Ie!==et||Be!==qe){var it=[.5/Pe,.5/Me],ct="".concat(re.SAMPLER2D_HALF_PX_UNIFORM).concat(De),rt=this._cacheUniformValue(ct,it,Z.FLOAT_2D_UNIFORM);if(rt&&this._setProgramUniform(ae,ct,it,Z.FLOAT_2D_UNIFORM),je){var ut=[Pe,Me],We="".concat(re.SAMPLER2D_DIMENSIONS_UNIFORM).concat(De),Re=this._cacheUniformValue(We,ut,Z.FLOAT_2D_UNIFORM);Re&&this._setProgramUniform(ae,We,ut,Z.FLOAT_2D_UNIFORM)}}}}}},fe.prototype._setVertexUniform=function(ae,ue,pe,_e){if(!ae)throw new Error("Must pass in valid WebGLProgram to GPUProgram._setVertexUniform, got undefined.");var xe=this._programsKeyLookup,be=xe.get(ae);if(!be)throw new Error('Could not find valid programName for WebGLProgram in GPUProgram "'.concat(this.name,'".'));var Te=(0,ee.uniformInternalTypeForValue)(pe,_e,ue,this.name);this._setProgramUniform(ae,ue,pe,Te)},fe.prototype.dispose=function(){var ae=this,ue=ae._composer,pe=ae._fragmentShaders,_e=ae._programs,xe=ae._programsKeyLookup,be=ue.gl,Te=ue.verboseLogging;if(Te&&console.log('Deallocating GPUProgram "'.concat(this.name,'".')),!be)throw new Error("Must call dispose() on all GPUPrograms before calling dispose() on GPUComposer.");if(Object.values(_e).forEach(function(he){he&&(be.deleteProgram(he),xe.delete(he))}),Object.keys(_e).forEach(function(he){delete _e[he]}),Object.values(pe).forEach(function(he){be.deleteShader(he)}),Object.keys(pe).forEach(function(he){delete pe[he]}),this._childPrograms){for(var ye=0,Ee=this._childPrograms.length;ye<Ee;ye++)this._childPrograms[ye].dispose();this._childPrograms.length}delete this._childPrograms,delete this._composer,delete this.name,delete this._fragmentShaderSource,delete this._compileTimeConstants,delete this._extensions,delete this._uniforms,delete this._programs,delete this._programsKeyLookup,delete this._fragmentShaders,delete this._samplerUniformsIndices},fe}();W.GPUProgram=ie;var ge=function(fe){J(ae,fe);function ae(ue,pe,_e){var xe=fe.call(this,ue,pe)||this,be=_e.fragmentShaderSource;return xe._fragmentShaderSource=be,xe}return ae}(ie)},579:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.wrappedLineColorProgram=W.renderSignedAmplitudeProgram=W.renderAmplitudeProgram=W.renderRGBProgram=W.zeroProgram=W.setColorProgram=W.setValueProgram=W.multiplyValueProgram=W.addValueProgram=W.addLayersProgram=W.copyProgram=void 0;var J=Y(566),te=Y(601),Z=Y(690),ee=Y(664);function re(xe,be){var Te=be.type,ye=be.precision||"",Ee=(0,Z.glslTypeForType)(Te,4),he=be.name||"copy_".concat((0,Z.uniformTypeForType)(Te,xe.glslVersion),"_layer");return new ee.GPUProgram(xe,{name:he,fragmentShader:`
in vec2 v_uv;
uniform `.concat(ye," ").concat((0,Z.glslPrefixForType)(Te),`sampler2D u_state;
out `).concat(ye," ").concat(Ee,` out_result;
void main() {
	out_result = texture(u_state, v_uv);
}`),uniforms:[{name:"u_state",value:0,type:te.INT}]})}W.copyProgram=re;function ne(xe,be){var Te=be.type,ye=be.numInputs||2,Ee=be.precision||"",he=be.components||"xyzw",oe=(0,Z.glslTypeForType)(Te,he.length),me=new Array(ye),ve=be.name||"".concat(ye,"-way_add_").concat((0,Z.uniformTypeForType)(Te,xe.glslVersion),"_").concat(he);return new ee.GPUProgram(xe,{name:ve,fragmentShader:`
in vec2 v_uv;
`.concat(me.map(function(we,Pe){return"uniform ".concat(Ee," ").concat((0,Z.glslPrefixForType)(Te),"sampler2D u_state").concat(Pe,";")}).join(`
`),`
out `).concat(Ee," ").concat(oe,` out_result;
void main() {
	out_result = `).concat(me.map(function(we,Pe){return"texture(u_state".concat(Pe,", v_uv).").concat(he)}).join(" + "),`;
}`),uniforms:me.map(function(we,Pe){return{name:"u_state".concat(Pe),value:Pe,type:te.INT}})})}W.addLayersProgram=ne;function le(xe,be){var Te=be.type,ye=be.value,Ee=be.precision||"",he=(0,J.isArray)(ye)?ye.length:1,oe=(0,Z.glslTypeForType)(Te,he),me=he===1?4:he,ve=(0,Z.glslTypeForType)(Te,me),we=(0,Z.glslComponentSelectionForNumComponents)(me),Pe=be.name||"addValue_".concat(oe,"_w_length_").concat(he);return new ee.GPUProgram(xe,{name:Pe,fragmentShader:`
in vec2 v_uv;
uniform `.concat(Ee," ").concat(oe,` u_value;
uniform `).concat(Ee," ").concat((0,Z.glslPrefixForType)(Te),`sampler2D u_state;
out `).concat(Ee," ").concat(ve,` out_result;
void main() {
	out_result = `).concat(oe!==ve?ve:"","(u_value) + texture(u_state, v_uv)").concat(we,`;
}`),uniforms:[{name:"u_state",value:0,type:te.INT},{name:"u_value",value:ye,type:(0,Z.uniformTypeForType)(Te,xe.glslVersion)}]})}W.addValueProgram=le;function se(xe,be){var Te=be.type,ye=be.value,Ee=be.precision||"",he=(0,J.isArray)(ye)?ye.length:1,oe=(0,Z.glslTypeForType)(Te,he),me=he===1?4:he,ve=(0,Z.glslTypeForType)(Te,me),we=(0,Z.glslComponentSelectionForNumComponents)(me),Pe=be.name||"addValue_".concat(oe,"_w_length_").concat(he);return new ee.GPUProgram(xe,{name:Pe,fragmentShader:`
in vec2 v_uv;
uniform `.concat(Ee," ").concat(oe,` u_value;
uniform `).concat(Ee," ").concat((0,Z.glslPrefixForType)(Te),`sampler2D u_state;
out `).concat(Ee," ").concat(ve,` out_result;
void main() {
	out_result = `).concat(oe!==ve?ve:"","(u_value) * texture(u_state, v_uv)").concat(we,`;
}`),uniforms:[{name:"u_state",value:0,type:te.INT},{name:"u_value",value:ye,type:(0,Z.uniformTypeForType)(Te,xe.glslVersion)}]})}W.multiplyValueProgram=se;function ie(xe,be){var Te=be.type,ye=be.value,Ee=be.precision||"",he=(0,J.isArray)(ye)?ye.length:1,oe=(0,Z.glslTypeForType)(Te,he),me=he===1?4:he,ve=(0,Z.glslTypeForType)(Te,me),we=be.name||"setValue_".concat(oe,"_w_length_").concat(he);return new ee.GPUProgram(xe,{name:we,fragmentShader:`
uniform `.concat(Ee," ").concat(oe,` u_value;
out `).concat(Ee," ").concat(ve,` out_result;
void main() {
	out_result = `).concat(oe!==ve?ve:"",`(u_value);
}`),uniforms:[{name:"u_value",value:ye,type:(0,Z.uniformTypeForType)(Te,xe.glslVersion)}]})}W.setValueProgram=ie;function ge(xe,be){var Te=be.type,ye=be.precision||"",Ee=be.opacity===void 0?1:be.opacity,he=be.color||[0,0,0],oe=be.name||"setColor",me=(0,Z.glslTypeForType)(Te,4);return new ee.GPUProgram(xe,{name:oe,fragmentShader:`
uniform `.concat(ye,` vec3 u_color;
uniform `).concat(ye,` float u_opacity;
out `).concat(ye," ").concat(me,` out_result;
void main() {
	out_result = `).concat(me,`(u_color, u_opacity);
}`),uniforms:[{name:"u_color",value:he,type:te.FLOAT},{name:"u_opacity",value:Ee,type:te.FLOAT}]})}W.setColorProgram=ge;function fe(xe,be){return ie(xe,{type:te.FLOAT,value:0,name:be.name})}W.zeroProgram=fe;function ae(xe,be){var Te=be.type,ye=be.precision||"",Ee=3,he=(0,Z.glslTypeForType)(Te,Ee),oe=(0,Z.glslTypeForType)(te.FLOAT,Ee),me=(0,Z.glslPrefixForType)(Te),ve=oe===he,we=be.name||"renderRGB_".concat(he);return new ee.GPUProgram(xe,{name:we,fragmentShader:`
in vec2 v_uv;
uniform float u_opacity;
uniform float u_scale;
uniform `.concat(ye," ").concat(me,`sampler2D u_state;
out vec4 out_result;
void main() {
	vec3 color = u_scale * (`).concat(ve?"":oe,`(texture(u_state, v_uv).rgb));
	out_result = vec4(color, u_opacity);
}`),uniforms:[{name:"u_state",value:0,type:te.INT},{name:"u_scale",value:be.scale!==void 0?be.scale:1,type:te.FLOAT},{name:"u_opacity",value:be.opacity!==void 0?be.opacity:1,type:te.FLOAT}]})}W.renderRGBProgram=ae;function ue(xe,be){var Te=be.type,ye=be.precision||"",Ee=be.components||"xyzw",he=Ee.length,oe=(0,Z.glslTypeForType)(Te,he),me=(0,Z.glslTypeForType)(te.FLOAT,he),ve=(0,Z.glslPrefixForType)(Te),we=me===oe,Pe=be.name||"renderAmplitude_".concat(oe,"_w_").concat(he,"_components");return new ee.GPUProgram(xe,{name:Pe,fragmentShader:`
in vec2 v_uv;
uniform float u_opacity;
uniform float u_scale;
uniform vec3 u_colorMax;
uniform vec3 u_colorMin;
uniform `.concat(ye," ").concat(ve,`sampler2D u_state;
out vec4 out_result;
void main() {
	float amplitude = u_scale * `).concat(he===1?"abs":"length","(").concat(we?"":me,"(texture(u_state, v_uv)").concat(Ee==="xyzw"||Ee==="rgba"||Ee==="stpq"?"":".".concat(Ee),`));
	vec3 color = mix(u_colorMin, u_colorMax, amplitude);
	out_result = vec4(color, u_opacity);
}`),uniforms:[{name:"u_state",value:0,type:te.INT},{name:"u_scale",value:be.scale!==void 0?be.scale:1,type:te.FLOAT},{name:"u_opacity",value:be.opacity!==void 0?be.opacity:1,type:te.FLOAT},{name:"u_colorMax",value:be.colorMax||[1,1,1],type:te.FLOAT},{name:"u_colorMin",value:be.colorMin||[0,0,0],type:te.FLOAT}]})}W.renderAmplitudeProgram=ue;function pe(xe,be){var Te=be.type,ye=be.precision||"",Ee=(0,Z.glslTypeForType)(Te,1),he=(0,Z.glslPrefixForType)(Te),oe=Ee==="float",me=be.component||"x",ve=be.name||"renderAmplitude_".concat(Ee,"_").concat(me);return new ee.GPUProgram(xe,{name:ve,fragmentShader:`
in vec2 v_uv;
uniform float u_opacity;
uniform float u_scale;
uniform float u_bias;
uniform vec3 u_colorMin;
uniform vec3 u_colorMax;
uniform vec3 u_colorCenter;
uniform `.concat(ye," ").concat(he,`sampler2D u_state;
out vec4 out_result;
void main() {
	float signedAmplitude = u_scale * (`).concat(oe?"":"float","(texture(u_state, v_uv).").concat(me,`) - u_bias);
	float amplitudeSign = sign(signedAmplitude);
	vec3 interpColor = mix(u_colorMin, u_colorMax, amplitudeSign / 2.0 + 0.5);
	vec3 color = mix(u_colorCenter, interpColor, signedAmplitude * amplitudeSign);
	out_result = vec4(color, u_opacity);
}`),uniforms:[{name:"u_state",value:0,type:te.INT},{name:"u_scale",value:be.scale!==void 0?be.scale:1,type:te.FLOAT},{name:"u_bias",value:be.bias||0,type:te.FLOAT},{name:"u_opacity",value:be.opacity!==void 0?be.opacity:1,type:te.FLOAT},{name:"u_colorMin",value:be.colorMin||[0,0,1],type:te.FLOAT},{name:"u_colorMax",value:be.colorMax||[1,0,0],type:te.FLOAT},{name:"u_colorCenter",value:be.colorCenter||[1,1,1],type:te.FLOAT}]})}W.renderSignedAmplitudeProgram=pe;function _e(xe){return new ee.GPUProgram(xe,{name:"wrappedLineColor",fragmentShader:`
in vec2 v_lineWrapping;
uniform vec4 u_value;
out vec4 out_result;
void main() {
	// Check if this line has wrapped.
	if ((v_lineWrapping.x != 0.0 && v_lineWrapping.x != 1.0) || (v_lineWrapping.y != 0.0 && v_lineWrapping.y != 1.0)) {
		// Render nothing.
		discard;
		return;
	}
	out_result = vec4(u_value);
}`})}W.wrappedLineColorProgram=_e},404:(q,W)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.Vector4=void 0;var Y=function(){function J(te,Z,ee,re){te===void 0&&(te=0),Z===void 0&&(Z=0),ee===void 0&&(ee=0),re===void 0&&(re=1),this.x=te,this.y=Z,this.z=ee,this.w=re}return Object.defineProperty(J.prototype,"width",{get:function(){return this.z},enumerable:!1,configurable:!0}),Object.defineProperty(J.prototype,"height",{get:function(){return this.w},enumerable:!1,configurable:!0}),J.prototype.copy=function(te){return this.x=te.x,this.y=te.y,this.z=te.z,this.w=te.w,this},J}();W.Vector4=Y},707:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.checkRequiredKeys=W.checkValidKeys=W.isNumberOfType=W.isValidClearValue=W.isValidImageType=W.isValidImageFormat=W.isValidWrap=W.isValidFilter=W.isValidDataType=void 0;var J=Y(566),te=Y(601);function Z(ae){return te.validDataTypes.indexOf(ae)>-1}W.isValidDataType=Z;function ee(ae){return te.validFilters.indexOf(ae)>-1}W.isValidFilter=ee;function re(ae){return te.validWraps.indexOf(ae)>-1}W.isValidWrap=re;function ne(ae){return te.validImageFormats.indexOf(ae)>-1}W.isValidImageFormat=ne;function le(ae){return te.validImageTypes.indexOf(ae)>-1}W.isValidImageType=le;function se(ae,ue,pe){if((0,J.isArray)(ae)){if(ae.length!==ue)return!1;for(var _e=0;_e<ae.length;_e++)if(!ie(ae[_e],pe))return!1}else if(!ie(ae,pe))return!1;return!0}W.isValidClearValue=se;function ie(ae,ue){switch(ue){case te.HALF_FLOAT:case te.FLOAT:return(0,J.isFiniteNumber)(ae);case te.BYTE:return ae<-128||ae>127?!1:(0,J.isInteger)(ae);case te.SHORT:return ae<-32768||ae>32767?!1:(0,J.isInteger)(ae);case te.INT:return ae<-2147483648||ae>2147483647?!1:(0,J.isInteger)(ae);case te.UNSIGNED_BYTE:return ae>255?!1:(0,J.isNonNegativeInteger)(ae);case te.UNSIGNED_SHORT:return ae>65535?!1:(0,J.isNonNegativeInteger)(ae);case te.UNSIGNED_INT:return ae>4294967295?!1:(0,J.isNonNegativeInteger)(ae);default:throw new Error("Unknown type ".concat(ue))}}W.isNumberOfType=ie;function ge(ae,ue,pe,_e){ae.forEach(function(xe){ue.indexOf(xe)<0&&console.warn('Invalid params key "'.concat(xe,'" passed to ').concat(pe).concat(_e?' with name "'.concat(_e,'"'):"",".  Valid keys are ").concat(JSON.stringify(ue),"."))})}W.checkValidKeys=ge;function fe(ae,ue,pe,_e){ue.forEach(function(xe){if(ae.indexOf(xe)<0)throw new Error('Required params key "'.concat(xe,'" was not passed to ').concat(pe).concat(_e?' with name "'.concat(_e,'"'):"","."))})}W.checkRequiredKeys=fe},601:(q,W)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.LAYER_POINTS_PROGRAM_NAME=W.SEGMENT_PROGRAM_NAME=W.DEFAULT_PROGRAM_NAME=W.BOOL_4D_UNIFORM=W.BOOL_3D_UNIFORM=W.BOOL_2D_UNIFORM=W.BOOL_1D_UNIFORM=W.UINT_4D_UNIFORM=W.UINT_3D_UNIFORM=W.UINT_2D_UNIFORM=W.UINT_1D_UNIFORM=W.INT_4D_UNIFORM=W.INT_3D_UNIFORM=W.INT_2D_UNIFORM=W.INT_1D_UNIFORM=W.FLOAT_4D_UNIFORM=W.FLOAT_3D_UNIFORM=W.FLOAT_2D_UNIFORM=W.FLOAT_1D_UNIFORM=W.PRECISION_HIGH_P=W.PRECISION_MEDIUM_P=W.PRECISION_LOW_P=W.EXPERIMENTAL_WEBGL2=W.EXPERIMENTAL_WEBGL=W.WEBGL1=W.WEBGL2=W.GLSL1=W.GLSL3=W.validImageTypes=W.validImageFormats=W.RGBA=W.RGB=W.validWraps=W.validFilters=W.validDataTypes=W.validArrayTypes=W.REPEAT=W.CLAMP_TO_EDGE=W.LINEAR=W.NEAREST=W.UINT=W.BOOL=W.INT=W.UNSIGNED_INT=W.SHORT=W.UNSIGNED_SHORT=W.BYTE=W.UNSIGNED_BYTE=W.FLOAT=W.HALF_FLOAT=void 0,W.BOUNDARY_RIGHT=W.BOUNDARY_LEFT=W.BOUNDARY_BOTTOM=W.BOUNDARY_TOP=W.GPUIO_FLOAT_PRECISION=W.GPUIO_INT_PRECISION=W.MAX_FLOAT_INT=W.MIN_FLOAT_INT=W.MAX_HALF_FLOAT_INT=W.MIN_HALF_FLOAT_INT=W.MAX_INT=W.MIN_INT=W.MAX_UNSIGNED_INT=W.MIN_UNSIGNED_INT=W.MAX_SHORT=W.MIN_SHORT=W.MAX_UNSIGNED_SHORT=W.MIN_UNSIGNED_SHORT=W.MAX_BYTE=W.MIN_BYTE=W.MAX_UNSIGNED_BYTE=W.MIN_UNSIGNED_BYTE=W.DEFAULT_CIRCLE_NUM_SEGMENTS=W.DEFAULT_ERROR_CALLBACK=W.GPUIO_VS_POSITION_W_ACCUM=W.GPUIO_VS_NORMAL_ATTRIBUTE=W.GPUIO_VS_UV_ATTRIBUTE=W.GPUIO_VS_INDEXED_POSITIONS=W.GPUIO_VS_WRAP_Y=W.GPUIO_VS_WRAP_X=W.LAYER_MESH_PROGRAM_NAME=W.LAYER_VECTOR_FIELD_PROGRAM_NAME=W.LAYER_LINES_PROGRAM_NAME=void 0,W.HALF_FLOAT="HALF_FLOAT",W.FLOAT="FLOAT",W.UNSIGNED_BYTE="UNSIGNED_BYTE",W.BYTE="BYTE",W.UNSIGNED_SHORT="UNSIGNED_SHORT",W.SHORT="SHORT",W.UNSIGNED_INT="UNSIGNED_INT",W.INT="INT",W.BOOL="BOOL",W.UINT="UINT",W.NEAREST="NEAREST",W.LINEAR="LINEAR",W.CLAMP_TO_EDGE="CLAMP_TO_EDGE",W.REPEAT="REPEAT",W.validArrayTypes=[Float32Array,Uint8Array,Int8Array,Uint16Array,Int16Array,Uint32Array,Int32Array,Array],W.validDataTypes=[W.HALF_FLOAT,W.FLOAT,W.UNSIGNED_BYTE,W.BYTE,W.UNSIGNED_SHORT,W.SHORT,W.UNSIGNED_INT,W.INT],W.validFilters=[W.NEAREST,W.LINEAR],W.validWraps=[W.CLAMP_TO_EDGE,W.REPEAT],W.RGB="RGB",W.RGBA="RGBA",W.validImageFormats=[W.RGB,W.RGBA],W.validImageTypes=[W.UNSIGNED_BYTE,W.FLOAT,W.HALF_FLOAT],W.GLSL3="300 es",W.GLSL1="100",W.WEBGL2="webgl2",W.WEBGL1="webgl",W.EXPERIMENTAL_WEBGL="experimental-webgl",W.EXPERIMENTAL_WEBGL2="experimental-webgl2",W.PRECISION_LOW_P="lowp",W.PRECISION_MEDIUM_P="mediump",W.PRECISION_HIGH_P="highp",W.FLOAT_1D_UNIFORM="FLOAT_1D_UNIFORM",W.FLOAT_2D_UNIFORM="FLOAT_2D_UNIFORM",W.FLOAT_3D_UNIFORM="FLOAT_3D_UNIFORM",W.FLOAT_4D_UNIFORM="FLOAT_4D_UNIFORM",W.INT_1D_UNIFORM="INT_1D_UNIFORM",W.INT_2D_UNIFORM="INT_2D_UNIFORM",W.INT_3D_UNIFORM="INT_3D_UNIFORM",W.INT_4D_UNIFORM="INT_4D_UNIFORM",W.UINT_1D_UNIFORM="UINT_1D_UNIFORM",W.UINT_2D_UNIFORM="UINT_2D_UNIFORM",W.UINT_3D_UNIFORM="UINT_3D_UNIFORM",W.UINT_4D_UNIFORM="UINT_4D_UNIFORM",W.BOOL_1D_UNIFORM="BOOL_1D_UNIFORM",W.BOOL_2D_UNIFORM="BOOL_2D_UNIFORM",W.BOOL_3D_UNIFORM="BOOL_3D_UNIFORM",W.BOOL_4D_UNIFORM="BOOL_4D_UNIFORM",W.DEFAULT_PROGRAM_NAME="DEFAULT",W.SEGMENT_PROGRAM_NAME="SEGMENT",W.LAYER_POINTS_PROGRAM_NAME="LAYER_POINTS",W.LAYER_LINES_PROGRAM_NAME="LAYER_LINES",W.LAYER_VECTOR_FIELD_PROGRAM_NAME="LAYER_VECTOR_FIELD",W.LAYER_MESH_PROGRAM_NAME="LAYER_MESH",W.GPUIO_VS_WRAP_X="GPUIO_VS_WRAP_X",W.GPUIO_VS_WRAP_Y="GPUIO_VS_WRAP_Y",W.GPUIO_VS_INDEXED_POSITIONS="GPUIO_VS_INDEXED_POSITIONS",W.GPUIO_VS_UV_ATTRIBUTE="GPUIO_VS_UV_ATTRIBUTE",W.GPUIO_VS_NORMAL_ATTRIBUTE="GPUIO_VS_NORMAL_ATTRIBUTE",W.GPUIO_VS_POSITION_W_ACCUM="GPUIO_VS_POSITION_W_ACCUM";var Y=function(J){throw new Error(J)};W.DEFAULT_ERROR_CALLBACK=Y,W.DEFAULT_CIRCLE_NUM_SEGMENTS=18,W.MIN_UNSIGNED_BYTE=0,W.MAX_UNSIGNED_BYTE=Math.pow(2,8)-1,W.MIN_BYTE=-Math.pow(2,7),W.MAX_BYTE=Math.pow(2,7)-1,W.MIN_UNSIGNED_SHORT=0,W.MAX_UNSIGNED_SHORT=Math.pow(2,16)-1,W.MIN_SHORT=-Math.pow(2,15),W.MAX_SHORT=Math.pow(2,15)-1,W.MIN_UNSIGNED_INT=0,W.MAX_UNSIGNED_INT=Math.pow(2,32)-1,W.MIN_INT=-Math.pow(2,31),W.MAX_INT=Math.pow(2,31)-1,W.MIN_HALF_FLOAT_INT=-2048,W.MAX_HALF_FLOAT_INT=2048,W.MIN_FLOAT_INT=-16777216,W.MAX_FLOAT_INT=16777216,W.GPUIO_INT_PRECISION="GPUIO_INT_PRECISION",W.GPUIO_FLOAT_PRECISION="GPUIO_FLOAT_PRECISION",W.BOUNDARY_TOP="BOUNDARY_TOP",W.BOUNDARY_BOTTOM="BOUNDARY_BOTTOM",W.BOUNDARY_LEFT="BOUNDARY_LEFT",W.BOUNDARY_RIGHT="BOUNDARY_RIGHT"},690:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.glslComponentSelectionForNumComponents=W.glslPrefixForType=W.glslTypeForType=W.arrayConstructorForType=W.uniformTypeForType=W.intForPrecision=void 0;var J=Y(601);function te(se){if(se===J.PRECISION_HIGH_P)return 2;if(se===J.PRECISION_MEDIUM_P)return 1;if(se===J.PRECISION_LOW_P)return 0;throw new Error("Unknown shader precision value: ".concat(JSON.stringify(se),"."))}W.intForPrecision=te;function Z(se,ie){switch(se){case J.HALF_FLOAT:case J.FLOAT:return J.FLOAT;case J.UNSIGNED_BYTE:case J.UNSIGNED_SHORT:case J.UNSIGNED_INT:return ie===J.GLSL1?J.INT:J.UINT;case J.BYTE:case J.SHORT:case J.INT:return J.INT;default:throw new Error("Invalid type: ".concat(se," passed to glslKeyForType."))}}W.uniformTypeForType=Z;function ee(se,ie){switch(ie===void 0&&(ie=!1),se){case J.HALF_FLOAT:return ie?Float32Array:Uint16Array;case J.FLOAT:return Float32Array;case J.UNSIGNED_BYTE:return Uint8Array;case J.BYTE:return Int8Array;case J.UNSIGNED_SHORT:return Uint16Array;case J.SHORT:return Int16Array;case J.UNSIGNED_INT:return Uint32Array;case J.INT:return Int32Array;default:throw new Error('Unsupported type: "'.concat(se,'".'))}}W.arrayConstructorForType=ee;function re(se,ie){switch(se){case J.HALF_FLOAT:case J.FLOAT:return ie===1?"float":"vec".concat(ie);case J.UNSIGNED_BYTE:case J.UNSIGNED_SHORT:case J.UNSIGNED_INT:return ie===1?"uint":"uvec".concat(ie);case J.BYTE:case J.SHORT:case J.INT:return ie===1?"int":"ivec".concat(ie)}throw new Error("Invalid type: ".concat(se," passed to glslTypeForType."))}W.glslTypeForType=re;function ne(se){switch(se){case J.HALF_FLOAT:case J.FLOAT:return"";case J.UNSIGNED_BYTE:case J.UNSIGNED_SHORT:case J.UNSIGNED_INT:return"u";case J.BYTE:case J.SHORT:case J.INT:return"i"}throw new Error("Invalid type: ".concat(se," passed to glslPrefixForType."))}W.glslPrefixForType=ne;function le(se){switch(se){case 1:return".x";case 2:return".xy";case 3:return".xyz";case 4:return""}throw new Error("Invalid numComponents: ".concat(se," passed to glslComponentSelectionForNumComponents."))}W.glslComponentSelectionForNumComponents=le},581:(q,W)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.getExtension=W.OES_STANDARD_DERIVATIVES=W.OES_ELEMENT_INDEX_UINT=W.OES_VERTEX_ARRAY_OBJECT=W.EXT_COLOR_BUFFER_HALF_FLOAT=W.EXT_COLOR_BUFFER_FLOAT=W.WEBGL_DEPTH_TEXTURE=W.OES_TEXTURE_HAlF_FLOAT_LINEAR=W.OES_TEXTURE_FLOAT_LINEAR=W.OES_TEXTURE_HALF_FLOAT=W.OES_TEXTURE_FLOAT=void 0,W.OES_TEXTURE_FLOAT="OES_texture_float",W.OES_TEXTURE_HALF_FLOAT="OES_texture_half_float",W.OES_TEXTURE_FLOAT_LINEAR="OES_texture_float_linear",W.OES_TEXTURE_HAlF_FLOAT_LINEAR="OES_texture_half_float_linear",W.WEBGL_DEPTH_TEXTURE="WEBGL_depth_texture",W.EXT_COLOR_BUFFER_FLOAT="EXT_color_buffer_float",W.EXT_COLOR_BUFFER_HALF_FLOAT="EXT_color_buffer_half_float",W.OES_VERTEX_ARRAY_OBJECT="OES_vertex_array_object",W.OES_ELEMENT_INDEX_UINT="OES_element_index_uint",W.OES_STANDARD_DERIVATIVES="OES_standard_derivatives";function Y(J,te,Z){if(Z===void 0&&(Z=!1),J._extensions[te]!==void 0)return J._extensions[te];var ee=J.gl,re=J._errorCallback,ne=J._extensions;J.verboseLogging;var le;try{le=ee.getExtension(te)}catch{}return le?(ne[te]=le,J.verboseLogging&&console.log("Loaded extension: ".concat(te,"."))):(ne[te]=!1,J.verboseLogging&&console.log("Unsupported ".concat(Z?"optional ":"","extension: ").concat(te,"."))),!le&&!Z&&re("Required extension unsupported by this device / browser: ".concat(te,".")),le}W.getExtension=Y},798:function(q,W){var Y=this&&this.__spreadArray||function(ne,le,se){if(se||arguments.length===2)for(var ie=0,ge=le.length,fe;ie<ge;ie++)(fe||!(ie in le))&&(fe||(fe=Array.prototype.slice.call(le,0,ie)),fe[ie]=le[ie]);return ne.concat(fe||Array.prototype.slice.call(le))};Object.defineProperty(W,"__esModule",{value:!0}),W.disposeFramebuffers=W.bindFrameBuffer=void 0;var J=new WeakMap,te=new WeakMap;function Z(ne,le,se,ie){var ge=ne.gl,fe=ne._errorCallback,ae=ne.isWebGL2,ue=ge.createFramebuffer();if(!ue){fe('Could not init framebuffer for GPULayer "'.concat(le.name,'": ').concat(ge.getError(),"."));return}if(ge.bindFramebuffer(ge.FRAMEBUFFER,ue),ge.framebufferTexture2D(ge.FRAMEBUFFER,ge.COLOR_ATTACHMENT0,ge.TEXTURE_2D,se,0),ie){if(!ae)throw new Error("WebGL1 does not support drawing to multiple outputs.");if(ie.length>15)throw new Error("Can't draw to more than 16 outputs.");for(var pe=0,_e=ie.length;pe<_e;pe++)ge.framebufferTexture2D(ge.FRAMEBUFFER,ge.COLOR_ATTACHMENT0+pe+1,ge.TEXTURE_2D,ie[pe],0)}var xe=ge.checkFramebufferStatus(ge.FRAMEBUFFER);return xe!==ge.FRAMEBUFFER_COMPLETE&&fe('Invalid status for framebuffer for GPULayer "'.concat(le.name,'": ').concat(xe,".")),ue}function ee(ne,le,se,ie){var ge=ne.gl,fe=ie?Y([se],ie,!0):se,ae=J.get(fe);if(!ae){if(ae=Z(ne,le,se,ie),!ae)return;J.set(fe,ae);var ue=te.get(se)||[];if(ue.push(ae),te.set(se,ue),ie)for(var pe=0,_e=ie.length;pe<_e;pe++){var xe=ie[pe],be=te.get(xe)||[];be.push(ae),te.set(xe,be)}}ge.bindFramebuffer(ge.FRAMEBUFFER,ae)}W.bindFrameBuffer=ee;function re(ne,le){ne.bindFramebuffer(ne.FRAMEBUFFER,null);var se=te.get(le);if(se)for(var ie=0,ge=se.length;ie<ge;ie++)ne.deleteFramebuffer(se[ie]);te.delete(le)}W.disposeFramebuffers=re},724:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.PRECISION_SOURCE=void 0;var J=Y(601),te=Y(690);W.PRECISION_SOURCE=`
#if (`.concat(J.GPUIO_INT_PRECISION," == ").concat((0,te.intForPrecision)(J.PRECISION_LOW_P),`)
	precision lowp int;
	#if (__VERSION__ == 300)
		precision lowp isampler2D;
		precision lowp usampler2D;
	#endif
#elif (`).concat(J.GPUIO_INT_PRECISION," == ").concat((0,te.intForPrecision)(J.PRECISION_MEDIUM_P),`)
	precision mediump int;
	#if (__VERSION__ == 300)
		precision mediump isampler2D;
		precision mediump usampler2D;
	#endif
#else 
	#ifdef GL_FRAGMENT_PRECISION_HIGH
		precision highp int;
		#if (__VERSION__ == 300)
			precision highp isampler2D;
			precision highp usampler2D;
		#endif
	#else
		precision mediump int;
		#if (__VERSION__ == 300)
			precision mediump isampler2D;
			precision mediump usampler2D;
		#endif
	#endif
#endif
#if (`).concat(J.GPUIO_FLOAT_PRECISION," == ").concat((0,te.intForPrecision)(J.PRECISION_LOW_P),`)
	precision lowp float;
	precision lowp sampler2D;
#elif (`).concat(J.GPUIO_FLOAT_PRECISION," == ").concat((0,te.intForPrecision)(J.PRECISION_MEDIUM_P),`)
	precision mediump float;
	precision mediump sampler2D;
#else
	#ifdef GL_FRAGMENT_PRECISION_HIGH
		precision highp float;
		precision highp sampler2D;
	#else
		precision mediump float;
		precision mediump sampler2D;
	#endif
#endif
`)},651:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.DEFAULT_VERT_SHADER_SOURCE=void 0;var J=Y(601);W.DEFAULT_VERT_SHADER_SOURCE=`
in vec2 a_gpuio_position;
#ifdef `.concat(J.GPUIO_VS_UV_ATTRIBUTE,`
	in vec2 a_gpuio_uv;
#endif
#ifdef `).concat(J.GPUIO_VS_NORMAL_ATTRIBUTE,`
	in vec2 a_gpuio_normal;
#endif

uniform vec2 u_gpuio_scale;
uniform vec2 u_gpuio_translation;

out vec2 v_uv;
out vec2 v_uv_local;
#ifdef `).concat(J.GPUIO_VS_NORMAL_ATTRIBUTE,`
	out vec2 v_normal;
#endif

void main() {
	// Optional varyings.
	#ifdef `).concat(J.GPUIO_VS_UV_ATTRIBUTE,`
		v_uv_local = a_gpuio_uv;
	#else
		v_uv_local = 0.5 * (a_gpuio_position + 1.0);
	#endif
	#ifdef `).concat(J.GPUIO_VS_NORMAL_ATTRIBUTE,`
		v_normal = a_gpuio_normal;
	#endif

	// Apply transformations.
	vec2 position = u_gpuio_scale * a_gpuio_position + u_gpuio_translation;

	// Calculate a global uv for the viewport.
	v_uv = 0.5 * (position + 1.0);

	// Calculate vertex position.
	gl_Position = vec4(position, 0, 1);
}`)},567:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.LAYER_LINES_VERTEX_SHADER_SOURCE=void 0;var J=Y(601),te=Y(324);W.LAYER_LINES_VERTEX_SHADER_SOURCE=`
`.concat(te.VERTEX_SHADER_HELPERS_SOURCE,`

#if (__VERSION__ != 300 || `).concat(J.GPUIO_VS_INDEXED_POSITIONS,` == 1)
	// Cannot use int vertex attributes.
	// https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer
	in float a_gpuio_index;
#endif

uniform sampler2D u_gpuio_positions; // Texture lookup with position data.
uniform vec2 u_gpuio_positionsDimensions;
uniform vec2 u_gpuio_scale;

out vec2 v_uv;
out vec2 v_lineWrapping; // Use this to test if line is only half wrapped and should not be rendered.
flat out int v_index;

void main() {
	// Calculate a uv based on the point's index attribute.
	#if (__VERSION__ != 300 || `).concat(J.GPUIO_VS_INDEXED_POSITIONS,` == 1)
		vec2 positionUV = uvFromIndex(a_gpuio_index, u_gpuio_positionsDimensions);
		v_index = int(a_gpuio_index);
	#else
		vec2 positionUV = uvFromIndex(gl_VertexID, u_gpuio_positionsDimensions);
		v_index = gl_VertexID;
	#endif

	// Calculate a global uv for the viewport.
	// Lookup vertex position and scale to [0, 1] range.
	#ifdef `).concat(J.GPUIO_VS_POSITION_W_ACCUM,`
		// We have packed a 2D displacement with the position.
		vec4 positionData = texture(u_gpuio_positions, positionUV);
		// position = first two components plus last two components (optional accumulation buffer).
		v_uv = (positionData.rg + positionData.ba) * u_gpuio_scale;
	#else
		v_uv = texture(u_gpuio_positions, positionUV).rg  * u_gpuio_scale;
	#endif

	// Wrap if needed.
	v_lineWrapping = vec2(0.0);
	#ifdef `).concat(J.GPUIO_VS_WRAP_X,`
		v_lineWrapping.x = max(step(1.0, v_uv.x), step(v_uv.x, 0.0));
		v_ux.x = fract(v_uv.x + 1.0);
	#endif
	#ifdef `).concat(J.GPUIO_VS_WRAP_Y,`
		v_lineWrapping.y = max(step(1.0, v_uv.y), step(v_uv.y, 0.0));
		v_ux.y = fract(v_uv.y + 1.0);
	#endif

	// Calculate position in [-1, 1] range.
	vec2 position = v_uv * 2.0 - 1.0;

	gl_Position = vec4(position, 0, 1);
}`)},380:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.LAYER_MESH_VERTEX_SHADER_SOURCE=void 0;var J=Y(601),te=Y(324);W.LAYER_MESH_VERTEX_SHADER_SOURCE=`
`.concat(te.VERTEX_SHADER_HELPERS_SOURCE,`

#if (__VERSION__ != 300)
	// Cannot use int vertex attributes.
	// https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer
	in float a_gpuio_index;
#endif

uniform sampler2D u_gpuio_positions; // Texture lookup with position data.
uniform vec2 u_gpuio_positionsDimensions;
uniform vec2 u_gpuio_scale;

out vec2 v_uv;
out vec2 v_uv_position;
out vec2 v_position;
flat out int v_index;

void main() {
	// Calculate a uv based on the point's index attribute.
	#if (__VERSION__ == 300)
		v_uv_position = uvFromIndex(gl_VertexID, u_gpuio_positionsDimensions);
		v_index = gl_VertexID;
	#else
		v_uv_position = uvFromIndex(a_gpuio_index, u_gpuio_positionsDimensions);
		v_index = int(a_gpuio_index);
	#endif

	// Calculate a global uv for the viewport.
	// Lookup vertex position and scale to [0, 1] range.
	#ifdef `).concat(J.GPUIO_VS_POSITION_W_ACCUM,`
		// We have packed a 2D displacement with the position.
		vec4 positionData = texture(u_gpuio_positions, v_uv_position);
		// position = first two components plus last two components (optional accumulation buffer).
		v_position = positionData.rg + positionData.ba;
		v_uv = v_position * u_gpuio_scale;
	#else
		v_position = texture(u_gpuio_positions, v_uv_position).rg;
		v_uv = v_position * u_gpuio_scale;
	#endif

	// Calculate position in [-1, 1] range.
	vec2 position = v_uv * 2.0 - 1.0;

	gl_Position = vec4(position, 0, 1);
}`)},929:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.LAYER_POINTS_VERTEX_SHADER_SOURCE=void 0;var J=Y(601),te=Y(324);W.LAYER_POINTS_VERTEX_SHADER_SOURCE=`
`.concat(te.VERTEX_SHADER_HELPERS_SOURCE,`

#if (__VERSION__ != 300)
	// Cannot use int vertex attributes.
	// https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer
	in float a_gpuio_index;
#endif

uniform sampler2D u_gpuio_positions; // Texture lookup with position data.
uniform vec2 u_gpuio_positionsDimensions;
uniform vec2 u_gpuio_scale;
uniform float u_gpuio_pointSize;

out vec2 v_uv;
out vec2 v_uv_position;
out vec2 v_position;
flat out int v_index;

void main() {
	// Calculate a uv based on the point's index attribute.
	#if (__VERSION__ == 300)
		v_uv_position = uvFromIndex(gl_VertexID, u_gpuio_positionsDimensions);
		v_index = gl_VertexID;
	#else
		v_uv_position = uvFromIndex(a_gpuio_index, u_gpuio_positionsDimensions);
		v_index = int(a_gpuio_index);
	#endif

	// Calculate a global uv for the viewport.
	// Lookup vertex position and scale to [0, 1] range.
	#ifdef `).concat(J.GPUIO_VS_POSITION_W_ACCUM,`
		// We have packed a 2D displacement with the position.
		vec4 positionData = texture(u_gpuio_positions, v_uv_position);
		// position = first two components plus last two components (optional accumulation buffer).
		v_position = positionData.rg + positionData.ba;
		v_uv = v_position * u_gpuio_scale;
	#else
		v_position = texture(u_gpuio_positions, v_uv_position).rg;
		v_uv = v_position * u_gpuio_scale;
	#endif

	// Wrap if needed.
	#ifdef `).concat(J.GPUIO_VS_WRAP_X,`
		v_uv.x = fract(v_uv.x + ceil(abs(v_uv.x)));
	#endif
	#ifdef `).concat(J.GPUIO_VS_WRAP_Y,`
		v_uv.y = fract(v_uv.y + ceil(abs(v_uv.y)));
	#endif

	// Calculate position in [-1, 1] range.
	vec2 position = v_uv * 2.0 - 1.0;

	gl_PointSize = u_gpuio_pointSize;
	gl_Position = vec4(position, 0, 1);
}`)},634:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.LAYER_VECTOR_FIELD_VERTEX_SHADER_SOURCE=void 0;var J=Y(324);W.LAYER_VECTOR_FIELD_VERTEX_SHADER_SOURCE=`
`.concat(J.VERTEX_SHADER_HELPERS_SOURCE,`

#if (__VERSION__ != 300)
	// Cannot use int vertex attributes.
	// https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer
	in float a_gpuio_index;
#endif

uniform sampler2D u_gpuio_vectors; // Texture lookup with vector data.
uniform vec2 u_gpuio_dimensions;
uniform vec2 u_gpuio_scale;

out vec2 v_uv;
flat out int v_index;

void main() {
	#if (__VERSION__ == 300)
		// Divide index by 2.
		int index = gl_VertexID / 2;
		v_index = index;
	#else
		// Divide index by 2.
		float index = floor((a_gpuio_index + 0.5) / 2.0);
		v_index = int(index);
	#endif

	// Calculate a uv based on the vertex index attribute.
	v_uv = uvFromIndex(index, u_gpuio_dimensions);
	#if (__VERSION__ == 300)
		// Add vector displacement if needed.
		v_uv += float(gl_VertexID - 2 * index) * texture(u_gpuio_vectors, v_uv).xy * u_gpuio_scale;
	#else
		// Add vector displacement if needed.
		v_uv += (a_gpuio_index - 2.0 * index) * texture(u_gpuio_vectors, v_uv).xy * u_gpuio_scale;
	#endif


	// Calculate position in [-1, 1] range.
	vec2 position = v_uv * 2.0 - 1.0;

	gl_Position = vec4(position, 0, 1);
}`)},946:(q,W)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.SEGMENT_VERTEX_SHADER_SOURCE=void 0,W.SEGMENT_VERTEX_SHADER_SOURCE=`
in vec2 a_gpuio_position;

uniform float u_gpuio_halfThickness;
uniform vec2 u_gpuio_scale;
uniform float u_gpuio_length;
uniform float u_gpuio_rotation;
uniform vec2 u_gpuio_translation;

out vec2 v_uv_local;
out vec2 v_uv;

mat2 rotate2d(float _angle){
	return mat2(cos(_angle), -sin(_angle), sin(_angle), cos(_angle));
}

void main() {
	// Calculate UV coordinates of current rendered object.
	v_uv_local = 0.5 * (a_gpuio_position + 1.0);

	vec2 position = a_gpuio_position;
	// Apply thickness / radius.
	position *= u_gpuio_halfThickness;
	// Stretch center of shape to form a round-capped line segment.
	float signX = sign(position.x);
	position.x += signX * u_gpuio_length / 2.0;
	v_uv_local.x = (signX + 1.0) / 2.0;// Set entire cap uv.x to 1 or 0.
	// Apply transformations.
	position = u_gpuio_scale * (rotate2d(-u_gpuio_rotation) * position) + u_gpuio_translation;

	// Calculate a global uv for the viewport.
	v_uv = 0.5 * (position + 1.0);

	// Calculate vertex position.
	gl_Position = vec4(position, 0, 1);
}`},324:(q,W)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.VERTEX_SHADER_HELPERS_SOURCE=void 0,W.VERTEX_SHADER_HELPERS_SOURCE=`
/**
 * Create UV coordinates from a 1D index for data stored in a texture of size "dimensions".
 */
vec2 uvFromIndex(const float index, const vec2 dimensions) {
	float y = floor((index + 0.5) / dimensions.x);
	float x = floor(index - y * dimensions.x + 0.5);
	return vec2(x + 0.5, y + 0.5) / dimensions;
}
vec2 uvFromIndex(const int index, const vec2 dimensions) {
	int width = int(dimensions.x);
	int y = index / width;
	int x = index - y * width;
	return vec2(float(x) + 0.5, float(y) + 0.5) / dimensions;
}
vec2 uvFromIndex(const float index, const ivec2 dimensions) {
	float width = float(dimensions.x);
	float y = floor((index + 0.5) / width);
	float x = floor(index - y * width + 0.5);
	return vec2(x + 0.5, y + 0.5) / vec2(dimensions);
}
vec2 uvFromIndex(const int index, const ivec2 dimensions) {
	int y = index / dimensions.x;
	int x = index - y * dimensions.x;
	return vec2(float(x) + 0.5, float(y) + 0.5) / vec2(dimensions);
}`},607:function(q,W,Y){var J=this&&this.__assign||function(){return J=Object.assign||function(et){for(var qe,je=1,it=arguments.length;je<it;je++){qe=arguments[je];for(var ct in qe)Object.prototype.hasOwnProperty.call(qe,ct)&&(et[ct]=qe[ct])}return et},J.apply(this,arguments)},te=this&&this.__createBinding||(Object.create?function(et,qe,je,it){it===void 0&&(it=je);var ct=Object.getOwnPropertyDescriptor(qe,je);(!ct||("get"in ct?!qe.__esModule:ct.writable||ct.configurable))&&(ct={enumerable:!0,get:function(){return qe[je]}}),Object.defineProperty(et,it,ct)}:function(et,qe,je,it){it===void 0&&(it=je),et[it]=qe[je]}),Z=this&&this.__exportStar||function(et,qe){for(var je in et)je!=="default"&&!Object.prototype.hasOwnProperty.call(qe,je)&&te(qe,et,je)};Object.defineProperty(W,"__esModule",{value:!0}),W._testing=W.renderRGBProgram=W.zeroProgram=W.setColorProgram=W.setValueProgram=W.renderSignedAmplitudeProgram=W.renderAmplitudeProgram=W.multiplyValueProgram=W.addValueProgram=W.addLayersProgram=W.copyProgram=W.getFragmentShaderMediumpPrecision=W.getVertexShaderMediumpPrecision=W.isHighpSupportedInFragmentShader=W.isHighpSupportedInVertexShader=W.isWebGL2Supported=W.isWebGL2=W.GPUIndexBuffer=W.GPUProgram=W.GPULayer=W.GPUComposer=void 0;var ee=Y(593),re=Y(484);Object.defineProperty(W,"GPUComposer",{enumerable:!0,get:function(){return re.GPUComposer}});var ne=Y(355);Object.defineProperty(W,"GPULayer",{enumerable:!0,get:function(){return ne.GPULayer}});var le=Y(191),se=Y(664);Object.defineProperty(W,"GPUProgram",{enumerable:!0,get:function(){return se.GPUProgram}});var ie=Y(981);Object.defineProperty(W,"GPUIndexBuffer",{enumerable:!0,get:function(){return ie.GPUIndexBuffer}});var ge=Y(707),fe=Y(126),ae=Y(581),ue=Y(360),pe=Y(690),_e=Y(579),xe=J(J(J(J(J(J({isFloatType:ee.isFloatType,isUnsignedIntType:ee.isUnsignedIntType,isSignedIntType:ee.isSignedIntType,isIntType:ee.isIntType,makeShaderHeader:ee.makeShaderHeader,compileShader:ee.compileShader,initGLProgram:ee.initGLProgram,readyToRead:ee.readyToRead,preprocessVertexShader:ee.preprocessVertexShader,preprocessFragmentShader:ee.preprocessFragmentShader,isPowerOf2:ee.isPowerOf2,initSequentialFloatArray:ee.initSequentialFloatArray,uniformInternalTypeForValue:ee.uniformInternalTypeForValue,indexOfLayerInArray:ee.indexOfLayerInArray,readPixelsAsync:ee.readPixelsAsync},ae),fe),ge),le),ue),pe);W._testing=xe;var be=ee.isWebGL2,Te=ee.isWebGL2Supported,ye=ee.isHighpSupportedInVertexShader,Ee=ee.isHighpSupportedInFragmentShader,he=ee.getVertexShaderMediumpPrecision,oe=ee.getFragmentShaderMediumpPrecision;W.isWebGL2=be,W.isWebGL2Supported=Te,W.isHighpSupportedInVertexShader=ye,W.isHighpSupportedInFragmentShader=Ee,W.getVertexShaderMediumpPrecision=he,W.getFragmentShaderMediumpPrecision=oe;var me=_e.copyProgram,ve=_e.addLayersProgram,we=_e.addValueProgram,Pe=_e.multiplyValueProgram,Me=_e.setValueProgram,De=_e.setColorProgram,Oe=_e.zeroProgram,Ie=_e.renderRGBProgram,Be=_e.renderAmplitudeProgram,ze=_e.renderSignedAmplitudeProgram;W.copyProgram=me,W.addLayersProgram=ve,W.addValueProgram=we,W.multiplyValueProgram=Pe,W.setValueProgram=Me,W.setColorProgram=De,W.zeroProgram=Oe,W.renderRGBProgram=Ie,W.renderAmplitudeProgram=Be,W.renderSignedAmplitudeProgram=ze,Z(Y(601),W)},360:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.fragmentShaderPolyfills=W.GLSL1Polyfills=W.texturePolyfill=W.SAMPLER2D_DIMENSIONS_UNIFORM=W.SAMPLER2D_HALF_PX_UNIFORM=W.SAMPLER2D_FILTER=W.SAMPLER2D_CAST_INT=W.SAMPLER2D_WRAP_Y=W.SAMPLER2D_WRAP_X=void 0;var J=Y(601),te=Y(126);W.SAMPLER2D_WRAP_X="GPUIO_WRAP_X",W.SAMPLER2D_WRAP_Y="GPUIO_WRAP_Y",W.SAMPLER2D_CAST_INT="GPUIO_CAST_INT",W.SAMPLER2D_FILTER="GPUIO_FILTER",W.SAMPLER2D_HALF_PX_UNIFORM="u_gpuio_half_px",W.SAMPLER2D_DIMENSIONS_UNIFORM="u_gpuio_dimensions";function Z(Oe){var Ie=Oe.match(/\btexture\(/g);if(!Ie||Ie.length===0)return{shaderSource:Oe,samplerUniforms:[]};var Be=(0,te.getSampler2DsInProgram)(Oe);if(Be.length===0)return{shaderSource:Oe,samplerUniforms:Be};Be.forEach(function(rt,ut){var We=new RegExp("\\btexture(2D)?\\(\\s?".concat(rt,"\\b"),"gs");Oe=Oe.replace(We,"GPUIO_TEXTURE_POLYFILL".concat(ut,"(").concat(rt))});var ze=Oe.match(/\btexture(2D)?\(/g);ze?.length&&console.warn("Fragment shader polyfill has missed some calls to texture().",Oe);for(var et={},qe=0;qe<Be.length;qe++)et["".concat(W.SAMPLER2D_HALF_PX_UNIFORM).concat(qe)]="vec2",et["".concat(W.SAMPLER2D_DIMENSIONS_UNIFORM).concat(qe)]="vec2";function je(rt,ut,We){We===void 0&&(We="");var Re=We===""?"":")",Ue=We===""?ut:"i";return`
`.concat(Ue,"vec4 GPUIO_TEXTURE_POLYFILL").concat(rt,"(const ").concat(ut,`sampler2D sampler, const vec2 uv) {
	`).concat(ut===""?"#if (".concat(W.SAMPLER2D_FILTER).concat(rt," == 0)"):"",`
		#if (`).concat(W.SAMPLER2D_WRAP_X).concat(rt,` == 0)
			#if (`).concat(W.SAMPLER2D_WRAP_Y).concat(rt,` == 0)
				return `).concat(We,"texture(sampler, uv)").concat(Re,`;
			#else
				return `).concat(We,"GPUIO_TEXTURE_WRAP_CLAMP_REPEAT(sampler, uv, ").concat(W.SAMPLER2D_HALF_PX_UNIFORM).concat(rt,")").concat(Re,`;
			#endif
		#else
			#if (`).concat(W.SAMPLER2D_WRAP_Y).concat(rt,` == 0)
				return `).concat(We,"GPUIO_TEXTURE_WRAP_REPEAT_CLAMP(sampler, uv, ").concat(W.SAMPLER2D_HALF_PX_UNIFORM).concat(rt,")").concat(Re,`;
			#else
				return `).concat(We,"GPUIO_TEXTURE_WRAP_REPEAT_REPEAT(sampler, uv, ").concat(W.SAMPLER2D_HALF_PX_UNIFORM).concat(rt,")").concat(Re,`;
			#endif
		#endif
	`).concat(ut===""?`#else
		#if (`.concat(W.SAMPLER2D_WRAP_X).concat(rt,` == 0)
			#if (`).concat(W.SAMPLER2D_WRAP_Y).concat(rt,` == 0)
				return `).concat(We,"GPUIO_TEXTURE_BILINEAR_INTERP(sampler, uv, ").concat(W.SAMPLER2D_HALF_PX_UNIFORM).concat(rt,", ").concat(W.SAMPLER2D_DIMENSIONS_UNIFORM).concat(rt,")").concat(Re,`;
			#else
				return `).concat(We,"GPUIO_TEXTURE_BILINEAR_INTERP_WRAP_CLAMP_REPEAT(sampler, uv, ").concat(W.SAMPLER2D_HALF_PX_UNIFORM).concat(rt,", ").concat(W.SAMPLER2D_DIMENSIONS_UNIFORM).concat(rt,")").concat(Re,`;
			#endif
		#else
			#if (`).concat(W.SAMPLER2D_WRAP_Y).concat(rt,` == 0)
				return `).concat(We,"GPUIO_TEXTURE_BILINEAR_INTERP_WRAP_REPEAT_CLAMP(sampler, uv, ").concat(W.SAMPLER2D_HALF_PX_UNIFORM).concat(rt,", ").concat(W.SAMPLER2D_DIMENSIONS_UNIFORM).concat(rt,")").concat(Re,`;
			#else
				return `).concat(We,"GPUIO_TEXTURE_BILINEAR_INTERP_WRAP_REPEAT_REPEAT(sampler, uv, ").concat(W.SAMPLER2D_HALF_PX_UNIFORM).concat(rt,", ").concat(W.SAMPLER2D_DIMENSIONS_UNIFORM).concat(rt,")").concat(Re,`;
			#endif
		#endif
	#endif`):"",`
}
`)}function it(rt){return`
`.concat(rt,"vec4 GPUIO_TEXTURE_WRAP_REPEAT_REPEAT(const ").concat(rt,`sampler2D sampler, const vec2 uv, const vec2 halfPx) {
	return texture(sampler, GPUIO_WRAP_REPEAT_UV(uv));
}
`).concat(rt,"vec4 GPUIO_TEXTURE_WRAP_REPEAT_CLAMP(const ").concat(rt,`sampler2D sampler, vec2 uv, const vec2 halfPx) {
	uv.x = GPUIO_WRAP_REPEAT_UV_COORD(uv.x);
	// uv.y = GPUIO_WRAP_CLAMP_UV_COORD(uv.y, halfPx.y);
	return texture(sampler, uv);
}
`).concat(rt,"vec4 GPUIO_TEXTURE_WRAP_CLAMP_REPEAT(const ").concat(rt,`sampler2D sampler, vec2 uv, const vec2 halfPx) {
	// uv.x = GPUIO_WRAP_CLAMP_UV_COORD(uv.x, halfPx.x);
	uv.y = GPUIO_WRAP_REPEAT_UV_COORD(uv.y);
	return texture(sampler, uv);
}
`)}function ct(rt){var ut=rt?"GPUIO_TEXTURE_WRAP_".concat(rt):"texture",We=rt?", halfPx":"";return`
vec4 GPUIO_TEXTURE_BILINEAR_INTERP`.concat(rt?"_WRAP_".concat(rt):"",`(const sampler2D sampler, const vec2 uv, const vec2 halfPx, const vec2 dimensions) {
	vec2 pxFraction = fract(uv * dimensions);
	vec2 offset = halfPx - vec2(0.00001, 0.00001) * max(
			step(abs(pxFraction.x - 0.5), 0.001),
			step(abs(pxFraction.y - 0.5), 0.001)
		);
	vec2 baseUV = uv - offset;
	vec2 diagOffset = vec2(offset.x, -offset.y);
	vec4 minmin = `).concat(ut,"(sampler, baseUV").concat(We,`);
	vec4 maxmin = `).concat(ut,"(sampler, uv + diagOffset").concat(We,`);
	vec4 minmax = `).concat(ut,"(sampler, uv - diagOffset").concat(We,`);
	vec4 maxmax = `).concat(ut,"(sampler, uv + offset").concat(We,`);
	vec2 t = fract(baseUV * dimensions);
	vec4 yMin = mix(minmin, maxmin, t.x);
	vec4 yMax = mix(minmax, maxmax, t.x);
	return mix(yMin, yMax, t.y);
}
`)}return Oe=`
`.concat(Object.keys(et).map(function(rt){return"uniform ".concat(et[rt]," ").concat(rt,";")}).join(`
`),`

float GPUIO_WRAP_REPEAT_UV_COORD(const float coord) {
	return fract(coord + ceil(abs(coord)));
}
vec2 GPUIO_WRAP_REPEAT_UV(const vec2 uv) {
	return fract(uv + ceil(abs(uv)));
}
// float GPUIO_WRAP_CLAMP_UV_COORD(const float coord, const float halfPx) {
// 	return clamp(coord, halfPx, 1.0 - halfPx);
// }

`).concat(it(""),`
#if (__VERSION__ == 300)
`).concat(["u","i"].map(function(rt){return it(rt)}).join(`
`),`
#endif

`).concat([null,"REPEAT_REPEAT","REPEAT_CLAMP","CLAMP_REPEAT"].map(function(rt){return ct(rt)}).join(`
`),`

`).concat(Be.map(function(rt,ut){return"#ifndef ".concat(W.SAMPLER2D_CAST_INT).concat(ut,`
	`).concat(je(ut,""),`
#endif`)}).join(`
`),`
#if (__VERSION__ == 300)
`).concat(["u","i"].map(function(rt){return Be.map(function(ut,We){return je(We,rt)}).join(`
`)}).join(`
`),`
#else
	`).concat(Be.map(function(rt,ut){return"#ifdef ".concat(W.SAMPLER2D_CAST_INT).concat(ut,`
	`).concat(je(ut,"","ivec4("),`
#endif`)}).join(`
`),`
#endif

`).concat(Oe),{shaderSource:Oe,samplerUniforms:Be}}W.texturePolyfill=Z;function ee(Oe){switch(Oe){case"int":case"uint":return"float";case"ivec2":case"uvec2":return"vec2";case"ivec3":case"uvec3":return"vec3";case"ivec4":case"uvec4":return"vec4"}throw new Error("Unknown type ".concat(Oe,"."))}function re(Oe){switch(Oe){case"bool":return"float";case"bvec2":return"vec2";case"bvec3":return"vec3";case"bvec4":return"vec4"}throw new Error("Unknown type ".concat(Oe,"."))}function ne(Oe){return"".concat(Oe," abs(const ").concat(Oe," a) { return ").concat(Oe,"(abs(").concat(ee(Oe),"(a))); }")}function le(Oe){return"".concat(Oe," sign(const ").concat(Oe," a) { return ").concat(Oe,"(sign(").concat(ee(Oe),"(a))); }")}function se(Oe){return"".concat(Oe," trunc(const ").concat(Oe," a) { return round(a - fract(a) * sign(a)); }")}function ie(Oe){return"".concat(Oe," round(const ").concat(Oe," a) { return floor(a + 0.5); }")}function ge(Oe){return"".concat(Oe," roundEven(const ").concat(Oe," a) { return 2.0 * round(a / 2.0); }")}function fe(Oe,Ie){return"".concat(Oe," min(const ").concat(Oe," a, const ").concat(Ie," b) { return ").concat(Oe,"(min(").concat(ee(Oe),"(a), ").concat(ee(Ie),"(b))); }")}function ae(Oe,Ie){return"".concat(Oe," max(const ").concat(Oe," a, const ").concat(Ie," b) { return ").concat(Oe,"(max(").concat(ee(Oe),"(a), ").concat(ee(Ie),"(b))); }")}function ue(Oe,Ie){return"".concat(Oe," clamp(const ").concat(Oe," a, const ").concat(Ie," min, const ").concat(Ie," max) { return ").concat(Oe,"(clamp(").concat(ee(Oe),"(a), ").concat(ee(Ie),"(min), ").concat(ee(Ie),"(max))); }")}function pe(Oe,Ie){return"".concat(Oe," mix(const ").concat(Oe," a, const ").concat(Oe," b, const ").concat(Ie," c) { return mix(a, b, ").concat(re(Ie),"(c)); }")}function _e(Oe,Ie,Be){return"a[".concat(Oe,"][").concat(Ie,"] * a[").concat((Oe+1)%Be,"][").concat((Ie+1)%Be,"] - a[").concat((Oe+1)%Be,"][").concat(Ie,"] * a[").concat(Oe,"][").concat((Ie+1)%Be,"]")}function xe(Oe,Ie,Be){return[0,1,2].map(function(ze){return"a[".concat(Oe,"][").concat((Ie+ze)%Be,"] * (").concat(_e((Oe+1)%Be,(Ie+1+ze)%Be,Be),")")}).join(" + ")}function be(Oe,Ie,Be){return[0,1,2,3].map(function(ze){return"a[".concat(Oe,"][").concat((Ie+ze)%Be,"] * (").concat(xe((Oe+1)%Be,(Ie+1+ze)%Be,Be),")")}).join(" + ")}function Te(Oe){var Ie="";return Oe.includes("abs")&&(Ie+=`


`.concat(ne("int"),`
`).concat(ne("ivec2"),`
`).concat(ne("ivec3"),`
`).concat(ne("ivec4"),`
`)),Oe.includes("sign")&&(Ie+=`


`.concat(le("int"),`
`).concat(le("ivec2"),`
`).concat(le("ivec3"),`
`).concat(le("ivec4"),`
`)),Oe.includes("round")&&(Ie+=`


`.concat(ie("float"),`
`).concat(ie("vec2"),`
`).concat(ie("vec3"),`
`).concat(ie("vec4"),`
`)),Oe.includes("trunc")&&(Ie+=`


`.concat(se("float"),`
`).concat(se("vec2"),`
`).concat(se("vec3"),`
`).concat(se("vec4"),`
`)),Oe.includes("roundEven")&&(Ie+=`


`.concat(ge("float"),`
`).concat(ge("vec2"),`
`).concat(ge("vec3"),`
`).concat(ge("vec4"),`
`)),Oe.includes("min")&&(Ie+=`


`.concat(fe("int","int"),`
`).concat(fe("ivec2","ivec2"),`
`).concat(fe("ivec3","ivec3"),`
`).concat(fe("ivec4","ivec4"),`
`).concat(fe("ivec2","int"),`
`).concat(fe("ivec3","int"),`
`).concat(fe("ivec4","int"),`
`)),Oe.includes("max")&&(Ie+=`


`.concat(ae("int","int"),`
`).concat(ae("ivec2","ivec2"),`
`).concat(ae("ivec3","ivec3"),`
`).concat(ae("ivec4","ivec4"),`
`).concat(ae("ivec2","int"),`
`).concat(ae("ivec3","int"),`
`).concat(ae("ivec4","int"),`
`)),Oe.includes("clamp")&&(Ie+=`


`.concat(ue("int","int"),`
`).concat(ue("ivec2","ivec2"),`
`).concat(ue("ivec3","ivec3"),`
`).concat(ue("ivec4","ivec4"),`
`).concat(ue("ivec2","int"),`
`).concat(ue("ivec3","int"),`
`).concat(ue("ivec4","int"),`
`)),Oe.includes("mix")&&(Ie+=`


`.concat(pe("float","bool"),`
`).concat(pe("vec2","bvec2"),`
`).concat(pe("vec3","bvec3"),`
`).concat(pe("vec4","bvec4"),`
`)),Oe.includes("outerProduct")&&(Ie+=`


mat2 outerProduct(const vec2 a, const vec2 b) {
	return mat2(
		a.x * b.x, a.x * b.y,
		a.y * b.x, a.y * b.y
	);
}
mat3 outerProduct(const vec3 a, const vec3 b) {
	return mat3(
		a.x * b.x, a.x * b.y, a.x * b.z,
		a.y * b.x, a.y * b.y, a.y * b.z,
		a.z * b.x, a.z * b.y, a.z * b.z
	);
}
mat4 outerProduct(const vec4 a, const vec4 b) {
	return mat4(
		a.x * b.x, a.x * b.y, a.x * b.z, a.x * b.w,
		a.y * b.x, a.y * b.y, a.y * b.z, a.y * b.w,
		a.z * b.x, a.z * b.y, a.z * b.z, a.z * b.w,
		a.w * b.x, a.w * b.y, a.w * b.z, a.w * b.w
	);
}
`),Oe.includes("transpose")&&(Ie+=`


mat2 transpose(mat2 a) {
	float temp = a[0][1];
	a[0][1] = a[1][0];
	a[1][0] = temp;
	return a;
}
mat3 transpose(mat3 a) {
	float temp = a[0][2];
	a[0][2] = a[2][0];
	a[2][0] = temp;
	temp = a[0][1];
	a[0][1] = a[1][0];
	a[1][0] = temp;
	temp = a[1][2];
	a[1][2] = a[2][1];
	a[2][1] = temp;
	return a;
}
mat4 transpose(mat4 a) {
	float temp = a[0][3];
	a[0][3] = a[3][0];
	a[3][0] = temp;
	temp = a[0][2];
	a[0][2] = a[2][0];
	a[2][0] = temp;
	temp = a[2][3];
	a[2][3] = a[3][2];
	a[3][2] = temp;
	temp = a[0][1];
	a[0][1] = a[1][0];
	a[1][0] = temp;
	temp = a[1][2];
	a[1][2] = a[2][1];
	a[2][1] = temp;
	temp = a[2][3];
	a[2][3] = a[3][2];
	a[3][2] = temp;
	return a;
}
`),Oe.includes("determinant")&&(Ie+=`


float determinant(const mat2 a) {
	return `.concat(_e(0,0,2),`;
}
float determinant(const mat3 a) {
	return `).concat(xe(0,0,3),`;
}
float determinant(const mat4 a) {
	return `).concat(be(0,0,4),`;
}
`)),Oe.includes("sinh")&&(Ie+=`


float sinh(const float x) {
	return (pow(`.concat(Math.E,", x) - pow(").concat(Math.E,`, -x)) / 2.0;
}
`)),Oe.includes("cosh")&&(Ie+=`


float cosh(const float x) {
	return (pow(`.concat(Math.E,", x) + pow(").concat(Math.E,`, -x)) / 2.0; 
}
`)),Oe.includes("tanh")&&(Ie+=`


float tanh(const float x) {
	float e = exp(2.0 * x);
	return (e - 1.0) / (e + 1.0);
}
`),Oe.includes("asinh")&&(Ie+=`


float asinh(const float x) {
	return log(x + sqrt(x * x + 1.0));
}
`),Oe.includes("asinh")&&(Ie+=`


float acosh(const float x) {
	return log(x + sqrt(x * x - 1.0));
}
`),Oe.includes("asinh")&&(Ie+=`


float atanh(float x) {
	x = (x + 1.0) / (x - 1.0);
	return 0.5 * log(x * sign(x));
}
`),Ie}W.GLSL1Polyfills=Te;function ye(Oe,Ie){return"vec2 index1DToUV(const ".concat(Oe," index1D, const ").concat(Ie,` dimensions) {
	`).concat(Oe," width = ").concat(Oe,`(dimensions.x);
	`).concat(Oe,` y = index1D / width;
	`).concat(Oe,` x = index1D - width * y;
	float u = (float(x) + 0.5) / float(dimensions.x);
	float v = (float(y) + 0.5) / float(dimensions.y);
	return vec2(u, v);
}`)}function Ee(Oe,Ie){return"".concat(Oe," modi(const ").concat(Oe," x, const ").concat(Ie," y) { return x - y * (x / y); }")}function he(Oe,Ie){return"".concat(Ie," stepi(const ").concat(Oe," x, const ").concat(Ie," y) { return ").concat(Ie,"(step(").concat(ee(Oe),"(x), ").concat(ee(Ie),"(y))); }")}function oe(Oe,Ie){return"".concat(Oe," bitshiftLeft(const ").concat(Oe," a, const ").concat(Ie,` b) {
	#if (__VERSION__ == 300)
		return a << b;
	#else
		return a * `).concat(Oe,"(pow(").concat(ee(Ie),"(2.0), ").concat(ee(Ie),`(b)));
	#endif
}`)}function me(Oe,Ie){return"".concat(Oe," bitshiftRight(const ").concat(Oe," a, const ").concat(Ie,` b) {
	#if (__VERSION__ == 300)
		return a >> b;
	#else
		return `).concat(Oe,"(round(").concat(ee(Oe),"(a) / pow(").concat(ee(Ie),"(2.0), ").concat(ee(Ie),`(b))));
	#endif
}`)}function ve(Oe){return"int bitwiseOr".concat(Oe===32?"":Oe,`(int a, int b) {
	#if (__VERSION__ == 300)
		return a | b;
	#else
		int result = 0;
		int n = 1;
		
		for (int i = 0; i < `).concat(Oe,`; i++) {
			if ((modi(a, 2) == 1) || (modi(b, 2) == 1)) {
				result += n;
			}
			a = a / 2;
			b = b / 2;
			n = n * 2;
			if(!(a > 0 || b > 0)) {
				break;
			}
		}
		return result;
	#endif
}`)}function we(Oe){return"int bitwiseXOR".concat(Oe===32?"":Oe,`(int a, int b) {
	#if (__VERSION__ == 300)
		return a ^ b;
	#else
		int result = 0;
		int n = 1;
		
		for (int i = 0; i < `).concat(Oe,`; i++) {
			if ((modi(a, 2) == 1) != (modi(b, 2) == 1)) {
				result += n;
			}
			a = a / 2;
			b = b / 2;
			n = n * 2;
			if(!(a > 0 || b > 0)) {
				break;
			}
		}
		return result;
	#endif
}`)}function Pe(Oe){return"int bitwiseAnd".concat(Oe===32?"":Oe,`(int a, int b) {
	#if (__VERSION__ == 300)
		return a & b;
	#else
		int result = 0;
		int n = 1;
		for (int i = 0; i < `).concat(Oe,`; i++) {
			if ((modi(a, 2) == 1) && (modi(b, 2) == 1)) {
				result += n;
			}
			a = a / 2;
			b = b / 2;
			n = n * 2;
			if(!(a > 0 && b > 0)) {
				break;
			}
		}
		return result;
	#endif
}`)}function Me(Oe){return"int bitwiseNot".concat(Oe===32?"":Oe,`(int a) {
	#if (__VERSION__ == 300)
		return ~a;
	#else
		int result = 0;
		int n = 1;

		for (int i = 0; i < `).concat(Oe,`; i++) {
			if (modi(a, 2) == 0) {
				result += n;
			}
			a = a / 2;
			n = n * 2;
		}
		return result;
	#endif
}`)}function De(Oe,Ie){var Be="";return Oe.includes("index1DToUV")&&(Be+=`

`.concat(ye("int","ivec2"),`
`).concat(ye("int","vec2"),`
#if (__VERSION__ == 300)
`).concat(ye("int","uvec2"),`
`).concat(ye("uint","uvec2"),`
`).concat(ye("uint","ivec2"),`
`).concat(ye("uint","vec2"),`
#endif
`)),(Oe.includes("modi")||Ie===J.GLSL1&&Oe.includes("bitwise"))&&(Be+=`

`.concat(Ee("int","int"),`
`).concat(Ee("ivec2","ivec2"),`
`).concat(Ee("ivec3","ivec3"),`
`).concat(Ee("ivec4","ivec4"),`
`).concat(Ee("ivec2","int"),`
`).concat(Ee("ivec3","int"),`
`).concat(Ee("ivec4","int"),`
#if (__VERSION__ == 300)
`).concat(Ee("uint","uint"),`
`).concat(Ee("uvec2","uvec2"),`
`).concat(Ee("uvec3","uvec3"),`
`).concat(Ee("uvec4","uvec4"),`
`).concat(Ee("uvec2","uint"),`
`).concat(Ee("uvec3","uint"),`
`).concat(Ee("uvec4","uint"),`
#endif
`)),Oe.includes("stepi")&&(Be+=`

`.concat(he("int","int"),`
`).concat(he("ivec2","ivec2"),`
`).concat(he("ivec3","ivec3"),`
`).concat(he("ivec4","ivec4"),`
`).concat(he("int","ivec2"),`
`).concat(he("int","ivec3"),`
`).concat(he("int","ivec4"),`
#if (__VERSION__ == 300)
`).concat(he("uint","uint"),`
`).concat(he("uvec2","uvec2"),`
`).concat(he("uvec3","uvec3"),`
`).concat(he("uvec4","uvec4"),`
`).concat(he("uint","uvec2"),`
`).concat(he("uint","uvec3"),`
`).concat(he("uint","uvec4"),`
#endif
`)),Oe.includes("bitshiftLeft")&&(Be+=`

`.concat(oe("int","int"),`
`).concat(oe("ivec2","ivec2"),`
`).concat(oe("ivec3","ivec3"),`
`).concat(oe("ivec4","ivec4"),`
`).concat(oe("ivec2","int"),`
`).concat(oe("ivec3","int"),`
`).concat(oe("ivec4","int"),`
#if (__VERSION__ == 300)
`).concat(oe("uint","uint"),`
`).concat(oe("uvec2","uvec2"),`
`).concat(oe("uvec3","uvec3"),`
`).concat(oe("uvec4","uvec4"),`
`).concat(oe("uvec2","uint"),`
`).concat(oe("uvec3","uint"),`
`).concat(oe("uvec4","uint"),`
#endif
`)),Oe.includes("bitshiftRight")&&(Be+=`

`.concat(me("int","int"),`
`).concat(me("ivec2","ivec2"),`
`).concat(me("ivec3","ivec3"),`
`).concat(me("ivec4","ivec4"),`
`).concat(me("ivec2","int"),`
`).concat(me("ivec3","int"),`
`).concat(me("ivec4","int"),`
#if (__VERSION__ == 300)
`).concat(me("uint","uint"),`
`).concat(me("uvec2","uvec2"),`
`).concat(me("uvec3","uvec3"),`
`).concat(me("uvec4","uvec4"),`
`).concat(me("uvec2","uint"),`
`).concat(me("uvec3","uint"),`
`).concat(me("uvec4","uint"),`
#endif
`)),Oe.includes("bitwiseOr")&&(Be+=`

`.concat(ve(8),`
`).concat(ve(16),`
`).concat(ve(32),`
#if (__VERSION__ == 300)
`).concat([8,16,""].map(function(ze){return`
uint bitwiseOr`.concat(ze,`(uint a, uint b) {
	return uint(bitwiseOr`).concat(ze,`(int(a), int(b)));
}`)}).join(`
`),`
#endif
`)),Oe.includes("bitwiseXOR")&&(Be+=`

`.concat(we(8),`
`).concat(we(16),`
`).concat(we(32),`
#if (__VERSION__ == 300)
`).concat([8,16,""].map(function(ze){return`
uint bitwiseXOR`.concat(ze,`(uint a, uint b) {
	return uint(bitwiseXOR`).concat(ze,`(int(a), int(b)));
}`)}).join(`
`),`
#endif
`)),Oe.includes("bitwiseAnd")&&(Be+=`

`.concat(Pe(8),`
`).concat(Pe(16),`
`).concat(Pe(32),`
#if (__VERSION__ == 300)
`).concat([8,16,""].map(function(ze){return`
uint bitwiseAnd`.concat(ze,`(uint a, uint b) {
	return uint(bitwiseAnd`).concat(ze,`(int(a), int(b)));
}`)}).join(`
`),`
#endif
`)),Oe.includes("bitwiseNot")&&(Be+=`

`.concat(Me(8),`
`).concat(Me(16),`
`).concat(Me(32),`
#if (__VERSION__ == 300)
`).concat([8,16,""].map(function(ze){return`
uint bitwiseNot`.concat(ze,`(uint a) {
	return uint(bitwiseNot`).concat(ze,`(int(a)));
}`)}).join(`
`),`
#endif
`)),Be}W.fragmentShaderPolyfills=De},126:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.getSampler2DsInProgram=W.stripComments=W.stripPrecision=W.stripVersion=W.highpToMediump=W.glsl1Uint=W.glsl1Sampler2D=W.glsl1Texture=W.checkFragmentShaderForFragColor=W.glsl1FragmentOut=W.getFragmentOuts=W.glsl1FragmentIn=W.glsl1VertexOut=W.castVaryingToFloat=W.glsl1VertexIn=void 0;var J=Y(601);function te(he){return he.replace(/\bin\b/g,"attribute")}W.glsl1VertexIn=te;function Z(he){return he.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ee(he,oe,me){var ve=new RegExp("\\b".concat(Z(oe),"\\s*=\\s*\\S[^;]*;"),"sg"),we=he.match(ve);if(we)for(var Pe=0;Pe<we.length;Pe++){var Me=new RegExp("\\b".concat(Z(oe),"\\s*=\\s*(\\S[^;]*);"),"s"),De=we[Pe].match(Me);if(De&&De[1]){var Oe=new RegExp("\\b".concat(Z(oe),"\\s*=\\s*").concat(Z(De[1]),"\\s*;"),"s");he=he.replace(Oe,"".concat(oe," = ").concat(me,"(").concat(De[1],");"))}else console.warn('Could not find value in expression: "'.concat(we[Pe],'"'))}else console.warn("No assignment found for shader variable ".concat(oe,"."));return he}function re(he,oe,me){var ve=new RegExp("".concat(oe,"\\s+\\S[^;]*;"),"g"),we=he.match(ve);if(we){var Pe=new RegExp("".concat(oe,"\\b"),"g");he=he.replace(Pe,"varying ".concat(me));for(var Me=0;Me<we.length;Me++){var De=new RegExp("".concat(oe,"\\s+(\\S[^;]*);")),Oe=we[Me].match(De);Oe&&Oe[2]?he=ee(he,Oe[2],me):console.warn('Could not find variable name in expression: "'.concat(we[Me],'"'))}}return he}function ne(he){return he=re(he,"\\bvarying\\s+(u)?int","float"),he=re(he,"\\bvarying\\s+(i|u)vec2","vec2"),he=re(he,"\\bvarying\\s+(i|u)vec3","vec3"),he=re(he,"\\bvarying\\s+(i|u)vec4","vec4"),he}W.castVaryingToFloat=ne;function le(he){return he=he.replace(/(\bflat\s+)?\bout\b/g,"varying"),he=ne(he),he}W.glsl1VertexOut=le;function se(he){return he=he.replace(/(\bflat\s+)?\bin\b/g,"varying"),he=ne(he),he}W.glsl1FragmentIn=se;function ie(he,oe){for(var me={},ve=0;;){var we=he.match(/\b(layout\s*\(\s*location\s*=\s*([0-9]+)\s*\)\s*)?out\s+((lowp|mediump|highp)\s+)?((float|int|uint|([iu]?vec[234]))\s+)?([_$a-zA-Z0-9]+)\s*;/);if(!we){if(Object.keys(me).length===0)return[];for(var Pe=Object.keys(me),Me=Pe.length,De=new Array(ve).fill(void 0),Oe=0;Oe<Me;Oe++){var Ie=Pe[Oe],Be=me[Ie],ze=Be.location,et=Be.type;if(De[ze]!==void 0)throw new Error('Must be exactly one out declaration per layout location in GPUProgram "'.concat(oe,'", conflicting declarations found at location ').concat(ze,"."));De[ze]={name:Ie,type:et}}if(Pe.length!==ve+1)throw new Error('Must be exactly one out declaration per layout location in GPUProgram "'.concat(oe,'", layout locations must be sequential (no missing location numbers) starting from 0.'));for(var Oe=0;Oe<=ve;Oe++)if(De[Oe]===void 0)throw new Error("Missing out declaration at location ".concat(Oe,' in GPUProgram "').concat(oe,'", layout locations must be sequential (no missing location numbers) starting from 0.'));return De}var qe=we[8],je=parseInt(we[2]||"0"),it=we[6];if(!it)throw new Error('No type found for out declaration "'.concat(we[0],'" for GPUProgram "').concat(oe,'".'));if(!qe)throw new Error('No variable name found for out declaration "'.concat(we[0],'" for GPUProgram "').concat(oe,'".'));if(me[qe]){if(me[qe].location!==je)throw new Error('All out declarations for variable "'.concat(qe,'" must have same location in GPUProgram "').concat(oe,'".'))}else je>ve&&(ve=je),me[qe]={location:je,type:it};he=he.replace(we[0],"")}}W.getFragmentOuts=ie;function ge(he,oe){var me=ie(he,oe);if(me.length===0)return[he];he=he.replace(/\blayout\s*\(\s*location\s*=\s*([0-9]+)\s*\)\s*/g,"");for(var ve=[],we=0,Pe=me.length;we<Pe;we++){var Me=me[we],De=Me.type,Oe=Me.name,Ie=new RegExp("\\bout\\s+((lowp|mediump|highp)\\s+)?(float|int|uint|([iu]?vec[234]))\\s+".concat(Oe,"\\s*;"),"g"),Be=he.replace(Ie,"");Be=Be.replace(/\bout\b/g,"");for(var ze=!1,et=new RegExp("\\b".concat(Oe,"\\s*=\\s*(\\S.*?);"),"s");;){var qe=Be.match(et);if(qe&&qe[1]){ze=!0;var je="";switch(De){case"float":case"int":case"uint":je=", 0, 0, 0";break;case"vec2":case"ivec2":case"uvec2":je=", 0, 0";break;case"vec3":case"ivec3":case"uvec3":je=", 0";break}Be=Be.replace(et,"gl_FragColor = vec4(".concat(qe[1]).concat(je,");"))}else{if(!ze)throw new Error('No assignment found for out declaration in GPUProgram "'.concat(oe,'".'));break}}ve.push(Be)}return ve}W.glsl1FragmentOut=ge;function fe(he){return!!he.match(/\bgl_FragColor\b/)}function ae(he,oe,me){var ve=fe(he);if(oe===J.GLSL3&&ve)throw new Error('Found "gl_FragColor" declaration in fragment shader for GPUProgram "'.concat(me,'": either init GPUComposer with glslVersion = GLSL1 or use GLSL3 syntax in your fragment shader.'))}W.checkFragmentShaderForFragColor=ae;function ue(he){return he.replace(/\btexture\(/g,"texture2D(")}W.glsl1Texture=ue;function pe(he){return he.replace(/\b(i|u)sampler2D\b/g,"sampler2D")}W.glsl1Sampler2D=pe;function _e(he){return he=he.replace(/\buint\b/g,"int"),he=he.replace(/\buvec2\b/g,"ivec2"),he=he.replace(/\buvec3\b/g,"ivec3"),he=he.replace(/\buvec4\b/g,"ivec4"),he=he.replace(/\buint\(/g,"int("),he=he.replace(/\buvec2\(/g,"ivec2("),he=he.replace(/\buvec3\(/g,"ivec3("),he=he.replace(/\buvec4\(/g,"ivec4("),he}W.glsl1Uint=_e;function xe(he){return he.replace(/\bhighp\b/,"mediump")}W.highpToMediump=xe;function be(he){var oe=he.length;return he=he.replace(/^\s*\#version\s+([0-9]+(\s+(es)+)?)\s*/,""),he.length!==oe&&console.warn("GPUIO expects shader source that does not contain #version declarations, removing...."),he}W.stripVersion=be;function Te(he){var oe=he.length;return he=he.replace(/\s*precision\s+((highp)|(mediump)|(lowp))\s+[a-zA-Z0-9]+\s*;/g,""),he.length!==oe&&console.warn("GPUIO expects shader source that does not contain precision declarations, removing...."),he}W.stripPrecision=Te;function ye(he){return he=he.replace(/[\t ]*\/\/.*\n/g,""),he=he.replace(/\/\*.*?\*\//gs,""),he}W.stripComments=ye;function Ee(he){var oe={},me="\\buniform\\s+(((highp)|(mediump)|(lowp))\\s+)?(i|u)?sampler2D\\s+(\\w+)\\s*;",ve=he.match(new RegExp(me,"g"));if(!ve||ve.length===0)return[];var we=new RegExp(me);return ve.forEach(function(Pe){var Me=Pe.match(we);if(!Me||!Me[7]){console.warn('Could not find sampler2D uniform name in string "'.concat(Pe,'".'));return}oe[Me[7]]=!0}),Object.keys(oe)}W.getSampler2DsInProgram=Ee},593:function(q,W,Y){var J=this&&this.__awaiter||function(We,Re,Ue,Le){function Ge(ke){return ke instanceof Ue?ke:new Ue(function(He){He(ke)})}return new(Ue||(Ue=Promise))(function(ke,He){function Ke(Ne){try{Qe(Le.next(Ne))}catch(Ce){He(Ce)}}function $e(Ne){try{Qe(Le.throw(Ne))}catch(Ce){He(Ce)}}function Qe(Ne){Ne.done?ke(Ne.value):Ge(Ne.value).then(Ke,$e)}Qe((Le=Le.apply(We,Re||[])).next())})},te=this&&this.__generator||function(We,Re){var Ue={label:0,sent:function(){if(ke[0]&1)throw ke[1];return ke[1]},trys:[],ops:[]},Le,Ge,ke,He;return He={next:Ke(0),throw:Ke(1),return:Ke(2)},typeof Symbol=="function"&&(He[Symbol.iterator]=function(){return this}),He;function Ke(Qe){return function(Ne){return $e([Qe,Ne])}}function $e(Qe){if(Le)throw new TypeError("Generator is already executing.");for(;Ue;)try{if(Le=1,Ge&&(ke=Qe[0]&2?Ge.return:Qe[0]?Ge.throw||((ke=Ge.return)&&ke.call(Ge),0):Ge.next)&&!(ke=ke.call(Ge,Qe[1])).done)return ke;switch(Ge=0,ke&&(Qe=[Qe[0]&2,ke.value]),Qe[0]){case 0:case 1:ke=Qe;break;case 4:return Ue.label++,{value:Qe[1],done:!1};case 5:Ue.label++,Ge=Qe[1],Qe=[0];continue;case 7:Qe=Ue.ops.pop(),Ue.trys.pop();continue;default:if(ke=Ue.trys,!(ke=ke.length>0&&ke[ke.length-1])&&(Qe[0]===6||Qe[0]===2)){Ue=0;continue}if(Qe[0]===3&&(!ke||Qe[1]>ke[0]&&Qe[1]<ke[3])){Ue.label=Qe[1];break}if(Qe[0]===6&&Ue.label<ke[1]){Ue.label=ke[1],ke=Qe;break}if(ke&&Ue.label<ke[2]){Ue.label=ke[2],Ue.ops.push(Qe);break}ke[2]&&Ue.ops.pop(),Ue.trys.pop();continue}Qe=Re.call(We,Ue)}catch(Ne){Qe=[6,Ne],Ge=0}finally{Le=ke=0}if(Qe[0]&5)throw Qe[1];return{value:Qe[0]?Qe[1]:void 0,done:!0}}};Object.defineProperty(W,"__esModule",{value:!0}),W.readPixelsAsync=W.indexOfLayerInArray=W.uniformInternalTypeForValue=W.preprocessFragmentShader=W.preprocessVertexShader=W.convertFragmentShaderToGLSL1=W.initSequentialFloatArray=W.isPowerOf2=W.getFragmentShaderMediumpPrecision=W.getVertexShaderMediumpPrecision=W.isHighpSupportedInFragmentShader=W.isHighpSupportedInVertexShader=W.readyToRead=W.isWebGL2Supported=W.isWebGL2=W.initGLProgram=W.compileShader=W.makeShaderHeader=W.isIntType=W.isSignedIntType=W.isUnsignedIntType=W.isFloatType=void 0;var Z=Y(566),ee=Y(601),re=Y(690),ne=Y(724),le=Y(360),se=Y(126),ie={supportsWebGL2:void 0,supportsHighpVertex:void 0,supportsHighpFragment:void 0,mediumpVertexPrecision:void 0,mediumpFragmentPrecision:void 0};function ge(We){return We===ee.FLOAT||We===ee.HALF_FLOAT}W.isFloatType=ge;function fe(We){return We===ee.UNSIGNED_BYTE||We===ee.UNSIGNED_SHORT||We===ee.UNSIGNED_INT}W.isUnsignedIntType=fe;function ae(We){return We===ee.BYTE||We===ee.SHORT||We===ee.INT}W.isSignedIntType=ae;function ue(We){return fe(We)||ae(We)}W.isIntType=ue;function pe(We){for(var Re="",Ue=Object.keys(We),Le=0;Le<Ue.length;Le++){var Ge=Ue[Le];if(!(0,Z.isString)(Ge)||!(0,Z.isString)(We[Ge]))throw new Error("GPUProgram compile time constants must be passed in as key value pairs that are both strings, got key value pair of type [".concat(typeof Ge," : ").concat(typeof We[Ge],"] for key ").concat(Ge,"."));Re+="#define ".concat(Ge," ").concat(We[Ge],`
`)}return Re}function _e(We,Re,Ue,Le,Ge){var ke,He=We===ee.GLSL3?"#version ".concat(ee.GLSL3,`
`):"",Ke=Le?pe(Le):"",$e=pe((ke={},ke[ee.GPUIO_INT_PRECISION]="".concat((0,re.intForPrecision)(Re)),ke[ee.GPUIO_FLOAT_PRECISION]="".concat((0,re.intForPrecision)(Ue)),ke));return"".concat(He).concat(Ge||"").concat(Ke).concat($e).concat(ne.PRECISION_SOURCE)}W.makeShaderHeader=_e;function xe(We,Re,Ue,Le,Ge,ke,He,Ke,$e,Qe,Ne){Ne===void 0&&(Ne=!1);var Ce=We.createShader(ke);if(!Ce)return Ke("Unable to init gl shader."),null;var Ze=_e(Re,Ue,Le,$e,Qe),at="".concat(Ze).concat(Ge);if(We.shaderSource(Ce,at),We.compileShader(Ce),Ne){var st=We.getShaderParameter(Ce,We.COMPILE_STATUS);if(!st)return console.log(at.split(`
`).map(function(Se,ce){return"".concat(ce,"	").concat(Se)}).join(`
`)),Ke("Could not compile ".concat(ke===We.FRAGMENT_SHADER?"fragment":"vertex",' shader for program "').concat(He,'": ').concat(We.getShaderInfoLog(Ce),".")),null}return Ce}W.compileShader=xe;function be(We,Re,Ue,Le,Ge){var ke=We.createProgram();if(!ke){Ge('Unable to init GL program for GPUProgram "'.concat(Le,'", gl.createProgram() has failed.'));return}We.attachShader(ke,Re),We.attachShader(ke,Ue),We.linkProgram(ke);var He=We.getProgramParameter(ke,We.LINK_STATUS);if(!He){Ge('GPUProgram "'.concat(Le,'" failed to link: ').concat(We.getProgramInfoLog(ke)));return}return ke}W.initGLProgram=be;function Te(We){return typeof WebGL2RenderingContext<"u"&&We instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&We instanceof WebGL2ComputeRenderingContext}W.isWebGL2=Te;function ye(){if(ie.supportsWebGL2===void 0){var We=document.createElement("canvas").getContext(ee.WEBGL2);ie.supportsWebGL2=Te(We)}return ie.supportsWebGL2}W.isWebGL2Supported=ye;function Ee(We){return We.checkFramebufferStatus(We.FRAMEBUFFER)==We.FRAMEBUFFER_COMPLETE}W.readyToRead=Ee;function he(We,Re){var Ue=document.createElement("canvas").getContext(ee.WEBGL1);if(!Ue)throw new Error("Unable to init webgl context.");try{var Le=xe(Ue,ee.GLSL1,ee.PRECISION_HIGH_P,ee.PRECISION_HIGH_P,We,Ue.VERTEX_SHADER,"highpFragmentTest",ee.DEFAULT_ERROR_CALLBACK),Ge=xe(Ue,ee.GLSL1,ee.PRECISION_HIGH_P,ee.PRECISION_HIGH_P,Re,Ue.FRAGMENT_SHADER,"highpFragmentTest",ee.DEFAULT_ERROR_CALLBACK),ke=be(Ue,Le,Ge,"highpFragmentTest",ee.DEFAULT_ERROR_CALLBACK);Ue.deleteProgram(ke),Ue.deleteShader(Le),Ue.deleteShader(Ge)}catch{return!1}return!0}function oe(){if(ie.supportsHighpVertex===void 0){var We=he("void main() { highp float test = 0.524; gl_Position = vec4(test, test, 0, 1); }","void main() { gl_FragColor = vec4(0); }");ie.supportsHighpVertex=We}return ie.supportsHighpVertex}W.isHighpSupportedInVertexShader=oe;function me(){if(ie.supportsHighpFragment===void 0){var We=he("void main() { gl_Position = vec4(0.5, 0.5, 0, 1); }","void main() { highp float test = 1.35; gl_FragColor = vec4(test); }");ie.supportsHighpFragment=We}return ie.supportsHighpFragment}W.isHighpSupportedInFragmentShader=me;function ve(We,Re,Ue,Le,Ge){var ke=be(Re,Le,Ue,We,ee.DEFAULT_ERROR_CALLBACK);if(!ke)throw new Error("Unable to init WebGLProgram.");var He=Re.getAttribLocation(ke,"position"),Ke=Re.createBuffer();Re.bindBuffer(Re.ARRAY_BUFFER,Ke),Re.bufferData(Re.ARRAY_BUFFER,1,Re.STATIC_DRAW),Re.enableVertexAttribArray(He),Re.vertexAttribPointer(He,1,Re.UNSIGNED_BYTE,!1,0,0),Re.viewport(0,0,1,1),Re.useProgram(ke),Ge(ke),Re.drawArrays(Re.POINTS,0,1);var $e=new Uint8Array(4);return Re.readPixels(0,0,1,1,Re.RGBA,Re.UNSIGNED_BYTE,$e),Re.disableVertexAttribArray(He),Re.deleteProgram(ke),Re.deleteShader(Le),Re.deleteShader(Ue),Re.deleteBuffer(Ke),$e}function we(){if(ie.mediumpVertexPrecision===void 0){var We=document.createElement("canvas"),Re=We.getContext("webgl");if(!Re)throw new Error("Unable to init webgl context.");var Ue=xe(Re,ee.GLSL1,ee.PRECISION_MEDIUM_P,ee.PRECISION_MEDIUM_P,`
	attribute vec4 position;  // needed because of another bug in Safari
	uniform mediump vec3 v;
	varying mediump vec4 v_result;
	void main() {
		gl_Position = position;
		gl_PointSize = 1.0;
		v_result = vec4(normalize(v) * 0.5 + 0.5, 1);
	}
		`,Re.VERTEX_SHADER,"mediumpPrecisionVertexTest",ee.DEFAULT_ERROR_CALLBACK);if(!Ue)throw new Error("Unable to init vertex shader.");var Le=xe(Re,ee.GLSL1,ee.PRECISION_MEDIUM_P,ee.PRECISION_MEDIUM_P,`
	varying mediump vec4 v_result;
	void main() {
		gl_FragColor = v_result;
	}
		`,Re.FRAGMENT_SHADER,"mediumpPrecisionVertexTest",ee.DEFAULT_ERROR_CALLBACK);if(!Le)throw new Error("Unable to init fragment shader.");var Ge=Math.pow(2,31)-1,ke=Math.sqrt(Ge),He=(ke/Math.sqrt(ke*ke*3)*.5+.5)*255|0,Ke=ve("mediumpPrecisionVertexTest",Re,Le,Ue,function(Qe){var Ne=Re.getUniformLocation(Qe,"v");Re.uniform3f(Ne,ke,ke,ke)}),$e=Math.abs(Ke[0]-He)>16;ie.mediumpVertexPrecision=$e?ee.PRECISION_MEDIUM_P:ee.PRECISION_HIGH_P}return ie.mediumpVertexPrecision}W.getVertexShaderMediumpPrecision=we;function Pe(){if(ie.mediumpFragmentPrecision===void 0){var We=document.createElement("canvas"),Re=We.getContext("webgl");if(!Re)throw new Error("Unable to init webgl context.");var Ue=xe(Re,ee.GLSL1,ee.PRECISION_MEDIUM_P,ee.PRECISION_MEDIUM_P,`
	attribute vec4 position;  // needed because of another bug in Safari
	void main() {
		gl_Position = position;
		gl_PointSize = 1.0;
	}
		`,Re.VERTEX_SHADER,"mediumpPrecisionFragmentTest",ee.DEFAULT_ERROR_CALLBACK);if(!Ue)throw new Error("Unable to init vertex shader.");var Le=xe(Re,ee.GLSL1,ee.PRECISION_MEDIUM_P,ee.PRECISION_MEDIUM_P,`
	uniform mediump vec3 v;
	void main() {
		gl_FragColor = vec4(normalize(v) * 0.5 + 0.5, 1);
	}
		`,Re.FRAGMENT_SHADER,"mediumpPrecisionFragmentTest",ee.DEFAULT_ERROR_CALLBACK);if(!Le)throw new Error("Unable to init fragment shader.");var Ge=Math.pow(2,31)-1,ke=Math.sqrt(Ge),He=(ke/Math.sqrt(ke*ke*3)*.5+.5)*255|0,Ke=ve("mediumpPrecisionFragmentTest",Re,Le,Ue,function(Qe){var Ne=Re.getUniformLocation(Qe,"v");Re.uniform3f(Ne,ke,ke,ke)}),$e=Math.abs(Ke[0]-He)>16;ie.mediumpFragmentPrecision=$e?ee.PRECISION_MEDIUM_P:ee.PRECISION_HIGH_P}return ie.mediumpFragmentPrecision}W.getFragmentShaderMediumpPrecision=Pe;function Me(We){return We>0&&(We&We-1)==0}W.isPowerOf2=Me;function De(We){for(var Re=new Float32Array(We),Ue=0;Ue<We;Ue++)Re[Ue]=Ue;return Re}W.initSequentialFloatArray=De;function Oe(We){return We=(0,se.stripVersion)(We),We=(0,se.stripPrecision)(We),We=(0,se.stripComments)(We),We}function Ie(We){return We=(0,se.glsl1Sampler2D)(We),We=(0,se.glsl1Uint)(We),We=(0,se.glsl1Texture)(We),We}function Be(We){return We=Ie(We),We=(0,se.glsl1VertexIn)(We),We=(0,se.glsl1VertexOut)(We),We}function ze(We,Re){return We=Ie(We),We=(0,se.glsl1FragmentIn)(We),(0,se.glsl1FragmentOut)(We,Re)}W.convertFragmentShaderToGLSL1=ze;function et(We,Re){return We=Oe(We),oe()||(console.warn("highp not supported in vertex shader in this browser, falling back to mediump."),We=(0,se.highpToMediump)(We)),Re===ee.GLSL3?We:Be(We)}W.preprocessVertexShader=et;function qe(We,Re,Ue){var Le;We=Oe(We),(0,se.checkFragmentShaderForFragColor)(We,Re,Ue),me()||(console.warn("highp not supported in fragment shader in this browser, falling back to mediump."),We=(0,se.highpToMediump)(We)),We=(0,le.fragmentShaderPolyfills)(We,Re)+We;var Ge;if(Le=(0,le.texturePolyfill)(We),We=Le.shaderSource,Ge=Le.samplerUniforms,Re!==ee.GLSL3){for(var ke=ze(We,Ue),He=0,Ke=ke.length;He<Ke;He++)ke[He]=(0,le.GLSL1Polyfills)(ke[He])+ke[He];if(We=ke.shift(),ke.length)return{shaderSource:We,samplerUniforms:Ge,additionalSources:ke}}return{shaderSource:We,samplerUniforms:Ge}}W.preprocessFragmentShader=qe;function je(We,Re,Ue,Le){if(Re===ee.FLOAT){if((0,Z.isArray)(We)){for(var Ge=0;Ge<We.length;Ge++)if(!(0,Z.isFiniteNumber)(We[Ge]))throw new Error("Invalid value ".concat(JSON.stringify(We),' for uniform "').concat(Ue,'" in program "').concat(Le,'", expected float or float[] of length 1-4.'))}else if(!(0,Z.isFiniteNumber)(We))throw new Error("Invalid value ".concat(JSON.stringify(We),' for uniform "').concat(Ue,'" in program "').concat(Le,'", expected float or float[] of length 1-4.'));if(!(0,Z.isArray)(We)||We.length===1)return ee.FLOAT_1D_UNIFORM;if(We.length===2)return ee.FLOAT_2D_UNIFORM;if(We.length===3)return ee.FLOAT_3D_UNIFORM;if(We.length===4)return ee.FLOAT_4D_UNIFORM;throw new Error("Invalid value ".concat(JSON.stringify(We),' for uniform "').concat(Ue,'" in program "').concat(Le,'", expected float or float[] of length 1-4.'))}else if(Re===ee.INT){if((0,Z.isArray)(We)){for(var Ge=0;Ge<We.length;Ge++)if(!(0,Z.isInteger)(We[Ge]))throw new Error("Invalid value ".concat(JSON.stringify(We),' for uniform "').concat(Ue,'" in program "').concat(Le,'", expected int or int[] of length 1-4.'))}else if(!(0,Z.isInteger)(We))throw new Error("Invalid value ".concat(JSON.stringify(We),' for uniform "').concat(Ue,'" in program "').concat(Le,'", expected int or int[] of length 1-4.'));if(!(0,Z.isArray)(We)||We.length===1)return ee.INT_1D_UNIFORM;if(We.length===2)return ee.INT_2D_UNIFORM;if(We.length===3)return ee.INT_3D_UNIFORM;if(We.length===4)return ee.INT_4D_UNIFORM;throw new Error("Invalid value ".concat(JSON.stringify(We),' for uniform "').concat(Ue,'" in program "').concat(Le,'", expected int or int[] of length 1-4.'))}else if(Re===ee.UINT){if((0,Z.isArray)(We)){for(var Ge=0;Ge<We.length;Ge++)if(!(0,Z.isNonNegativeInteger)(We[Ge]))throw new Error("Invalid value ".concat(JSON.stringify(We),' for uniform "').concat(Ue,'" in program "').concat(Le,'", expected uint or uint[] of length 1-4.'))}else if(!(0,Z.isNonNegativeInteger)(We))throw new Error("Invalid value ".concat(JSON.stringify(We),' for uniform "').concat(Ue,'" in program "').concat(Le,'", expected uint or uint[] of length 1-4.'));if(!(0,Z.isArray)(We)||We.length===1)return ee.UINT_1D_UNIFORM;if(We.length===2)return ee.UINT_2D_UNIFORM;if(We.length===3)return ee.UINT_3D_UNIFORM;if(We.length===4)return ee.UINT_4D_UNIFORM;throw new Error("Invalid value ".concat(JSON.stringify(We),' for uniform "').concat(Ue,'" in program "').concat(Le,'", expected uint or uint[] of length 1-4.'))}else if(Re===ee.BOOL){if((0,Z.isArray)(We)){for(var Ge=0;Ge<We.length;Ge++)if(!(0,Z.isBoolean)(We[Ge]))throw new Error("Invalid value ".concat(JSON.stringify(We),' for uniform "').concat(Ue,'" in program "').concat(Le,'", expected bool or bool[] of length 1-4.'))}else if(!(0,Z.isBoolean)(We))throw new Error("Invalid value ".concat(JSON.stringify(We),' for uniform "').concat(Ue,'" in program "').concat(Le,'", expected bool or bool[] of length 1-4.'));if(!(0,Z.isArray)(We)||We.length===1)return ee.BOOL_1D_UNIFORM;if(We.length===2)return ee.BOOL_2D_UNIFORM;if(We.length===3)return ee.BOOL_3D_UNIFORM;if(We.length===4)return ee.BOOL_4D_UNIFORM;throw new Error("Invalid value ".concat(JSON.stringify(We),' for uniform "').concat(Ue,'" in program "').concat(Le,'", expected boolean.'))}else throw new Error('Invalid type "'.concat(Re,'" for uniform "').concat(Ue,'" in program "').concat(Le,'", expected ').concat(ee.FLOAT," or ").concat(ee.INT," or ").concat(ee.BOOL,"."))}W.uniformInternalTypeForValue=je;function it(We,Re){return Re.findIndex(function(Ue){return Ue===We||Ue.layer===We})}W.indexOfLayerInArray=it;function ct(We,Re,Ue,Le){return new Promise(function(Ge,ke){function He(){var Ke=We.clientWaitSync(Re,Ue,0);if(Ke===We.WAIT_FAILED){ke();return}if(Ke===We.TIMEOUT_EXPIRED){setTimeout(He,Le);return}Ge()}He()})}function rt(We,Re,Ue,Le,Ge){return J(this,void 0,void 0,function(){var ke;return te(this,function(He){switch(He.label){case 0:return ke=We.fenceSync(We.SYNC_GPU_COMMANDS_COMPLETE,0),We.flush(),[4,ct(We,ke,0,10)];case 1:return He.sent(),We.deleteSync(ke),We.bindBuffer(Re,Ue),We.getBufferSubData(Re,Le,Ge),We.bindBuffer(Re,null),[2]}})})}function ut(We,Re,Ue,Le,Ge,ke,He,Ke){return J(this,void 0,void 0,function(){var $e;return te(this,function(Qe){switch(Qe.label){case 0:return $e=We.createBuffer(),We.bindBuffer(We.PIXEL_PACK_BUFFER,$e),We.bufferData(We.PIXEL_PACK_BUFFER,Ke.byteLength,We.STREAM_READ),We.readPixels(Re,Ue,Le,Ge,ke,He,0),We.bindBuffer(We.PIXEL_PACK_BUFFER,null),[4,rt(We,We.PIXEL_PACK_BUFFER,$e,0,Ke)];case 1:return Qe.sent(),We.deleteBuffer($e),[2,Ke]}})})}W.readPixelsAsync=ut},557:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.getFloat16=ee,W.setFloat16=re;var J=Y(802),te=Y(605),Z=Y(983);function ee(ne,le,...se){return(0,te.convertToNumber)((0,Z.DataViewPrototypeGetUint16)(ne,le,...(0,J.safeIfNeeded)(se)))}function re(ne,le,se,...ie){return(0,Z.DataViewPrototypeSetUint16)(ne,le,(0,te.roundToFloat16Bits)(se),...(0,J.safeIfNeeded)(ie))}},310:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.isFloat16Array=ge;var J=Y(802),te=Y(299),Z=Y(605),ee=Y(554),re=Y(930),ne=Y(983),le=Y(700);const se=2,ie=new ne.NativeWeakMap;function ge(ye){return(0,ne.WeakMapPrototypeHas)(ie,ye)||!(0,ne.ArrayBufferIsView)(ye)&&(0,te.hasFloat16ArrayBrand)(ye)}function fe(ye){if(!ge(ye))throw(0,ne.NativeTypeError)(re.THIS_IS_NOT_A_FLOAT16ARRAY_OBJECT)}function ae(ye,Ee){const he=ge(ye),oe=(0,ee.isNativeTypedArray)(ye);if(!he&&!oe)throw(0,ne.NativeTypeError)(re.SPECIES_CONSTRUCTOR_DIDNT_RETURN_TYPEDARRAY_OBJECT);if(typeof Ee=="number"){let me;if(he){const ve=ue(ye);me=(0,ne.TypedArrayPrototypeGetLength)(ve)}else me=(0,ne.TypedArrayPrototypeGetLength)(ye);if(me<Ee)throw(0,ne.NativeTypeError)(re.DERIVED_CONSTRUCTOR_CREATED_TYPEDARRAY_OBJECT_WHICH_WAS_TOO_SMALL_LENGTH)}if((0,ee.isNativeBigIntTypedArray)(ye))throw(0,ne.NativeTypeError)(re.CANNOT_MIX_BIGINT_AND_OTHER_TYPES)}function ue(ye){const Ee=(0,ne.WeakMapPrototypeGet)(ie,ye);if(Ee!==void 0){const me=(0,ne.TypedArrayPrototypeGetBuffer)(Ee);if((0,le.IsDetachedBuffer)(me))throw(0,ne.NativeTypeError)(re.ATTEMPTING_TO_ACCESS_DETACHED_ARRAYBUFFER);return Ee}const he=ye.buffer;if((0,le.IsDetachedBuffer)(he))throw(0,ne.NativeTypeError)(re.ATTEMPTING_TO_ACCESS_DETACHED_ARRAYBUFFER);const oe=(0,ne.ReflectConstruct)(be,[he,ye.byteOffset,ye.length],ye.constructor);return(0,ne.WeakMapPrototypeGet)(ie,oe)}function pe(ye){const Ee=(0,ne.TypedArrayPrototypeGetLength)(ye),he=[];for(let oe=0;oe<Ee;++oe)he[oe]=(0,Z.convertToNumber)(ye[oe]);return he}const _e=new ne.NativeWeakSet;for(const ye of(0,ne.ReflectOwnKeys)(ne.TypedArrayPrototype)){if(ye===ne.SymbolToStringTag)continue;const Ee=(0,ne.ReflectGetOwnPropertyDescriptor)(ne.TypedArrayPrototype,ye);(0,ne.ObjectHasOwn)(Ee,"get")&&typeof Ee.get=="function"&&(0,ne.WeakSetPrototypeAdd)(_e,Ee.get)}const xe=(0,ne.ObjectFreeze)({get(ye,Ee,he){return(0,ee.isCanonicalIntegerIndexString)(Ee)&&(0,ne.ObjectHasOwn)(ye,Ee)?(0,Z.convertToNumber)((0,ne.ReflectGet)(ye,Ee)):(0,ne.WeakSetPrototypeHas)(_e,(0,ne.ObjectPrototype__lookupGetter__)(ye,Ee))?(0,ne.ReflectGet)(ye,Ee):(0,ne.ReflectGet)(ye,Ee,he)},set(ye,Ee,he,oe){return(0,ee.isCanonicalIntegerIndexString)(Ee)&&(0,ne.ObjectHasOwn)(ye,Ee)?(0,ne.ReflectSet)(ye,Ee,(0,Z.roundToFloat16Bits)(he)):(0,ne.ReflectSet)(ye,Ee,he,oe)},getOwnPropertyDescriptor(ye,Ee){if((0,ee.isCanonicalIntegerIndexString)(Ee)&&(0,ne.ObjectHasOwn)(ye,Ee)){const he=(0,ne.ReflectGetOwnPropertyDescriptor)(ye,Ee);return he.value=(0,Z.convertToNumber)(he.value),he}return(0,ne.ReflectGetOwnPropertyDescriptor)(ye,Ee)},defineProperty(ye,Ee,he){return(0,ee.isCanonicalIntegerIndexString)(Ee)&&(0,ne.ObjectHasOwn)(ye,Ee)&&(0,ne.ObjectHasOwn)(he,"value")&&(he.value=(0,Z.roundToFloat16Bits)(he.value)),(0,ne.ReflectDefineProperty)(ye,Ee,he)}});class be{constructor(Ee,he,oe){let me;if(ge(Ee))me=(0,ne.ReflectConstruct)(ne.NativeUint16Array,[ue(Ee)],new.target);else if((0,ee.isObject)(Ee)&&!(0,ee.isArrayBuffer)(Ee)){let we,Pe;if((0,ee.isNativeTypedArray)(Ee)){we=Ee,Pe=(0,ne.TypedArrayPrototypeGetLength)(Ee);const Me=(0,ne.TypedArrayPrototypeGetBuffer)(Ee),De=(0,ee.isSharedArrayBuffer)(Me)?ne.NativeArrayBuffer:(0,le.SpeciesConstructor)(Me,ne.NativeArrayBuffer);if((0,le.IsDetachedBuffer)(Me))throw(0,ne.NativeTypeError)(re.ATTEMPTING_TO_ACCESS_DETACHED_ARRAYBUFFER);if((0,ee.isNativeBigIntTypedArray)(Ee))throw(0,ne.NativeTypeError)(re.CANNOT_MIX_BIGINT_AND_OTHER_TYPES);const Oe=new De(Pe*se);me=(0,ne.ReflectConstruct)(ne.NativeUint16Array,[Oe],new.target)}else{const Me=Ee[ne.SymbolIterator];if(Me!=null&&typeof Me!="function")throw(0,ne.NativeTypeError)(re.ITERATOR_PROPERTY_IS_NOT_CALLABLE);Me!=null?(0,ee.isOrdinaryArray)(Ee)?(we=Ee,Pe=Ee.length):(we=[...Ee],Pe=we.length):(we=Ee,Pe=(0,le.ToLength)(we.length)),me=(0,ne.ReflectConstruct)(ne.NativeUint16Array,[Pe],new.target)}for(let Me=0;Me<Pe;++Me)me[Me]=(0,Z.roundToFloat16Bits)(we[Me])}else me=(0,ne.ReflectConstruct)(ne.NativeUint16Array,arguments,new.target);const ve=new ne.NativeProxy(me,xe);return(0,ne.WeakMapPrototypeSet)(ie,ve,me),ve}static from(Ee,...he){const oe=this;if(!(0,ne.ReflectHas)(oe,te.brand))throw(0,ne.NativeTypeError)(re.THIS_CONSTRUCTOR_IS_NOT_A_SUBCLASS_OF_FLOAT16ARRAY);if(oe===be){if(ge(Ee)&&he.length===0){const Oe=ue(Ee),Ie=new ne.NativeUint16Array((0,ne.TypedArrayPrototypeGetBuffer)(Oe),(0,ne.TypedArrayPrototypeGetByteOffset)(Oe),(0,ne.TypedArrayPrototypeGetLength)(Oe));return new be((0,ne.TypedArrayPrototypeGetBuffer)((0,ne.TypedArrayPrototypeSlice)(Ie)))}if(he.length===0)return new be((0,ne.TypedArrayPrototypeGetBuffer)((0,ne.Uint16ArrayFrom)(Ee,Z.roundToFloat16Bits)));const Me=he[0],De=he[1];return new be((0,ne.TypedArrayPrototypeGetBuffer)((0,ne.Uint16ArrayFrom)(Ee,function(Oe,...Ie){return(0,Z.roundToFloat16Bits)((0,ne.ReflectApply)(Me,this,[Oe,...(0,J.safeIfNeeded)(Ie)]))},De)))}let me,ve;const we=Ee[ne.SymbolIterator];if(we!=null&&typeof we!="function")throw(0,ne.NativeTypeError)(re.ITERATOR_PROPERTY_IS_NOT_CALLABLE);if(we!=null)(0,ee.isOrdinaryArray)(Ee)?(me=Ee,ve=Ee.length):(0,ee.isOrdinaryNativeTypedArray)(Ee)?(me=Ee,ve=(0,ne.TypedArrayPrototypeGetLength)(Ee)):(me=[...Ee],ve=me.length);else{if(Ee==null)throw(0,ne.NativeTypeError)(re.CANNOT_CONVERT_UNDEFINED_OR_NULL_TO_OBJECT);me=(0,ne.NativeObject)(Ee),ve=(0,le.ToLength)(me.length)}const Pe=new oe(ve);if(he.length===0)for(let Me=0;Me<ve;++Me)Pe[Me]=me[Me];else{const Me=he[0],De=he[1];for(let Oe=0;Oe<ve;++Oe)Pe[Oe]=(0,ne.ReflectApply)(Me,De,[me[Oe],Oe])}return Pe}static of(...Ee){const he=this;if(!(0,ne.ReflectHas)(he,te.brand))throw(0,ne.NativeTypeError)(re.THIS_CONSTRUCTOR_IS_NOT_A_SUBCLASS_OF_FLOAT16ARRAY);const oe=Ee.length;if(he===be){const ve=new be(oe),we=ue(ve);for(let Pe=0;Pe<oe;++Pe)we[Pe]=(0,Z.roundToFloat16Bits)(Ee[Pe]);return ve}const me=new he(oe);for(let ve=0;ve<oe;++ve)me[ve]=Ee[ve];return me}keys(){fe(this);const Ee=ue(this);return(0,ne.TypedArrayPrototypeKeys)(Ee)}values(){fe(this);const Ee=ue(this);return(0,J.wrap)(function*(){for(const he of(0,ne.TypedArrayPrototypeValues)(Ee))yield(0,Z.convertToNumber)(he)}())}entries(){fe(this);const Ee=ue(this);return(0,J.wrap)(function*(){for(const[he,oe]of(0,ne.TypedArrayPrototypeEntries)(Ee))yield[he,(0,Z.convertToNumber)(oe)]}())}at(Ee){fe(this);const he=ue(this),oe=(0,ne.TypedArrayPrototypeGetLength)(he),me=(0,le.ToIntegerOrInfinity)(Ee),ve=me>=0?me:oe+me;if(!(ve<0||ve>=oe))return(0,Z.convertToNumber)(he[ve])}map(Ee,...he){fe(this);const oe=ue(this),me=(0,ne.TypedArrayPrototypeGetLength)(oe),ve=he[0],we=(0,le.SpeciesConstructor)(oe,be);if(we===be){const Me=new be(me),De=ue(Me);for(let Oe=0;Oe<me;++Oe){const Ie=(0,Z.convertToNumber)(oe[Oe]);De[Oe]=(0,Z.roundToFloat16Bits)((0,ne.ReflectApply)(Ee,ve,[Ie,Oe,this]))}return Me}const Pe=new we(me);ae(Pe,me);for(let Me=0;Me<me;++Me){const De=(0,Z.convertToNumber)(oe[Me]);Pe[Me]=(0,ne.ReflectApply)(Ee,ve,[De,Me,this])}return Pe}filter(Ee,...he){fe(this);const oe=ue(this),me=(0,ne.TypedArrayPrototypeGetLength)(oe),ve=he[0],we=[];for(let De=0;De<me;++De){const Oe=(0,Z.convertToNumber)(oe[De]);(0,ne.ReflectApply)(Ee,ve,[Oe,De,this])&&(0,ne.ArrayPrototypePush)(we,Oe)}const Pe=(0,le.SpeciesConstructor)(oe,be),Me=new Pe(we);return ae(Me),Me}reduce(Ee,...he){fe(this);const oe=ue(this),me=(0,ne.TypedArrayPrototypeGetLength)(oe);if(me===0&&he.length===0)throw(0,ne.NativeTypeError)(re.REDUCE_OF_EMPTY_ARRAY_WITH_NO_INITIAL_VALUE);let ve,we;he.length===0?(ve=(0,Z.convertToNumber)(oe[0]),we=1):(ve=he[0],we=0);for(let Pe=we;Pe<me;++Pe)ve=Ee(ve,(0,Z.convertToNumber)(oe[Pe]),Pe,this);return ve}reduceRight(Ee,...he){fe(this);const oe=ue(this),me=(0,ne.TypedArrayPrototypeGetLength)(oe);if(me===0&&he.length===0)throw(0,ne.NativeTypeError)(re.REDUCE_OF_EMPTY_ARRAY_WITH_NO_INITIAL_VALUE);let ve,we;he.length===0?(ve=(0,Z.convertToNumber)(oe[me-1]),we=me-2):(ve=he[0],we=me-1);for(let Pe=we;Pe>=0;--Pe)ve=Ee(ve,(0,Z.convertToNumber)(oe[Pe]),Pe,this);return ve}forEach(Ee,...he){fe(this);const oe=ue(this),me=(0,ne.TypedArrayPrototypeGetLength)(oe),ve=he[0];for(let we=0;we<me;++we)(0,ne.ReflectApply)(Ee,ve,[(0,Z.convertToNumber)(oe[we]),we,this])}find(Ee,...he){fe(this);const oe=ue(this),me=(0,ne.TypedArrayPrototypeGetLength)(oe),ve=he[0];for(let we=0;we<me;++we){const Pe=(0,Z.convertToNumber)(oe[we]);if((0,ne.ReflectApply)(Ee,ve,[Pe,we,this]))return Pe}}findIndex(Ee,...he){fe(this);const oe=ue(this),me=(0,ne.TypedArrayPrototypeGetLength)(oe),ve=he[0];for(let we=0;we<me;++we){const Pe=(0,Z.convertToNumber)(oe[we]);if((0,ne.ReflectApply)(Ee,ve,[Pe,we,this]))return we}return-1}findLast(Ee,...he){fe(this);const oe=ue(this),me=(0,ne.TypedArrayPrototypeGetLength)(oe),ve=he[0];for(let we=me-1;we>=0;--we){const Pe=(0,Z.convertToNumber)(oe[we]);if((0,ne.ReflectApply)(Ee,ve,[Pe,we,this]))return Pe}}findLastIndex(Ee,...he){fe(this);const oe=ue(this),me=(0,ne.TypedArrayPrototypeGetLength)(oe),ve=he[0];for(let we=me-1;we>=0;--we){const Pe=(0,Z.convertToNumber)(oe[we]);if((0,ne.ReflectApply)(Ee,ve,[Pe,we,this]))return we}return-1}every(Ee,...he){fe(this);const oe=ue(this),me=(0,ne.TypedArrayPrototypeGetLength)(oe),ve=he[0];for(let we=0;we<me;++we)if(!(0,ne.ReflectApply)(Ee,ve,[(0,Z.convertToNumber)(oe[we]),we,this]))return!1;return!0}some(Ee,...he){fe(this);const oe=ue(this),me=(0,ne.TypedArrayPrototypeGetLength)(oe),ve=he[0];for(let we=0;we<me;++we)if((0,ne.ReflectApply)(Ee,ve,[(0,Z.convertToNumber)(oe[we]),we,this]))return!0;return!1}set(Ee,...he){fe(this);const oe=ue(this),me=(0,le.ToIntegerOrInfinity)(he[0]);if(me<0)throw(0,ne.NativeRangeError)(re.OFFSET_IS_OUT_OF_BOUNDS);if(Ee==null)throw(0,ne.NativeTypeError)(re.CANNOT_CONVERT_UNDEFINED_OR_NULL_TO_OBJECT);if((0,ee.isNativeBigIntTypedArray)(Ee))throw(0,ne.NativeTypeError)(re.CANNOT_MIX_BIGINT_AND_OTHER_TYPES);if(ge(Ee))return(0,ne.TypedArrayPrototypeSet)(ue(this),ue(Ee),me);if((0,ee.isNativeTypedArray)(Ee)){const Me=(0,ne.TypedArrayPrototypeGetBuffer)(Ee);if((0,le.IsDetachedBuffer)(Me))throw(0,ne.NativeTypeError)(re.ATTEMPTING_TO_ACCESS_DETACHED_ARRAYBUFFER)}const ve=(0,ne.TypedArrayPrototypeGetLength)(oe),we=(0,ne.NativeObject)(Ee),Pe=(0,le.ToLength)(we.length);if(me===1/0||Pe+me>ve)throw(0,ne.NativeRangeError)(re.OFFSET_IS_OUT_OF_BOUNDS);for(let Me=0;Me<Pe;++Me)oe[Me+me]=(0,Z.roundToFloat16Bits)(we[Me])}reverse(){fe(this);const Ee=ue(this);return(0,ne.TypedArrayPrototypeReverse)(Ee),this}fill(Ee,...he){fe(this);const oe=ue(this);return(0,ne.TypedArrayPrototypeFill)(oe,(0,Z.roundToFloat16Bits)(Ee),...(0,J.safeIfNeeded)(he)),this}copyWithin(Ee,he,...oe){fe(this);const me=ue(this);return(0,ne.TypedArrayPrototypeCopyWithin)(me,Ee,he,...(0,J.safeIfNeeded)(oe)),this}sort(Ee){fe(this);const he=ue(this),oe=Ee!==void 0?Ee:le.defaultCompare;return(0,ne.TypedArrayPrototypeSort)(he,(me,ve)=>oe((0,Z.convertToNumber)(me),(0,Z.convertToNumber)(ve))),this}slice(Ee,he){fe(this);const oe=ue(this),me=(0,le.SpeciesConstructor)(oe,be);if(me===be){const et=new ne.NativeUint16Array((0,ne.TypedArrayPrototypeGetBuffer)(oe),(0,ne.TypedArrayPrototypeGetByteOffset)(oe),(0,ne.TypedArrayPrototypeGetLength)(oe));return new be((0,ne.TypedArrayPrototypeGetBuffer)((0,ne.TypedArrayPrototypeSlice)(et,Ee,he)))}const ve=(0,ne.TypedArrayPrototypeGetLength)(oe),we=(0,le.ToIntegerOrInfinity)(Ee),Pe=he===void 0?ve:(0,le.ToIntegerOrInfinity)(he);let Me;we===-1/0?Me=0:we<0?Me=ve+we>0?ve+we:0:Me=ve<we?ve:we;let De;Pe===-1/0?De=0:Pe<0?De=ve+Pe>0?ve+Pe:0:De=ve<Pe?ve:Pe;const Oe=De-Me>0?De-Me:0,Ie=new me(Oe);if(ae(Ie,Oe),Oe===0)return Ie;const Be=(0,ne.TypedArrayPrototypeGetBuffer)(oe);if((0,le.IsDetachedBuffer)(Be))throw(0,ne.NativeTypeError)(re.ATTEMPTING_TO_ACCESS_DETACHED_ARRAYBUFFER);let ze=0;for(;Me<De;)Ie[ze]=(0,Z.convertToNumber)(oe[Me]),++Me,++ze;return Ie}subarray(Ee,he){fe(this);const oe=ue(this),me=(0,le.SpeciesConstructor)(oe,be),ve=new ne.NativeUint16Array((0,ne.TypedArrayPrototypeGetBuffer)(oe),(0,ne.TypedArrayPrototypeGetByteOffset)(oe),(0,ne.TypedArrayPrototypeGetLength)(oe)),we=(0,ne.TypedArrayPrototypeSubarray)(ve,Ee,he),Pe=new me((0,ne.TypedArrayPrototypeGetBuffer)(we),(0,ne.TypedArrayPrototypeGetByteOffset)(we),(0,ne.TypedArrayPrototypeGetLength)(we));return ae(Pe),Pe}indexOf(Ee,...he){fe(this);const oe=ue(this),me=(0,ne.TypedArrayPrototypeGetLength)(oe);let ve=(0,le.ToIntegerOrInfinity)(he[0]);if(ve===1/0)return-1;ve<0&&(ve+=me,ve<0&&(ve=0));for(let we=ve;we<me;++we)if((0,ne.ObjectHasOwn)(oe,we)&&(0,Z.convertToNumber)(oe[we])===Ee)return we;return-1}lastIndexOf(Ee,...he){fe(this);const oe=ue(this),me=(0,ne.TypedArrayPrototypeGetLength)(oe);let ve=he.length>=1?(0,le.ToIntegerOrInfinity)(he[0]):me-1;if(ve===-1/0)return-1;ve>=0?ve=ve<me-1?ve:me-1:ve+=me;for(let we=ve;we>=0;--we)if((0,ne.ObjectHasOwn)(oe,we)&&(0,Z.convertToNumber)(oe[we])===Ee)return we;return-1}includes(Ee,...he){fe(this);const oe=ue(this),me=(0,ne.TypedArrayPrototypeGetLength)(oe);let ve=(0,le.ToIntegerOrInfinity)(he[0]);if(ve===1/0)return!1;ve<0&&(ve+=me,ve<0&&(ve=0));const we=(0,ne.NumberIsNaN)(Ee);for(let Pe=ve;Pe<me;++Pe){const Me=(0,Z.convertToNumber)(oe[Pe]);if(we&&(0,ne.NumberIsNaN)(Me)||Me===Ee)return!0}return!1}join(Ee){fe(this);const he=ue(this),oe=pe(he);return(0,ne.ArrayPrototypeJoin)(oe,Ee)}toLocaleString(...Ee){fe(this);const he=ue(this),oe=pe(he);return(0,ne.ArrayPrototypeToLocaleString)(oe,...(0,J.safeIfNeeded)(Ee))}get[ne.SymbolToStringTag](){if(ge(this))return"Float16Array"}}W.Float16Array=be,(0,ne.ObjectDefineProperty)(be,"BYTES_PER_ELEMENT",{value:se}),(0,ne.ObjectDefineProperty)(be,te.brand,{}),(0,ne.ReflectSetPrototypeOf)(be,ne.TypedArray);const Te=be.prototype;(0,ne.ObjectDefineProperty)(Te,"BYTES_PER_ELEMENT",{value:se}),(0,ne.ObjectDefineProperty)(Te,ne.SymbolIterator,{value:Te.values,writable:!0,configurable:!0}),(0,ne.ReflectSetPrototypeOf)(Te,ne.TypedArrayPrototype)},802:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.safeIfNeeded=ee,W.wrap=le;var J=Y(983);const te=new J.NativeWeakMap,Z=(0,J.ObjectCreate)(null,{next:{value:function(){const ie=(0,J.WeakMapPrototypeGet)(te,this);return(0,J.ArrayIteratorPrototypeNext)(ie)}},[J.SymbolIterator]:{value:function(){return this}}});function ee(se){if(se[J.SymbolIterator]===J.NativeArrayPrototypeSymbolIterator)return se;const ie=(0,J.ObjectCreate)(Z);return(0,J.WeakMapPrototypeSet)(te,ie,(0,J.ArrayPrototypeSymbolIterator)(se)),ie}const re=new J.NativeWeakMap,ne=(0,J.ObjectCreate)(J.IteratorPrototype,{next:{value:function(){const ie=(0,J.WeakMapPrototypeGet)(re,this);return(0,J.GeneratorPrototypeNext)(ie)},writable:!0,configurable:!0}});for(const se of(0,J.ReflectOwnKeys)(J.ArrayIteratorPrototype))se!=="next"&&(0,J.ObjectDefineProperty)(ne,se,(0,J.ReflectGetOwnPropertyDescriptor)(J.ArrayIteratorPrototype,se));function le(se){const ie=(0,J.ObjectCreate)(ne);return(0,J.WeakMapPrototypeSet)(re,ie,se),ie}},299:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.hasFloat16ArrayBrand=re;var J=Y(554),te=Y(930),Z=Y(983);const ee=(0,Z.SymbolFor)("__Float16Array__");W.brand=ee;function re(ne){if(!(0,J.isObjectLike)(ne))return!1;const le=(0,Z.ReflectGetPrototypeOf)(ne);if(!(0,J.isObjectLike)(le))return!1;const se=le.constructor;if(se===void 0)return!1;if(!(0,J.isObject)(se))throw(0,Z.NativeTypeError)(te.THE_CONSTRUCTOR_PROPERTY_VALUE_IS_NOT_AN_OBJECT);return(0,Z.ReflectHas)(se,ee)}},605:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.convertToNumber=fe,W.roundToFloat16Bits=le;var J=Y(983);const te=new J.NativeArrayBuffer(4),Z=new J.NativeFloat32Array(te),ee=new J.NativeUint32Array(te),re=new J.NativeUint32Array(512),ne=new J.NativeUint32Array(512);for(let ae=0;ae<256;++ae){const ue=ae-127;ue<-27?(re[ae]=0,re[ae|256]=32768,ne[ae]=24,ne[ae|256]=24):ue<-14?(re[ae]=1024>>-ue-14,re[ae|256]=1024>>-ue-14|32768,ne[ae]=-ue-1,ne[ae|256]=-ue-1):ue<=15?(re[ae]=ue+15<<10,re[ae|256]=ue+15<<10|32768,ne[ae]=13,ne[ae|256]=13):ue<128?(re[ae]=31744,re[ae|256]=64512,ne[ae]=24,ne[ae|256]=24):(re[ae]=31744,re[ae|256]=64512,ne[ae]=13,ne[ae|256]=13)}function le(ae){Z[0]=ae;const ue=ee[0],pe=ue>>23&511;return re[pe]+((ue&8388607)>>ne[pe])}const se=new J.NativeUint32Array(2048),ie=new J.NativeUint32Array(64),ge=new J.NativeUint32Array(64);for(let ae=1;ae<1024;++ae){let ue=ae<<13,pe=0;for(;!(ue&8388608);)ue<<=1,pe-=8388608;ue&=-8388609,pe+=947912704,se[ae]=ue|pe}for(let ae=1024;ae<2048;++ae)se[ae]=939524096+(ae-1024<<13);for(let ae=1;ae<31;++ae)ie[ae]=ae<<23;ie[31]=1199570944,ie[32]=2147483648;for(let ae=33;ae<63;++ae)ie[ae]=2147483648+(ae-32<<23);ie[63]=3347054592;for(let ae=1;ae<64;++ae)ae!==32&&(ge[ae]=1024);function fe(ae){const ue=ae>>10;return ee[0]=se[ge[ue]+(ae&1023)]+ie[ue],Z[0]}},554:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.isArrayBuffer=ne,W.isCanonicalIntegerIndexString=ge,W.isNativeBigIntTypedArray=re,W.isNativeTypedArray=ee,W.isObject=te,W.isObjectLike=Z,W.isOrdinaryArray=se,W.isOrdinaryNativeTypedArray=ie,W.isSharedArrayBuffer=le;var J=Y(983);function te(fe){return fe!==null&&typeof fe=="object"||typeof fe=="function"}function Z(fe){return fe!==null&&typeof fe=="object"}function ee(fe){return(0,J.TypedArrayPrototypeGetSymbolToStringTag)(fe)!==void 0}function re(fe){const ae=(0,J.TypedArrayPrototypeGetSymbolToStringTag)(fe);return ae==="BigInt64Array"||ae==="BigUint64Array"}function ne(fe){try{return(0,J.ArrayBufferPrototypeGetByteLength)(fe),!0}catch{return!1}}function le(fe){if(J.NativeSharedArrayBuffer===null)return!1;try{return(0,J.SharedArrayBufferPrototypeGetByteLength)(fe),!0}catch{return!1}}function se(fe){return(0,J.ArrayIsArray)(fe)?fe[J.SymbolIterator]===J.NativeArrayPrototypeSymbolIterator?!0:fe[J.SymbolIterator]()[J.SymbolToStringTag]==="Array Iterator":!1}function ie(fe){return ee(fe)?fe[J.SymbolIterator]===J.NativeTypedArrayPrototypeSymbolIterator?!0:fe[J.SymbolIterator]()[J.SymbolToStringTag]==="Array Iterator":!1}function ge(fe){if(typeof fe!="string")return!1;const ae=+fe;return fe!==ae+""||!(0,J.NumberIsFinite)(ae)?!1:ae===(0,J.MathTrunc)(ae)}},930:(q,W)=>{Object.defineProperty(W,"__esModule",{value:!0});const Y="This is not an object";W.THIS_IS_NOT_AN_OBJECT=Y;const J="This is not a Float16Array object";W.THIS_IS_NOT_A_FLOAT16ARRAY_OBJECT=J;const te="This constructor is not a subclass of Float16Array";W.THIS_CONSTRUCTOR_IS_NOT_A_SUBCLASS_OF_FLOAT16ARRAY=te;const Z="The constructor property value is not an object";W.THE_CONSTRUCTOR_PROPERTY_VALUE_IS_NOT_AN_OBJECT=Z;const ee="Species constructor didn't return TypedArray object";W.SPECIES_CONSTRUCTOR_DIDNT_RETURN_TYPEDARRAY_OBJECT=ee;const re="Derived constructor created TypedArray object which was too small length";W.DERIVED_CONSTRUCTOR_CREATED_TYPEDARRAY_OBJECT_WHICH_WAS_TOO_SMALL_LENGTH=re;const ne="Attempting to access detached ArrayBuffer";W.ATTEMPTING_TO_ACCESS_DETACHED_ARRAYBUFFER=ne;const le="Cannot convert undefined or null to object";W.CANNOT_CONVERT_UNDEFINED_OR_NULL_TO_OBJECT=le;const se="Cannot mix BigInt and other types, use explicit conversions";W.CANNOT_MIX_BIGINT_AND_OTHER_TYPES=se;const ie="@@iterator property is not callable";W.ITERATOR_PROPERTY_IS_NOT_CALLABLE=ie;const ge="Reduce of empty array with no initial value";W.REDUCE_OF_EMPTY_ARRAY_WITH_NO_INITIAL_VALUE=ge;const fe="Offset is out of bounds";W.OFFSET_IS_OUT_OF_BOUNDS=fe},983:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0});var J=Y(930);function te(yt){return(ft,..._t)=>ee(yt,ft,_t)}function Z(yt,ft){return te(se(yt,ft).get)}const{apply:ee,construct:re,defineProperty:ne,get:le,getOwnPropertyDescriptor:se,getPrototypeOf:ie,has:ge,ownKeys:fe,set:ae,setPrototypeOf:ue}=Reflect;W.ReflectSetPrototypeOf=ue,W.ReflectSet=ae,W.ReflectOwnKeys=fe,W.ReflectHas=ge,W.ReflectGetPrototypeOf=ie,W.ReflectGetOwnPropertyDescriptor=se,W.ReflectGet=le,W.ReflectDefineProperty=ne,W.ReflectConstruct=re,W.ReflectApply=ee;const pe=Proxy;W.NativeProxy=pe;const{MAX_SAFE_INTEGER:_e,isFinite:xe,isNaN:be}=Number;W.NumberIsNaN=be,W.NumberIsFinite=xe,W.MAX_SAFE_INTEGER=_e;const{iterator:Te,species:ye,toStringTag:Ee,for:he}=Symbol;W.SymbolFor=he,W.SymbolToStringTag=Ee,W.SymbolSpecies=ye,W.SymbolIterator=Te;const oe=Object;W.NativeObject=oe;const{create:me,defineProperty:ve,freeze:we,is:Pe}=oe;W.ObjectIs=Pe,W.ObjectFreeze=we,W.ObjectDefineProperty=ve,W.ObjectCreate=me;const Me=oe.prototype,De=Me.__lookupGetter__?te(Me.__lookupGetter__):(yt,ft)=>{if(yt==null)throw kt(J.CANNOT_CONVERT_UNDEFINED_OR_NULL_TO_OBJECT);let _t=oe(yt);do{const Rt=se(_t,ft);if(Rt!==void 0)return Oe(Rt,"get")?Rt.get:void 0}while((_t=ie(_t))!==null)};W.ObjectPrototype__lookupGetter__=De;const Oe=oe.hasOwn||te(Me.hasOwnProperty);W.ObjectHasOwn=Oe;const Ie=Array,Be=Ie.isArray;W.ArrayIsArray=Be;const ze=Ie.prototype,et=te(ze.join);W.ArrayPrototypeJoin=et;const qe=te(ze.push);W.ArrayPrototypePush=qe;const je=te(ze.toLocaleString);W.ArrayPrototypeToLocaleString=je;const it=ze[Te];W.NativeArrayPrototypeSymbolIterator=it;const ct=te(it);W.ArrayPrototypeSymbolIterator=ct;const rt=Math.trunc;W.MathTrunc=rt;const ut=ArrayBuffer;W.NativeArrayBuffer=ut;const We=ut.isView;W.ArrayBufferIsView=We;const Re=ut.prototype,Ue=te(Re.slice);W.ArrayBufferPrototypeSlice=Ue;const Le=Z(Re,"byteLength");W.ArrayBufferPrototypeGetByteLength=Le;const Ge=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:null;W.NativeSharedArrayBuffer=Ge;const ke=Ge&&Z(Ge.prototype,"byteLength");W.SharedArrayBufferPrototypeGetByteLength=ke;const He=ie(Uint8Array);W.TypedArray=He;const Ke=He.from,$e=He.prototype;W.TypedArrayPrototype=$e;const Qe=$e[Te];W.NativeTypedArrayPrototypeSymbolIterator=Qe;const Ne=te($e.keys);W.TypedArrayPrototypeKeys=Ne;const Ce=te($e.values);W.TypedArrayPrototypeValues=Ce;const Ze=te($e.entries);W.TypedArrayPrototypeEntries=Ze;const at=te($e.set);W.TypedArrayPrototypeSet=at;const st=te($e.reverse);W.TypedArrayPrototypeReverse=st;const Se=te($e.fill);W.TypedArrayPrototypeFill=Se;const ce=te($e.copyWithin);W.TypedArrayPrototypeCopyWithin=ce;const de=te($e.sort);W.TypedArrayPrototypeSort=de;const Ae=te($e.slice);W.TypedArrayPrototypeSlice=Ae;const Fe=te($e.subarray);W.TypedArrayPrototypeSubarray=Fe;const Ve=Z($e,"buffer");W.TypedArrayPrototypeGetBuffer=Ve;const Je=Z($e,"byteOffset");W.TypedArrayPrototypeGetByteOffset=Je;const dt=Z($e,"length");W.TypedArrayPrototypeGetLength=dt;const St=Z($e,Ee);W.TypedArrayPrototypeGetSymbolToStringTag=St;const Tt=Uint16Array;W.NativeUint16Array=Tt;const At=(...yt)=>ee(Ke,Tt,yt);W.Uint16ArrayFrom=At;const wt=Uint32Array;W.NativeUint32Array=wt;const ot=Float32Array;W.NativeFloat32Array=ot;const pt=ie([][Te]());W.ArrayIteratorPrototype=pt;const xt=te(pt.next);W.ArrayIteratorPrototypeNext=xt;const Mt=te(function*(){}().next);W.GeneratorPrototypeNext=Mt;const tt=ie(pt);W.IteratorPrototype=tt;const ht=DataView.prototype,Pt=te(ht.getUint16);W.DataViewPrototypeGetUint16=Pt;const Ct=te(ht.setUint16);W.DataViewPrototypeSetUint16=Ct;const kt=TypeError;W.NativeTypeError=kt;const Qt=RangeError;W.NativeRangeError=Qt;const tn=WeakSet;W.NativeWeakSet=tn;const Xt=tn.prototype,yn=te(Xt.add);W.WeakSetPrototypeAdd=yn;const Zt=te(Xt.has);W.WeakSetPrototypeHas=Zt;const bn=WeakMap;W.NativeWeakMap=bn;const Jt=bn.prototype,nn=te(Jt.get);W.WeakMapPrototypeGet=nn;const nt=te(Jt.has);W.WeakMapPrototypeHas=nt;const mt=te(Jt.set);W.WeakMapPrototypeSet=mt},700:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.IsDetachedBuffer=le,W.SpeciesConstructor=ne,W.ToIntegerOrInfinity=ee,W.ToLength=re,W.defaultCompare=se;var J=Y(554),te=Y(930),Z=Y(983);function ee(ie){const ge=+ie;return(0,Z.NumberIsNaN)(ge)||ge===0?0:(0,Z.MathTrunc)(ge)}function re(ie){const ge=ee(ie);return ge<0?0:ge<Z.MAX_SAFE_INTEGER?ge:Z.MAX_SAFE_INTEGER}function ne(ie,ge){if(!(0,J.isObject)(ie))throw(0,Z.NativeTypeError)(te.THIS_IS_NOT_AN_OBJECT);const fe=ie.constructor;if(fe===void 0)return ge;if(!(0,J.isObject)(fe))throw(0,Z.NativeTypeError)(te.THE_CONSTRUCTOR_PROPERTY_VALUE_IS_NOT_AN_OBJECT);const ae=fe[Z.SymbolSpecies];return ae??ge}function le(ie){if((0,J.isSharedArrayBuffer)(ie))return!1;try{return(0,Z.ArrayBufferPrototypeSlice)(ie,0,0),!1}catch{}return!0}function se(ie,ge){const fe=(0,Z.NumberIsNaN)(ie),ae=(0,Z.NumberIsNaN)(ge);if(fe&&ae)return 0;if(fe)return 1;if(ae||ie<ge)return-1;if(ie>ge)return 1;if(ie===0&&ge===0){const ue=(0,Z.ObjectIs)(ie,0),pe=(0,Z.ObjectIs)(ge,0);if(!ue&&pe)return-1;if(ue&&!pe)return 1}return 0}},216:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.hfround=Z;var J=Y(605),te=Y(983);function Z(ee){const re=+ee;if(!(0,te.NumberIsFinite)(re)||re===0)return re;const ne=(0,J.roundToFloat16Bits)(re);return(0,J.convertToNumber)(ne)}},650:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0});var J=Y(310);W.Float16Array=J.Float16Array,W.isFloat16Array=J.isFloat16Array;var te=Y(146);W.isTypedArray=te.isTypedArray;var Z=Y(557);W.getFloat16=Z.getFloat16,W.setFloat16=Z.setFloat16;var ee=Y(216);W.hfround=ee.hfround},146:(q,W,Y)=>{Object.defineProperty(W,"__esModule",{value:!0}),W.isTypedArray=Z;var J=Y(310),te=Y(554);function Z(ee){return(0,te.isNativeTypedArray)(ee)||(0,J.isFloat16Array)(ee)}}},G={};function Q(q){var W=G[q];if(W!==void 0)return W.exports;var Y=G[q]={exports:{}};return F[q].call(Y.exports,Y,Y.exports,Q),Y.exports}Q.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var X=Q(607);return X})())})(gpuIo);const getLayers=(U,{type:D=gpuIoExports.FLOAT,numComponents:F=1,dimensions:G=32}={})=>{const Q=getGPUComposer();console.log(U,"making layers");const X=new gpuIoExports.GPULayer(Q,{name:`current_${U}`,type:D,dimensions:G,numComponents:F,numBuffers:2}),q=new gpuIoExports.GPULayer(Q,{name:`target_${U}`,type:D,dimensions:G,numComponents:F,numBuffers:1}),W=new Texture;q.attachToThreeTexture(W);const Y=new gpuIoExports.GPULayer(Q,{name:`view_${U}`,type:D,dimensions:G,numComponents:F,numBuffers:1}),J=new Texture;return Y.attachToThreeTexture(J),{current:X,target:q,view:Y,viewTexture:J,targetTexture:W}},getPositionLayers=moize.infinite(()=>getLayers("position",{numComponents:3})),getColorLayers=moize.infinite(()=>getLayers("color",{numComponents:4})),getSizeLayers=moize.infinite(()=>getLayers("size",{numComponents:1})),getEmphasisLayers=moize.infinite(()=>getLayers("emphasis",{numComponents:1})),setAllLayerSizes=U=>{[getPositionLayers(),getColorLayers(),getSizeLayers(),getEmphasisLayers()].forEach(({current:F,target:G,view:Q,viewTexture:X,targetTexture:q})=>{F.resize(U),G.resize(U),G.attachToThreeTexture(q),Q.resize(U),Q.attachToThreeTexture(X)})},getInterpolationProgram=moize.infinite(()=>new gpuIoExports.GPUProgram(getGPUComposer(),{name:"interpolation",fragmentShader:`
      in vec2 v_uv;

      // the current and target textures
      uniform sampler2D uTargetPositions;
      uniform sampler2D uCurrentPositions;
      uniform sampler2D uTargetColors;
      uniform sampler2D uCurrentColors;
      uniform sampler2D uTargetSizes;
      uniform sampler2D uCurrentSizes;
      uniform sampler2D uTargetEmphasis;
      uniform sampler2D uCurrentEmphasis;

      // the interpolation ratio
      uniform float uMixRatio;

      layout(location = 0) out vec3 outPositions;
      layout(location = 1) out vec3 viewPositions;
      layout(location = 2) out vec4 outColors;
      layout(location = 3) out vec4 viewColors;
      layout(location = 4) out float outSizes;
      layout(location = 5) out float viewSizes;
      layout(location = 6) out float outEmphasis;
      layout(location = 7) out float viewEmphasis;

      void main() {
        vec3 targetPosition = texture(uTargetPositions, v_uv).xyz;
        vec3 currentPosition = texture(uCurrentPositions, v_uv).xyz;
        outPositions = mix(currentPosition, targetPosition, uMixRatio);
        viewPositions = outPositions;

        vec4 targetColor = texture(uTargetColors, v_uv);
        vec4 currentColor = texture(uCurrentColors, v_uv);
        outColors = mix(currentColor, targetColor, uMixRatio);
        viewColors = outColors;

        float targetSize = texture(uTargetSizes, v_uv).r;
        float currentSize = texture(uCurrentSizes, v_uv).r;
        outSizes = mix(currentSize, targetSize, uMixRatio);
        viewSizes = outSizes;

        float targetEmphasis = texture(uTargetEmphasis, v_uv).r;
        float currentEmphasis = texture(uCurrentEmphasis, v_uv).r;
        outEmphasis = mix(currentEmphasis, targetEmphasis, uMixRatio);
        viewEmphasis = outEmphasis;
      }
    `,uniforms:[{name:"uTargetPositions",type:gpuIoExports.INT,value:0},{name:"uCurrentPositions",type:gpuIoExports.INT,value:1},{name:"uTargetColors",type:gpuIoExports.INT,value:2},{name:"uCurrentColors",type:gpuIoExports.INT,value:3},{name:"uTargetSizes",type:gpuIoExports.INT,value:4},{name:"uCurrentSizes",type:gpuIoExports.INT,value:5},{name:"uTargetEmphasis",type:gpuIoExports.INT,value:6},{name:"uCurrentEmphasis",type:gpuIoExports.INT,value:7},{name:"uMixRatio",type:gpuIoExports.FLOAT,value:.1}]}));console.log(graphLayout,"graphLayout???");const colorHash=new ColorHash({saturation:.7,lightness:.6}),fetchData=async()=>{const U="https://dat-ecosystem.org/dat-garden-rake/",D=await fetch(`${U}index.json`).then(q=>q.json()),F=`${U}${D.latest}`,[G,Q,X]=await Promise.all([fetch(F+"/../valuenetwork.json").then(q=>q.json()),fetch(F+"/../projects.json").then(q=>q.json()),fetch(F+"/../organizations.json").then(q=>q.json())]);return{valueNetworkData:G,projectsData:Q,organizationsData:X}},datEcosystemData=moize.promise(fetchData),nodeScaleFn=U=>Math.max(4*Math.log(2*(U?.length||1)**1.2),2),makeNavId=U=>U.replace(/^(https?:\/\/)?(www\.)?([a-z0-9-]+\.)+[a-z0-9-]+/i,"").replace(/\/$/,"").replace(/^\//,"").replace(/[^A-Za-z0-9\.]/gi,"-").replace(/-+/g,"-").replace(/^package-/,"").replace(/-v-/,"-"),getGraphData=moize.promise(async()=>{const{valueNetworkData:U,projectsData:D,organizationsData:F}=await datEcosystemData(),G=Object.entries(U).map(([J,{dependents:te,owner:Z,dependencies:ee}],re)=>({index:re,project:J,id:J,data:D[J],navId:makeNavId(J),owner:Z,ownerData:F[Z],color:[...colorHash.rgb(Z||J||String(re)).map(ne=>ne/255),1],size:nodeScaleFn(te),dependents:te,dependencies:ee}));fromPairs(G.map(J=>[J.index,J]));const Q=fromPairs(G.map(J=>[J.project,J])),X=fromPairs(G.map(J=>[J.data.name,J])),q=fromPairs(G.map(J=>[J.navId,J]));let W=Object.entries(U).flatMap(([J,{dependents:te,dependencies:Z}])=>(te||[]).map(ee=>({source:ee,sourceNode:Q[ee],sourceIndex:G.find(re=>re.project===ee).index,target:J,targetNode:Q[J],targetIndex:G.find(re=>re.project===J).index})).concat((Z||[]).map(ee=>({source:J,sourceNode:Q[J],sourceIndex:G.find(re=>re.project===J).index,target:ee,targetNode:Q[ee],targetIndex:G.find(re=>re.project===ee).index})))).filter(J=>J);W=uniqWith(W,(J,te)=>J.sourceIndex===te.sourceIndex&&J.targetIndex===te.targetIndex);const Y=W.map(({sourceIndex:J,targetIndex:te})=>[J,te]);return fromPairs(Y.map(([J,te],Z)=>[`${J}-${te}`,Z])),fromPairs(Y.map(([J,te],Z)=>[`${J}-${te}`,W[Z]])),{nodes:G,links:W,linkIndexPairs:Y,nodesByNavId:q,nodesByProject:Q,nodesByProjectName:X}}),prepareGraphDBWorker=async()=>{const U=await datEcosystemData();return await graphDb.buildGraph(U)},{NgraphForceLayout,D3ForceLayout}=graphLayout,getLayoutSimulator=moize.infinite(async()=>{const U=await new D3ForceLayout(await getGraphData());return U.start(),U});let latestTargetPositions;const getLatestTargetPositions=()=>latestTargetPositions,updateNodePositionTargets=async()=>{(await getLayoutSimulator()).getPositions(proxy(D=>{D.length>0&&(latestTargetPositions=D,getPositionLayers().target.setFromArray(D))}))},getNodePosition=U=>{const D=getLatestTargetPositions()?getLatestTargetPositions():[],F=U.index;return[D[F*3],D[F*3+1],D[F*3+2]]},{doQuery,buildGraph}=graphDb;var t$1;const i$1=window,s$2=i$1.trustedTypes,e$1=s$2?s$2.createPolicy("lit-html",{createHTML:U=>U}):void 0,o$1="$lit$",n$1=`lit$${(Math.random()+"").slice(9)}$`,l$2="?"+n$1,h$2=`<${l$2}>`,r$1=document,d$2=()=>r$1.createComment(""),u$1=U=>U===null||typeof U!="object"&&typeof U!="function",c$1=Array.isArray,v$2=U=>c$1(U)||typeof U?.[Symbol.iterator]=="function",a$1=`[ 	
\f\r]`,f$1=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,_=/-->/g,m$2=/>/g,p$1=RegExp(`>|${a$1}(?:([^\\s"'>=/]+)(${a$1}*=${a$1}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),g$1=/'/g,$$1=/"/g,y$2=/^(?:script|style|textarea|title)$/i,w$1=U=>(D,...F)=>({_$litType$:U,strings:D,values:F}),x$2=w$1(1),T=Symbol.for("lit-noChange"),A=Symbol.for("lit-nothing"),E=new WeakMap,C=r$1.createTreeWalker(r$1,129,null,!1),P=(U,D)=>{const F=U.length-1,G=[];let Q,X=D===2?"<svg>":"",q=f$1;for(let Y=0;Y<F;Y++){const J=U[Y];let te,Z,ee=-1,re=0;for(;re<J.length&&(q.lastIndex=re,Z=q.exec(J),Z!==null);)re=q.lastIndex,q===f$1?Z[1]==="!--"?q=_:Z[1]!==void 0?q=m$2:Z[2]!==void 0?(y$2.test(Z[2])&&(Q=RegExp("</"+Z[2],"g")),q=p$1):Z[3]!==void 0&&(q=p$1):q===p$1?Z[0]===">"?(q=Q??f$1,ee=-1):Z[1]===void 0?ee=-2:(ee=q.lastIndex-Z[2].length,te=Z[1],q=Z[3]===void 0?p$1:Z[3]==='"'?$$1:g$1):q===$$1||q===g$1?q=p$1:q===_||q===m$2?q=f$1:(q=p$1,Q=void 0);const ne=q===p$1&&U[Y+1].startsWith("/>")?" ":"";X+=q===f$1?J+h$2:ee>=0?(G.push(te),J.slice(0,ee)+o$1+J.slice(ee)+n$1+ne):J+n$1+(ee===-2?(G.push(void 0),Y):ne)}const W=X+(U[F]||"<?>")+(D===2?"</svg>":"");if(!Array.isArray(U)||!U.hasOwnProperty("raw"))throw Error("invalid template strings array");return[e$1!==void 0?e$1.createHTML(W):W,G]};class V{constructor({strings:D,_$litType$:F},G){let Q;this.parts=[];let X=0,q=0;const W=D.length-1,Y=this.parts,[J,te]=P(D,F);if(this.el=V.createElement(J,G),C.currentNode=this.el.content,F===2){const Z=this.el.content,ee=Z.firstChild;ee.remove(),Z.append(...ee.childNodes)}for(;(Q=C.nextNode())!==null&&Y.length<W;){if(Q.nodeType===1){if(Q.hasAttributes()){const Z=[];for(const ee of Q.getAttributeNames())if(ee.endsWith(o$1)||ee.startsWith(n$1)){const re=te[q++];if(Z.push(ee),re!==void 0){const ne=Q.getAttribute(re.toLowerCase()+o$1).split(n$1),le=/([.?@])?(.*)/.exec(re);Y.push({type:1,index:X,name:le[2],strings:ne,ctor:le[1]==="."?k$2:le[1]==="?"?I$1:le[1]==="@"?L$1:R})}else Y.push({type:6,index:X})}for(const ee of Z)Q.removeAttribute(ee)}if(y$2.test(Q.tagName)){const Z=Q.textContent.split(n$1),ee=Z.length-1;if(ee>0){Q.textContent=s$2?s$2.emptyScript:"";for(let re=0;re<ee;re++)Q.append(Z[re],d$2()),C.nextNode(),Y.push({type:2,index:++X});Q.append(Z[ee],d$2())}}}else if(Q.nodeType===8)if(Q.data===l$2)Y.push({type:2,index:X});else{let Z=-1;for(;(Z=Q.data.indexOf(n$1,Z+1))!==-1;)Y.push({type:7,index:X}),Z+=n$1.length-1}X++}}static createElement(D,F){const G=r$1.createElement("template");return G.innerHTML=D,G}}function N$1(U,D,F=U,G){var Q,X,q,W;if(D===T)return D;let Y=G!==void 0?(Q=F._$Co)===null||Q===void 0?void 0:Q[G]:F._$Cl;const J=u$1(D)?void 0:D._$litDirective$;return Y?.constructor!==J&&((X=Y?._$AO)===null||X===void 0||X.call(Y,!1),J===void 0?Y=void 0:(Y=new J(U),Y._$AT(U,F,G)),G!==void 0?((q=(W=F)._$Co)!==null&&q!==void 0?q:W._$Co=[])[G]=Y:F._$Cl=Y),Y!==void 0&&(D=N$1(U,Y._$AS(U,D.values),Y,G)),D}let S$1=class{constructor(D,F){this._$AV=[],this._$AN=void 0,this._$AD=D,this._$AM=F}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(D){var F;const{el:{content:G},parts:Q}=this._$AD,X=((F=D?.creationScope)!==null&&F!==void 0?F:r$1).importNode(G,!0);C.currentNode=X;let q=C.nextNode(),W=0,Y=0,J=Q[0];for(;J!==void 0;){if(W===J.index){let te;J.type===2?te=new M$2(q,q.nextSibling,this,D):J.type===1?te=new J.ctor(q,J.name,J.strings,this,D):J.type===6&&(te=new z(q,this,D)),this._$AV.push(te),J=Q[++Y]}W!==J?.index&&(q=C.nextNode(),W++)}return X}v(D){let F=0;for(const G of this._$AV)G!==void 0&&(G.strings!==void 0?(G._$AI(D,G,F),F+=G.strings.length-2):G._$AI(D[F])),F++}},M$2=class gi{constructor(D,F,G,Q){var X;this.type=2,this._$AH=A,this._$AN=void 0,this._$AA=D,this._$AB=F,this._$AM=G,this.options=Q,this._$Cp=(X=Q?.isConnected)===null||X===void 0||X}get _$AU(){var D,F;return(F=(D=this._$AM)===null||D===void 0?void 0:D._$AU)!==null&&F!==void 0?F:this._$Cp}get parentNode(){let D=this._$AA.parentNode;const F=this._$AM;return F!==void 0&&D?.nodeType===11&&(D=F.parentNode),D}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(D,F=this){D=N$1(this,D,F),u$1(D)?D===A||D==null||D===""?(this._$AH!==A&&this._$AR(),this._$AH=A):D!==this._$AH&&D!==T&&this._(D):D._$litType$!==void 0?this.g(D):D.nodeType!==void 0?this.$(D):v$2(D)?this.T(D):this._(D)}k(D){return this._$AA.parentNode.insertBefore(D,this._$AB)}$(D){this._$AH!==D&&(this._$AR(),this._$AH=this.k(D))}_(D){this._$AH!==A&&u$1(this._$AH)?this._$AA.nextSibling.data=D:this.$(r$1.createTextNode(D)),this._$AH=D}g(D){var F;const{values:G,_$litType$:Q}=D,X=typeof Q=="number"?this._$AC(D):(Q.el===void 0&&(Q.el=V.createElement(Q.h,this.options)),Q);if(((F=this._$AH)===null||F===void 0?void 0:F._$AD)===X)this._$AH.v(G);else{const q=new S$1(X,this),W=q.u(this.options);q.v(G),this.$(W),this._$AH=q}}_$AC(D){let F=E.get(D.strings);return F===void 0&&E.set(D.strings,F=new V(D)),F}T(D){c$1(this._$AH)||(this._$AH=[],this._$AR());const F=this._$AH;let G,Q=0;for(const X of D)Q===F.length?F.push(G=new gi(this.k(d$2()),this.k(d$2()),this,this.options)):G=F[Q],G._$AI(X),Q++;Q<F.length&&(this._$AR(G&&G._$AB.nextSibling,Q),F.length=Q)}_$AR(D=this._$AA.nextSibling,F){var G;for((G=this._$AP)===null||G===void 0||G.call(this,!1,!0,F);D&&D!==this._$AB;){const Q=D.nextSibling;D.remove(),D=Q}}setConnected(D){var F;this._$AM===void 0&&(this._$Cp=D,(F=this._$AP)===null||F===void 0||F.call(this,D))}};class R{constructor(D,F,G,Q,X){this.type=1,this._$AH=A,this._$AN=void 0,this.element=D,this.name=F,this._$AM=Q,this.options=X,G.length>2||G[0]!==""||G[1]!==""?(this._$AH=Array(G.length-1).fill(new String),this.strings=G):this._$AH=A}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(D,F=this,G,Q){const X=this.strings;let q=!1;if(X===void 0)D=N$1(this,D,F,0),q=!u$1(D)||D!==this._$AH&&D!==T,q&&(this._$AH=D);else{const W=D;let Y,J;for(D=X[0],Y=0;Y<X.length-1;Y++)J=N$1(this,W[G+Y],F,Y),J===T&&(J=this._$AH[Y]),q||(q=!u$1(J)||J!==this._$AH[Y]),J===A?D=A:D!==A&&(D+=(J??"")+X[Y+1]),this._$AH[Y]=J}q&&!Q&&this.j(D)}j(D){D===A?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,D??"")}}let k$2=class extends R{constructor(){super(...arguments),this.type=3}j(D){this.element[this.name]=D===A?void 0:D}};const H$1=s$2?s$2.emptyScript:"";let I$1=class extends R{constructor(){super(...arguments),this.type=4}j(D){D&&D!==A?this.element.setAttribute(this.name,H$1):this.element.removeAttribute(this.name)}},L$1=class extends R{constructor(D,F,G,Q,X){super(D,F,G,Q,X),this.type=5}_$AI(D,F=this){var G;if((D=(G=N$1(this,D,F,0))!==null&&G!==void 0?G:A)===T)return;const Q=this._$AH,X=D===A&&Q!==A||D.capture!==Q.capture||D.once!==Q.once||D.passive!==Q.passive,q=D!==A&&(Q===A||X);X&&this.element.removeEventListener(this.name,this,Q),q&&this.element.addEventListener(this.name,this,D),this._$AH=D}handleEvent(D){var F,G;typeof this._$AH=="function"?this._$AH.call((G=(F=this.options)===null||F===void 0?void 0:F.host)!==null&&G!==void 0?G:this.element,D):this._$AH.handleEvent(D)}};class z{constructor(D,F,G){this.element=D,this.type=6,this._$AN=void 0,this._$AM=F,this.options=G}get _$AU(){return this._$AM._$AU}_$AI(D){N$1(this,D)}}const j$1=i$1.litHtmlPolyfillSupport;j$1?.(V,M$2),((t$1=i$1.litHtmlVersions)!==null&&t$1!==void 0?t$1:i$1.litHtmlVersions=[]).push("2.7.1");const B=(U,D,F)=>{var G,Q;const X=(G=F?.renderBefore)!==null&&G!==void 0?G:D;let q=X._$litPart$;if(q===void 0){const W=(Q=F?.renderBefore)!==null&&Q!==void 0?Q:null;X._$litPart$=q=new M$2(D.insertBefore(d$2(),W),W,void 0,F??{})}return q._$AI(U),q};var hue;function s$1(U,D,F){return Math.min(Math.max(U||0,D),F)}function h$1(U){return{r:s$1(U.r,0,255),g:s$1(U.g,0,255),b:s$1(U.b,0,255),a:s$1(U.a,0,1)}}function x$1(U){return{r:255*U.r,g:255*U.g,b:255*U.b,a:U.a}}function O(U){return{r:U.r/255,g:U.g/255,b:U.b/255,a:U.a}}function I(U,D){D===void 0&&(D=0);var F=Math.pow(10,D);return{r:Math.round(U.r*F)/F,g:Math.round(U.g*F)/F,b:Math.round(U.b*F)/F,a:U.a}}function M$1(U,D,F,G,Q,X){return(1-D/F)*G+D/F*Math.round((1-U)*Q+U*X)}function m$1(U,D,F,G,Q){Q===void 0&&(Q={unitInput:!1,unitOutput:!1,roundOutput:!0}),Q.unitInput&&(U=x$1(U),D=x$1(D)),U=h$1(U);var X=(D=h$1(D)).a+U.a-D.a*U.a,q=F(U,D,G),W=h$1({r:M$1(U.a,D.a,X,U.r,D.r,q.r),g:M$1(U.a,D.a,X,U.g,D.g,q.g),b:M$1(U.a,D.a,X,U.b,D.b,q.b),a:X});return Q.unitOutput?O(W):Q.roundOutput?I(W):I(W,9)}function d$1(U,D,F){return x$1(F(O(U),O(D)))}function l$1(U){return .3*U.r+.59*U.g+.11*U.b}function v$1(U,D){var F=D-l$1(U);return function(G){var Q=l$1(G),X=G.r,q=G.g,W=G.b,Y=Math.min(X,q,W),J=Math.max(X,q,W);function te(ee){return Q+(ee-Q)*Q/(Q-Y)}function Z(ee){return Q+(ee-Q)*(1-Q)/(J-Q)}return Y<0&&(X=te(X),q=te(q),W=te(W)),J>1&&(X=Z(X),q=Z(q),W=Z(W)),{r:X,g:q,b:W}}({r:U.r+F,g:U.g+F,b:U.b+F})}function y$1(U){return Math.max(U.r,U.g,U.b)-Math.min(U.r,U.g,U.b)}function L(U,D){var F=["r","g","b"].sort(function(W,Y){return U[W]-U[Y]}),G=F[0],Q=F[1],X=F[2],q={r:U.r,g:U.g,b:U.b};return q[X]>q[G]?(q[Q]=(q[Q]-q[G])*D/(q[X]-q[G]),q[X]=D):q[Q]=q[X]=0,q[G]=0,q}function k$1(U,D){return v$1(L(D,y$1(U)),l$1(U))}hue=function(U,D){return m$1(U,D,d$1,k$1,{unitInput:!0,unitOutput:!0})};var r={grad:.9,turn:360,rad:360/(2*Math.PI)},t=function(U){return typeof U=="string"?U.length>0:typeof U=="number"},n=function(U,D,F){return D===void 0&&(D=0),F===void 0&&(F=Math.pow(10,D)),Math.round(F*U)/F+0},e=function(U,D,F){return D===void 0&&(D=0),F===void 0&&(F=1),U>F?F:U>D?U:D},u=function(U){return(U=isFinite(U)?U%360:0)>0?U:U+360},a=function(U){return{r:e(U.r,0,255),g:e(U.g,0,255),b:e(U.b,0,255),a:e(U.a)}},o=function(U){return{r:n(U.r),g:n(U.g),b:n(U.b),a:n(U.a,3)}},i=/^#([0-9a-f]{3,8})$/i,s=function(U){var D=U.toString(16);return D.length<2?"0"+D:D},h=function(U){var D=U.r,F=U.g,G=U.b,Q=U.a,X=Math.max(D,F,G),q=X-Math.min(D,F,G),W=q?X===D?(F-G)/q:X===F?2+(G-D)/q:4+(D-F)/q:0;return{h:60*(W<0?W+6:W),s:X?q/X*100:0,v:X/255*100,a:Q}},b=function(U){var D=U.h,F=U.s,G=U.v,Q=U.a;D=D/360*6,F/=100,G/=100;var X=Math.floor(D),q=G*(1-F),W=G*(1-(D-X)*F),Y=G*(1-(1-D+X)*F),J=X%6;return{r:255*[G,W,q,q,Y,G][J],g:255*[Y,G,G,W,q,q][J],b:255*[q,q,Y,G,G,W][J],a:Q}},g=function(U){return{h:u(U.h),s:e(U.s,0,100),l:e(U.l,0,100),a:e(U.a)}},d=function(U){return{h:n(U.h),s:n(U.s),l:n(U.l),a:n(U.a,3)}},f=function(U){return b((F=(D=U).s,{h:D.h,s:(F*=((G=D.l)<50?G:100-G)/100)>0?2*F/(G+F)*100:0,v:G+F,a:D.a}));var D,F,G},c=function(U){return{h:(D=h(U)).h,s:(Q=(200-(F=D.s))*(G=D.v)/100)>0&&Q<200?F*G/100/(Q<=100?Q:200-Q)*100:0,l:Q/2,a:D.a};var D,F,G,Q},l=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,p=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,m=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y={string:[[function(U){var D=i.exec(U);return D?(U=D[1]).length<=4?{r:parseInt(U[0]+U[0],16),g:parseInt(U[1]+U[1],16),b:parseInt(U[2]+U[2],16),a:U.length===4?n(parseInt(U[3]+U[3],16)/255,2):1}:U.length===6||U.length===8?{r:parseInt(U.substr(0,2),16),g:parseInt(U.substr(2,2),16),b:parseInt(U.substr(4,2),16),a:U.length===8?n(parseInt(U.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(U){var D=v.exec(U)||m.exec(U);return D?D[2]!==D[4]||D[4]!==D[6]?null:a({r:Number(D[1])/(D[2]?100/255:1),g:Number(D[3])/(D[4]?100/255:1),b:Number(D[5])/(D[6]?100/255:1),a:D[7]===void 0?1:Number(D[7])/(D[8]?100:1)}):null},"rgb"],[function(U){var D=l.exec(U)||p.exec(U);if(!D)return null;var F,G,Q=g({h:(F=D[1],G=D[2],G===void 0&&(G="deg"),Number(F)*(r[G]||1)),s:Number(D[3]),l:Number(D[4]),a:D[5]===void 0?1:Number(D[5])/(D[6]?100:1)});return f(Q)},"hsl"]],object:[[function(U){var D=U.r,F=U.g,G=U.b,Q=U.a,X=Q===void 0?1:Q;return t(D)&&t(F)&&t(G)?a({r:Number(D),g:Number(F),b:Number(G),a:Number(X)}):null},"rgb"],[function(U){var D=U.h,F=U.s,G=U.l,Q=U.a,X=Q===void 0?1:Q;if(!t(D)||!t(F)||!t(G))return null;var q=g({h:Number(D),s:Number(F),l:Number(G),a:Number(X)});return f(q)},"hsl"],[function(U){var D=U.h,F=U.s,G=U.v,Q=U.a,X=Q===void 0?1:Q;if(!t(D)||!t(F)||!t(G))return null;var q=function(W){return{h:u(W.h),s:e(W.s,0,100),v:e(W.v,0,100),a:e(W.a)}}({h:Number(D),s:Number(F),v:Number(G),a:Number(X)});return b(q)},"hsv"]]},N=function(U,D){for(var F=0;F<D.length;F++){var G=D[F][0](U);if(G)return[G,D[F][1]]}return[null,void 0]},x=function(U){return typeof U=="string"?N(U.trim(),y.string):typeof U=="object"&&U!==null?N(U,y.object):[null,void 0]},M=function(U,D){var F=c(U);return{h:F.h,s:e(F.s+100*D,0,100),l:F.l,a:F.a}},H=function(U){return(299*U.r+587*U.g+114*U.b)/1e3/255},$=function(U,D){var F=c(U);return{h:F.h,s:F.s,l:e(F.l+100*D,0,100),a:F.a}},j=function(){function U(D){this.parsed=x(D)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return U.prototype.isValid=function(){return this.parsed!==null},U.prototype.brightness=function(){return n(H(this.rgba),2)},U.prototype.isDark=function(){return H(this.rgba)<.5},U.prototype.isLight=function(){return H(this.rgba)>=.5},U.prototype.toHex=function(){return D=o(this.rgba),F=D.r,G=D.g,Q=D.b,q=(X=D.a)<1?s(n(255*X)):"","#"+s(F)+s(G)+s(Q)+q;var D,F,G,Q,X,q},U.prototype.toRgb=function(){return o(this.rgba)},U.prototype.toRgbString=function(){return D=o(this.rgba),F=D.r,G=D.g,Q=D.b,(X=D.a)<1?"rgba("+F+", "+G+", "+Q+", "+X+")":"rgb("+F+", "+G+", "+Q+")";var D,F,G,Q,X},U.prototype.toHsl=function(){return d(c(this.rgba))},U.prototype.toHslString=function(){return D=d(c(this.rgba)),F=D.h,G=D.s,Q=D.l,(X=D.a)<1?"hsla("+F+", "+G+"%, "+Q+"%, "+X+")":"hsl("+F+", "+G+"%, "+Q+"%)";var D,F,G,Q,X},U.prototype.toHsv=function(){return D=h(this.rgba),{h:n(D.h),s:n(D.s),v:n(D.v),a:n(D.a,3)};var D},U.prototype.invert=function(){return w({r:255-(D=this.rgba).r,g:255-D.g,b:255-D.b,a:D.a});var D},U.prototype.saturate=function(D){return D===void 0&&(D=.1),w(M(this.rgba,D))},U.prototype.desaturate=function(D){return D===void 0&&(D=.1),w(M(this.rgba,-D))},U.prototype.grayscale=function(){return w(M(this.rgba,-1))},U.prototype.lighten=function(D){return D===void 0&&(D=.1),w($(this.rgba,D))},U.prototype.darken=function(D){return D===void 0&&(D=.1),w($(this.rgba,-D))},U.prototype.rotate=function(D){return D===void 0&&(D=15),this.hue(this.hue()+D)},U.prototype.alpha=function(D){return typeof D=="number"?w({r:(F=this.rgba).r,g:F.g,b:F.b,a:D}):n(this.rgba.a,3);var F},U.prototype.hue=function(D){var F=c(this.rgba);return typeof D=="number"?w({h:D,s:F.s,l:F.l,a:F.a}):n(F.h)},U.prototype.isEqual=function(D){return this.toHex()===w(D).toHex()},U}(),w=function(U){return U instanceof j?U:new j(U)},S=[],k=function(U){U.forEach(function(D){S.indexOf(D)<0&&(D(j,y),S.push(D))})};function namesPlugin(U,D){var F={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},G={};for(var Q in F)G[F[Q]]=Q;var X={};U.prototype.toName=function(q){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var W,Y,J=G[this.toHex()];if(J)return J;if(q?.closest){var te=this.toRgb(),Z=1/0,ee="black";if(!X.length)for(var re in F)X[re]=new U(F[re]).toRgb();for(var ne in F){var le=(W=te,Y=X[ne],Math.pow(W.r-Y.r,2)+Math.pow(W.g-Y.g,2)+Math.pow(W.b-Y.b,2));le<Z&&(Z=le,ee=ne)}return ee}},D.string.push([function(q){var W=q.toLowerCase(),Y=W==="transparent"?"#0000":F[W];return Y?new U(Y).toRgb():null},"name"])}const defaultColorMap=({color:U})=>U,getDefaultColors=moize.infinite(async(U=identity$2)=>{const{nodes:D,links:F}=await getGraphData();return new Float32Array(D.map(defaultColorMap).flatMap(U))}),defaultSizeMap=({size:U})=>Math.sqrt(U)/40,getDefaultSizes=moize.infinite(async(U=identity$2)=>{const{nodes:D,links:F}=await getGraphData();return new Float32Array(D.map(defaultSizeMap).map(U))}),applyVisuals=async({colorMap:U=identity$2,sizeMap:D=identity$2,immediate:F=!1}={})=>{const G=await getDefaultColors(U),Q=await getDefaultSizes(D),X=getColorLayers(),q=getSizeLayers(),W=getEmphasisLayers();X.target.setFromArray(G),q.target.setFromArray(Q),W.target.setFromArray(new Float32Array(Q.length).fill(0)),F&&(X.current.setFromArray(G),q.current.setFromArray(Q),W.current.setFromArray(new Float32Array(Q.length).fill(0)))},applyVisualsToNode=async(U,{colorMap:D=identity$2,sizeMap:F=identity$2,emphasis:G=0,immediate:Q=!1}={})=>{const X=new Float32Array(D(defaultColorMap(U))),q=new Float32Array([F(defaultSizeMap(U))]),W=new Float32Array([G]),Y=getColorLayers(),J=getSizeLayers(),te=getEmphasisLayers();Y.target.setAtIndex1D(U.index,X),J.target.setAtIndex1D(U.index,q),te.target.setAtIndex1D(U.index,W),Q&&(Y.current.setAtIndex1D(U.index,X),J.current.setAtIndex1D(U.index,q),te.current.setAtIndex1D(U.index,W))},initializationVisualMaps={colorMap:U=>{const D=U.slice(0,3).reduce((F,G)=>F+G,0)/3;return[...U.slice(0,3).map(F=>D),.5]},sizeMap:U=>U*.5},initializeSelectionVisuals=async(U=!1)=>{await applyVisuals({...initializationVisualMaps,immediate:U})},onImgErrorHandler="this.parentNode.style.display='none'",onImgSuccessHandler="this.parentNode.style.display='initial'",selectionInfo=U=>x$2`
  <div class="project">
    <h3><a target="_blank" href="${U.data?.homepage}">${U.data.name}</a></h3>
    <div class="description">${U.data.description}</div>
    <div class="links">
      <span class="owner">
        <div class="owner-name-container">
          ${U.ownerData.html_url?x$2`<a target="_blank" href="${U.ownerData.html_url}">${U.ownerData.name}</a>`:x$2`<span>${U.ownerData.name}</span>`}
        </div>
        <div class="avatar-container">
          <img class="avatar-stroke" src="${U.ownerData?.avatar_url}" onerror=${onImgErrorHandler} onload=${onImgSuccessHandler} alt="">
          <img class="avatar" src="${U.ownerData?.avatar_url}" onerror=${onImgErrorHandler} onload=${onImgSuccessHandler} alt="${U.ownerData?.name}">
        </div>
      </span>
      <span><a target="_blank" href="${U.project}">NPM</a></span>
      ${U.data?.repository?x$2`<span><a target="_blank" href="${U.data.repository}">Git</a></span>`:x$2``}
      ${U.data?.bugs?x$2`<span><a target="_blank" href="${U.data.bugs}">Issues</a></span>`:x$2``}
      <!-- <a href="${U.ownerData.html_url}">Owner Profile</a> -->
    </div>
  </div>

`,showSelectionInfo=debounce(U=>{const D=document.getElementById("selection-info");if(U){const F=selectionInfo(U);B(F,D)}else B(x$2``,D)},0),selectNodeAndDownstreamDependents=async(U,D=!0)=>{if(U){setSelectedIndex(U.index);const F=getNodePosition(U),G=directDependentsQuery(U.project),Q=directDependenciesQuery(U.project),{nodesByProject:X,links:q}=await getGraphData(),W=({sizeMap:Y=identity$2,emphasis:J=1,colorMap:te=identity$2})=>(Z,ee)=>{ee(["dependent","dependency"]).then(({dependent:re,dependency:ne})=>{applyVisualsToNode(X[re?.value||U.project],{sizeMap:Y,emphasis:J,colorMap:te}),applyVisualsToNode(X[ne?.value||U.project],{sizeMap:Y,emphasis:J,colorMap:te})})};initializeSelectionVisuals().then(()=>{doQuery(G,proxy(W({sizeMap:Y=>Y*2,colorMap:Y=>{const J={r:Y[0],g:Y[1],b:Y[2],a:Y[3]},te={r:57/255,g:179/255,b:83/255,a:.8},Z=hue(J,te);return[Z.r,Z.g,Z.b,Z.a]}}))),applyVisualsToNode(U,{sizeMap:Y=>Y*4,emphasis:1}),doQuery(Q,proxy(W({sizeMap:Y=>Y*2,colorMap:Y=>{const J={r:Y[0],g:Y[1],b:Y[2],a:Y[3]},te={r:0,g:102/255,b:209/255,a:.8},Z=hue(J,te);return[Z.r,Z.g,Z.b,Z.a]}}))),D&&setCameraCenter(F),D&&setCameraDistance(selectedZoom||75)})}else D&&setCameraDistance(deselectedZoom||1500),D&&setCameraCenter([0,0,0],4e3),applyVisuals(),setSelectedIndex(-1);showSelectionInfo(U)},selectNothingAndZoomOut=()=>{selectNodeAndDownstreamDependents(null)};window.initializeSelectionVisuals=initializeSelectionVisuals;let selectedIndex=-1;const getSelectedIndex=()=>selectedIndex,setSelectedIndex=U=>{selectedIndex=U},getSelectedNode=async()=>{const U=getSelectedIndex(),{nodes:D}=await getGraphData();return D[U]};k([namesPlugin]);const getSelectedColor=()=>{const U=document.documentElement,D=w(getComputedStyle(U).getPropertyValue("--selected-color")).toRgb();return new Float32Array([D.r/255,D.g/255,D.b/255,1])};var handlers={},on=(U,D)=>{handlers[U]??(handlers[U]=[]),handlers[U].push(D)},off=(U,D)=>{var F;(F=handlers[U])==null||F.splice(handlers[U].indexOf(D),1)},emit=async(U,D,F)=>{for(const G of handlers[U]??[])await G(D,F)},stripTrailingSlash=U=>U.length>1&&U.endsWith("/")?U.slice(0,-1):U,parsePattern=U=>{var D;const F=(D=U.match(/(:[^/]+)/g))==null?void 0:D.map(G=>G.substring(1));return F&&{keys:F,regExp:new RegExp("^"+U.replace(/(:[^/]+)/g,"([^/]+)")+"$")}},getParams=(U,D)=>Object.fromEntries(D.map((F,G)=>[F,U[G+1]])),routeDefinitions=[],currentRoute,findDefinition=U=>{for(const D of routeDefinitions){const{pattern:F,regExp:G,keys:Q}=D,X=G?U.match(G):F==="*"||F===U;if(X){const q=Array.isArray(X)?getParams(X,Q):void 0;return{definition:D,params:q}}}},handleChange=async(U,D)=>{const F=findDefinition(U),G=!!F,Q=F?.params??{},X=currentRoute;currentRoute={path:U,params:Q,matches:G,trigger:D},await emit("before-route",currentRoute,X),await F?.definition.action(Q,currentRoute,X),await emit("route",currentRoute,X)},src_default={get currentRoute(){return currentRoute},on,off,start({handleInitial:U=!0}={}){const D=window.location.hash!=""&&window.location.hash;U&&handleChange(D||window.location.pathname||"/","init"),window.addEventListener("popstate",()=>handleChange(window.location.pathname,"popstate")),window.addEventListener("hashchange",()=>{handleChange(window.location.hash,"hashchange")})},route(U,D){const F=stripTrailingSlash(U),{regExp:G,keys:Q=[]}=parsePattern(U)||{};routeDefinitions.push({pattern:F,action:D,regExp:G,keys:Q})},push(U){window.history.pushState(null,"",stripTrailingSlash(U)),handleChange(U,"push")},replace(U){window.history.replaceState(null,"",stripTrailingSlash(U)),handleChange(U,"replace")}};src_default.route("#-",()=>{selectNothingAndZoomOut()});src_default.route("#project/:id",async(U,{trigger:D})=>{const{nodesByNavId:F}=await getGraphData(),G=F[U.id];selectNodeAndDownstreamDependents(G,D!=="init")});var node_default$1=`#version 300 es
precision highp float;
precision highp int;

in vec3 vertexPosition;
in vec3 vertexNormal;
in int index;

uniform cameras {
  mat4 projection;
  mat4 view;
  mat4 orthoFixedProjection;
  mat4 orthoFixedView;
  mat4 orthoZoomedProjection;
  mat4 orthoZoomedView;
  float distance;
  vec3 center;
  vec3 rotationCenter;
};

uniform int selectedIndex;
uniform vec4 selectedColor;
float bump(float x, float q, float w) {
  float clamped_x = clamp(x/w, -0.5, 0.5);
  float y = pow(exp(1.0 - 1.0 / (1.0 - pow(2.0*clamped_x, 2.0))), q);
  return y;
}

float defaultFogVisibility = 0.3;
float defaultFogBoundaryClipZ = 700.0;

float computeFog(float positionClipZ, float fogBoundaryClipZ) {
  float fogLevel = 1.0 - bump(positionClipZ, 1.0, fogBoundaryClipZ);
  fogLevel = mix(
    fogLevel, 
    0.0,
    smoothstep(400.0, 800.0, distance)
  );
  
  return fogLevel;
}

struct CameraMatrices {
  mat4 projection;
  mat4 view;
  mat4 orthoFixedProjection;
  mat4 orthoFixedView;
  mat4 orthoZoomedProjection;
  mat4 orthoZoomedView;
};

struct NodeGeometryBundle {
  vec3 globalNDC;
  vec4 globalClipPosition;
  vec4 orthoFixedClipPosition;
  vec4 orthoZoomedClipPosition;
  vec4 orthographicClipPosition;
};

NodeGeometryBundle nodeGeometry(
  in vec3 nodePosition,
  in vec3 vertexPosition,
  float scale,
  in CameraMatrices cam
) {
  vec4 globalClipPosition = cam.projection * cam.view * vec4(nodePosition, 1.0);
  vec3 globalNDC = globalClipPosition.xyz / globalClipPosition.w;

  vec4 orthoFixedClipPosition = cam.orthoFixedProjection * cam.orthoFixedView * vec4(vertexPosition*scale, 1.0);
  vec3 orthoFixedNDC = orthoFixedClipPosition.xyz / orthoFixedClipPosition.w;
  
  vec4 orthoZoomedClipPosition = cam.orthoZoomedProjection * cam.orthoZoomedView * vec4(vertexPosition*scale, 1.0)*0.5;
  vec3 orthoZoomedNDC = orthoZoomedClipPosition.xyz / orthoZoomedClipPosition.w;

  vec3 localNDC = mix(orthoZoomedNDC, orthoFixedNDC, 0.5);

  
  vec3 orthographicNDC = vec3(localNDC.xy + globalNDC.xy, globalNDC.z + (localNDC.z - 0.99)*0.0001 );
  
  vec4 orthographicClipPosition = vec4(orthographicNDC * globalClipPosition.w, globalClipPosition.w);
  
  return NodeGeometryBundle(
    globalNDC,
    globalClipPosition,
    orthoFixedClipPosition,
    orthoZoomedClipPosition,
    orthographicClipPosition
  );
}

ivec2 getTextureIndex(int index, ivec2 textureDimensions) {
  int textureLength = textureDimensions.x * textureDimensions.y;
  

  
  int x = index % textureDimensions.x;
  int y = index / textureDimensions.x;

  return ivec2(x,y);
}

uniform vec2 mousePosition;

uniform sampler2D positionTexture;
uniform sampler2D colorTexture;
uniform sampler2D sizeTexture;
uniform sampler2D emphasisTexture;

uniform ivec2 textureDimensions;

#ifdef PICKER
  flat out vec4 color;
#else
  out vec4 color;
#endif

out vec3 position;
out vec3 normal;

vec3 desaturate(vec3 color, float amount) {
  float average = (color.r + color.g + color.b) / 3.0;
  return mix(color, vec3(average), amount);
}

void main() {
  int id = int(index);
  
  vec3 nodePosition = texelFetch(positionTexture, getTextureIndex(id, textureDimensions), 0).xyz;
  vec4 nodeColor = texelFetch(colorTexture, getTextureIndex(id, textureDimensions), 0);
  float nodeSize = texelFetch(sizeTexture, getTextureIndex(id, textureDimensions), 0).r;
  float nodeEmphasis = texelFetch(emphasisTexture, getTextureIndex(id, textureDimensions), 0).r;

  float scale = nodeSize;
  float isSelected = float(index == selectedIndex);
  scale *= mix(1.0, 1.1, isSelected);
  
  #ifdef PICKER
    scale = max(scale, 0.05);
  #endif

  NodeGeometryBundle geo = nodeGeometry(
    nodePosition,
    vertexPosition,
    scale,
    CameraMatrices(
      projection,
      view,
      orthoFixedProjection,
      orthoFixedView,
      orthoZoomedProjection,
      orthoZoomedView
    )
  );
  
  
  
  
  

  vec4 clipPosition = geo.orthographicClipPosition;
  
  #ifdef PICKER
    color = instanceIdToColor();
  #else
    color = mix(nodeColor, selectedColor*1.4, float(index == selectedIndex));

    
    vec3 selectedNodePosition = texelFetch(positionTexture, getTextureIndex(selectedIndex, textureDimensions), 0).xyz;

    float fogVisibility = 0.2;

    
    float selectedDistance = length(nodePosition - selectedNodePosition);
    float anythingSelected = float(selectedIndex > -1);
    
    
    float fog = min(computeFog(geo.globalClipPosition.z, defaultFogBoundaryClipZ), 1.0-isSelected);
    fog = min(fog, 1.0-nodeEmphasis);
    color.rgb *= mix(1.0, 0.5, fog);
    color.rgb = desaturate(color.rgb, (1.0-fogVisibility)*fog);
    
    
  #endif

  normal = mat3(orthoFixedView) * vertexNormal;
  gl_Position = clipPosition;
}`,node_default=`#version 300 es
precision lowp float;
in vec4 color;
in vec3 normal;

in vec3 position;
out vec4 fragColor;

void main() {
  
  
  const vec3 lightDirection = normalize(vec3(0.0, 0.0, 1.0));
  float light = dot(normal, lightDirection);
  fragColor = vec4(color.xyz*light, color.a);
  
  
  
}`,node_picker_default$1=`#version 300 es
precision highp float;

vec4 instanceIdToColor() {
  int instanceId = gl_InstanceID+1;
  float r = float(instanceId & 0x0000FF) / 255.0;
  float g = float((instanceId & 0x00FF00) >> 8) / 255.0;
  float b = float((instanceId & 0xFF0000) >> 16) / 255.0;

  return vec4(r, g, b, 1.0);
}

#define PICKER
in vec3 vertexPosition;
in vec3 vertexNormal;
in int index;

uniform cameras {
  mat4 projection;
  mat4 view;
  mat4 orthoFixedProjection;
  mat4 orthoFixedView;
  mat4 orthoZoomedProjection;
  mat4 orthoZoomedView;
  float distance;
  vec3 center;
  vec3 rotationCenter;
};

uniform int selectedIndex;
uniform vec4 selectedColor;
float bump(float x, float q, float w) {
  float clamped_x = clamp(x/w, -0.5, 0.5);
  float y = pow(exp(1.0 - 1.0 / (1.0 - pow(2.0*clamped_x, 2.0))), q);
  return y;
}

float defaultFogVisibility = 0.3;
float defaultFogBoundaryClipZ = 700.0;

float computeFog(float positionClipZ, float fogBoundaryClipZ) {
  float fogLevel = 1.0 - bump(positionClipZ, 1.0, fogBoundaryClipZ);
  fogLevel = mix(
    fogLevel, 
    0.0,
    smoothstep(400.0, 800.0, distance)
  );
  
  return fogLevel;
}

struct CameraMatrices {
  mat4 projection;
  mat4 view;
  mat4 orthoFixedProjection;
  mat4 orthoFixedView;
  mat4 orthoZoomedProjection;
  mat4 orthoZoomedView;
};

struct NodeGeometryBundle {
  vec3 globalNDC;
  vec4 globalClipPosition;
  vec4 orthoFixedClipPosition;
  vec4 orthoZoomedClipPosition;
  vec4 orthographicClipPosition;
};

NodeGeometryBundle nodeGeometry(
  in vec3 nodePosition,
  in vec3 vertexPosition,
  float scale,
  in CameraMatrices cam
) {
  vec4 globalClipPosition = cam.projection * cam.view * vec4(nodePosition, 1.0);
  vec3 globalNDC = globalClipPosition.xyz / globalClipPosition.w;

  vec4 orthoFixedClipPosition = cam.orthoFixedProjection * cam.orthoFixedView * vec4(vertexPosition*scale, 1.0);
  vec3 orthoFixedNDC = orthoFixedClipPosition.xyz / orthoFixedClipPosition.w;
  
  vec4 orthoZoomedClipPosition = cam.orthoZoomedProjection * cam.orthoZoomedView * vec4(vertexPosition*scale, 1.0)*0.5;
  vec3 orthoZoomedNDC = orthoZoomedClipPosition.xyz / orthoZoomedClipPosition.w;

  vec3 localNDC = mix(orthoZoomedNDC, orthoFixedNDC, 0.5);

  
  vec3 orthographicNDC = vec3(localNDC.xy + globalNDC.xy, globalNDC.z + (localNDC.z - 0.99)*0.0001 );
  
  vec4 orthographicClipPosition = vec4(orthographicNDC * globalClipPosition.w, globalClipPosition.w);
  
  return NodeGeometryBundle(
    globalNDC,
    globalClipPosition,
    orthoFixedClipPosition,
    orthoZoomedClipPosition,
    orthographicClipPosition
  );
}

ivec2 getTextureIndex(int index, ivec2 textureDimensions) {
  int textureLength = textureDimensions.x * textureDimensions.y;
  

  
  int x = index % textureDimensions.x;
  int y = index / textureDimensions.x;

  return ivec2(x,y);
}

uniform vec2 mousePosition;

uniform sampler2D positionTexture;
uniform sampler2D colorTexture;
uniform sampler2D sizeTexture;
uniform sampler2D emphasisTexture;

uniform ivec2 textureDimensions;

#ifdef PICKER
  flat out vec4 color;
#else
  out vec4 color;
#endif

out vec3 position;
out vec3 normal;

vec3 desaturate(vec3 color, float amount) {
  float average = (color.r + color.g + color.b) / 3.0;
  return mix(color, vec3(average), amount);
}

void main() {
  int id = int(index);
  
  vec3 nodePosition = texelFetch(positionTexture, getTextureIndex(id, textureDimensions), 0).xyz;
  vec4 nodeColor = texelFetch(colorTexture, getTextureIndex(id, textureDimensions), 0);
  float nodeSize = texelFetch(sizeTexture, getTextureIndex(id, textureDimensions), 0).r;
  float nodeEmphasis = texelFetch(emphasisTexture, getTextureIndex(id, textureDimensions), 0).r;

  float scale = nodeSize;
  float isSelected = float(index == selectedIndex);
  scale *= mix(1.0, 1.1, isSelected);
  
  #ifdef PICKER
    scale = max(scale, 0.05);
  #endif

  NodeGeometryBundle geo = nodeGeometry(
    nodePosition,
    vertexPosition,
    scale,
    CameraMatrices(
      projection,
      view,
      orthoFixedProjection,
      orthoFixedView,
      orthoZoomedProjection,
      orthoZoomedView
    )
  );
  
  
  
  
  

  vec4 clipPosition = geo.orthographicClipPosition;
  
  #ifdef PICKER
    color = instanceIdToColor();
  #else
    color = mix(nodeColor, selectedColor*1.4, float(index == selectedIndex));

    
    vec3 selectedNodePosition = texelFetch(positionTexture, getTextureIndex(selectedIndex, textureDimensions), 0).xyz;

    float fogVisibility = 0.2;

    
    float selectedDistance = length(nodePosition - selectedNodePosition);
    float anythingSelected = float(selectedIndex > -1);
    
    
    float fog = min(computeFog(geo.globalClipPosition.z, defaultFogBoundaryClipZ), 1.0-isSelected);
    fog = min(fog, 1.0-nodeEmphasis);
    color.rgb *= mix(1.0, 0.5, fog);
    color.rgb = desaturate(color.rgb, (1.0-fogVisibility)*fog);
    
    
  #endif

  normal = mat3(orthoFixedView) * vertexNormal;
  gl_Position = clipPosition;
}`,node_picker_default=`#version 300 es
precision highp float;

flat in vec4 color;
out vec4 fragColor;

void main() {
  fragColor = color;
}`,edge_default$1=`#version 300 es
precision highp float;
precision highp int;

in vec3 segmentOffset;
in ivec2 edgeIndices;

out vec4 color;
out vec4 position;
out float size;
flat out vec2 edgeDirection;
flat out float edgeLength;
flat out float edgeLength2D;
flat out float isAnySelected;
flat out vec2 sourcePosition2D;
flat out vec2 targetPosition2D;
out float isSource;
out float isTarget;
out float emphasis;
out float selected;
out float hovering; 
out float v;
out float y;

out float offsetRadius2D;

uniform vec2 mousePosition;

uniform cameras {
  mat4 projection;
  mat4 view;
  mat4 orthoFixedProjection;
  mat4 orthoFixedView;
  mat4 orthoZoomedProjection;
  mat4 orthoZoomedView;
  float distance;
  vec3 center;
  vec3 rotationCenter;
};

uniform int selectedIndex;
uniform vec4 selectedColor;
float bump(float x, float q, float w) {
  float clamped_x = clamp(x/w, -0.5, 0.5);
  float y = pow(exp(1.0 - 1.0 / (1.0 - pow(2.0*clamped_x, 2.0))), q);
  return y;
}

float defaultFogVisibility = 0.3;
float defaultFogBoundaryClipZ = 700.0;

float computeFog(float positionClipZ, float fogBoundaryClipZ) {
  float fogLevel = 1.0 - bump(positionClipZ, 1.0, fogBoundaryClipZ);
  fogLevel = mix(
    fogLevel, 
    0.0,
    smoothstep(400.0, 800.0, distance)
  );
  
  return fogLevel;
}

struct CameraMatrices {
  mat4 projection;
  mat4 view;
  mat4 orthoFixedProjection;
  mat4 orthoFixedView;
  mat4 orthoZoomedProjection;
  mat4 orthoZoomedView;
};

struct NodeGeometryBundle {
  vec3 globalNDC;
  vec4 globalClipPosition;
  vec4 orthoFixedClipPosition;
  vec4 orthoZoomedClipPosition;
  vec4 orthographicClipPosition;
};

NodeGeometryBundle nodeGeometry(
  in vec3 nodePosition,
  in vec3 vertexPosition,
  float scale,
  in CameraMatrices cam
) {
  vec4 globalClipPosition = cam.projection * cam.view * vec4(nodePosition, 1.0);
  vec3 globalNDC = globalClipPosition.xyz / globalClipPosition.w;

  vec4 orthoFixedClipPosition = cam.orthoFixedProjection * cam.orthoFixedView * vec4(vertexPosition*scale, 1.0);
  vec3 orthoFixedNDC = orthoFixedClipPosition.xyz / orthoFixedClipPosition.w;
  
  vec4 orthoZoomedClipPosition = cam.orthoZoomedProjection * cam.orthoZoomedView * vec4(vertexPosition*scale, 1.0)*0.5;
  vec3 orthoZoomedNDC = orthoZoomedClipPosition.xyz / orthoZoomedClipPosition.w;

  vec3 localNDC = mix(orthoZoomedNDC, orthoFixedNDC, 0.5);

  
  vec3 orthographicNDC = vec3(localNDC.xy + globalNDC.xy, globalNDC.z + (localNDC.z - 0.99)*0.0001 );
  
  vec4 orthographicClipPosition = vec4(orthographicNDC * globalClipPosition.w, globalClipPosition.w);
  
  return NodeGeometryBundle(
    globalNDC,
    globalClipPosition,
    orthoFixedClipPosition,
    orthoZoomedClipPosition,
    orthographicClipPosition
  );
}

ivec2 getTextureIndex(int index, ivec2 textureDimensions) {
  int textureLength = textureDimensions.x * textureDimensions.y;
  

  
  int x = index % textureDimensions.x;
  int y = index / textureDimensions.x;

  return ivec2(x,y);
}

uniform sampler2D positionTexture;
uniform sampler2D colorTexture;
uniform sampler2D sizeTexture;
uniform sampler2D emphasisTexture;
uniform ivec2 textureDimensions;

uniform vec2 viewport;

uniform int hoveringIndex;

vec4 edgeGeometry(
  in vec3 nodePosition,
  in vec3 vertexPosition,
  in vec2 edgeDirection,
  float scale,
  float flatness,
  in CameraMatrices cam
) {
  vec2 normalizedEdgeDirection = normalize(edgeDirection);
  vec2 edgePerpendicular = vec2(-normalizedEdgeDirection.y, normalizedEdgeDirection.x)*scale/3.0;
  vec4 position = cam.projection * cam.view * vec4(nodePosition, 1.0);
  vec4 positionNDC = position / position.w;

  vec4 positionClip = vec4(position.xy + vertexPosition.y*1.0 * edgePerpendicular, position.zw);

  vec4 positionFixedStrokeNDC = positionNDC + vec4(vertexPosition.y * edgePerpendicular, 0.0, 0.0);
  vec4 positionFixedStrokeClip = positionFixedStrokeNDC * position.w;

  return mix(positionClip, positionFixedStrokeClip, flatness);
}

vec3 desaturate(vec3 color, float amount) {
  float average = (color.r + color.g + color.b) / 3.0;
  return mix(color, vec3(average), amount);
}

void main() {
  selected = float(selectedIndex == edgeIndices.x || selectedIndex == edgeIndices.y);
  hovering = float(hoveringIndex == edgeIndices.x || hoveringIndex == edgeIndices.y);
  isAnySelected = float(selectedIndex > -1);

  
  vec3 segmentPosition = segmentOffset.yxz + vec3(0.5, 0.0, 0.0);
  isSource = segmentPosition.x;
  isTarget = 1.0-segmentPosition.x;
  
  float sourceEmphasis = texelFetch(emphasisTexture, getTextureIndex(edgeIndices.x, textureDimensions), 0).r;
  float targetEmphasis = texelFetch(emphasisTexture, getTextureIndex(edgeIndices.y, textureDimensions), 0).r;

  emphasis = max(sourceEmphasis, targetEmphasis);
  
  position = vec4(0);
  vec3 vertexOffset = segmentPosition + vec3(0.0, 0, 0.0);

  vec3 sourceNodePosition = texelFetch(positionTexture, getTextureIndex(edgeIndices.x, textureDimensions), 0).xyz;
  vec3 targetNodePosition = texelFetch(positionTexture, getTextureIndex(edgeIndices.y, textureDimensions), 0).xyz;
  
  vec3 nodePosition = sourceNodePosition*isSource + targetNodePosition*isTarget;
  
  
  

  
  
  
  vec4 sourcePositionClip = projection * view * vec4(sourceNodePosition, 1.0);
  vec4 targetPositionClip = projection * view * vec4(targetNodePosition, 1.0);
  
  vec2 sourcePosition2DNDC = sourcePositionClip.xy/sourcePositionClip.w;
  vec2 targetPosition2DNDC = targetPositionClip.xy/targetPositionClip.w;
  
  
  sourcePosition2D = (sourcePosition2DNDC + 1.0) * 0.5 * viewport;
  targetPosition2D = (targetPosition2DNDC + 1.0) * 0.5 * viewport;
  edgeLength2D = length(targetPosition2D - sourcePosition2D);

  edgeDirection = normalize(targetPositionClip.xyz/targetPositionClip.w - sourcePositionClip.xyz/sourcePositionClip.w).xy;
  edgeLength = length(targetNodePosition.xyz - sourceNodePosition.xyz);

  
  

  

  
  
  
  
  
  
  
  
  
  
  
  
  

  
  
  
  
  
  
  
  
  
  
  
  
  

  
  

  
  
  
  

  float sourceSize = texelFetch(sizeTexture, getTextureIndex(edgeIndices.x, textureDimensions), 0).r;
  float targetSize = texelFetch(sizeTexture, getTextureIndex(edgeIndices.y, textureDimensions), 0).r;

  size = sourceSize*isSource + targetSize*isTarget;
  
  
  size *= 0.3;

  position = edgeGeometry(
    nodePosition,
    vertexOffset,
    edgeDirection,
    size,
    1.0,
    
    CameraMatrices(
      projection,
      
      view,
      orthoFixedProjection,
      
      orthoFixedView,
      orthoZoomedProjection,
      orthoZoomedView
    )
  );

  
  vec4 sourceColor = texelFetch(colorTexture, getTextureIndex(edgeIndices.x, textureDimensions), 0);
  sourceColor = mix(sourceColor, selectedColor, float(selectedIndex == edgeIndices.x));
  vec4 targetColor = texelFetch(colorTexture, getTextureIndex(edgeIndices.y, textureDimensions), 0);
  targetColor = mix(targetColor, selectedColor, float(selectedIndex == edgeIndices.y));
  color += sourceColor*isSource;
  color += targetColor*isTarget;

  
  color.rgb = desaturate(color.rgb, mix(1.0, 0.2, emphasis));
  color.a *= mix(0.2, 1.0, mix(1.0, emphasis, isAnySelected));
  color.a *= mix(0.4, 1.0, mix(1.0, selected, isAnySelected));
  
  float fog = computeFog(position.z, defaultFogBoundaryClipZ);
  fog = min(fog, 1.0 - selected);
  fog = min(fog, 1.0 - emphasis);
  color.a *= mix(1.0, 0.1, fog);
  
  
  
  gl_Position = position;
  y = vertexOffset.y;
  v = segmentPosition.y;

  

  
  
  
  
  

  
  
  
  
}`,edge_default=`#version 300 es

precision highp float;

in float selected;
in float isTarget;

in vec4 color;

in float emphasis;
in float size;
in float offsetRadius2D;

flat in float edgeLength;
flat in float edgeLength2D;
flat in vec2 sourcePosition2D;
flat in vec2 targetPosition2D;
in float y;
in float v;

out vec4 fragColor;

const float PI = 3.1415926535897932384626433832795;
const float freq = 1.0;

uniform float time;
uniform float devicePixelRatio;
uniform sampler2D nodeDepthTexture;

float bump(float x, float q, float w) {
  float clamped_x = clamp(x/w, -0.5, 0.5);
  float y = pow(exp(1.0 - 1.0 / (1.0 - pow(2.0*clamped_x, 2.0))), q);
  return y;
}

float wave(float t, float freq){ return pow(sin(t * freq * PI), 2.0); }
void main() {
  
  float u_2D = length(gl_FragCoord.xy/devicePixelRatio - sourcePosition2D)/edgeLength2D;
  fragColor = color;
  
  float u_3D = isTarget;
  
  
  

  
  float u_hybrid = mix(u_2D, u_3D, 0.5);
  float endBumpsMellow = 
    bump(u_hybrid,       1.0, 0.5) +
    bump(u_hybrid - 1.0, 1.0, 0.5);
    
  float endBumpsFirm = 
    bump(u_hybrid,       1.0, 0.1) +
    bump(u_hybrid - 1.0, 1.0, 0.1);

  
  float otherEndBumps = 
    bump(u_3D      , 1.0, offsetRadius2D/edgeLength) +
    bump(u_3D - 1.0, 1.0, offsetRadius2D/edgeLength);

  
  
  float frequency = edgeLength2D / 4.0;
  float waveSpeed = 4.0;
  float waves = mix(
    1.0,
    wave(u_2D + time/frequency * waveSpeed, frequency), 
    mix(0.5, 1.0, emphasis) 
  );

  
  float highFrequency = edgeLength/4.0;
  float pulseSpeed = 20.0/edgeLength;
  float pulse = pow(wave(u_3D + time * pulseSpeed, 1.0), edgeLength2D);
  
  
  fragColor.rgb = mix(fragColor.rgb, vec3(1.0, 1.0, 0.0), mix(0.0, pulse, 0.1));
  
  
  fragColor.a *= mix(1.0, waves, 1.0-pulse);
  
  
  fragColor.a *= bump(
    v, 
    1.0, 
    (pulse * mix(0.2, 0.4, selected) * wave(u_3D, highFrequency)) + 0.6
  );
  
  
  
  
  
  fragColor.a *= mix(0.4, 1.0, selected);
  
  
  fragColor.a *= mix(1.0, 0.0, mix(endBumpsMellow, endBumpsFirm, pulse));

  
  float nodeDepth = texelFetch(nodeDepthTexture, ivec2(gl_FragCoord.xy), 0).r;
  
  gl_FragDepth = max(gl_FragCoord.z, nodeDepth) - 0.0001;

  
  
  

  
  
  
}`;const getNodeVisualizerMesh=moize.infinite(()=>{let U=new BoxGeometry(1,1,1);const D=new InstancedBufferGeometry;D.setAttribute("vertexPosition",U.attributes.position),D.setAttribute("vertexNormal",U.attributes.normal),D.setIndex(U.index),D.setAttribute("index",new InstancedBufferAttribute(new Int32Array([]),1));const F=new RawShaderMaterial({vertexShader:node_default$1,fragmentShader:node_default}),G=new RawShaderMaterial({vertexShader:node_picker_default$1,fragmentShader:node_picker_default,depthWrite:!0});D.setAttribute("index",new InstancedBufferAttribute(new Int32Array([1,2,3,4]),1)),F.uniformsGroups=[getCamerasUniformsGroup()];const Q=new Mesh(D,F),X=new Mesh(D,G);return{mesh:Q,pickerMesh:X}}),initializeNodeVisualizerUniforms=()=>{const{mesh:U,pickerMesh:D}=getNodeVisualizerMesh();U.material.uniforms={positionTexture:{value:getPositionLayers().viewTexture},colorTexture:{value:getColorLayers().viewTexture},sizeTexture:{value:getSizeLayers().viewTexture},emphasisTexture:{value:getEmphasisLayers().viewTexture},textureDimensions:{value:[getColorLayers().view.width,getColorLayers().view.height]},mousePosition:{value:getPointerPositionClip()},selectedIndex:{value:-1},selectedColor:{value:getSelectedColor()},hoveringIndex:{value:getCurrentlyHoveringIndex()},time:{value:performance.now()/1e3}},D.material.uniforms=U.material.uniforms,U.material.needsUpdate=!0,D.material.needsUpdate=!0},updateNodeVisualizerUniforms=()=>{const{mesh:U,pickerMesh:D}=getNodeVisualizerMesh();for(const F of[U.material.uniforms,D.material.uniforms])F.positionTexture.value=getPositionLayers().viewTexture,F.colorTexture.value=getColorLayers().viewTexture,F.sizeTexture.value=getSizeLayers().viewTexture,F.emphasisTexture.value=getEmphasisLayers().viewTexture,F.textureDimensions.value=[getColorLayers().view.width,getColorLayers().view.height],F.mousePosition.value=getPointerPositionClip(),F.selectedIndex.value=getSelectedIndex(),F.selectedColor.value=getSelectedColor(),F.hoveringIndex.value=getCurrentlyHoveringIndex(),F.time.value=performance.now()/1e3},getNodeIndexArray=moize.infinite(U=>{const D=new Int32Array(U);for(let F=0;F<U;F++)D[F]=F;return new InstancedBufferAttribute(D,1)}),loadNodeVertexArray=U=>{console.log("loading node vertex array",U);const{mesh:D,pickerMesh:F}=getNodeVisualizerMesh(),G=getNodeIndexArray(U);D.geometry.setAttribute("index",G),F.geometry.setAttribute("index",G)},getEdgeVisualizerMesh=moize.infinite(()=>{const U=new CylinderGeometry(.5,.5,1,4,4,!0),D=new InstancedBufferGeometry;D.setAttribute("segmentOffset",U.attributes.position),D.setIndex(U.index),D.setAttribute("edgeIndices",new InstancedBufferAttribute(new Int32Array([1,2,3]),2));const F=new RawShaderMaterial({vertexShader:edge_default$1,fragmentShader:edge_default,uniforms:{},depthTest:!!deviceHasMouse(),depthWrite:!0,depthFunc:LessEqualDepth,transparent:!0});return new Mesh(D,F)}),getEdgeIndexBuffer=moize.infinite(U=>{const D=new Int32Array(U.flat());return new InstancedBufferAttribute(D,2)}),loadEdgeVertexArray=U=>{const D=getEdgeVisualizerMesh(),F=getEdgeIndexBuffer(U);D.geometry.setAttribute("edgeIndices",F)},initializeEdgeVisualizerUniforms=()=>{const U=getEdgeVisualizerMesh();U.material.uniforms={positionTexture:{value:getPositionLayers().viewTexture},colorTexture:{value:getColorLayers().viewTexture},sizeTexture:{value:getSizeLayers().viewTexture},nodeDepthTexture:{value:getNodeDepthRenderTarget().depthTexture},emphasisTexture:{value:getEmphasisLayers().viewTexture},textureDimensions:{value:[getColorLayers().current.width,getColorLayers().current.height]},mousePosition:{value:getPointerPositionClip()},selectedIndex:{value:getSelectedIndex()},selectedColor:{value:getSelectedColor()},hoveringIndex:{value:getCurrentlyHoveringIndex()},time:{value:performance.now()/1e3},viewport:{value:[0,0]},devicePixelRatio:{value:window.devicePixelRatio}},U.material.uniformsGroups=[getCamerasUniformsGroup()],U.material.needsUpdate=!0},viewport=new Vector2,updateEdgeVisualizerUniforms=()=>{const{renderer:U}=getThreeSetup();U.getSize(viewport);const D=getEdgeVisualizerMesh();for(const F of[D.material.uniforms])F.positionTexture.value=getPositionLayers().viewTexture,F.colorTexture.value=getColorLayers().viewTexture,F.sizeTexture.value=getSizeLayers().viewTexture,F.emphasisTexture.value=getEmphasisLayers().viewTexture,F.textureDimensions.value=[getColorLayers().view.width,getColorLayers().view.height],F.nodeDepthTexture.value=getNodeDepthRenderTarget().depthTexture,F.mousePosition.value=getPointerPositionClip(),F.selectedIndex.value=getSelectedIndex(),F.selectedColor.value=getSelectedColor(),F.hoveringIndex.value=getCurrentlyHoveringIndex(),F.time.value=performance.now()/1e3,F.viewport.value=viewport.toArray()},getThreeSetup=moize.infinite(()=>{const{canvas:U,gl:D}=getCanvasAndGLContext(),F=new Scene,G=new Scene,Q=new Scene,X=new PerspectiveCamera(75,window.innerWidth/window.innerHeight,.5,1e3);X.position.z=50;const q=new WebGLRenderer({canvas:U,context:D});q.setSize(window.innerWidth,window.innerHeight),q.setPixelRatio(window.devicePixelRatio);const W=getEdgeVisualizerMesh();F.add(W);const Y=getNodeVisualizerMesh().mesh;F.add(Y);const J=getNodeVisualizerMesh().pickerMesh;return Q.add(J),{scene:F,depthScene:G,pickerScene:Q,camera:X,renderer:q,nodeVisualizerMesh:Y,edgeVisualizerMesh:W,nodePickerMesh:J}}),getPickerRenderTarget=moize.infinite(()=>{const{canvas:U}=getCanvasAndGLContext();return new WebGLRenderTarget(U.width,U.height,{stencilBuffer:!1})}),getNodeDepthRenderTarget=moize.infinite(()=>{const{canvas:U}=getCanvasAndGLContext();return new WebGLRenderTarget(U.width,U.height,{depthTexture:new DepthTexture(U.width,U.height),depthBuffer:!0,stencilBuffer:!1})}),normalizedEventCoordinates=U=>{const{canvas:D}=getCanvasAndGLContext(),F=D.getBoundingClientRect(),G=(U.clientX-F.left)/F.width,Q=(U.clientY-F.top)/F.height;return{x:G*2-1,y:-(Q*2-1)}},{globalCamera,updateCameras,getGlobalCameraParams,setCameraCenter,setCameraDistance,zoomGlobalCamera,panGlobalCamera,startZooming,startPanning,stopPanning,computeScreenPosition}=graphCameraAnimation,deviceHasMouse=moize.infinite(()=>window.matchMedia("(pointer:fine)").matches);let selectedZoom,deselectedZoom;const maxSelectedZoom=500,minUnselectedZoom=maxSelectedZoom,stopZooming=async()=>{const U=getSelectedIndex(),D=(await getGlobalCameraParams()).distance;U>-1?selectedZoom=Math.min(D,maxSelectedZoom):deselectedZoom=Math.max(D,minUnselectedZoom)},pointerPositionInfo={},pickedColor=new Uint8Array(4).fill(0);let lastOverIndex=-1,dragging=!1,countLastDragEvents=0,cumulativeDragDistance=0;const incrementDragEvents=()=>{countLastDragEvents++},getPointerPositionClip=()=>[pointerPositionInfo.x,pointerPositionInfo.y],getPointerPositionPicker=()=>[pointerPositionInfo.pickerX,pointerPositionInfo.pickerY],collectPointerPositionInfo=({x:U,y:D})=>{const{canvas:F}=getCanvasAndGLContext();pointerPositionInfo.x=U,pointerPositionInfo.y=D,pointerPositionInfo.canvasX=(U+1)/2*F.width,pointerPositionInfo.canvasY=(D+1)/2*F.height;const G=window.devicePixelRatio||1;pointerPositionInfo.pickerX=Math.floor(pointerPositionInfo.canvasX/G),pointerPositionInfo.pickerY=Math.floor(pointerPositionInfo.canvasY/G)};let currentlyHoveringIndex=-1;const getCurrentlyHoveringIndex=()=>currentlyHoveringIndex,getCurrentlyHoveringNode=async()=>{const{nodes:U}=await getGraphData();return U[currentlyHoveringIndex]},setupSelection=moize.infinite(()=>{const{canvas:U}=getCanvasAndGLContext();normalizedInteractionEvents_1(U).on("touchmove",collectPointerPositionInfo).on("mousemove",collectPointerPositionInfo),normalizedInteractionEvents_1(U).on("mousemove",()=>{!dragging&&updatePickerColorDebounced()}),normalizedInteractionEvents_1(U).on("touchmove",incrementDragEvents).on("pinchmove",incrementDragEvents).on("mousemove",incrementDragEvents),U.addEventListener("pointerdown",async D=>{const F=async([Q,X])=>{const q=cumulativeDragDistance>.03||countLastDragEvents>5;if(dragging=!1,!q){const W=getCurrentlyHoveringIndex();setSelectedIndex(W),getSelectedInfo().then(Y=>{U.dispatchEvent(new CustomEvent("selected",{detail:{selectedIndex:W,info:Y}}))}),U.dispatchEvent(new CustomEvent("tap",{detail:{selectedIndex:W}}))}},G=new Promise((Q,X)=>{U.addEventListener("pointerup",Q,{once:!0}),setTimeout(()=>X("pointer event timed out after 100ms"),200)});dragging=!0,countLastDragEvents=0,cumulativeDragDistance=0,Promise.all([G,getNextHoverOnUpdate()]).then(F).catch(()=>{}),setTimeout(()=>{cumulativeDragDistance>.03||countLastDragEvents>5||updatePickerColor()},2),collectPointerPositionInfo(normalizedEventCoordinates(D))}),U.addEventListener("selected",D=>{const F=D.detail.info;console.log("preparing to navigate:",F),src_default.push(F?`#project/${F?.navId}`:"#-")}),U.addEventListener("hover",async D=>{const{nodes:F}=await getGraphData(),G=D.detail.wasHoveredIndex;G>-1&&F[G];const Q=D.detail.nowHoveredIndex,X=Q>-1?F[Q]:null;getSelectedIndex()>-1&&F[getSelectedIndex()],X?currentlyHoveringIndex=X?.index||-1:currentlyHoveringIndex=-1})}),radiansPerHalfScreenWidth=Math.PI/3,setupCameraInteraction=()=>{const{canvas:U}=getCanvasAndGLContext();U.addEventListener("wheel",D=>{const F=Math.exp(D.deltaY/U.clientHeight*2)-1,G=Math.sign(F);startZooming(),zoomGlobalCamera(0,0,G*Math.min(Math.abs(F),.06)),D.preventDefault(),stopZooming()},{passive:!1}),normalizedInteractionEvents_1(U).on("mousemove",function(D){!D.active||D.buttons!==1||(cumulativeDragDistance+=Math.sqrt(Math.pow(D.dx,2)+Math.pow(D.dy,2)),D.mods.shift?(startPanning(),panGlobalCamera(D.dx,D.dy)):D.mods.meta?globalCamera.pivot(D.dx,D.dy):(globalCamera.rotate(-D.dx*radiansPerHalfScreenWidth,-D.dy*radiansPerHalfScreenWidth),stopPanning()),D.originalEvent.preventDefault())}).on("touchmove",function(D){collectPointerPositionInfo(D),D.active&&(cumulativeDragDistance+=Math.sqrt(Math.pow(D.dx,2)+Math.pow(D.dy,2)),globalCamera.rotate(-D.dx*radiansPerHalfScreenWidth,-D.dy*radiansPerHalfScreenWidth))}).on("pinchmove",function(D){D.active&&(dragging=!0,startPanning(),startZooming(),zoomGlobalCamera(0,0,1-D.zoomx),panGlobalCamera(D.dx,D.dy))}).on("touchstart",D=>D.originalEvent.preventDefault()).on("pinchstart",D=>D.originalEvent.preventDefault()).on("pinchend",()=>{stopPanning(),stopZooming()})},getNodeIndexFromPickerColor=U=>U[0]+U[1]*256+U[2]*256*256-1;let pickerSync=null;const checkPickerSync=()=>{const U=getCanvasAndGLContext().gl,D=()=>U.fenceSync(U.SYNC_GPU_COMMANDS_COMPLETE,0);return pickerSync?U?.clientWaitSync(pickerSync,0,0)===U?.CONDITION_SATISFIED?(U.deleteSync(pickerSync),pickerSync=D(),!0):!1:(pickerSync=D(),!1)};let pickerFailures=0,pickerGuardFailed=!1;const updatePickerColor=()=>{const U=checkPickerSync(),{canvas:D}=getCanvasAndGLContext(),F=getCanvasAndGLContext().gl;if(pickerFailures>10&&(pickerGuardFailed=!0,console.warn("picker guard failed")),!U&&!pickerGuardFailed)console.log("not ready to read picker pixel yet"),pickerFailures+=1;else{pickerFailures=0;const{renderer:G}=getThreeSetup(),Q=getPointerPositionPicker(),X=getPickerRenderTarget();G.readRenderTargetPixels(X,...Q,1,1,pickedColor),F.flush();const q=getNodeIndexFromPickerColor(pickedColor);setTimeout(()=>{D.dispatchEvent(new CustomEvent("hover",{detail:{wasHoveredIndex:lastOverIndex,nowHoveredIndex:q}}))},1),q>-1&&setTimeout(()=>{D.dispatchEvent(new CustomEvent("hoveron",{detail:{wasHoveredIndex:lastOverIndex,nowHoveredIndex:q}}))},1),lastOverIndex=q}},updatePickerColorThrottled=throttle(updatePickerColor,1e3),updatePickerColorDebounced=debounce(updatePickerColor,300),getNextHoverOnUpdate=async()=>new Promise(U=>{const D=getCanvasAndGLContext().canvas,F=G=>{U(G.detail)};D.addEventListener("hover",F,{once:!0})}),getSelectedInfo=async()=>{const{nodes:U}=await getGraphData();return U[getSelectedIndex()]},makeCursor=({classes:U,htmlTemplate:D,applyScreenPositionStyle:F}={})=>{F=F||((Y,J)=>{J.style.left=`${Y[0]}vw`,J.style.bottom=`${Y[1]}vh`});const G=document.createElement("div");G.classList.add("cursor"),U?.forEach(Y=>G.classList.add(Y)),document.body.appendChild(G);const Q=Y=>{F(Y,G)},X=Y=>{const J=[(Y[0]+1)/2*100,(Y[1]+1)/2*100];Q(J)},q=throttle(async Y=>{const J=getNodePosition(Y),te=await computeScreenPosition(J);X(te)},1e3/10),W=throttle(async Y=>{Y?(await q(Y),G.classList.add("focused")):G.classList.remove("focused"),Y&&D&&B(D(Y),G)},50);return{element:G,alignToScreenPosition:Q,alignToNDCPosition:X,alignToNode:q,highlightNode:W,destroy:()=>G.remove()}},selectedCursor=makeCursor({classes:["selected-cursor"]}),hoveredTooltip=makeCursor({classes:["hovered-tooltip"],htmlTemplate:U=>x$2`
    <div class="node-name">${U.data.name}</div>
  `,applyScreenPositionStyle(U,D){D.style.left=`calc(min(${U[0]}vw, calc(100vw - 15em)))`,D.style.bottom=`${U[1]}vh`}}),hoveredCursor=makeCursor({classes:["hovered-cursor"]});window.addEventListener("keydown",U=>{U.key,U.key});const getWidthAndHeight=()=>{const U=window.devicePixelRatio||1,D=window.innerWidth,F=window.innerHeight,G=Math.floor(D*U),Q=Math.floor(F*U);return{width:G,height:Q}},getCanvasAndGLContext=moize.infinite(()=>{const U=document.createElement("canvas");document.body.appendChild(U);const D=U.getContext("webgl2",{powerPreference:"high-performance"});return D?console.log("WebGL2 initialized"):console.error("WebGL2 failed to initialize"),{canvas:U,gl:D}}),getGPUComposer=moize.infinite(()=>{const{renderer:U}=getThreeSetup();return gpuIoExports.GPUComposer.initWithThreeRenderer(U)}),fillCanvasToWindow=()=>{const{canvas:U}=getCanvasAndGLContext(),{renderer:D}=getThreeSetup(),{width:F,height:G}=getWidthAndHeight();D.setSize(window.innerWidth,window.innerHeight),getPickerRenderTarget().setSize(window.innerWidth,window.innerHeight),getNodeDepthRenderTarget().setSize(F,G),globalCamera.resize(F/G),U.style.position="absolute",U.style.top="0px",U.style.left="0px",U.style.height="100vh"};fillCanvasToWindow();gpuIoExports.copyProgram(getGPUComposer(),{name:"copy",type:gpuIoExports.FLOAT});initializeNodeVisualizerUniforms();initializeEdgeVisualizerUniforms();getCanvasAndGLContext();const interpolate=()=>{const U=getGPUComposer();U.undoThreeState();const D=[getPositionLayers(),getColorLayers(),getSizeLayers(),getEmphasisLayers()],F=getInterpolationProgram();U.step({program:F,input:D.flatMap(G=>[G.target,G.current]),output:D.flatMap(G=>[G.current,G.view])}),U.resetThreeState()},animateGraph=()=>{updateNodePositionTargets(),getSelectedNode().then(q=>{selectedCursor.highlightNode(q)}),deviceHasMouse()&&getCurrentlyHoveringNode().then(q=>{hoveredTooltip.highlightNode(q),hoveredCursor.highlightNode(q)}),updateCameras(updateCamerasUniformsGroup,window.innerWidth,window.innerHeight),interpolate(),fillCanvasToWindow();const{renderer:U,scene:D,camera:F,nodeVisualizerMesh:G,nodePickerMesh:Q,edgeVisualizerMesh:X}=getThreeSetup();updateNodeVisualizerUniforms(),updateEdgeVisualizerUniforms(),G.material.depthTest&&(U.setRenderTarget(getNodeDepthRenderTarget()),U.render(G,F)),U.setRenderTarget(null),U.render(D,F),U.setRenderTarget(getPickerRenderTarget()),U.render(Q,F),deviceHasMouse()&&updatePickerColorThrottled(),requestAnimationFrame(animateGraph)},fpsIndicator=document.createElement("div");document.body.appendChild(fpsIndicator);fpsIndicator.id="fps-indicator";fpsIndicator.classList.add("overlay");fpsIndicator.classList.add("debug");fpsIndicator.innerHTML=`
<div class="value">FPS: 0</div>
<canvas width="60" height="100" class="graph"></canvas>
`;fpsIndicator.style.position="absolute";fpsIndicator.style.top="0px";fpsIndicator.style.left="0px";fpsIndicator.style.color="white";const fpsValue=document.querySelector("#fps-indicator .value"),fpsCanvas=document.querySelector("#fps-indicator .graph"),fpsCanvasCtx=fpsCanvas.getContext("2d");let lastTime=performance.now(),lastIndicatorUpdate=performance.now(),frames=0,fpsHistory=[];const smaWindow=1,getFPS=()=>fpsHistory.slice(0,smaWindow).reduce((U,D)=>U+D,0)/smaWindow,trackFPS=()=>{const U=getFPS(),D=performance.now();frames++,D>lastTime+100&&(fpsHistory=[Math.round(frames*1e3/(D-lastTime)/2),...fpsHistory].slice(0,1e3),fpsCanvasCtx?.clearRect(0,0,fpsCanvas.width,fpsCanvas.height),fpsCanvasCtx?.beginPath(),fpsCanvasCtx?.moveTo(0,fpsCanvas.height),fpsHistory.forEach((F,G)=>{fpsCanvasCtx?.lineTo(G,fpsCanvas.height-F)}),fpsCanvasCtx?.lineTo(fpsHistory.length,fpsCanvas.height),fpsCanvasCtx.fillStyle="rgba(255, 255, 255, 0.5)",fpsCanvasCtx?.fill(),fpsCanvasCtx?.stroke(),lastTime=D,frames=0),D>lastIndicatorUpdate+1e3&&(lastIndicatorUpdate=D,fpsValue.innerText=`FPS: ${U}`),requestAnimationFrame(trackFPS)};trackFPS();var throttledQueueExports={},throttledQueue={get exports(){return throttledQueueExports},set exports(U){throttledQueueExports=U}};(function(U,D){Object.defineProperty(D,"__esModule",{value:!0});function F(G,Q,X){X===void 0&&(X=!1),X&&(Q=Q/G,G=1);var q=[],W=0,Y=0,J,te=function(){var Z=W+Q,ee=Date.now();if(ee<Z){J!==void 0&&clearTimeout(J),J=setTimeout(te,Z-ee);return}W=ee,Y=0;for(var re=0,ne=q.splice(0,G);re<ne.length;re++){var le=ne[re];Y++,le()}q.length?J=setTimeout(te,Q):J=void 0};return function(Z){return new Promise(function(ee,re){var ne=function(){return Promise.resolve().then(Z).then(ee).catch(re)},le=Date.now();J===void 0&&le-W>Q&&(W=le,Y=0),Y++<G?ne():(q.push(ne),J===void 0&&(J=setTimeout(te,W+Q-le)))})}}U.exports=F,D.default=F})(throttledQueue,throttledQueueExports);const queuedThrottle=getDefaultExportFromCjs(throttledQueueExports);getThreeSetup();setupCameraInteraction();setupSelection();document.querySelector("html")?.classList.add("loading");let graphData=await getGraphData();await prepareGraphDBWorker();const{nodes,linkIndexPairs}=graphData;loadEdgeVertexArray(linkIndexPairs);loadNodeVertexArray(nodes.length);setAllLayerSizes(nodes.length);const colors=new Float32Array(nodes.flatMap(({color:U})=>U));getColorLayers().target.setFromArray(colors);getColorLayers().current.setFromArray(colors);const nodeSizes=new Float32Array(nodes.length);for(let U=0;U<nodeSizes.length;U++)nodeSizes[U]=Math.sqrt(nodes[U].size)/40;getSizeLayers().target.setFromArray(nodeSizes);getSizeLayers().current.setFromArray(nodeSizes);const scale=40,randomPoint=()=>[Math.random()*scale-1,Math.random()*scale-1,Math.random()*scale-1],initialNodePositions=new Float32Array(nodes.flatMap(randomPoint));getPositionLayers().target.setFromArray(initialNodePositions);getPositionLayers().current.setFromArray(initialNodePositions);getEmphasisLayers().target.setFromArray(new Float32Array(nodes.length).fill(0));getEmphasisLayers().current.setFromArray(new Float32Array(nodes.length).fill(0));const statsPanel=document.createElement("div");statsPanel.classList.add("overlay");statsPanel.classList.add("debug");statsPanel.style.top="0";statsPanel.style.right="0";document.body.appendChild(statsPanel);statsPanel.innerHTML=`
    <div>Nodes: ${nodes.length}</div>
    <div>Edges: ${linkIndexPairs.length}</div>
    <div id="debug-message"></div>
`;document.querySelector("html").classList.remove("loading");animateGraph();trackFPS();src_default.start();window.addEventListener("keydown",U=>{const D=document.querySelector("html").classList.contains("debug");U.key==="d"&&document.querySelector("html").classList.toggle("debug",!D)});queuedThrottle(1,1e3);let lastTap=0,tapCount=0;document.addEventListener("pointerup",U=>{const D=Date.now();D-lastTap<300?tapCount++:tapCount=1,lastTap=D,tapCount===4&&(tapCount=0,document.querySelector("html").classList.toggle("debug"))})})();